var LU=Object.defineProperty;var NU=(t,e,n)=>e in t?LU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var O=(t,e,n)=>NU(t,typeof e!="symbol"?e+"":e,n);function zU(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _l(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var vb={exports:{}},Lh={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xM;function $U(){if(xM)return Lh;xM=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var l in i)l!=="key"&&(s[l]=i[l])}else s=i;return i=s.ref,{$$typeof:t,type:r,key:o,ref:i!==void 0?i:null,props:s}}return Lh.Fragment=e,Lh.jsx=n,Lh.jsxs=n,Lh}var wM;function BU(){return wM||(wM=1,vb.exports=$U()),vb.exports}var p=BU(),bb={exports:{}},Ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CM;function FU(){if(CM)return Ze;CM=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function m(H){return H===null||typeof H!="object"?null:(H=g&&H[g]||H["@@iterator"],typeof H=="function"?H:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,v={};function w(H,te,ge){this.props=H,this.context=te,this.refs=v,this.updater=ge||S}w.prototype.isReactComponent={},w.prototype.setState=function(H,te){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,te,"setState")},w.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=w.prototype;function _(H,te,ge){this.props=H,this.context=te,this.refs=v,this.updater=ge||S}var M=_.prototype=new C;M.constructor=_,b(M,w.prototype),M.isPureReactComponent=!0;var I=Array.isArray,A={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function D(H,te,ge,de,Se,me){return ge=me.ref,{$$typeof:t,type:H,key:te,ref:ge!==void 0?ge:null,props:me}}function L(H,te){return D(H.type,te,void 0,void 0,void 0,H.props)}function G(H){return typeof H=="object"&&H!==null&&H.$$typeof===t}function k(H){var te={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ge){return te[ge]})}var $=/\/+/g;function F(H,te){return typeof H=="object"&&H!==null&&H.key!=null?k(""+H.key):te.toString(36)}function N(){}function B(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(N,N):(H.status="pending",H.then(function(te){H.status==="pending"&&(H.status="fulfilled",H.value=te)},function(te){H.status==="pending"&&(H.status="rejected",H.reason=te)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function Y(H,te,ge,de,Se){var me=typeof H;(me==="undefined"||me==="boolean")&&(H=null);var Me=!1;if(H===null)Me=!0;else switch(me){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(H.$$typeof){case t:case e:Me=!0;break;case f:return Me=H._init,Y(Me(H._payload),te,ge,de,Se)}}if(Me)return Se=Se(H),Me=de===""?"."+F(H,0):de,I(Se)?(ge="",Me!=null&&(ge=Me.replace($,"$&/")+"/"),Y(Se,te,ge,"",function(Ie){return Ie})):Se!=null&&(G(Se)&&(Se=L(Se,ge+(Se.key==null||H&&H.key===Se.key?"":(""+Se.key).replace($,"$&/")+"/")+Me)),te.push(Se)),1;Me=0;var Ne=de===""?".":de+":";if(I(H))for(var we=0;we<H.length;we++)de=H[we],me=Ne+F(de,we),Me+=Y(de,te,ge,me,Se);else if(we=m(H),typeof we=="function")for(H=we.call(H),we=0;!(de=H.next()).done;)de=de.value,me=Ne+F(de,we++),Me+=Y(de,te,ge,me,Se);else if(me==="object"){if(typeof H.then=="function")return Y(B(H),te,ge,de,Se);throw te=String(H),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return Me}function K(H,te,ge){if(H==null)return H;var de=[],Se=0;return Y(H,de,"","",function(me){return te.call(ge,me,Se++)}),de}function V(H){if(H._status===-1){var te=H._result;te=te(),te.then(function(ge){(H._status===0||H._status===-1)&&(H._status=1,H._result=ge)},function(ge){(H._status===0||H._status===-1)&&(H._status=2,H._result=ge)}),H._status===-1&&(H._status=0,H._result=te)}if(H._status===1)return H._result.default;throw H._result}var W=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)};function ee(){}return Ze.Children={map:K,forEach:function(H,te,ge){K(H,function(){te.apply(this,arguments)},ge)},count:function(H){var te=0;return K(H,function(){te++}),te},toArray:function(H){return K(H,function(te){return te})||[]},only:function(H){if(!G(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Ze.Component=w,Ze.Fragment=n,Ze.Profiler=i,Ze.PureComponent=_,Ze.StrictMode=r,Ze.Suspense=u,Ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ze.act=function(){throw Error("act(...) is not supported in production builds of React.")},Ze.cache=function(H){return function(){return H.apply(null,arguments)}},Ze.cloneElement=function(H,te,ge){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var de=b({},H.props),Se=H.key,me=void 0;if(te!=null)for(Me in te.ref!==void 0&&(me=void 0),te.key!==void 0&&(Se=""+te.key),te)!R.call(te,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&te.ref===void 0||(de[Me]=te[Me]);var Me=arguments.length-2;if(Me===1)de.children=ge;else if(1<Me){for(var Ne=Array(Me),we=0;we<Me;we++)Ne[we]=arguments[we+2];de.children=Ne}return D(H.type,Se,void 0,void 0,me,de)},Ze.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:s,_context:H},H},Ze.createElement=function(H,te,ge){var de,Se={},me=null;if(te!=null)for(de in te.key!==void 0&&(me=""+te.key),te)R.call(te,de)&&de!=="key"&&de!=="__self"&&de!=="__source"&&(Se[de]=te[de]);var Me=arguments.length-2;if(Me===1)Se.children=ge;else if(1<Me){for(var Ne=Array(Me),we=0;we<Me;we++)Ne[we]=arguments[we+2];Se.children=Ne}if(H&&H.defaultProps)for(de in Me=H.defaultProps,Me)Se[de]===void 0&&(Se[de]=Me[de]);return D(H,me,void 0,void 0,null,Se)},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(H){return{$$typeof:l,render:H}},Ze.isValidElement=G,Ze.lazy=function(H){return{$$typeof:f,_payload:{_status:-1,_result:H},_init:V}},Ze.memo=function(H,te){return{$$typeof:d,type:H,compare:te===void 0?null:te}},Ze.startTransition=function(H){var te=A.T,ge={};A.T=ge;try{var de=H(),Se=A.S;Se!==null&&Se(ge,de),typeof de=="object"&&de!==null&&typeof de.then=="function"&&de.then(ee,W)}catch(me){W(me)}finally{A.T=te}},Ze.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ze.use=function(H){return A.H.use(H)},Ze.useActionState=function(H,te,ge){return A.H.useActionState(H,te,ge)},Ze.useCallback=function(H,te){return A.H.useCallback(H,te)},Ze.useContext=function(H){return A.H.useContext(H)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(H,te){return A.H.useDeferredValue(H,te)},Ze.useEffect=function(H,te){return A.H.useEffect(H,te)},Ze.useId=function(){return A.H.useId()},Ze.useImperativeHandle=function(H,te,ge){return A.H.useImperativeHandle(H,te,ge)},Ze.useInsertionEffect=function(H,te){return A.H.useInsertionEffect(H,te)},Ze.useLayoutEffect=function(H,te){return A.H.useLayoutEffect(H,te)},Ze.useMemo=function(H,te){return A.H.useMemo(H,te)},Ze.useOptimistic=function(H,te){return A.H.useOptimistic(H,te)},Ze.useReducer=function(H,te,ge){return A.H.useReducer(H,te,ge)},Ze.useRef=function(H){return A.H.useRef(H)},Ze.useState=function(H){return A.H.useState(H)},Ze.useSyncExternalStore=function(H,te,ge){return A.H.useSyncExternalStore(H,te,ge)},Ze.useTransition=function(){return A.H.useTransition()},Ze.version="19.0.0",Ze}var _M;function C_(){return _M||(_M=1,bb.exports=FU()),bb.exports}var E=C_();const et=_l(E),oy=zU({__proto__:null,default:et},[E]);var xb={exports:{}},Nh={},wb={exports:{}},Cb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EM;function UU(){return EM||(EM=1,function(t){function e(K,V){var W=K.length;K.push(V);e:for(;0<W;){var ee=W-1>>>1,H=K[ee];if(0<i(H,V))K[ee]=V,K[W]=H,W=ee;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var V=K[0],W=K.pop();if(W!==V){K[0]=W;e:for(var ee=0,H=K.length,te=H>>>1;ee<te;){var ge=2*(ee+1)-1,de=K[ge],Se=ge+1,me=K[Se];if(0>i(de,W))Se<H&&0>i(me,de)?(K[ee]=me,K[Se]=W,ee=Se):(K[ee]=de,K[ge]=W,ee=ge);else if(Se<H&&0>i(me,W))K[ee]=me,K[Se]=W,ee=Se;else break e}}return V}function i(K,V){var W=K.sortIndex-V.sortIndex;return W!==0?W:K.id-V.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,g=null,m=3,S=!1,b=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function M(K){for(var V=n(d);V!==null;){if(V.callback===null)r(d);else if(V.startTime<=K)r(d),V.sortIndex=V.expirationTime,e(u,V);else break;V=n(d)}}function I(K){if(v=!1,M(K),!b)if(n(u)!==null)b=!0,B();else{var V=n(d);V!==null&&Y(I,V.startTime-K)}}var A=!1,R=-1,D=5,L=-1;function G(){return!(t.unstable_now()-L<D)}function k(){if(A){var K=t.unstable_now();L=K;var V=!0;try{e:{b=!1,v&&(v=!1,C(R),R=-1),S=!0;var W=m;try{t:{for(M(K),g=n(u);g!==null&&!(g.expirationTime>K&&G());){var ee=g.callback;if(typeof ee=="function"){g.callback=null,m=g.priorityLevel;var H=ee(g.expirationTime<=K);if(K=t.unstable_now(),typeof H=="function"){g.callback=H,M(K),V=!0;break t}g===n(u)&&r(u),M(K)}else r(u);g=n(u)}if(g!==null)V=!0;else{var te=n(d);te!==null&&Y(I,te.startTime-K),V=!1}}break e}finally{g=null,m=W,S=!1}V=void 0}}finally{V?$():A=!1}}}var $;if(typeof _=="function")$=function(){_(k)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,N=F.port2;F.port1.onmessage=k,$=function(){N.postMessage(null)}}else $=function(){w(k,0)};function B(){A||(A=!0,$())}function Y(K,V){R=w(function(){K(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){b||S||(b=!0,B())},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var V=3;break;default:V=m}var W=m;m=V;try{return K()}finally{m=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,V){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var W=m;m=K;try{return V()}finally{m=W}},t.unstable_scheduleCallback=function(K,V,W){var ee=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ee+W:ee):W=ee,K){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=W+H,K={id:f++,callback:V,priorityLevel:K,startTime:W,expirationTime:H,sortIndex:-1},W>ee?(K.sortIndex=W,e(d,K),n(u)===null&&K===n(d)&&(v?(C(R),R=-1):v=!0,Y(I,W-ee))):(K.sortIndex=H,e(u,K),b||S||(b=!0,B())),K},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(K){var V=m;return function(){var W=m;m=V;try{return K.apply(this,arguments)}finally{m=W}}}}(Cb)),Cb}var PM;function HU(){return PM||(PM=1,wb.exports=UU()),wb.exports}var _b={exports:{}},fr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TM;function KU(){if(TM)return fr;TM=1;var t=C_();function e(u){var d="https://react.dev/errors/"+u;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+u+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,d,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:u,containerInfo:d,implementation:f}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,d){if(u==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return fr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,fr.createPortal=function(u,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(u,d,null,f)},fr.flushSync=function(u){var d=o.T,f=r.p;try{if(o.T=null,r.p=2,u)return u()}finally{o.T=d,r.p=f,r.d.f()}},fr.preconnect=function(u,d){typeof u=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(u,d))},fr.prefetchDNS=function(u){typeof u=="string"&&r.d.D(u)},fr.preinit=function(u,d){if(typeof u=="string"&&d&&typeof d.as=="string"){var f=d.as,g=l(f,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,S=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;f==="style"?r.d.S(u,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:S}):f==="script"&&r.d.X(u,{crossOrigin:g,integrity:m,fetchPriority:S,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},fr.preinitModule=function(u,d){if(typeof u=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var f=l(d.as,d.crossOrigin);r.d.M(u,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(u)},fr.preload=function(u,d){if(typeof u=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var f=d.as,g=l(f,d.crossOrigin);r.d.L(u,f,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},fr.preloadModule=function(u,d){if(typeof u=="string")if(d){var f=l(d.as,d.crossOrigin);r.d.m(u,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(u)},fr.requestFormReset=function(u){r.d.r(u)},fr.unstable_batchedUpdates=function(u,d){return u(d)},fr.useFormState=function(u,d,f){return o.H.useFormState(u,d,f)},fr.useFormStatus=function(){return o.H.useHostTransitionStatus()},fr.version="19.0.0",fr}var IM;function MD(){if(IM)return _b.exports;IM=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_b.exports=KU(),_b.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MM;function GU(){if(MM)return Nh;MM=1;var t=HU(),e=C_(),n=MD();function r(a){var c="https://react.dev/errors/"+a;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}var s=Symbol.for("react.element"),o=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),S=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),M=Symbol.for("react.offscreen"),I=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function R(a){return a===null||typeof a!="object"?null:(a=A&&a[A]||a["@@iterator"],typeof a=="function"?a:null)}var D=Symbol.for("react.client.reference");function L(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===D?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case u:return"Fragment";case l:return"Portal";case f:return"Profiler";case d:return"StrictMode";case v:return"Suspense";case w:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Provider";case m:return(a._context.displayName||"Context")+".Consumer";case b:var c=a.render;return a=a.displayName,a||(a=c.displayName||c.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case C:return c=a.displayName||null,c!==null?c:L(a.type)||"Memo";case _:c=a._payload,a=a._init;try{return L(a(c))}catch{}}return null}var G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,k=Object.assign,$,F;function N(a){if($===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);$=c&&c[1]||"",F=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$+a+F}var B=!1;function Y(a,c){if(!a||B)return"";B=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(c){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var se=ce}Reflect.construct(a,[],ve)}else{try{ve.call()}catch(ce){se=ce}a.call(ve.prototype)}}else{try{throw Error()}catch(ce){se=ce}(ve=a())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&se&&typeof ce.stack=="string")return[ce.stack,se.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=y.DetermineComponentFrameRoot(),j=P[0],z=P[1];if(j&&z){var q=j.split(`
`),Q=z.split(`
`);for(x=y=0;y<q.length&&!q[y].includes("DetermineComponentFrameRoot");)y++;for(;x<Q.length&&!Q[x].includes("DetermineComponentFrameRoot");)x++;if(y===q.length||x===Q.length)for(y=q.length-1,x=Q.length-1;1<=y&&0<=x&&q[y]!==Q[x];)x--;for(;1<=y&&0<=x;y--,x--)if(q[y]!==Q[x]){if(y!==1||x!==1)do if(y--,x--,0>x||q[y]!==Q[x]){var ue=`
`+q[y].replace(" at new "," at ");return a.displayName&&ue.includes("<anonymous>")&&(ue=ue.replace("<anonymous>",a.displayName)),ue}while(1<=y&&0<=x);break}}}finally{B=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?N(h):""}function K(a){switch(a.tag){case 26:case 27:case 5:return N(a.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 15:return a=Y(a.type,!1),a;case 11:return a=Y(a.type.render,!1),a;case 1:return a=Y(a.type,!0),a;default:return""}}function V(a){try{var c="";do c+=K(a),a=a.return;while(a);return c}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}function W(a){var c=a,h=a;if(a.alternate)for(;c.return;)c=c.return;else{a=c;do c=a,c.flags&4098&&(h=c.return),a=c.return;while(a)}return c.tag===3?h:null}function ee(a){if(a.tag===13){var c=a.memoizedState;if(c===null&&(a=a.alternate,a!==null&&(c=a.memoizedState)),c!==null)return c.dehydrated}return null}function H(a){if(W(a)!==a)throw Error(r(188))}function te(a){var c=a.alternate;if(!c){if(c=W(a),c===null)throw Error(r(188));return c!==a?null:a}for(var h=a,y=c;;){var x=h.return;if(x===null)break;var P=x.alternate;if(P===null){if(y=x.return,y!==null){h=y;continue}break}if(x.child===P.child){for(P=x.child;P;){if(P===h)return H(x),a;if(P===y)return H(x),c;P=P.sibling}throw Error(r(188))}if(h.return!==y.return)h=x,y=P;else{for(var j=!1,z=x.child;z;){if(z===h){j=!0,h=x,y=P;break}if(z===y){j=!0,y=x,h=P;break}z=z.sibling}if(!j){for(z=P.child;z;){if(z===h){j=!0,h=P,y=x;break}if(z===y){j=!0,y=P,h=x;break}z=z.sibling}if(!j)throw Error(r(189))}}if(h.alternate!==y)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?a:c}function ge(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a;for(a=a.child;a!==null;){if(c=ge(a),c!==null)return c;a=a.sibling}return null}var de=Array.isArray,Se=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Me=[],Ne=-1;function we(a){return{current:a}}function Ie(a){0>Ne||(a.current=Me[Ne],Me[Ne]=null,Ne--)}function ke(a,c){Ne++,Me[Ne]=a.current,a.current=c}var Ue=we(null),Nt=we(null),ot=we(null),Mt=we(null);function wt(a,c){switch(ke(ot,c),ke(Nt,a),ke(Ue,null),a=c.nodeType,a){case 9:case 11:c=(c=c.documentElement)&&(c=c.namespaceURI)?XI(c):0;break;default:if(a=a===8?c.parentNode:c,c=a.tagName,a=a.namespaceURI)a=XI(a),c=ZI(a,c);else switch(c){case"svg":c=1;break;case"math":c=2;break;default:c=0}}Ie(Ue),ke(Ue,c)}function ft(){Ie(Ue),Ie(Nt),Ie(ot)}function jn(a){a.memoizedState!==null&&ke(Mt,a);var c=Ue.current,h=ZI(c,a.type);c!==h&&(ke(Nt,a),ke(Ue,h))}function dn(a){Nt.current===a&&(Ie(Ue),Ie(Nt)),Mt.current===a&&(Ie(Mt),kh._currentValue=me)}var lr=Object.prototype.hasOwnProperty,Tr=t.unstable_scheduleCallback,ls=t.unstable_cancelCallback,qe=t.unstable_shouldYield,jd=t.unstable_requestPaint,Br=t.unstable_now,Dd=t.unstable_getCurrentPriorityLevel,Bc=t.unstable_ImmediatePriority,Ao=t.unstable_UserBlockingPriority,cs=t.unstable_NormalPriority,Fc=t.unstable_LowPriority,ae=t.unstable_IdlePriority,Ce=t.log,He=t.unstable_setDisableYieldValue,Ct=null,nn=null;function Fr(a){if(nn&&typeof nn.onCommitFiberRoot=="function")try{nn.onCommitFiberRoot(Ct,a,void 0,(a.current.flags&128)===128)}catch{}}function Ur(a){if(typeof Ce=="function"&&He(a),nn&&typeof nn.setStrictMode=="function")try{nn.setStrictMode(Ct,a)}catch{}}var rn=Math.clz32?Math.clz32:ds,us=Math.log,ji=Math.LN2;function ds(a){return a>>>=0,a===0?32:31-(us(a)/ji|0)|0}var Di=128,ko=4194304;function hs(a){var c=a&42;if(c!==0)return c;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Bs(a,c){var h=a.pendingLanes;if(h===0)return 0;var y=0,x=a.suspendedLanes,P=a.pingedLanes,j=a.warmLanes;a=a.finishedLanes!==0;var z=h&134217727;return z!==0?(h=z&~x,h!==0?y=hs(h):(P&=z,P!==0?y=hs(P):a||(j=z&~j,j!==0&&(y=hs(j))))):(z=h&~x,z!==0?y=hs(z):P!==0?y=hs(P):a||(j=h&~j,j!==0&&(y=hs(j)))),y===0?0:c!==0&&c!==y&&!(c&x)&&(x=y&-y,j=c&-c,x>=j||x===32&&(j&4194176)!==0)?c:y}function Ro(a,c){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&c)===0}function Ld(a,c){switch(a){case 1:case 2:case 4:case 8:return c+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uc(){var a=Di;return Di<<=1,!(Di&4194176)&&(Di=128),a}function Ia(){var a=ko;return ko<<=1,!(ko&62914560)&&(ko=4194304),a}function Nd(a){for(var c=[],h=0;31>h;h++)c.push(a);return c}function Ll(a,c){a.pendingLanes|=c,c!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function xv(a,c,h,y,x,P){var j=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var z=a.entanglements,q=a.expirationTimes,Q=a.hiddenUpdates;for(h=j&~h;0<h;){var ue=31-rn(h),ve=1<<ue;z[ue]=0,q[ue]=-1;var se=Q[ue];if(se!==null)for(Q[ue]=null,ue=0;ue<se.length;ue++){var ce=se[ue];ce!==null&&(ce.lane&=-536870913)}h&=~ve}y!==0&&Pp(a,y,0),P!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=P&~(j&~c))}function Pp(a,c,h){a.pendingLanes|=c,a.suspendedLanes&=~c;var y=31-rn(c);a.entangledLanes|=c,a.entanglements[y]=a.entanglements[y]|1073741824|h&4194218}function Tp(a,c){var h=a.entangledLanes|=c;for(a=a.entanglements;h;){var y=31-rn(h),x=1<<y;x&c|a[y]&c&&(a[y]|=c),h&=~x}}function zd(a){return a&=-a,2<a?8<a?a&134217727?32:268435456:8:2}function Hc(){var a=Se.p;return a!==0?a:(a=window.event,a===void 0?32:gM(a.type))}function Oo(a,c){var h=Se.p;try{return Se.p=a,c()}finally{Se.p=h}}var Fs=Math.random().toString(36).slice(2),$n="__reactFiber$"+Fs,cr="__reactProps$"+Fs,Ma="__reactContainer$"+Fs,$d="__reactEvents$"+Fs,fs="__reactListeners$"+Fs,wv="__reactHandles$"+Fs,Ip="__reactResources$"+Fs,Nl="__reactMarker$"+Fs;function Bd(a){delete a[$n],delete a[cr],delete a[$d],delete a[fs],delete a[wv]}function jo(a){var c=a[$n];if(c)return c;for(var h=a.parentNode;h;){if(c=h[Ma]||h[$n]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(a=eM(a);a!==null;){if(h=a[$n])return h;a=eM(a)}return c}a=h,h=a.parentNode}return null}function Hr(a){if(a=a[$n]||a[Ma]){var c=a.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return a}return null}function zl(a){var c=a.tag;if(c===5||c===26||c===27||c===6)return a.stateNode;throw Error(r(33))}function Aa(a){var c=a[Ip];return c||(c=a[Ip]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Pn(a){a[Nl]=!0}var Mp=new Set,Ap={};function Li(a,c){ka(a,c),ka(a+"Capture",c)}function ka(a,c){for(Ap[a]=c,a=0;a<c.length;a++)Mp.add(c[a])}var ps=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Us=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),kp={},Rp={};function Cv(a){return lr.call(Rp,a)?!0:lr.call(kp,a)?!1:Us.test(a)?Rp[a]=!0:(kp[a]=!0,!1)}function Kc(a,c,h){if(Cv(c))if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(c);return;case"boolean":var y=c.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){a.removeAttribute(c);return}}a.setAttribute(c,""+h)}}function Gc(a,c,h){if(h===null)a.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttribute(c,""+h)}}function gs(a,c,h,y){if(y===null)a.removeAttribute(h);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(c,h,""+y)}}function qn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Op(a){var c=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function $l(a){var c=Op(a)?"checked":"value",h=Object.getOwnPropertyDescriptor(a.constructor.prototype,c),y=""+a[c];if(!a.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,P=h.set;return Object.defineProperty(a,c,{configurable:!0,get:function(){return x.call(this)},set:function(j){y=""+j,P.call(this,j)}}),Object.defineProperty(a,c,{enumerable:h.enumerable}),{getValue:function(){return y},setValue:function(j){y=""+j},stopTracking:function(){a._valueTracker=null,delete a[c]}}}}function Bl(a){a._valueTracker||(a._valueTracker=$l(a))}function Fd(a){if(!a)return!1;var c=a._valueTracker;if(!c)return!0;var h=c.getValue(),y="";return a&&(y=Op(a)?a.checked?"true":"false":a.value),a=y,a!==h?(c.setValue(a),!0):!1}function qc(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var _v=/[\n"\\]/g;function Kr(a){return a.replace(_v,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function Ud(a,c,h,y,x,P,j,z){a.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?a.type=j:a.removeAttribute("type"),c!=null?j==="number"?(c===0&&a.value===""||a.value!=c)&&(a.value=""+qn(c)):a.value!==""+qn(c)&&(a.value=""+qn(c)):j!=="submit"&&j!=="reset"||a.removeAttribute("value"),c!=null?Kd(a,j,qn(c)):h!=null?Kd(a,j,qn(h)):y!=null&&a.removeAttribute("value"),x==null&&P!=null&&(a.defaultChecked=!!P),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?a.name=""+qn(z):a.removeAttribute("name")}function Hd(a,c,h,y,x,P,j,z){if(P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"&&(a.type=P),c!=null||h!=null){if(!(P!=="submit"&&P!=="reset"||c!=null))return;h=h!=null?""+qn(h):"",c=c!=null?""+qn(c):h,z||c===a.value||(a.value=c),a.defaultValue=c}y=y??x,y=typeof y!="function"&&typeof y!="symbol"&&!!y,a.checked=z?a.checked:!!y,a.defaultChecked=!!y,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.name=j)}function Kd(a,c,h){c==="number"&&qc(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function Ra(a,c,h,y){if(a=a.options,c){c={};for(var x=0;x<h.length;x++)c["$"+h[x]]=!0;for(h=0;h<a.length;h++)x=c.hasOwnProperty("$"+a[h].value),a[h].selected!==x&&(a[h].selected=x),x&&y&&(a[h].defaultSelected=!0)}else{for(h=""+qn(h),c=null,x=0;x<a.length;x++){if(a[x].value===h){a[x].selected=!0,y&&(a[x].defaultSelected=!0);return}c!==null||a[x].disabled||(c=a[x])}c!==null&&(c.selected=!0)}}function Gd(a,c,h){if(c!=null&&(c=""+qn(c),c!==a.value&&(a.value=c),h==null)){a.defaultValue!==c&&(a.defaultValue=c);return}a.defaultValue=h!=null?""+qn(h):""}function Fl(a,c,h,y){if(c==null){if(y!=null){if(h!=null)throw Error(r(92));if(de(y)){if(1<y.length)throw Error(r(93));y=y[0]}h=y}h==null&&(h=""),c=h}h=qn(c),a.defaultValue=h,y=a.textContent,y===h&&y!==""&&y!==null&&(a.value=y)}function ui(a,c){if(c){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=c;return}}a.textContent=c}var Ev=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function jp(a,c,h){var y=c.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?y?a.setProperty(c,""):c==="float"?a.cssFloat="":a[c]="":y?a.setProperty(c,h):typeof h!="number"||h===0||Ev.has(c)?c==="float"?a.cssFloat=h:a[c]=(""+h).trim():a[c]=h+"px"}function ms(a,c,h){if(c!=null&&typeof c!="object")throw Error(r(62));if(a=a.style,h!=null){for(var y in h)!h.hasOwnProperty(y)||c!=null&&c.hasOwnProperty(y)||(y.indexOf("--")===0?a.setProperty(y,""):y==="float"?a.cssFloat="":a[y]="");for(var x in c)y=c[x],c.hasOwnProperty(x)&&h[x]!==y&&jp(a,x,y)}else for(var P in c)c.hasOwnProperty(P)&&jp(a,P,c[P])}function qd(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Tv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yc(a){return Tv.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Yd=null;function ys(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Do=null,Oa=null;function Ul(a){var c=Hr(a);if(c&&(a=c.stateNode)){var h=a[cr]||null;e:switch(a=c.stateNode,c.type){case"input":if(Ud(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),c=h.name,h.type==="radio"&&c!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Kr(""+c)+'"][type="radio"]'),c=0;c<h.length;c++){var y=h[c];if(y!==a&&y.form===a.form){var x=y[cr]||null;if(!x)throw Error(r(90));Ud(y,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(c=0;c<h.length;c++)y=h[c],y.form===a.form&&Fd(y)}break e;case"textarea":Gd(a,h.value,h.defaultValue);break e;case"select":c=h.value,c!=null&&Ra(a,!!h.multiple,c,!1)}}}var Vd=!1;function Vc(a,c,h){if(Vd)return a(c,h);Vd=!0;try{var y=a(c);return y}finally{if(Vd=!1,(Do!==null||Oa!==null)&&(pg(),Do&&(c=Do,a=Oa,Oa=Do=null,Ul(c),a)))for(c=0;c<a.length;c++)Ul(a[c])}}function Hl(a,c){var h=a.stateNode;if(h===null)return null;var y=h[cr]||null;if(y===null)return null;h=y[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(a=a.type,y=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!y;break e;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var Wc=!1;if(ps)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){Wc=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{Wc=!1}var Ss=null,Lo=null,Kl=null;function Dp(){if(Kl)return Kl;var a,c=Lo,h=c.length,y,x="value"in Ss?Ss.value:Ss.textContent,P=x.length;for(a=0;a<h&&c[a]===x[a];a++);var j=h-a;for(y=1;y<=j&&c[h-y]===x[P-y];y++);return Kl=x.slice(a,1<y?1-y:void 0)}function Xc(a){var c=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&c===13&&(a=13)):a=c,a===10&&(a=13),32<=a||a===13?a:0}function Zc(){return!0}function U(){return!1}function X(a){function c(h,y,x,P,j){this._reactName=h,this._targetInst=x,this.type=y,this.nativeEvent=P,this.target=j,this.currentTarget=null;for(var z in a)a.hasOwnProperty(z)&&(h=a[z],this[z]=h?h(P):P[z]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Zc:U,this.isPropagationStopped=U,this}return k(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Zc)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Zc)},persist:function(){},isPersistent:Zc}),c}var pe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Te=X(pe),_t=k({},pe,{view:0,detail:0}),Xe=X(_t),Ht,hn,sn,kt=k({},_t,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iv,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==sn&&(sn&&a.type==="mousemove"?(Ht=a.screenX-sn.screenX,hn=a.screenY-sn.screenY):hn=Ht=0,sn=a),Ht)},movementY:function(a){return"movementY"in a?a.movementY:hn}}),ur=X(kt),di=k({},kt,{dataTransfer:0}),Bn=X(di),Gr=k({},_t,{relatedTarget:0}),dr=X(Gr),Hs=k({},pe,{animationName:0,elapsedTime:0,pseudoElement:0}),vs=X(Hs),No=k({},pe,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Lp=X(No),Qc=k({},pe,{data:0}),Gl=X(Qc),G7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},q7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Y7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V7(a){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(a):(a=Y7[a])?!!c[a]:!1}function Iv(){return V7}var W7=k({},_t,{key:function(a){if(a.key){var c=G7[a.key]||a.key;if(c!=="Unidentified")return c}return a.type==="keypress"?(a=Xc(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?q7[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iv,charCode:function(a){return a.type==="keypress"?Xc(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Xc(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),X7=X(W7),Z7=k({},kt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hP=X(Z7),Q7=k({},_t,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iv}),J7=X(Q7),eF=k({},pe,{propertyName:0,elapsedTime:0,pseudoElement:0}),tF=X(eF),nF=k({},kt,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),rF=X(nF),iF=k({},pe,{newState:0,oldState:0}),sF=X(iF),oF=[9,13,27,32],Mv=ps&&"CompositionEvent"in window,Wd=null;ps&&"documentMode"in document&&(Wd=document.documentMode);var aF=ps&&"TextEvent"in window&&!Wd,fP=ps&&(!Mv||Wd&&8<Wd&&11>=Wd),pP=" ",gP=!1;function mP(a,c){switch(a){case"keyup":return oF.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yP(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Jc=!1;function lF(a,c){switch(a){case"compositionend":return yP(c);case"keypress":return c.which!==32?null:(gP=!0,pP);case"textInput":return a=c.data,a===pP&&gP?null:a;default:return null}}function cF(a,c){if(Jc)return a==="compositionend"||!Mv&&mP(a,c)?(a=Dp(),Kl=Lo=Ss=null,Jc=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return fP&&c.locale!=="ko"?null:c.data;default:return null}}var uF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SP(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c==="input"?!!uF[a.type]:c==="textarea"}function vP(a,c,h,y){Do?Oa?Oa.push(y):Oa=[y]:Do=y,c=vg(c,"onChange"),0<c.length&&(h=new Te("onChange","change",null,h,y),a.push({event:h,listeners:c}))}var Xd=null,Zd=null;function dF(a){GI(a,0)}function Np(a){var c=zl(a);if(Fd(c))return a}function bP(a,c){if(a==="change")return c}var xP=!1;if(ps){var Av;if(ps){var kv="oninput"in document;if(!kv){var wP=document.createElement("div");wP.setAttribute("oninput","return;"),kv=typeof wP.oninput=="function"}Av=kv}else Av=!1;xP=Av&&(!document.documentMode||9<document.documentMode)}function CP(){Xd&&(Xd.detachEvent("onpropertychange",_P),Zd=Xd=null)}function _P(a){if(a.propertyName==="value"&&Np(Zd)){var c=[];vP(c,Zd,a,ys(a)),Vc(dF,c)}}function hF(a,c,h){a==="focusin"?(CP(),Xd=c,Zd=h,Xd.attachEvent("onpropertychange",_P)):a==="focusout"&&CP()}function fF(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Np(Zd)}function pF(a,c){if(a==="click")return Np(c)}function gF(a,c){if(a==="input"||a==="change")return Np(c)}function mF(a,c){return a===c&&(a!==0||1/a===1/c)||a!==a&&c!==c}var hi=typeof Object.is=="function"?Object.is:mF;function Qd(a,c){if(hi(a,c))return!0;if(typeof a!="object"||a===null||typeof c!="object"||c===null)return!1;var h=Object.keys(a),y=Object.keys(c);if(h.length!==y.length)return!1;for(y=0;y<h.length;y++){var x=h[y];if(!lr.call(c,x)||!hi(a[x],c[x]))return!1}return!0}function EP(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function PP(a,c){var h=EP(a);a=0;for(var y;h;){if(h.nodeType===3){if(y=a+h.textContent.length,a<=c&&y>=c)return{node:h,offset:c-a};a=y}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=EP(h)}}function TP(a,c){return a&&c?a===c?!0:a&&a.nodeType===3?!1:c&&c.nodeType===3?TP(a,c.parentNode):"contains"in a?a.contains(c):a.compareDocumentPosition?!!(a.compareDocumentPosition(c)&16):!1:!1}function IP(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var c=qc(a.document);c instanceof a.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)a=c.contentWindow;else break;c=qc(a.document)}return c}function Rv(a){var c=a&&a.nodeName&&a.nodeName.toLowerCase();return c&&(c==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||c==="textarea"||a.contentEditable==="true")}function yF(a,c){var h=IP(c);c=a.focusedElem;var y=a.selectionRange;if(h!==c&&c&&c.ownerDocument&&TP(c.ownerDocument.documentElement,c)){if(y!==null&&Rv(c)){if(a=y.start,h=y.end,h===void 0&&(h=a),"selectionStart"in c)c.selectionStart=a,c.selectionEnd=Math.min(h,c.value.length);else if(h=(a=c.ownerDocument||document)&&a.defaultView||window,h.getSelection){h=h.getSelection();var x=c.textContent.length,P=Math.min(y.start,x);y=y.end===void 0?P:Math.min(y.end,x),!h.extend&&P>y&&(x=y,y=P,P=x),x=PP(c,P);var j=PP(c,y);x&&j&&(h.rangeCount!==1||h.anchorNode!==x.node||h.anchorOffset!==x.offset||h.focusNode!==j.node||h.focusOffset!==j.offset)&&(a=a.createRange(),a.setStart(x.node,x.offset),h.removeAllRanges(),P>y?(h.addRange(a),h.extend(j.node,j.offset)):(a.setEnd(j.node,j.offset),h.addRange(a)))}}for(a=[],h=c;h=h.parentNode;)h.nodeType===1&&a.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<a.length;c++)h=a[c],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var SF=ps&&"documentMode"in document&&11>=document.documentMode,eu=null,Ov=null,Jd=null,jv=!1;function MP(a,c,h){var y=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;jv||eu==null||eu!==qc(y)||(y=eu,"selectionStart"in y&&Rv(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Jd&&Qd(Jd,y)||(Jd=y,y=vg(Ov,"onSelect"),0<y.length&&(c=new Te("onSelect","select",null,c,h),a.push({event:c,listeners:y}),c.target=eu)))}function ql(a,c){var h={};return h[a.toLowerCase()]=c.toLowerCase(),h["Webkit"+a]="webkit"+c,h["Moz"+a]="moz"+c,h}var tu={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionrun:ql("Transition","TransitionRun"),transitionstart:ql("Transition","TransitionStart"),transitioncancel:ql("Transition","TransitionCancel"),transitionend:ql("Transition","TransitionEnd")},Dv={},AP={};ps&&(AP=document.createElement("div").style,"AnimationEvent"in window||(delete tu.animationend.animation,delete tu.animationiteration.animation,delete tu.animationstart.animation),"TransitionEvent"in window||delete tu.transitionend.transition);function Yl(a){if(Dv[a])return Dv[a];if(!tu[a])return a;var c=tu[a],h;for(h in c)if(c.hasOwnProperty(h)&&h in AP)return Dv[a]=c[h];return a}var kP=Yl("animationend"),RP=Yl("animationiteration"),OP=Yl("animationstart"),vF=Yl("transitionrun"),bF=Yl("transitionstart"),xF=Yl("transitioncancel"),jP=Yl("transitionend"),DP=new Map,LP="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function bs(a,c){DP.set(a,c),Li(c,[a])}var Ni=[],nu=0,Lv=0;function zp(){for(var a=nu,c=Lv=nu=0;c<a;){var h=Ni[c];Ni[c++]=null;var y=Ni[c];Ni[c++]=null;var x=Ni[c];Ni[c++]=null;var P=Ni[c];if(Ni[c++]=null,y!==null&&x!==null){var j=y.pending;j===null?x.next=x:(x.next=j.next,j.next=x),y.pending=x}P!==0&&NP(h,x,P)}}function $p(a,c,h,y){Ni[nu++]=a,Ni[nu++]=c,Ni[nu++]=h,Ni[nu++]=y,Lv|=y,a.lanes|=y,a=a.alternate,a!==null&&(a.lanes|=y)}function Nv(a,c,h,y){return $p(a,c,h,y),Bp(a)}function Da(a,c){return $p(a,null,null,c),Bp(a)}function NP(a,c,h){a.lanes|=h;var y=a.alternate;y!==null&&(y.lanes|=h);for(var x=!1,P=a.return;P!==null;)P.childLanes|=h,y=P.alternate,y!==null&&(y.childLanes|=h),P.tag===22&&(a=P.stateNode,a===null||a._visibility&1||(x=!0)),a=P,P=P.return;x&&c!==null&&a.tag===3&&(P=a.stateNode,x=31-rn(h),P=P.hiddenUpdates,a=P[x],a===null?P[x]=[c]:a.push(c),c.lane=h|536870912)}function Bp(a){if(50<_h)throw _h=0,H0=null,Error(r(185));for(var c=a.return;c!==null;)a=c,c=a.return;return a.tag===3?a.stateNode:null}var ru={},zP=new WeakMap;function zi(a,c){if(typeof a=="object"&&a!==null){var h=zP.get(a);return h!==void 0?h:(c={value:a,source:c,stack:V(c)},zP.set(a,c),c)}return{value:a,source:c,stack:V(c)}}var iu=[],su=0,Fp=null,Up=0,$i=[],Bi=0,Vl=null,zo=1,$o="";function Wl(a,c){iu[su++]=Up,iu[su++]=Fp,Fp=a,Up=c}function $P(a,c,h){$i[Bi++]=zo,$i[Bi++]=$o,$i[Bi++]=Vl,Vl=a;var y=zo;a=$o;var x=32-rn(y)-1;y&=~(1<<x),h+=1;var P=32-rn(c)+x;if(30<P){var j=x-x%5;P=(y&(1<<j)-1).toString(32),y>>=j,x-=j,zo=1<<32-rn(c)+x|h<<x|y,$o=P+a}else zo=1<<P|h<<x|y,$o=a}function zv(a){a.return!==null&&(Wl(a,1),$P(a,1,0))}function $v(a){for(;a===Fp;)Fp=iu[--su],iu[su]=null,Up=iu[--su],iu[su]=null;for(;a===Vl;)Vl=$i[--Bi],$i[Bi]=null,$o=$i[--Bi],$i[Bi]=null,zo=$i[--Bi],$i[Bi]=null}var Ir=null,Yn=null,St=!1,xs=null,Ks=!1,Bv=Error(r(519));function Xl(a){var c=Error(r(418,""));throw nh(zi(c,a)),Bv}function BP(a){var c=a.stateNode,h=a.type,y=a.memoizedProps;switch(c[$n]=a,c[cr]=y,h){case"dialog":dt("cancel",c),dt("close",c);break;case"iframe":case"object":case"embed":dt("load",c);break;case"video":case"audio":for(h=0;h<Ph.length;h++)dt(Ph[h],c);break;case"source":dt("error",c);break;case"img":case"image":case"link":dt("error",c),dt("load",c);break;case"details":dt("toggle",c);break;case"input":dt("invalid",c),Hd(c,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),Bl(c);break;case"select":dt("invalid",c);break;case"textarea":dt("invalid",c),Fl(c,y.value,y.defaultValue,y.children),Bl(c)}h=y.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||c.textContent===""+h||y.suppressHydrationWarning===!0||WI(c.textContent,h)?(y.popover!=null&&(dt("beforetoggle",c),dt("toggle",c)),y.onScroll!=null&&dt("scroll",c),y.onScrollEnd!=null&&dt("scrollend",c),y.onClick!=null&&(c.onclick=bg),c=!0):c=!1,c||Xl(a)}function FP(a){for(Ir=a.return;Ir;)switch(Ir.tag){case 3:case 27:Ks=!0;return;case 5:case 13:Ks=!1;return;default:Ir=Ir.return}}function eh(a){if(a!==Ir)return!1;if(!St)return FP(a),St=!0,!1;var c=!1,h;if((h=a.tag!==3&&a.tag!==27)&&((h=a.tag===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||ob(a.type,a.memoizedProps)),h=!h),h&&(c=!0),c&&Yn&&Xl(a),FP(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(r(317));e:{for(a=a.nextSibling,c=0;a;){if(a.nodeType===8)if(h=a.data,h==="/$"){if(c===0){Yn=Cs(a.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++;a=a.nextSibling}Yn=null}}else Yn=Ir?Cs(a.stateNode.nextSibling):null;return!0}function th(){Yn=Ir=null,St=!1}function nh(a){xs===null?xs=[a]:xs.push(a)}var rh=Error(r(460)),UP=Error(r(474)),Fv={then:function(){}};function HP(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Hp(){}function KP(a,c,h){switch(h=a[h],h===void 0?a.push(c):h!==c&&(c.then(Hp,Hp),c=h),c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,a===rh?Error(r(483)):a;default:if(typeof c.status=="string")c.then(Hp,Hp);else{if(a=Kt,a!==null&&100<a.shellSuspendCounter)throw Error(r(482));a=c,a.status="pending",a.then(function(y){if(c.status==="pending"){var x=c;x.status="fulfilled",x.value=y}},function(y){if(c.status==="pending"){var x=c;x.status="rejected",x.reason=y}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw a=c.reason,a===rh?Error(r(483)):a}throw ih=c,rh}}var ih=null;function GP(){if(ih===null)throw Error(r(459));var a=ih;return ih=null,a}var ou=null,sh=0;function Kp(a){var c=sh;return sh+=1,ou===null&&(ou=[]),KP(ou,a,c)}function oh(a,c){c=c.props.ref,a.ref=c!==void 0?c:null}function Gp(a,c){throw c.$$typeof===s?Error(r(525)):(a=Object.prototype.toString.call(c),Error(r(31,a==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":a)))}function qP(a){var c=a._init;return c(a._payload)}function YP(a){function c(J,Z){if(a){var ie=J.deletions;ie===null?(J.deletions=[Z],J.flags|=16):ie.push(Z)}}function h(J,Z){if(!a)return null;for(;Z!==null;)c(J,Z),Z=Z.sibling;return null}function y(J){for(var Z=new Map;J!==null;)J.key!==null?Z.set(J.key,J):Z.set(J.index,J),J=J.sibling;return Z}function x(J,Z){return J=Ya(J,Z),J.index=0,J.sibling=null,J}function P(J,Z,ie){return J.index=ie,a?(ie=J.alternate,ie!==null?(ie=ie.index,ie<Z?(J.flags|=33554434,Z):ie):(J.flags|=33554434,Z)):(J.flags|=1048576,Z)}function j(J){return a&&J.alternate===null&&(J.flags|=33554434),J}function z(J,Z,ie,ye){return Z===null||Z.tag!==6?(Z=D0(ie,J.mode,ye),Z.return=J,Z):(Z=x(Z,ie),Z.return=J,Z)}function q(J,Z,ie,ye){var Oe=ie.type;return Oe===u?ue(J,Z,ie.props.children,ye,ie.key):Z!==null&&(Z.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===_&&qP(Oe)===Z.type)?(Z=x(Z,ie.props),oh(Z,ie),Z.return=J,Z):(Z=cg(ie.type,ie.key,ie.props,null,J.mode,ye),oh(Z,ie),Z.return=J,Z)}function Q(J,Z,ie,ye){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==ie.containerInfo||Z.stateNode.implementation!==ie.implementation?(Z=L0(ie,J.mode,ye),Z.return=J,Z):(Z=x(Z,ie.children||[]),Z.return=J,Z)}function ue(J,Z,ie,ye,Oe){return Z===null||Z.tag!==7?(Z=oc(ie,J.mode,ye,Oe),Z.return=J,Z):(Z=x(Z,ie),Z.return=J,Z)}function ve(J,Z,ie){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=D0(""+Z,J.mode,ie),Z.return=J,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case o:return ie=cg(Z.type,Z.key,Z.props,null,J.mode,ie),oh(ie,Z),ie.return=J,ie;case l:return Z=L0(Z,J.mode,ie),Z.return=J,Z;case _:var ye=Z._init;return Z=ye(Z._payload),ve(J,Z,ie)}if(de(Z)||R(Z))return Z=oc(Z,J.mode,ie,null),Z.return=J,Z;if(typeof Z.then=="function")return ve(J,Kp(Z),ie);if(Z.$$typeof===S)return ve(J,og(J,Z),ie);Gp(J,Z)}return null}function se(J,Z,ie,ye){var Oe=Z!==null?Z.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Oe!==null?null:z(J,Z,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case o:return ie.key===Oe?q(J,Z,ie,ye):null;case l:return ie.key===Oe?Q(J,Z,ie,ye):null;case _:return Oe=ie._init,ie=Oe(ie._payload),se(J,Z,ie,ye)}if(de(ie)||R(ie))return Oe!==null?null:ue(J,Z,ie,ye,null);if(typeof ie.then=="function")return se(J,Z,Kp(ie),ye);if(ie.$$typeof===S)return se(J,Z,og(J,ie),ye);Gp(J,ie)}return null}function ce(J,Z,ie,ye,Oe){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return J=J.get(ie)||null,z(Z,J,""+ye,Oe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case o:return J=J.get(ye.key===null?ie:ye.key)||null,q(Z,J,ye,Oe);case l:return J=J.get(ye.key===null?ie:ye.key)||null,Q(Z,J,ye,Oe);case _:var nt=ye._init;return ye=nt(ye._payload),ce(J,Z,ie,ye,Oe)}if(de(ye)||R(ye))return J=J.get(ie)||null,ue(Z,J,ye,Oe,null);if(typeof ye.then=="function")return ce(J,Z,ie,Kp(ye),Oe);if(ye.$$typeof===S)return ce(J,Z,ie,og(Z,ye),Oe);Gp(Z,ye)}return null}function De(J,Z,ie,ye){for(var Oe=null,nt=null,ze=Z,Ke=Z=0,Hn=null;ze!==null&&Ke<ie.length;Ke++){ze.index>Ke?(Hn=ze,ze=null):Hn=ze.sibling;var vt=se(J,ze,ie[Ke],ye);if(vt===null){ze===null&&(ze=Hn);break}a&&ze&&vt.alternate===null&&c(J,ze),Z=P(vt,Z,Ke),nt===null?Oe=vt:nt.sibling=vt,nt=vt,ze=Hn}if(Ke===ie.length)return h(J,ze),St&&Wl(J,Ke),Oe;if(ze===null){for(;Ke<ie.length;Ke++)ze=ve(J,ie[Ke],ye),ze!==null&&(Z=P(ze,Z,Ke),nt===null?Oe=ze:nt.sibling=ze,nt=ze);return St&&Wl(J,Ke),Oe}for(ze=y(ze);Ke<ie.length;Ke++)Hn=ce(ze,J,Ke,ie[Ke],ye),Hn!==null&&(a&&Hn.alternate!==null&&ze.delete(Hn.key===null?Ke:Hn.key),Z=P(Hn,Z,Ke),nt===null?Oe=Hn:nt.sibling=Hn,nt=Hn);return a&&ze.forEach(function(el){return c(J,el)}),St&&Wl(J,Ke),Oe}function Ve(J,Z,ie,ye){if(ie==null)throw Error(r(151));for(var Oe=null,nt=null,ze=Z,Ke=Z=0,Hn=null,vt=ie.next();ze!==null&&!vt.done;Ke++,vt=ie.next()){ze.index>Ke?(Hn=ze,ze=null):Hn=ze.sibling;var el=se(J,ze,vt.value,ye);if(el===null){ze===null&&(ze=Hn);break}a&&ze&&el.alternate===null&&c(J,ze),Z=P(el,Z,Ke),nt===null?Oe=el:nt.sibling=el,nt=el,ze=Hn}if(vt.done)return h(J,ze),St&&Wl(J,Ke),Oe;if(ze===null){for(;!vt.done;Ke++,vt=ie.next())vt=ve(J,vt.value,ye),vt!==null&&(Z=P(vt,Z,Ke),nt===null?Oe=vt:nt.sibling=vt,nt=vt);return St&&Wl(J,Ke),Oe}for(ze=y(ze);!vt.done;Ke++,vt=ie.next())vt=ce(ze,J,Ke,vt.value,ye),vt!==null&&(a&&vt.alternate!==null&&ze.delete(vt.key===null?Ke:vt.key),Z=P(vt,Z,Ke),nt===null?Oe=vt:nt.sibling=vt,nt=vt);return a&&ze.forEach(function(DU){return c(J,DU)}),St&&Wl(J,Ke),Oe}function gn(J,Z,ie,ye){if(typeof ie=="object"&&ie!==null&&ie.type===u&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case o:e:{for(var Oe=ie.key;Z!==null;){if(Z.key===Oe){if(Oe=ie.type,Oe===u){if(Z.tag===7){h(J,Z.sibling),ye=x(Z,ie.props.children),ye.return=J,J=ye;break e}}else if(Z.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===_&&qP(Oe)===Z.type){h(J,Z.sibling),ye=x(Z,ie.props),oh(ye,ie),ye.return=J,J=ye;break e}h(J,Z);break}else c(J,Z);Z=Z.sibling}ie.type===u?(ye=oc(ie.props.children,J.mode,ye,ie.key),ye.return=J,J=ye):(ye=cg(ie.type,ie.key,ie.props,null,J.mode,ye),oh(ye,ie),ye.return=J,J=ye)}return j(J);case l:e:{for(Oe=ie.key;Z!==null;){if(Z.key===Oe)if(Z.tag===4&&Z.stateNode.containerInfo===ie.containerInfo&&Z.stateNode.implementation===ie.implementation){h(J,Z.sibling),ye=x(Z,ie.children||[]),ye.return=J,J=ye;break e}else{h(J,Z);break}else c(J,Z);Z=Z.sibling}ye=L0(ie,J.mode,ye),ye.return=J,J=ye}return j(J);case _:return Oe=ie._init,ie=Oe(ie._payload),gn(J,Z,ie,ye)}if(de(ie))return De(J,Z,ie,ye);if(R(ie)){if(Oe=R(ie),typeof Oe!="function")throw Error(r(150));return ie=Oe.call(ie),Ve(J,Z,ie,ye)}if(typeof ie.then=="function")return gn(J,Z,Kp(ie),ye);if(ie.$$typeof===S)return gn(J,Z,og(J,ie),ye);Gp(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,Z!==null&&Z.tag===6?(h(J,Z.sibling),ye=x(Z,ie),ye.return=J,J=ye):(h(J,Z),ye=D0(ie,J.mode,ye),ye.return=J,J=ye),j(J)):h(J,Z)}return function(J,Z,ie,ye){try{sh=0;var Oe=gn(J,Z,ie,ye);return ou=null,Oe}catch(ze){if(ze===rh)throw ze;var nt=Ki(29,ze,null,J.mode);return nt.lanes=ye,nt.return=J,nt}finally{}}}var Zl=YP(!0),VP=YP(!1),au=we(null),qp=we(0);function WP(a,c){a=Xo,ke(qp,a),ke(au,c),Xo=a|c.baseLanes}function Uv(){ke(qp,Xo),ke(au,au.current)}function Hv(){Xo=qp.current,Ie(au),Ie(qp)}var Fi=we(null),Gs=null;function La(a){var c=a.alternate;ke(Dn,Dn.current&1),ke(Fi,a),Gs===null&&(c===null||au.current!==null||c.memoizedState!==null)&&(Gs=a)}function XP(a){if(a.tag===22){if(ke(Dn,Dn.current),ke(Fi,a),Gs===null){var c=a.alternate;c!==null&&c.memoizedState!==null&&(Gs=a)}}else Na()}function Na(){ke(Dn,Dn.current),ke(Fi,Fi.current)}function Bo(a){Ie(Fi),Gs===a&&(Gs=null),Ie(Dn)}var Dn=we(0);function Yp(a){for(var c=a;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var wF=typeof AbortController<"u"?AbortController:function(){var a=[],c=this.signal={aborted:!1,addEventListener:function(h,y){a.push(y)}};this.abort=function(){c.aborted=!0,a.forEach(function(h){return h()})}},CF=t.unstable_scheduleCallback,_F=t.unstable_NormalPriority,Ln={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Kv(){return{controller:new wF,data:new Map,refCount:0}}function ah(a){a.refCount--,a.refCount===0&&CF(_F,function(){a.controller.abort()})}var lh=null,Gv=0,lu=0,cu=null;function EF(a,c){if(lh===null){var h=lh=[];Gv=0,lu=Z0(),cu={status:"pending",value:void 0,then:function(y){h.push(y)}}}return Gv++,c.then(ZP,ZP),c}function ZP(){if(--Gv===0&&lh!==null){cu!==null&&(cu.status="fulfilled");var a=lh;lh=null,lu=0,cu=null;for(var c=0;c<a.length;c++)(0,a[c])()}}function PF(a,c){var h=[],y={status:"pending",value:null,reason:null,then:function(x){h.push(x)}};return a.then(function(){y.status="fulfilled",y.value=c;for(var x=0;x<h.length;x++)(0,h[x])(c)},function(x){for(y.status="rejected",y.reason=x,x=0;x<h.length;x++)(0,h[x])(void 0)}),y}var QP=G.S;G.S=function(a,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&EF(a,c),QP!==null&&QP(a,c)};var Ql=we(null);function qv(){var a=Ql.current;return a!==null?a:Kt.pooledCache}function Vp(a,c){c===null?ke(Ql,Ql.current):ke(Ql,c.pool)}function JP(){var a=qv();return a===null?null:{parent:Ln._currentValue,pool:a}}var za=0,tt=null,Rt=null,Tn=null,Wp=!1,uu=!1,Jl=!1,Xp=0,ch=0,du=null,TF=0;function vn(){throw Error(r(321))}function Yv(a,c){if(c===null)return!1;for(var h=0;h<c.length&&h<a.length;h++)if(!hi(a[h],c[h]))return!1;return!0}function Vv(a,c,h,y,x,P){return za=P,tt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,G.H=a===null||a.memoizedState===null?ec:$a,Jl=!1,P=h(y,x),Jl=!1,uu&&(P=tT(c,h,y,x)),eT(a),P}function eT(a){G.H=qs;var c=Rt!==null&&Rt.next!==null;if(za=0,Tn=Rt=tt=null,Wp=!1,ch=0,du=null,c)throw Error(r(300));a===null||Fn||(a=a.dependencies,a!==null&&sg(a)&&(Fn=!0))}function tT(a,c,h,y){tt=a;var x=0;do{if(uu&&(du=null),ch=0,uu=!1,25<=x)throw Error(r(301));if(x+=1,Tn=Rt=null,a.updateQueue!=null){var P=a.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}G.H=tc,P=c(h,y)}while(uu);return P}function IF(){var a=G.H,c=a.useState()[0];return c=typeof c.then=="function"?uh(c):c,a=a.useState()[0],(Rt!==null?Rt.memoizedState:null)!==a&&(tt.flags|=1024),c}function Wv(){var a=Xp!==0;return Xp=0,a}function Xv(a,c,h){c.updateQueue=a.updateQueue,c.flags&=-2053,a.lanes&=~h}function Zv(a){if(Wp){for(a=a.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Wp=!1}za=0,Tn=Rt=tt=null,uu=!1,ch=Xp=0,du=null}function qr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?tt.memoizedState=Tn=a:Tn=Tn.next=a,Tn}function In(){if(Rt===null){var a=tt.alternate;a=a!==null?a.memoizedState:null}else a=Rt.next;var c=Tn===null?tt.memoizedState:Tn.next;if(c!==null)Tn=c,Rt=a;else{if(a===null)throw tt.alternate===null?Error(r(467)):Error(r(310));Rt=a,a={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Tn===null?tt.memoizedState=Tn=a:Tn=Tn.next=a}return Tn}var Zp;Zp=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function uh(a){var c=ch;return ch+=1,du===null&&(du=[]),a=KP(du,a,c),c=tt,(Tn===null?c.memoizedState:Tn.next)===null&&(c=c.alternate,G.H=c===null||c.memoizedState===null?ec:$a),a}function Qp(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return uh(a);if(a.$$typeof===S)return hr(a)}throw Error(r(438,String(a)))}function Qv(a){var c=null,h=tt.updateQueue;if(h!==null&&(c=h.memoCache),c==null){var y=tt.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(c={data:y.data.map(function(x){return x.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),h===null&&(h=Zp(),tt.updateQueue=h),h.memoCache=c,h=c.data[c.index],h===void 0)for(h=c.data[c.index]=Array(a),y=0;y<a;y++)h[y]=I;return c.index++,h}function Fo(a,c){return typeof c=="function"?c(a):c}function Jp(a){var c=In();return Jv(c,Rt,a)}function Jv(a,c,h){var y=a.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=h;var x=a.baseQueue,P=y.pending;if(P!==null){if(x!==null){var j=x.next;x.next=P.next,P.next=j}c.baseQueue=x=P,y.pending=null}if(P=a.baseState,x===null)a.memoizedState=P;else{c=x.next;var z=j=null,q=null,Q=c,ue=!1;do{var ve=Q.lane&-536870913;if(ve!==Q.lane?(pt&ve)===ve:(za&ve)===ve){var se=Q.revertLane;if(se===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ve===lu&&(ue=!0);else if((za&se)===se){Q=Q.next,se===lu&&(ue=!0);continue}else ve={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},q===null?(z=q=ve,j=P):q=q.next=ve,tt.lanes|=se,Va|=se;ve=Q.action,Jl&&h(P,ve),P=Q.hasEagerState?Q.eagerState:h(P,ve)}else se={lane:ve,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},q===null?(z=q=se,j=P):q=q.next=se,tt.lanes|=ve,Va|=ve;Q=Q.next}while(Q!==null&&Q!==c);if(q===null?j=P:q.next=z,!hi(P,a.memoizedState)&&(Fn=!0,ue&&(h=cu,h!==null)))throw h;a.memoizedState=P,a.baseState=j,a.baseQueue=q,y.lastRenderedState=P}return x===null&&(y.lanes=0),[a.memoizedState,y.dispatch]}function e0(a){var c=In(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=a;var y=h.dispatch,x=h.pending,P=c.memoizedState;if(x!==null){h.pending=null;var j=x=x.next;do P=a(P,j.action),j=j.next;while(j!==x);hi(P,c.memoizedState)||(Fn=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),h.lastRenderedState=P}return[P,y]}function nT(a,c,h){var y=tt,x=In(),P=St;if(P){if(h===void 0)throw Error(r(407));h=h()}else h=c();var j=!hi((Rt||x).memoizedState,h);if(j&&(x.memoizedState=h,Fn=!0),x=x.queue,r0(sT.bind(null,y,x,a),[a]),x.getSnapshot!==c||j||Tn!==null&&Tn.memoizedState.tag&1){if(y.flags|=2048,hu(9,iT.bind(null,y,x,h,c),{destroy:void 0},null),Kt===null)throw Error(r(349));P||za&60||rT(y,c,h)}return h}function rT(a,c,h){a.flags|=16384,a={getSnapshot:c,value:h},c=tt.updateQueue,c===null?(c=Zp(),tt.updateQueue=c,c.stores=[a]):(h=c.stores,h===null?c.stores=[a]:h.push(a))}function iT(a,c,h,y){c.value=h,c.getSnapshot=y,oT(c)&&aT(a)}function sT(a,c,h){return h(function(){oT(c)&&aT(a)})}function oT(a){var c=a.getSnapshot;a=a.value;try{var h=c();return!hi(a,h)}catch{return!0}}function aT(a){var c=Da(a,2);c!==null&&Mr(c,a,2)}function t0(a){var c=qr();if(typeof a=="function"){var h=a;if(a=h(),Jl){Ur(!0);try{h()}finally{Ur(!1)}}}return c.memoizedState=c.baseState=a,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:a},c}function lT(a,c,h,y){return a.baseState=h,Jv(a,Rt,typeof y=="function"?y:Fo)}function MF(a,c,h,y,x){if(ng(a))throw Error(r(485));if(a=c.action,a!==null){var P={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){P.listeners.push(j)}};G.T!==null?h(!0):P.isTransition=!1,y(P),h=c.pending,h===null?(P.next=c.pending=P,cT(c,P)):(P.next=h.next,c.pending=h.next=P)}}function cT(a,c){var h=c.action,y=c.payload,x=a.state;if(c.isTransition){var P=G.T,j={};G.T=j;try{var z=h(x,y),q=G.S;q!==null&&q(j,z),uT(a,c,z)}catch(Q){n0(a,c,Q)}finally{G.T=P}}else try{P=h(x,y),uT(a,c,P)}catch(Q){n0(a,c,Q)}}function uT(a,c,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(y){dT(a,c,y)},function(y){return n0(a,c,y)}):dT(a,c,h)}function dT(a,c,h){c.status="fulfilled",c.value=h,hT(c),a.state=h,c=a.pending,c!==null&&(h=c.next,h===c?a.pending=null:(h=h.next,c.next=h,cT(a,h)))}function n0(a,c,h){var y=a.pending;if(a.pending=null,y!==null){y=y.next;do c.status="rejected",c.reason=h,hT(c),c=c.next;while(c!==y)}a.action=null}function hT(a){a=a.listeners;for(var c=0;c<a.length;c++)(0,a[c])()}function fT(a,c){return c}function pT(a,c){if(St){var h=Kt.formState;if(h!==null){e:{var y=tt;if(St){if(Yn){t:{for(var x=Yn,P=Ks;x.nodeType!==8;){if(!P){x=null;break t}if(x=Cs(x.nextSibling),x===null){x=null;break t}}P=x.data,x=P==="F!"||P==="F"?x:null}if(x){Yn=Cs(x.nextSibling),y=x.data==="F!";break e}}Xl(y)}y=!1}y&&(c=h[0])}}return h=qr(),h.memoizedState=h.baseState=c,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fT,lastRenderedState:c},h.queue=y,h=RT.bind(null,tt,y),y.dispatch=h,y=t0(!1),P=l0.bind(null,tt,!1,y.queue),y=qr(),x={state:c,dispatch:null,action:a,pending:null},y.queue=x,h=MF.bind(null,tt,x,P,h),x.dispatch=h,y.memoizedState=a,[c,h,!1]}function gT(a){var c=In();return mT(c,Rt,a)}function mT(a,c,h){c=Jv(a,c,fT)[0],a=Jp(Fo)[0],c=typeof c=="object"&&c!==null&&typeof c.then=="function"?uh(c):c;var y=In(),x=y.queue,P=x.dispatch;return h!==y.memoizedState&&(tt.flags|=2048,hu(9,AF.bind(null,x,h),{destroy:void 0},null)),[c,P,a]}function AF(a,c){a.action=c}function yT(a){var c=In(),h=Rt;if(h!==null)return mT(c,h,a);In(),c=c.memoizedState,h=In();var y=h.queue.dispatch;return h.memoizedState=a,[c,y,!1]}function hu(a,c,h,y){return a={tag:a,create:c,inst:h,deps:y,next:null},c=tt.updateQueue,c===null&&(c=Zp(),tt.updateQueue=c),h=c.lastEffect,h===null?c.lastEffect=a.next=a:(y=h.next,h.next=a,a.next=y,c.lastEffect=a),a}function ST(){return In().memoizedState}function eg(a,c,h,y){var x=qr();tt.flags|=a,x.memoizedState=hu(1|c,h,{destroy:void 0},y===void 0?null:y)}function tg(a,c,h,y){var x=In();y=y===void 0?null:y;var P=x.memoizedState.inst;Rt!==null&&y!==null&&Yv(y,Rt.memoizedState.deps)?x.memoizedState=hu(c,h,P,y):(tt.flags|=a,x.memoizedState=hu(1|c,h,P,y))}function vT(a,c){eg(8390656,8,a,c)}function r0(a,c){tg(2048,8,a,c)}function bT(a,c){return tg(4,2,a,c)}function xT(a,c){return tg(4,4,a,c)}function wT(a,c){if(typeof c=="function"){a=a();var h=c(a);return function(){typeof h=="function"?h():c(null)}}if(c!=null)return a=a(),c.current=a,function(){c.current=null}}function CT(a,c,h){h=h!=null?h.concat([a]):null,tg(4,4,wT.bind(null,c,a),h)}function i0(){}function _T(a,c){var h=In();c=c===void 0?null:c;var y=h.memoizedState;return c!==null&&Yv(c,y[1])?y[0]:(h.memoizedState=[a,c],a)}function ET(a,c){var h=In();c=c===void 0?null:c;var y=h.memoizedState;if(c!==null&&Yv(c,y[1]))return y[0];if(y=a(),Jl){Ur(!0);try{a()}finally{Ur(!1)}}return h.memoizedState=[y,c],y}function s0(a,c,h){return h===void 0||za&1073741824?a.memoizedState=c:(a.memoizedState=h,a=TI(),tt.lanes|=a,Va|=a,h)}function PT(a,c,h,y){return hi(h,c)?h:au.current!==null?(a=s0(a,h,y),hi(a,c)||(Fn=!0),a):za&42?(a=TI(),tt.lanes|=a,Va|=a,c):(Fn=!0,a.memoizedState=h)}function TT(a,c,h,y,x){var P=Se.p;Se.p=P!==0&&8>P?P:8;var j=G.T,z={};G.T=z,l0(a,!1,c,h);try{var q=x(),Q=G.S;if(Q!==null&&Q(z,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var ue=PF(q,y);dh(a,c,ue,mi(a))}else dh(a,c,y,mi(a))}catch(ve){dh(a,c,{then:function(){},status:"rejected",reason:ve},mi())}finally{Se.p=P,G.T=j}}function kF(){}function o0(a,c,h,y){if(a.tag!==5)throw Error(r(476));var x=IT(a).queue;TT(a,x,c,me,h===null?kF:function(){return MT(a),h(y)})}function IT(a){var c=a.memoizedState;if(c!==null)return c;c={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:me},next:null};var h={};return c.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:h},next:null},a.memoizedState=c,a=a.alternate,a!==null&&(a.memoizedState=c),c}function MT(a){var c=IT(a).next.queue;dh(a,c,{},mi())}function a0(){return hr(kh)}function AT(){return In().memoizedState}function kT(){return In().memoizedState}function RF(a){for(var c=a.return;c!==null;){switch(c.tag){case 24:case 3:var h=mi();a=Ua(h);var y=Ha(c,a,h);y!==null&&(Mr(y,c,h),ph(y,c,h)),c={cache:Kv()},a.payload=c;return}c=c.return}}function OF(a,c,h){var y=mi();h={lane:y,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null},ng(a)?OT(c,h):(h=Nv(a,c,h,y),h!==null&&(Mr(h,a,y),jT(h,c,y)))}function RT(a,c,h){var y=mi();dh(a,c,h,y)}function dh(a,c,h,y){var x={lane:y,revertLane:0,action:h,hasEagerState:!1,eagerState:null,next:null};if(ng(a))OT(c,x);else{var P=a.alternate;if(a.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var j=c.lastRenderedState,z=P(j,h);if(x.hasEagerState=!0,x.eagerState=z,hi(z,j))return $p(a,c,x,0),Kt===null&&zp(),!1}catch{}finally{}if(h=Nv(a,c,x,y),h!==null)return Mr(h,a,y),jT(h,c,y),!0}return!1}function l0(a,c,h,y){if(y={lane:2,revertLane:Z0(),action:y,hasEagerState:!1,eagerState:null,next:null},ng(a)){if(c)throw Error(r(479))}else c=Nv(a,h,y,2),c!==null&&Mr(c,a,2)}function ng(a){var c=a.alternate;return a===tt||c!==null&&c===tt}function OT(a,c){uu=Wp=!0;var h=a.pending;h===null?c.next=c:(c.next=h.next,h.next=c),a.pending=c}function jT(a,c,h){if(h&4194176){var y=c.lanes;y&=a.pendingLanes,h|=y,c.lanes=h,Tp(a,h)}}var qs={readContext:hr,use:Qp,useCallback:vn,useContext:vn,useEffect:vn,useImperativeHandle:vn,useLayoutEffect:vn,useInsertionEffect:vn,useMemo:vn,useReducer:vn,useRef:vn,useState:vn,useDebugValue:vn,useDeferredValue:vn,useTransition:vn,useSyncExternalStore:vn,useId:vn};qs.useCacheRefresh=vn,qs.useMemoCache=vn,qs.useHostTransitionStatus=vn,qs.useFormState=vn,qs.useActionState=vn,qs.useOptimistic=vn;var ec={readContext:hr,use:Qp,useCallback:function(a,c){return qr().memoizedState=[a,c===void 0?null:c],a},useContext:hr,useEffect:vT,useImperativeHandle:function(a,c,h){h=h!=null?h.concat([a]):null,eg(4194308,4,wT.bind(null,c,a),h)},useLayoutEffect:function(a,c){return eg(4194308,4,a,c)},useInsertionEffect:function(a,c){eg(4,2,a,c)},useMemo:function(a,c){var h=qr();c=c===void 0?null:c;var y=a();if(Jl){Ur(!0);try{a()}finally{Ur(!1)}}return h.memoizedState=[y,c],y},useReducer:function(a,c,h){var y=qr();if(h!==void 0){var x=h(c);if(Jl){Ur(!0);try{h(c)}finally{Ur(!1)}}}else x=c;return y.memoizedState=y.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},y.queue=a,a=a.dispatch=OF.bind(null,tt,a),[y.memoizedState,a]},useRef:function(a){var c=qr();return a={current:a},c.memoizedState=a},useState:function(a){a=t0(a);var c=a.queue,h=RT.bind(null,tt,c);return c.dispatch=h,[a.memoizedState,h]},useDebugValue:i0,useDeferredValue:function(a,c){var h=qr();return s0(h,a,c)},useTransition:function(){var a=t0(!1);return a=TT.bind(null,tt,a.queue,!0,!1),qr().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,c,h){var y=tt,x=qr();if(St){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),Kt===null)throw Error(r(349));pt&60||rT(y,c,h)}x.memoizedState=h;var P={value:h,getSnapshot:c};return x.queue=P,vT(sT.bind(null,y,P,a),[a]),y.flags|=2048,hu(9,iT.bind(null,y,P,h,c),{destroy:void 0},null),h},useId:function(){var a=qr(),c=Kt.identifierPrefix;if(St){var h=$o,y=zo;h=(y&~(1<<32-rn(y)-1)).toString(32)+h,c=":"+c+"R"+h,h=Xp++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=TF++,c=":"+c+"r"+h.toString(32)+":";return a.memoizedState=c},useCacheRefresh:function(){return qr().memoizedState=RF.bind(null,tt)}};ec.useMemoCache=Qv,ec.useHostTransitionStatus=a0,ec.useFormState=pT,ec.useActionState=pT,ec.useOptimistic=function(a){var c=qr();c.memoizedState=c.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=h,c=l0.bind(null,tt,!0,h),h.dispatch=c,[a,c]};var $a={readContext:hr,use:Qp,useCallback:_T,useContext:hr,useEffect:r0,useImperativeHandle:CT,useInsertionEffect:bT,useLayoutEffect:xT,useMemo:ET,useReducer:Jp,useRef:ST,useState:function(){return Jp(Fo)},useDebugValue:i0,useDeferredValue:function(a,c){var h=In();return PT(h,Rt.memoizedState,a,c)},useTransition:function(){var a=Jp(Fo)[0],c=In().memoizedState;return[typeof a=="boolean"?a:uh(a),c]},useSyncExternalStore:nT,useId:AT};$a.useCacheRefresh=kT,$a.useMemoCache=Qv,$a.useHostTransitionStatus=a0,$a.useFormState=gT,$a.useActionState=gT,$a.useOptimistic=function(a,c){var h=In();return lT(h,Rt,a,c)};var tc={readContext:hr,use:Qp,useCallback:_T,useContext:hr,useEffect:r0,useImperativeHandle:CT,useInsertionEffect:bT,useLayoutEffect:xT,useMemo:ET,useReducer:e0,useRef:ST,useState:function(){return e0(Fo)},useDebugValue:i0,useDeferredValue:function(a,c){var h=In();return Rt===null?s0(h,a,c):PT(h,Rt.memoizedState,a,c)},useTransition:function(){var a=e0(Fo)[0],c=In().memoizedState;return[typeof a=="boolean"?a:uh(a),c]},useSyncExternalStore:nT,useId:AT};tc.useCacheRefresh=kT,tc.useMemoCache=Qv,tc.useHostTransitionStatus=a0,tc.useFormState=yT,tc.useActionState=yT,tc.useOptimistic=function(a,c){var h=In();return Rt!==null?lT(h,Rt,a,c):(h.baseState=a,[a,h.queue.dispatch])};function c0(a,c,h,y){c=a.memoizedState,h=h(y,c),h=h==null?c:k({},c,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var u0={isMounted:function(a){return(a=a._reactInternals)?W(a)===a:!1},enqueueSetState:function(a,c,h){a=a._reactInternals;var y=mi(),x=Ua(y);x.payload=c,h!=null&&(x.callback=h),c=Ha(a,x,y),c!==null&&(Mr(c,a,y),ph(c,a,y))},enqueueReplaceState:function(a,c,h){a=a._reactInternals;var y=mi(),x=Ua(y);x.tag=1,x.payload=c,h!=null&&(x.callback=h),c=Ha(a,x,y),c!==null&&(Mr(c,a,y),ph(c,a,y))},enqueueForceUpdate:function(a,c){a=a._reactInternals;var h=mi(),y=Ua(h);y.tag=2,c!=null&&(y.callback=c),c=Ha(a,y,h),c!==null&&(Mr(c,a,h),ph(c,a,h))}};function DT(a,c,h,y,x,P,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(y,P,j):c.prototype&&c.prototype.isPureReactComponent?!Qd(h,y)||!Qd(x,P):!0}function LT(a,c,h,y){a=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,y),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,y),c.state!==a&&u0.enqueueReplaceState(c,c.state,null)}function nc(a,c){var h=c;if("ref"in c){h={};for(var y in c)y!=="ref"&&(h[y]=c[y])}if(a=a.defaultProps){h===c&&(h=k({},h));for(var x in a)h[x]===void 0&&(h[x]=a[x])}return h}var rg=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function NT(a){rg(a)}function zT(a){console.error(a)}function $T(a){rg(a)}function ig(a,c){try{var h=a.onUncaughtError;h(c.value,{componentStack:c.stack})}catch(y){setTimeout(function(){throw y})}}function BT(a,c,h){try{var y=a.onCaughtError;y(h.value,{componentStack:h.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function d0(a,c,h){return h=Ua(h),h.tag=3,h.payload={element:null},h.callback=function(){ig(a,c)},h}function FT(a){return a=Ua(a),a.tag=3,a}function UT(a,c,h,y){var x=h.type.getDerivedStateFromError;if(typeof x=="function"){var P=y.value;a.payload=function(){return x(P)},a.callback=function(){BT(c,h,y)}}var j=h.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(a.callback=function(){BT(c,h,y),typeof x!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var z=y.stack;this.componentDidCatch(y.value,{componentStack:z!==null?z:""})})}function jF(a,c,h,y,x){if(h.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(c=h.alternate,c!==null&&fh(c,h,x,!0),h=Fi.current,h!==null){switch(h.tag){case 13:return Gs===null?q0():h.alternate===null&&pn===0&&(pn=3),h.flags&=-257,h.flags|=65536,h.lanes=x,y===Fv?h.flags|=16384:(c=h.updateQueue,c===null?h.updateQueue=new Set([y]):c.add(y),V0(a,y,x)),!1;case 22:return h.flags|=65536,y===Fv?h.flags|=16384:(c=h.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([y])},h.updateQueue=c):(h=c.retryQueue,h===null?c.retryQueue=new Set([y]):h.add(y)),V0(a,y,x)),!1}throw Error(r(435,h.tag))}return V0(a,y,x),q0(),!1}if(St)return c=Fi.current,c!==null?(!(c.flags&65536)&&(c.flags|=256),c.flags|=65536,c.lanes=x,y!==Bv&&(a=Error(r(422),{cause:y}),nh(zi(a,h)))):(y!==Bv&&(c=Error(r(423),{cause:y}),nh(zi(c,h))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,y=zi(y,h),x=d0(a.stateNode,y,x),P0(a,x),pn!==4&&(pn=2)),!1;var P=Error(r(520),{cause:y});if(P=zi(P,h),wh===null?wh=[P]:wh.push(P),pn!==4&&(pn=2),c===null)return!0;y=zi(y,h),h=c;do{switch(h.tag){case 3:return h.flags|=65536,a=x&-x,h.lanes|=a,a=d0(h.stateNode,y,a),P0(h,a),!1;case 1:if(c=h.type,P=h.stateNode,(h.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(Wa===null||!Wa.has(P))))return h.flags|=65536,x&=-x,h.lanes|=x,x=FT(x),UT(x,a,h,y),P0(h,x),!1}h=h.return}while(h!==null);return!1}var HT=Error(r(461)),Fn=!1;function Vn(a,c,h,y){c.child=a===null?VP(c,null,h,y):Zl(c,a.child,h,y)}function KT(a,c,h,y,x){h=h.render;var P=c.ref;if("ref"in y){var j={};for(var z in y)z!=="ref"&&(j[z]=y[z])}else j=y;return ic(c),y=Vv(a,c,h,j,P,x),z=Wv(),a!==null&&!Fn?(Xv(a,c,x),Uo(a,c,x)):(St&&z&&zv(c),c.flags|=1,Vn(a,c,y,x),c.child)}function GT(a,c,h,y,x){if(a===null){var P=h.type;return typeof P=="function"&&!j0(P)&&P.defaultProps===void 0&&h.compare===null?(c.tag=15,c.type=P,qT(a,c,P,y,x)):(a=cg(h.type,null,y,c,c.mode,x),a.ref=c.ref,a.return=c,c.child=a)}if(P=a.child,!b0(a,x)){var j=P.memoizedProps;if(h=h.compare,h=h!==null?h:Qd,h(j,y)&&a.ref===c.ref)return Uo(a,c,x)}return c.flags|=1,a=Ya(P,y),a.ref=c.ref,a.return=c,c.child=a}function qT(a,c,h,y,x){if(a!==null){var P=a.memoizedProps;if(Qd(P,y)&&a.ref===c.ref)if(Fn=!1,c.pendingProps=y=P,b0(a,x))a.flags&131072&&(Fn=!0);else return c.lanes=a.lanes,Uo(a,c,x)}return h0(a,c,h,y,x)}function YT(a,c,h){var y=c.pendingProps,x=y.children,P=(c.stateNode._pendingVisibility&2)!==0,j=a!==null?a.memoizedState:null;if(hh(a,c),y.mode==="hidden"||P){if(c.flags&128){if(y=j!==null?j.baseLanes|h:h,a!==null){for(x=c.child=a.child,P=0;x!==null;)P=P|x.lanes|x.childLanes,x=x.sibling;c.childLanes=P&~y}else c.childLanes=0,c.child=null;return VT(a,c,y,h)}if(h&536870912)c.memoizedState={baseLanes:0,cachePool:null},a!==null&&Vp(c,j!==null?j.cachePool:null),j!==null?WP(c,j):Uv(),XP(c);else return c.lanes=c.childLanes=536870912,VT(a,c,j!==null?j.baseLanes|h:h,h)}else j!==null?(Vp(c,j.cachePool),WP(c,j),Na(),c.memoizedState=null):(a!==null&&Vp(c,null),Uv(),Na());return Vn(a,c,x,h),c.child}function VT(a,c,h,y){var x=qv();return x=x===null?null:{parent:Ln._currentValue,pool:x},c.memoizedState={baseLanes:h,cachePool:x},a!==null&&Vp(c,null),Uv(),XP(c),a!==null&&fh(a,c,y,!0),null}function hh(a,c){var h=c.ref;if(h===null)a!==null&&a.ref!==null&&(c.flags|=2097664);else{if(typeof h!="function"&&typeof h!="object")throw Error(r(284));(a===null||a.ref!==h)&&(c.flags|=2097664)}}function h0(a,c,h,y,x){return ic(c),h=Vv(a,c,h,y,void 0,x),y=Wv(),a!==null&&!Fn?(Xv(a,c,x),Uo(a,c,x)):(St&&y&&zv(c),c.flags|=1,Vn(a,c,h,x),c.child)}function WT(a,c,h,y,x,P){return ic(c),c.updateQueue=null,h=tT(c,y,h,x),eT(a),y=Wv(),a!==null&&!Fn?(Xv(a,c,P),Uo(a,c,P)):(St&&y&&zv(c),c.flags|=1,Vn(a,c,h,P),c.child)}function XT(a,c,h,y,x){if(ic(c),c.stateNode===null){var P=ru,j=h.contextType;typeof j=="object"&&j!==null&&(P=hr(j)),P=new h(y,P),c.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=u0,c.stateNode=P,P._reactInternals=c,P=c.stateNode,P.props=y,P.state=c.memoizedState,P.refs={},_0(c),j=h.contextType,P.context=typeof j=="object"&&j!==null?hr(j):ru,P.state=c.memoizedState,j=h.getDerivedStateFromProps,typeof j=="function"&&(c0(c,h,j,y),P.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(j=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),j!==P.state&&u0.enqueueReplaceState(P,P.state,null),mh(c,y,P,x),gh(),P.state=c.memoizedState),typeof P.componentDidMount=="function"&&(c.flags|=4194308),y=!0}else if(a===null){P=c.stateNode;var z=c.memoizedProps,q=nc(h,z);P.props=q;var Q=P.context,ue=h.contextType;j=ru,typeof ue=="object"&&ue!==null&&(j=hr(ue));var ve=h.getDerivedStateFromProps;ue=typeof ve=="function"||typeof P.getSnapshotBeforeUpdate=="function",z=c.pendingProps!==z,ue||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(z||Q!==j)&&LT(c,P,y,j),Fa=!1;var se=c.memoizedState;P.state=se,mh(c,y,P,x),gh(),Q=c.memoizedState,z||se!==Q||Fa?(typeof ve=="function"&&(c0(c,h,ve,y),Q=c.memoizedState),(q=Fa||DT(c,h,q,y,se,Q,j))?(ue||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(c.flags|=4194308)):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=y,c.memoizedState=Q),P.props=y,P.state=Q,P.context=j,y=q):(typeof P.componentDidMount=="function"&&(c.flags|=4194308),y=!1)}else{P=c.stateNode,E0(a,c),j=c.memoizedProps,ue=nc(h,j),P.props=ue,ve=c.pendingProps,se=P.context,Q=h.contextType,q=ru,typeof Q=="object"&&Q!==null&&(q=hr(Q)),z=h.getDerivedStateFromProps,(Q=typeof z=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(j!==ve||se!==q)&&LT(c,P,y,q),Fa=!1,se=c.memoizedState,P.state=se,mh(c,y,P,x),gh();var ce=c.memoizedState;j!==ve||se!==ce||Fa||a!==null&&a.dependencies!==null&&sg(a.dependencies)?(typeof z=="function"&&(c0(c,h,z,y),ce=c.memoizedState),(ue=Fa||DT(c,h,ue,y,se,ce,q)||a!==null&&a.dependencies!==null&&sg(a.dependencies))?(Q||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(y,ce,q),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(y,ce,q)),typeof P.componentDidUpdate=="function"&&(c.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof P.componentDidUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),c.memoizedProps=y,c.memoizedState=ce),P.props=y,P.state=ce,P.context=q,y=ue):(typeof P.componentDidUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(c.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&se===a.memoizedState||(c.flags|=1024),y=!1)}return P=y,hh(a,c),y=(c.flags&128)!==0,P||y?(P=c.stateNode,h=y&&typeof h.getDerivedStateFromError!="function"?null:P.render(),c.flags|=1,a!==null&&y?(c.child=Zl(c,a.child,null,x),c.child=Zl(c,null,h,x)):Vn(a,c,h,x),c.memoizedState=P.state,a=c.child):a=Uo(a,c,x),a}function ZT(a,c,h,y){return th(),c.flags|=256,Vn(a,c,h,y),c.child}var f0={dehydrated:null,treeContext:null,retryLane:0};function p0(a){return{baseLanes:a,cachePool:JP()}}function g0(a,c,h){return a=a!==null?a.childLanes&~h:0,c&&(a|=Gi),a}function QT(a,c,h){var y=c.pendingProps,x=!1,P=(c.flags&128)!==0,j;if((j=P)||(j=a!==null&&a.memoizedState===null?!1:(Dn.current&2)!==0),j&&(x=!0,c.flags&=-129),j=(c.flags&32)!==0,c.flags&=-33,a===null){if(St){if(x?La(c):Na(),St){var z=Yn,q;if(q=z){e:{for(q=z,z=Ks;q.nodeType!==8;){if(!z){z=null;break e}if(q=Cs(q.nextSibling),q===null){z=null;break e}}z=q}z!==null?(c.memoizedState={dehydrated:z,treeContext:Vl!==null?{id:zo,overflow:$o}:null,retryLane:536870912},q=Ki(18,null,null,0),q.stateNode=z,q.return=c,c.child=q,Ir=c,Yn=null,q=!0):q=!1}q||Xl(c)}if(z=c.memoizedState,z!==null&&(z=z.dehydrated,z!==null))return z.data==="$!"?c.lanes=16:c.lanes=536870912,null;Bo(c)}return z=y.children,y=y.fallback,x?(Na(),x=c.mode,z=y0({mode:"hidden",children:z},x),y=oc(y,x,h,null),z.return=c,y.return=c,z.sibling=y,c.child=z,x=c.child,x.memoizedState=p0(h),x.childLanes=g0(a,j,h),c.memoizedState=f0,y):(La(c),m0(c,z))}if(q=a.memoizedState,q!==null&&(z=q.dehydrated,z!==null)){if(P)c.flags&256?(La(c),c.flags&=-257,c=S0(a,c,h)):c.memoizedState!==null?(Na(),c.child=a.child,c.flags|=128,c=null):(Na(),x=y.fallback,z=c.mode,y=y0({mode:"visible",children:y.children},z),x=oc(x,z,h,null),x.flags|=2,y.return=c,x.return=c,y.sibling=x,c.child=y,Zl(c,a.child,null,h),y=c.child,y.memoizedState=p0(h),y.childLanes=g0(a,j,h),c.memoizedState=f0,c=x);else if(La(c),z.data==="$!"){if(j=z.nextSibling&&z.nextSibling.dataset,j)var Q=j.dgst;j=Q,y=Error(r(419)),y.stack="",y.digest=j,nh({value:y,source:null,stack:null}),c=S0(a,c,h)}else if(Fn||fh(a,c,h,!1),j=(h&a.childLanes)!==0,Fn||j){if(j=Kt,j!==null){if(y=h&-h,y&42)y=1;else switch(y){case 2:y=1;break;case 8:y=4;break;case 32:y=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:y=64;break;case 268435456:y=134217728;break;default:y=0}if(y=y&(j.suspendedLanes|h)?0:y,y!==0&&y!==q.retryLane)throw q.retryLane=y,Da(a,y),Mr(j,a,y),HT}z.data==="$?"||q0(),c=S0(a,c,h)}else z.data==="$?"?(c.flags|=128,c.child=a.child,c=WF.bind(null,a),z._reactRetry=c,c=null):(a=q.treeContext,Yn=Cs(z.nextSibling),Ir=c,St=!0,xs=null,Ks=!1,a!==null&&($i[Bi++]=zo,$i[Bi++]=$o,$i[Bi++]=Vl,zo=a.id,$o=a.overflow,Vl=c),c=m0(c,y.children),c.flags|=4096);return c}return x?(Na(),x=y.fallback,z=c.mode,q=a.child,Q=q.sibling,y=Ya(q,{mode:"hidden",children:y.children}),y.subtreeFlags=q.subtreeFlags&31457280,Q!==null?x=Ya(Q,x):(x=oc(x,z,h,null),x.flags|=2),x.return=c,y.return=c,y.sibling=x,c.child=y,y=x,x=c.child,z=a.child.memoizedState,z===null?z=p0(h):(q=z.cachePool,q!==null?(Q=Ln._currentValue,q=q.parent!==Q?{parent:Q,pool:Q}:q):q=JP(),z={baseLanes:z.baseLanes|h,cachePool:q}),x.memoizedState=z,x.childLanes=g0(a,j,h),c.memoizedState=f0,y):(La(c),h=a.child,a=h.sibling,h=Ya(h,{mode:"visible",children:y.children}),h.return=c,h.sibling=null,a!==null&&(j=c.deletions,j===null?(c.deletions=[a],c.flags|=16):j.push(a)),c.child=h,c.memoizedState=null,h)}function m0(a,c){return c=y0({mode:"visible",children:c},a.mode),c.return=a,a.child=c}function y0(a,c){return _I(a,c,0,null)}function S0(a,c,h){return Zl(c,a.child,null,h),a=m0(c,c.pendingProps.children),a.flags|=2,c.memoizedState=null,a}function JT(a,c,h){a.lanes|=c;var y=a.alternate;y!==null&&(y.lanes|=c),w0(a.return,c,h)}function v0(a,c,h,y,x){var P=a.memoizedState;P===null?a.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:y,tail:h,tailMode:x}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=y,P.tail=h,P.tailMode=x)}function eI(a,c,h){var y=c.pendingProps,x=y.revealOrder,P=y.tail;if(Vn(a,c,y.children,h),y=Dn.current,y&2)y=y&1|2,c.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=c.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&JT(a,h,c);else if(a.tag===19)JT(a,h,c);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===c)break e;for(;a.sibling===null;){if(a.return===null||a.return===c)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}y&=1}switch(ke(Dn,y),x){case"forwards":for(h=c.child,x=null;h!==null;)a=h.alternate,a!==null&&Yp(a)===null&&(x=h),h=h.sibling;h=x,h===null?(x=c.child,c.child=null):(x=h.sibling,h.sibling=null),v0(c,!1,x,h,P);break;case"backwards":for(h=null,x=c.child,c.child=null;x!==null;){if(a=x.alternate,a!==null&&Yp(a)===null){c.child=x;break}a=x.sibling,x.sibling=h,h=x,x=a}v0(c,!0,h,null,P);break;case"together":v0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Uo(a,c,h){if(a!==null&&(c.dependencies=a.dependencies),Va|=c.lanes,!(h&c.childLanes))if(a!==null){if(fh(a,c,h,!1),(h&c.childLanes)===0)return null}else return null;if(a!==null&&c.child!==a.child)throw Error(r(153));if(c.child!==null){for(a=c.child,h=Ya(a,a.pendingProps),c.child=h,h.return=c;a.sibling!==null;)a=a.sibling,h=h.sibling=Ya(a,a.pendingProps),h.return=c;h.sibling=null}return c.child}function b0(a,c){return a.lanes&c?!0:(a=a.dependencies,!!(a!==null&&sg(a)))}function DF(a,c,h){switch(c.tag){case 3:wt(c,c.stateNode.containerInfo),Ba(c,Ln,a.memoizedState.cache),th();break;case 27:case 5:jn(c);break;case 4:wt(c,c.stateNode.containerInfo);break;case 10:Ba(c,c.type,c.memoizedProps.value);break;case 13:var y=c.memoizedState;if(y!==null)return y.dehydrated!==null?(La(c),c.flags|=128,null):h&c.child.childLanes?QT(a,c,h):(La(c),a=Uo(a,c,h),a!==null?a.sibling:null);La(c);break;case 19:var x=(a.flags&128)!==0;if(y=(h&c.childLanes)!==0,y||(fh(a,c,h,!1),y=(h&c.childLanes)!==0),x){if(y)return eI(a,c,h);c.flags|=128}if(x=c.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),ke(Dn,Dn.current),y)break;return null;case 22:case 23:return c.lanes=0,YT(a,c,h);case 24:Ba(c,Ln,a.memoizedState.cache)}return Uo(a,c,h)}function tI(a,c,h){if(a!==null)if(a.memoizedProps!==c.pendingProps)Fn=!0;else{if(!b0(a,h)&&!(c.flags&128))return Fn=!1,DF(a,c,h);Fn=!!(a.flags&131072)}else Fn=!1,St&&c.flags&1048576&&$P(c,Up,c.index);switch(c.lanes=0,c.tag){case 16:e:{a=c.pendingProps;var y=c.elementType,x=y._init;if(y=x(y._payload),c.type=y,typeof y=="function")j0(y)?(a=nc(y,a),c.tag=1,c=XT(null,c,y,a,h)):(c.tag=0,c=h0(null,c,y,a,h));else{if(y!=null){if(x=y.$$typeof,x===b){c.tag=11,c=KT(null,c,y,a,h);break e}else if(x===C){c.tag=14,c=GT(null,c,y,a,h);break e}}throw c=L(y)||y,Error(r(306,c,""))}}return c;case 0:return h0(a,c,c.type,c.pendingProps,h);case 1:return y=c.type,x=nc(y,c.pendingProps),XT(a,c,y,x,h);case 3:e:{if(wt(c,c.stateNode.containerInfo),a===null)throw Error(r(387));var P=c.pendingProps;x=c.memoizedState,y=x.element,E0(a,c),mh(c,P,null,h);var j=c.memoizedState;if(P=j.cache,Ba(c,Ln,P),P!==x.cache&&C0(c,[Ln],h,!0),gh(),P=j.element,x.isDehydrated)if(x={element:P,isDehydrated:!1,cache:j.cache},c.updateQueue.baseState=x,c.memoizedState=x,c.flags&256){c=ZT(a,c,P,h);break e}else if(P!==y){y=zi(Error(r(424)),c),nh(y),c=ZT(a,c,P,h);break e}else for(Yn=Cs(c.stateNode.containerInfo.firstChild),Ir=c,St=!0,xs=null,Ks=!0,h=VP(c,null,P,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(th(),P===y){c=Uo(a,c,h);break e}Vn(a,c,P,h)}c=c.child}return c;case 26:return hh(a,c),a===null?(h=iM(c.type,null,c.pendingProps,null))?c.memoizedState=h:St||(h=c.type,a=c.pendingProps,y=xg(ot.current).createElement(h),y[$n]=c,y[cr]=a,Wn(y,h,a),Pn(y),c.stateNode=y):c.memoizedState=iM(c.type,a.memoizedProps,c.pendingProps,a.memoizedState),null;case 27:return jn(c),a===null&&St&&(y=c.stateNode=tM(c.type,c.pendingProps,ot.current),Ir=c,Ks=!0,Yn=Cs(y.firstChild)),y=c.pendingProps.children,a!==null||St?Vn(a,c,y,h):c.child=Zl(c,null,y,h),hh(a,c),c.child;case 5:return a===null&&St&&((x=y=Yn)&&(y=dU(y,c.type,c.pendingProps,Ks),y!==null?(c.stateNode=y,Ir=c,Yn=Cs(y.firstChild),Ks=!1,x=!0):x=!1),x||Xl(c)),jn(c),x=c.type,P=c.pendingProps,j=a!==null?a.memoizedProps:null,y=P.children,ob(x,P)?y=null:j!==null&&ob(x,j)&&(c.flags|=32),c.memoizedState!==null&&(x=Vv(a,c,IF,null,null,h),kh._currentValue=x),hh(a,c),Vn(a,c,y,h),c.child;case 6:return a===null&&St&&((a=h=Yn)&&(h=hU(h,c.pendingProps,Ks),h!==null?(c.stateNode=h,Ir=c,Yn=null,a=!0):a=!1),a||Xl(c)),null;case 13:return QT(a,c,h);case 4:return wt(c,c.stateNode.containerInfo),y=c.pendingProps,a===null?c.child=Zl(c,null,y,h):Vn(a,c,y,h),c.child;case 11:return KT(a,c,c.type,c.pendingProps,h);case 7:return Vn(a,c,c.pendingProps,h),c.child;case 8:return Vn(a,c,c.pendingProps.children,h),c.child;case 12:return Vn(a,c,c.pendingProps.children,h),c.child;case 10:return y=c.pendingProps,Ba(c,c.type,y.value),Vn(a,c,y.children,h),c.child;case 9:return x=c.type._context,y=c.pendingProps.children,ic(c),x=hr(x),y=y(x),c.flags|=1,Vn(a,c,y,h),c.child;case 14:return GT(a,c,c.type,c.pendingProps,h);case 15:return qT(a,c,c.type,c.pendingProps,h);case 19:return eI(a,c,h);case 22:return YT(a,c,h);case 24:return ic(c),y=hr(Ln),a===null?(x=qv(),x===null&&(x=Kt,P=Kv(),x.pooledCache=P,P.refCount++,P!==null&&(x.pooledCacheLanes|=h),x=P),c.memoizedState={parent:y,cache:x},_0(c),Ba(c,Ln,x)):(a.lanes&h&&(E0(a,c),mh(c,null,null,h),gh()),x=a.memoizedState,P=c.memoizedState,x.parent!==y?(x={parent:y,cache:y},c.memoizedState=x,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=x),Ba(c,Ln,y)):(y=P.cache,Ba(c,Ln,y),y!==x.cache&&C0(c,[Ln],h,!0))),Vn(a,c,c.pendingProps.children,h),c.child;case 29:throw c.pendingProps}throw Error(r(156,c.tag))}var x0=we(null),rc=null,Ho=null;function Ba(a,c,h){ke(x0,c._currentValue),c._currentValue=h}function Ko(a){a._currentValue=x0.current,Ie(x0)}function w0(a,c,h){for(;a!==null;){var y=a.alternate;if((a.childLanes&c)!==c?(a.childLanes|=c,y!==null&&(y.childLanes|=c)):y!==null&&(y.childLanes&c)!==c&&(y.childLanes|=c),a===h)break;a=a.return}}function C0(a,c,h,y){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var P=x.dependencies;if(P!==null){var j=x.child;P=P.firstContext;e:for(;P!==null;){var z=P;P=x;for(var q=0;q<c.length;q++)if(z.context===c[q]){P.lanes|=h,z=P.alternate,z!==null&&(z.lanes|=h),w0(P.return,h,a),y||(j=null);break e}P=z.next}}else if(x.tag===18){if(j=x.return,j===null)throw Error(r(341));j.lanes|=h,P=j.alternate,P!==null&&(P.lanes|=h),w0(j,h,a),j=null}else j=x.child;if(j!==null)j.return=x;else for(j=x;j!==null;){if(j===a){j=null;break}if(x=j.sibling,x!==null){x.return=j.return,j=x;break}j=j.return}x=j}}function fh(a,c,h,y){a=null;for(var x=c,P=!1;x!==null;){if(!P){if(x.flags&524288)P=!0;else if(x.flags&262144)break}if(x.tag===10){var j=x.alternate;if(j===null)throw Error(r(387));if(j=j.memoizedProps,j!==null){var z=x.type;hi(x.pendingProps.value,j.value)||(a!==null?a.push(z):a=[z])}}else if(x===Mt.current){if(j=x.alternate,j===null)throw Error(r(387));j.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(kh):a=[kh])}x=x.return}a!==null&&C0(c,a,h,y),c.flags|=262144}function sg(a){for(a=a.firstContext;a!==null;){if(!hi(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function ic(a){rc=a,Ho=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function hr(a){return nI(rc,a)}function og(a,c){return rc===null&&ic(a),nI(a,c)}function nI(a,c){var h=c._currentValue;if(c={context:c,memoizedValue:h,next:null},Ho===null){if(a===null)throw Error(r(308));Ho=c,a.dependencies={lanes:0,firstContext:c},a.flags|=524288}else Ho=Ho.next=c;return h}var Fa=!1;function _0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function E0(a,c){a=a.updateQueue,c.updateQueue===a&&(c.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ua(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ha(a,c,h){var y=a.updateQueue;if(y===null)return null;if(y=y.shared,an&2){var x=y.pending;return x===null?c.next=c:(c.next=x.next,x.next=c),y.pending=c,c=Bp(a),NP(a,null,h),c}return $p(a,y,c,h),Bp(a)}function ph(a,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194176)!==0)){var y=c.lanes;y&=a.pendingLanes,h|=y,c.lanes=h,Tp(a,h)}}function P0(a,c){var h=a.updateQueue,y=a.alternate;if(y!==null&&(y=y.updateQueue,h===y)){var x=null,P=null;if(h=h.firstBaseUpdate,h!==null){do{var j={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};P===null?x=P=j:P=P.next=j,h=h.next}while(h!==null);P===null?x=P=c:P=P.next=c}else x=P=c;h={baseState:y.baseState,firstBaseUpdate:x,lastBaseUpdate:P,shared:y.shared,callbacks:y.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=c}var T0=!1;function gh(){if(T0){var a=cu;if(a!==null)throw a}}function mh(a,c,h,y){T0=!1;var x=a.updateQueue;Fa=!1;var P=x.firstBaseUpdate,j=x.lastBaseUpdate,z=x.shared.pending;if(z!==null){x.shared.pending=null;var q=z,Q=q.next;q.next=null,j===null?P=Q:j.next=Q,j=q;var ue=a.alternate;ue!==null&&(ue=ue.updateQueue,z=ue.lastBaseUpdate,z!==j&&(z===null?ue.firstBaseUpdate=Q:z.next=Q,ue.lastBaseUpdate=q))}if(P!==null){var ve=x.baseState;j=0,ue=Q=q=null,z=P;do{var se=z.lane&-536870913,ce=se!==z.lane;if(ce?(pt&se)===se:(y&se)===se){se!==0&&se===lu&&(T0=!0),ue!==null&&(ue=ue.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var De=a,Ve=z;se=c;var gn=h;switch(Ve.tag){case 1:if(De=Ve.payload,typeof De=="function"){ve=De.call(gn,ve,se);break e}ve=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Ve.payload,se=typeof De=="function"?De.call(gn,ve,se):De,se==null)break e;ve=k({},ve,se);break e;case 2:Fa=!0}}se=z.callback,se!==null&&(a.flags|=64,ce&&(a.flags|=8192),ce=x.callbacks,ce===null?x.callbacks=[se]:ce.push(se))}else ce={lane:se,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ue===null?(Q=ue=ce,q=ve):ue=ue.next=ce,j|=se;if(z=z.next,z===null){if(z=x.shared.pending,z===null)break;ce=z,z=ce.next,ce.next=null,x.lastBaseUpdate=ce,x.shared.pending=null}}while(!0);ue===null&&(q=ve),x.baseState=q,x.firstBaseUpdate=Q,x.lastBaseUpdate=ue,P===null&&(x.shared.lanes=0),Va|=j,a.lanes=j,a.memoizedState=ve}}function rI(a,c){if(typeof a!="function")throw Error(r(191,a));a.call(c)}function iI(a,c){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)rI(h[a],c)}function yh(a,c){try{var h=c.updateQueue,y=h!==null?h.lastEffect:null;if(y!==null){var x=y.next;h=x;do{if((h.tag&a)===a){y=void 0;var P=h.create,j=h.inst;y=P(),j.destroy=y}h=h.next}while(h!==x)}}catch(z){zt(c,c.return,z)}}function Ka(a,c,h){try{var y=c.updateQueue,x=y!==null?y.lastEffect:null;if(x!==null){var P=x.next;y=P;do{if((y.tag&a)===a){var j=y.inst,z=j.destroy;if(z!==void 0){j.destroy=void 0,x=c;var q=h;try{z()}catch(Q){zt(x,q,Q)}}}y=y.next}while(y!==P)}}catch(Q){zt(c,c.return,Q)}}function sI(a){var c=a.updateQueue;if(c!==null){var h=a.stateNode;try{iI(c,h)}catch(y){zt(a,a.return,y)}}}function oI(a,c,h){h.props=nc(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(y){zt(a,c,y)}}function sc(a,c){try{var h=a.ref;if(h!==null){var y=a.stateNode;switch(a.tag){case 26:case 27:case 5:var x=y;break;default:x=y}typeof h=="function"?a.refCleanup=h(x):h.current=x}}catch(P){zt(a,c,P)}}function fi(a,c){var h=a.ref,y=a.refCleanup;if(h!==null)if(typeof y=="function")try{y()}catch(x){zt(a,c,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(x){zt(a,c,x)}else h.current=null}function aI(a){var c=a.type,h=a.memoizedProps,y=a.stateNode;try{e:switch(c){case"button":case"input":case"select":case"textarea":h.autoFocus&&y.focus();break e;case"img":h.src?y.src=h.src:h.srcSet&&(y.srcset=h.srcSet)}}catch(x){zt(a,a.return,x)}}function lI(a,c,h){try{var y=a.stateNode;oU(y,a.type,h,c),y[cr]=c}catch(x){zt(a,a.return,x)}}function cI(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27||a.tag===4}function I0(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||cI(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==27&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function M0(a,c,h){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(a,c):h.insertBefore(a,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(a,h)):(c=h,c.appendChild(a)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=bg));else if(y!==4&&y!==27&&(a=a.child,a!==null))for(M0(a,c,h),a=a.sibling;a!==null;)M0(a,c,h),a=a.sibling}function ag(a,c,h){var y=a.tag;if(y===5||y===6)a=a.stateNode,c?h.insertBefore(a,c):h.appendChild(a);else if(y!==4&&y!==27&&(a=a.child,a!==null))for(ag(a,c,h),a=a.sibling;a!==null;)ag(a,c,h),a=a.sibling}var Go=!1,fn=!1,A0=!1,uI=typeof WeakSet=="function"?WeakSet:Set,Un=null,dI=!1;function LF(a,c){if(a=a.containerInfo,ib=Tg,a=IP(a),Rv(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else e:{h=(h=a.ownerDocument)&&h.defaultView||window;var y=h.getSelection&&h.getSelection();if(y&&y.rangeCount!==0){h=y.anchorNode;var x=y.anchorOffset,P=y.focusNode;y=y.focusOffset;try{h.nodeType,P.nodeType}catch{h=null;break e}var j=0,z=-1,q=-1,Q=0,ue=0,ve=a,se=null;t:for(;;){for(var ce;ve!==h||x!==0&&ve.nodeType!==3||(z=j+x),ve!==P||y!==0&&ve.nodeType!==3||(q=j+y),ve.nodeType===3&&(j+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)se=ve,ve=ce;for(;;){if(ve===a)break t;if(se===h&&++Q===x&&(z=j),se===P&&++ue===y&&(q=j),(ce=ve.nextSibling)!==null)break;ve=se,se=ve.parentNode}ve=ce}h=z===-1||q===-1?null:{start:z,end:q}}else h=null}h=h||{start:0,end:0}}else h=null;for(sb={focusedElem:a,selectionRange:h},Tg=!1,Un=c;Un!==null;)if(c=Un,a=c.child,(c.subtreeFlags&1028)!==0&&a!==null)a.return=c,Un=a;else for(;Un!==null;){switch(c=Un,P=c.alternate,a=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if(a&1024&&P!==null){a=void 0,h=c,x=P.memoizedProps,P=P.memoizedState,y=h.stateNode;try{var De=nc(h.type,x,h.elementType===h.type);a=y.getSnapshotBeforeUpdate(De,P),y.__reactInternalSnapshotBeforeUpdate=a}catch(Ve){zt(h,h.return,Ve)}}break;case 3:if(a&1024){if(a=c.stateNode.containerInfo,h=a.nodeType,h===9)cb(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":cb(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(r(163))}if(a=c.sibling,a!==null){a.return=c.return,Un=a;break}Un=c.return}return De=dI,dI=!1,De}function hI(a,c,h){var y=h.flags;switch(h.tag){case 0:case 11:case 15:Yo(a,h),y&4&&yh(5,h);break;case 1:if(Yo(a,h),y&4)if(a=h.stateNode,c===null)try{a.componentDidMount()}catch(z){zt(h,h.return,z)}else{var x=nc(h.type,c.memoizedProps);c=c.memoizedState;try{a.componentDidUpdate(x,c,a.__reactInternalSnapshotBeforeUpdate)}catch(z){zt(h,h.return,z)}}y&64&&sI(h),y&512&&sc(h,h.return);break;case 3:if(Yo(a,h),y&64&&(y=h.updateQueue,y!==null)){if(a=null,h.child!==null)switch(h.child.tag){case 27:case 5:a=h.child.stateNode;break;case 1:a=h.child.stateNode}try{iI(y,a)}catch(z){zt(h,h.return,z)}}break;case 26:Yo(a,h),y&512&&sc(h,h.return);break;case 27:case 5:Yo(a,h),c===null&&y&4&&aI(h),y&512&&sc(h,h.return);break;case 12:Yo(a,h);break;case 13:Yo(a,h),y&4&&gI(a,h);break;case 22:if(x=h.memoizedState!==null||Go,!x){c=c!==null&&c.memoizedState!==null||fn;var P=Go,j=fn;Go=x,(fn=c)&&!j?Ga(a,h,(h.subtreeFlags&8772)!==0):Yo(a,h),Go=P,fn=j}y&512&&(h.memoizedProps.mode==="manual"?sc(h,h.return):fi(h,h.return));break;default:Yo(a,h)}}function fI(a){var c=a.alternate;c!==null&&(a.alternate=null,fI(c)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(c=a.stateNode,c!==null&&Bd(c)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Mn=null,pi=!1;function qo(a,c,h){for(h=h.child;h!==null;)pI(a,c,h),h=h.sibling}function pI(a,c,h){if(nn&&typeof nn.onCommitFiberUnmount=="function")try{nn.onCommitFiberUnmount(Ct,h)}catch{}switch(h.tag){case 26:fn||fi(h,c),qo(a,c,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:fn||fi(h,c);var y=Mn,x=pi;for(Mn=h.stateNode,qo(a,c,h),h=h.stateNode,c=h.attributes;c.length;)h.removeAttributeNode(c[0]);Bd(h),Mn=y,pi=x;break;case 5:fn||fi(h,c);case 6:x=Mn;var P=pi;if(Mn=null,qo(a,c,h),Mn=x,pi=P,Mn!==null)if(pi)try{a=Mn,y=h.stateNode,a.nodeType===8?a.parentNode.removeChild(y):a.removeChild(y)}catch(j){zt(h,c,j)}else try{Mn.removeChild(h.stateNode)}catch(j){zt(h,c,j)}break;case 18:Mn!==null&&(pi?(c=Mn,h=h.stateNode,c.nodeType===8?lb(c.parentNode,h):c.nodeType===1&&lb(c,h),Dh(c)):lb(Mn,h.stateNode));break;case 4:y=Mn,x=pi,Mn=h.stateNode.containerInfo,pi=!0,qo(a,c,h),Mn=y,pi=x;break;case 0:case 11:case 14:case 15:fn||Ka(2,h,c),fn||Ka(4,h,c),qo(a,c,h);break;case 1:fn||(fi(h,c),y=h.stateNode,typeof y.componentWillUnmount=="function"&&oI(h,c,y)),qo(a,c,h);break;case 21:qo(a,c,h);break;case 22:fn||fi(h,c),fn=(y=fn)||h.memoizedState!==null,qo(a,c,h),fn=y;break;default:qo(a,c,h)}}function gI(a,c){if(c.memoizedState===null&&(a=c.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Dh(a)}catch(h){zt(c,c.return,h)}}function NF(a){switch(a.tag){case 13:case 19:var c=a.stateNode;return c===null&&(c=a.stateNode=new uI),c;case 22:return a=a.stateNode,c=a._retryCache,c===null&&(c=a._retryCache=new uI),c;default:throw Error(r(435,a.tag))}}function k0(a,c){var h=NF(a);c.forEach(function(y){var x=XF.bind(null,a,y);h.has(y)||(h.add(y),y.then(x,x))})}function Ui(a,c){var h=c.deletions;if(h!==null)for(var y=0;y<h.length;y++){var x=h[y],P=a,j=c,z=j;e:for(;z!==null;){switch(z.tag){case 27:case 5:Mn=z.stateNode,pi=!1;break e;case 3:Mn=z.stateNode.containerInfo,pi=!0;break e;case 4:Mn=z.stateNode.containerInfo,pi=!0;break e}z=z.return}if(Mn===null)throw Error(r(160));pI(P,j,x),Mn=null,pi=!1,P=x.alternate,P!==null&&(P.return=null),x.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)mI(c,a),c=c.sibling}var ws=null;function mI(a,c){var h=a.alternate,y=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ui(c,a),Hi(a),y&4&&(Ka(3,a,a.return),yh(3,a),Ka(5,a,a.return));break;case 1:Ui(c,a),Hi(a),y&512&&(fn||h===null||fi(h,h.return)),y&64&&Go&&(a=a.updateQueue,a!==null&&(y=a.callbacks,y!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?y:h.concat(y))));break;case 26:var x=ws;if(Ui(c,a),Hi(a),y&512&&(fn||h===null||fi(h,h.return)),y&4){var P=h!==null?h.memoizedState:null;if(y=a.memoizedState,h===null)if(y===null)if(a.stateNode===null){e:{y=a.type,h=a.memoizedProps,x=x.ownerDocument||x;t:switch(y){case"title":P=x.getElementsByTagName("title")[0],(!P||P[Nl]||P[$n]||P.namespaceURI==="http://www.w3.org/2000/svg"||P.hasAttribute("itemprop"))&&(P=x.createElement(y),x.head.insertBefore(P,x.querySelector("head > title"))),Wn(P,y,h),P[$n]=a,Pn(P),y=P;break e;case"link":var j=aM("link","href",x).get(y+(h.href||""));if(j){for(var z=0;z<j.length;z++)if(P=j[z],P.getAttribute("href")===(h.href==null?null:h.href)&&P.getAttribute("rel")===(h.rel==null?null:h.rel)&&P.getAttribute("title")===(h.title==null?null:h.title)&&P.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){j.splice(z,1);break t}}P=x.createElement(y),Wn(P,y,h),x.head.appendChild(P);break;case"meta":if(j=aM("meta","content",x).get(y+(h.content||""))){for(z=0;z<j.length;z++)if(P=j[z],P.getAttribute("content")===(h.content==null?null:""+h.content)&&P.getAttribute("name")===(h.name==null?null:h.name)&&P.getAttribute("property")===(h.property==null?null:h.property)&&P.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&P.getAttribute("charset")===(h.charSet==null?null:h.charSet)){j.splice(z,1);break t}}P=x.createElement(y),Wn(P,y,h),x.head.appendChild(P);break;default:throw Error(r(468,y))}P[$n]=a,Pn(P),y=P}a.stateNode=y}else lM(x,a.type,a.stateNode);else a.stateNode=oM(x,y,a.memoizedProps);else P!==y?(P===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):P.count--,y===null?lM(x,a.type,a.stateNode):oM(x,y,a.memoizedProps)):y===null&&a.stateNode!==null&&lI(a,a.memoizedProps,h.memoizedProps)}break;case 27:if(y&4&&a.alternate===null){x=a.stateNode,P=a.memoizedProps;try{for(var q=x.firstChild;q;){var Q=q.nextSibling,ue=q.nodeName;q[Nl]||ue==="HEAD"||ue==="BODY"||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&q.rel.toLowerCase()==="stylesheet"||x.removeChild(q),q=Q}for(var ve=a.type,se=x.attributes;se.length;)x.removeAttributeNode(se[0]);Wn(x,ve,P),x[$n]=a,x[cr]=P}catch(De){zt(a,a.return,De)}}case 5:if(Ui(c,a),Hi(a),y&512&&(fn||h===null||fi(h,h.return)),a.flags&32){x=a.stateNode;try{ui(x,"")}catch(De){zt(a,a.return,De)}}y&4&&a.stateNode!=null&&(x=a.memoizedProps,lI(a,x,h!==null?h.memoizedProps:x)),y&1024&&(A0=!0);break;case 6:if(Ui(c,a),Hi(a),y&4){if(a.stateNode===null)throw Error(r(162));y=a.memoizedProps,h=a.stateNode;try{h.nodeValue=y}catch(De){zt(a,a.return,De)}}break;case 3:if(_g=null,x=ws,ws=wg(c.containerInfo),Ui(c,a),ws=x,Hi(a),y&4&&h!==null&&h.memoizedState.isDehydrated)try{Dh(c.containerInfo)}catch(De){zt(a,a.return,De)}A0&&(A0=!1,yI(a));break;case 4:y=ws,ws=wg(a.stateNode.containerInfo),Ui(c,a),Hi(a),ws=y;break;case 12:Ui(c,a),Hi(a);break;case 13:Ui(c,a),Hi(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(B0=Br()),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,k0(a,y)));break;case 22:if(y&512&&(fn||h===null||fi(h,h.return)),q=a.memoizedState!==null,Q=h!==null&&h.memoizedState!==null,ue=Go,ve=fn,Go=ue||q,fn=ve||Q,Ui(c,a),fn=ve,Go=ue,Hi(a),c=a.stateNode,c._current=a,c._visibility&=-3,c._visibility|=c._pendingVisibility&2,y&8192&&(c._visibility=q?c._visibility&-2:c._visibility|1,q&&(c=Go||fn,h===null||Q||c||fu(a)),a.memoizedProps===null||a.memoizedProps.mode!=="manual"))e:for(h=null,c=a;;){if(c.tag===5||c.tag===26||c.tag===27){if(h===null){Q=h=c;try{if(x=Q.stateNode,q)P=x.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none";else{j=Q.stateNode,z=Q.memoizedProps.style;var ce=z!=null&&z.hasOwnProperty("display")?z.display:null;j.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(De){zt(Q,Q.return,De)}}}else if(c.tag===6){if(h===null){Q=c;try{Q.stateNode.nodeValue=q?"":Q.memoizedProps}catch(De){zt(Q,Q.return,De)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===a)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===a)break e;for(;c.sibling===null;){if(c.return===null||c.return===a)break e;h===c&&(h=null),c=c.return}h===c&&(h=null),c.sibling.return=c.return,c=c.sibling}y&4&&(y=a.updateQueue,y!==null&&(h=y.retryQueue,h!==null&&(y.retryQueue=null,k0(a,h))));break;case 19:Ui(c,a),Hi(a),y&4&&(y=a.updateQueue,y!==null&&(a.updateQueue=null,k0(a,y)));break;case 21:break;default:Ui(c,a),Hi(a)}}function Hi(a){var c=a.flags;if(c&2){try{if(a.tag!==27){e:{for(var h=a.return;h!==null;){if(cI(h)){var y=h;break e}h=h.return}throw Error(r(160))}switch(y.tag){case 27:var x=y.stateNode,P=I0(a);ag(a,P,x);break;case 5:var j=y.stateNode;y.flags&32&&(ui(j,""),y.flags&=-33);var z=I0(a);ag(a,z,j);break;case 3:case 4:var q=y.stateNode.containerInfo,Q=I0(a);M0(a,Q,q);break;default:throw Error(r(161))}}}catch(ue){zt(a,a.return,ue)}a.flags&=-3}c&4096&&(a.flags&=-4097)}function yI(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var c=a;yI(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),a=a.sibling}}function Yo(a,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)hI(a,c.alternate,c),c=c.sibling}function fu(a){for(a=a.child;a!==null;){var c=a;switch(c.tag){case 0:case 11:case 14:case 15:Ka(4,c,c.return),fu(c);break;case 1:fi(c,c.return);var h=c.stateNode;typeof h.componentWillUnmount=="function"&&oI(c,c.return,h),fu(c);break;case 26:case 27:case 5:fi(c,c.return),fu(c);break;case 22:fi(c,c.return),c.memoizedState===null&&fu(c);break;default:fu(c)}a=a.sibling}}function Ga(a,c,h){for(h=h&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var y=c.alternate,x=a,P=c,j=P.flags;switch(P.tag){case 0:case 11:case 15:Ga(x,P,h),yh(4,P);break;case 1:if(Ga(x,P,h),y=P,x=y.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Q){zt(y,y.return,Q)}if(y=P,x=y.updateQueue,x!==null){var z=y.stateNode;try{var q=x.shared.hiddenCallbacks;if(q!==null)for(x.shared.hiddenCallbacks=null,x=0;x<q.length;x++)rI(q[x],z)}catch(Q){zt(y,y.return,Q)}}h&&j&64&&sI(P),sc(P,P.return);break;case 26:case 27:case 5:Ga(x,P,h),h&&y===null&&j&4&&aI(P),sc(P,P.return);break;case 12:Ga(x,P,h);break;case 13:Ga(x,P,h),h&&j&4&&gI(x,P);break;case 22:P.memoizedState===null&&Ga(x,P,h),sc(P,P.return);break;default:Ga(x,P,h)}c=c.sibling}}function R0(a,c){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(a=c.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&ah(h))}function O0(a,c){a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&ah(a))}function qa(a,c,h,y){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)SI(a,c,h,y),c=c.sibling}function SI(a,c,h,y){var x=c.flags;switch(c.tag){case 0:case 11:case 15:qa(a,c,h,y),x&2048&&yh(9,c);break;case 3:qa(a,c,h,y),x&2048&&(a=null,c.alternate!==null&&(a=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==a&&(c.refCount++,a!=null&&ah(a)));break;case 12:if(x&2048){qa(a,c,h,y),a=c.stateNode;try{var P=c.memoizedProps,j=P.id,z=P.onPostCommit;typeof z=="function"&&z(j,c.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(q){zt(c,c.return,q)}}else qa(a,c,h,y);break;case 23:break;case 22:P=c.stateNode,c.memoizedState!==null?P._visibility&4?qa(a,c,h,y):Sh(a,c):P._visibility&4?qa(a,c,h,y):(P._visibility|=4,pu(a,c,h,y,(c.subtreeFlags&10256)!==0)),x&2048&&R0(c.alternate,c);break;case 24:qa(a,c,h,y),x&2048&&O0(c.alternate,c);break;default:qa(a,c,h,y)}}function pu(a,c,h,y,x){for(x=x&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var P=a,j=c,z=h,q=y,Q=j.flags;switch(j.tag){case 0:case 11:case 15:pu(P,j,z,q,x),yh(8,j);break;case 23:break;case 22:var ue=j.stateNode;j.memoizedState!==null?ue._visibility&4?pu(P,j,z,q,x):Sh(P,j):(ue._visibility|=4,pu(P,j,z,q,x)),x&&Q&2048&&R0(j.alternate,j);break;case 24:pu(P,j,z,q,x),x&&Q&2048&&O0(j.alternate,j);break;default:pu(P,j,z,q,x)}c=c.sibling}}function Sh(a,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var h=a,y=c,x=y.flags;switch(y.tag){case 22:Sh(h,y),x&2048&&R0(y.alternate,y);break;case 24:Sh(h,y),x&2048&&O0(y.alternate,y);break;default:Sh(h,y)}c=c.sibling}}var vh=8192;function gu(a){if(a.subtreeFlags&vh)for(a=a.child;a!==null;)vI(a),a=a.sibling}function vI(a){switch(a.tag){case 26:gu(a),a.flags&vh&&a.memoizedState!==null&&EU(ws,a.memoizedState,a.memoizedProps);break;case 5:gu(a);break;case 3:case 4:var c=ws;ws=wg(a.stateNode.containerInfo),gu(a),ws=c;break;case 22:a.memoizedState===null&&(c=a.alternate,c!==null&&c.memoizedState!==null?(c=vh,vh=16777216,gu(a),vh=c):gu(a));break;default:gu(a)}}function bI(a){var c=a.alternate;if(c!==null&&(a=c.child,a!==null)){c.child=null;do c=a.sibling,a.sibling=null,a=c;while(a!==null)}}function bh(a){var c=a.deletions;if(a.flags&16){if(c!==null)for(var h=0;h<c.length;h++){var y=c[h];Un=y,wI(y,a)}bI(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)xI(a),a=a.sibling}function xI(a){switch(a.tag){case 0:case 11:case 15:bh(a),a.flags&2048&&Ka(9,a,a.return);break;case 3:bh(a);break;case 12:bh(a);break;case 22:var c=a.stateNode;a.memoizedState!==null&&c._visibility&4&&(a.return===null||a.return.tag!==13)?(c._visibility&=-5,lg(a)):bh(a);break;default:bh(a)}}function lg(a){var c=a.deletions;if(a.flags&16){if(c!==null)for(var h=0;h<c.length;h++){var y=c[h];Un=y,wI(y,a)}bI(a)}for(a=a.child;a!==null;){switch(c=a,c.tag){case 0:case 11:case 15:Ka(8,c,c.return),lg(c);break;case 22:h=c.stateNode,h._visibility&4&&(h._visibility&=-5,lg(c));break;default:lg(c)}a=a.sibling}}function wI(a,c){for(;Un!==null;){var h=Un;switch(h.tag){case 0:case 11:case 15:Ka(8,h,c);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var y=h.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:ah(h.memoizedState.cache)}if(y=h.child,y!==null)y.return=h,Un=y;else e:for(h=a;Un!==null;){y=Un;var x=y.sibling,P=y.return;if(fI(y),y===h){Un=null;break e}if(x!==null){x.return=P,Un=x;break e}Un=P}}}function zF(a,c,h,y){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ki(a,c,h,y){return new zF(a,c,h,y)}function j0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ya(a,c){var h=a.alternate;return h===null?(h=Ki(a.tag,c,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=c,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&31457280,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,c=a.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function CI(a,c){a.flags&=31457282;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=c,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,c=h.dependencies,a.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),a}function cg(a,c,h,y,x,P){var j=0;if(y=a,typeof a=="function")j0(a)&&(j=1);else if(typeof a=="string")j=CU(a,h,Ue.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case u:return oc(h.children,x,P,c);case d:j=8,x|=24;break;case f:return a=Ki(12,h,c,x|2),a.elementType=f,a.lanes=P,a;case v:return a=Ki(13,h,c,x),a.elementType=v,a.lanes=P,a;case w:return a=Ki(19,h,c,x),a.elementType=w,a.lanes=P,a;case M:return _I(h,x,P,c);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case g:case S:j=10;break e;case m:j=9;break e;case b:j=11;break e;case C:j=14;break e;case _:j=16,y=null;break e}j=29,h=Error(r(130,a===null?"null":typeof a,"")),y=null}return c=Ki(j,h,c,x),c.elementType=a,c.type=y,c.lanes=P,c}function oc(a,c,h,y){return a=Ki(7,a,y,c),a.lanes=h,a}function _I(a,c,h,y){a=Ki(22,a,y,c),a.elementType=M,a.lanes=h;var x={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var P=x._current;if(P===null)throw Error(r(456));if(!(x._pendingVisibility&2)){var j=Da(P,2);j!==null&&(x._pendingVisibility|=2,Mr(j,P,2))}},attach:function(){var P=x._current;if(P===null)throw Error(r(456));if(x._pendingVisibility&2){var j=Da(P,2);j!==null&&(x._pendingVisibility&=-3,Mr(j,P,2))}}};return a.stateNode=x,a}function D0(a,c,h){return a=Ki(6,a,null,c),a.lanes=h,a}function L0(a,c,h){return c=Ki(4,a.children!==null?a.children:[],a.key,c),c.lanes=h,c.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},c}function Vo(a){a.flags|=4}function EI(a,c){if(c.type!=="stylesheet"||c.state.loading&4)a.flags&=-16777217;else if(a.flags|=16777216,!cM(c)){if(c=Fi.current,c!==null&&((pt&4194176)===pt?Gs!==null:(pt&62914560)!==pt&&!(pt&536870912)||c!==Gs))throw ih=Fv,UP;a.flags|=8192}}function ug(a,c){c!==null&&(a.flags|=4),a.flags&16384&&(c=a.tag!==22?Ia():536870912,a.lanes|=c,yu|=c)}function xh(a,c){if(!St)switch(a.tailMode){case"hidden":c=a.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var y=null;h!==null;)h.alternate!==null&&(y=h),h=h.sibling;y===null?c||a.tail===null?a.tail=null:a.tail.sibling=null:y.sibling=null}}function on(a){var c=a.alternate!==null&&a.alternate.child===a.child,h=0,y=0;if(c)for(var x=a.child;x!==null;)h|=x.lanes|x.childLanes,y|=x.subtreeFlags&31457280,y|=x.flags&31457280,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)h|=x.lanes|x.childLanes,y|=x.subtreeFlags,y|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=y,a.childLanes=h,c}function $F(a,c,h){var y=c.pendingProps;switch($v(c),c.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(c),null;case 1:return on(c),null;case 3:return h=c.stateNode,y=null,a!==null&&(y=a.memoizedState.cache),c.memoizedState.cache!==y&&(c.flags|=2048),Ko(Ln),ft(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(eh(c)?Vo(c):a===null||a.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,xs!==null&&(K0(xs),xs=null))),on(c),null;case 26:return h=c.memoizedState,a===null?(Vo(c),h!==null?(on(c),EI(c,h)):(on(c),c.flags&=-16777217)):h?h!==a.memoizedState?(Vo(c),on(c),EI(c,h)):(on(c),c.flags&=-16777217):(a.memoizedProps!==y&&Vo(c),on(c),c.flags&=-16777217),null;case 27:dn(c),h=ot.current;var x=c.type;if(a!==null&&c.stateNode!=null)a.memoizedProps!==y&&Vo(c);else{if(!y){if(c.stateNode===null)throw Error(r(166));return on(c),null}a=Ue.current,eh(c)?BP(c):(a=tM(x,y,h),c.stateNode=a,Vo(c))}return on(c),null;case 5:if(dn(c),h=c.type,a!==null&&c.stateNode!=null)a.memoizedProps!==y&&Vo(c);else{if(!y){if(c.stateNode===null)throw Error(r(166));return on(c),null}if(a=Ue.current,eh(c))BP(c);else{switch(x=xg(ot.current),a){case 1:a=x.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:a=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":a=x.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":a=x.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":a=x.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof y.is=="string"?x.createElement("select",{is:y.is}):x.createElement("select"),y.multiple?a.multiple=!0:y.size&&(a.size=y.size);break;default:a=typeof y.is=="string"?x.createElement(h,{is:y.is}):x.createElement(h)}}a[$n]=c,a[cr]=y;e:for(x=c.child;x!==null;){if(x.tag===5||x.tag===6)a.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===c)break e;for(;x.sibling===null;){if(x.return===null||x.return===c)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}c.stateNode=a;e:switch(Wn(a,h,y),h){case"button":case"input":case"select":case"textarea":a=!!y.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Vo(c)}}return on(c),c.flags&=-16777217,null;case 6:if(a&&c.stateNode!=null)a.memoizedProps!==y&&Vo(c);else{if(typeof y!="string"&&c.stateNode===null)throw Error(r(166));if(a=ot.current,eh(c)){if(a=c.stateNode,h=c.memoizedProps,y=null,x=Ir,x!==null)switch(x.tag){case 27:case 5:y=x.memoizedProps}a[$n]=c,a=!!(a.nodeValue===h||y!==null&&y.suppressHydrationWarning===!0||WI(a.nodeValue,h)),a||Xl(c)}else a=xg(a).createTextNode(y),a[$n]=c,c.stateNode=a}return on(c),null;case 13:if(y=c.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=eh(c),y!==null&&y.dehydrated!==null){if(a===null){if(!x)throw Error(r(318));if(x=c.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[$n]=c}else th(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;on(c),x=!1}else xs!==null&&(K0(xs),xs=null),x=!0;if(!x)return c.flags&256?(Bo(c),c):(Bo(c),null)}if(Bo(c),c.flags&128)return c.lanes=h,c;if(h=y!==null,a=a!==null&&a.memoizedState!==null,h){y=c.child,x=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(x=y.alternate.memoizedState.cachePool.pool);var P=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(P=y.memoizedState.cachePool.pool),P!==x&&(y.flags|=2048)}return h!==a&&h&&(c.child.flags|=8192),ug(c,c.updateQueue),on(c),null;case 4:return ft(),a===null&&tb(c.stateNode.containerInfo),on(c),null;case 10:return Ko(c.type),on(c),null;case 19:if(Ie(Dn),x=c.memoizedState,x===null)return on(c),null;if(y=(c.flags&128)!==0,P=x.rendering,P===null)if(y)xh(x,!1);else{if(pn!==0||a!==null&&a.flags&128)for(a=c.child;a!==null;){if(P=Yp(a),P!==null){for(c.flags|=128,xh(x,!1),a=P.updateQueue,c.updateQueue=a,ug(c,a),c.subtreeFlags=0,a=h,h=c.child;h!==null;)CI(h,a),h=h.sibling;return ke(Dn,Dn.current&1|2),c.child}a=a.sibling}x.tail!==null&&Br()>dg&&(c.flags|=128,y=!0,xh(x,!1),c.lanes=4194304)}else{if(!y)if(a=Yp(P),a!==null){if(c.flags|=128,y=!0,a=a.updateQueue,c.updateQueue=a,ug(c,a),xh(x,!0),x.tail===null&&x.tailMode==="hidden"&&!P.alternate&&!St)return on(c),null}else 2*Br()-x.renderingStartTime>dg&&h!==536870912&&(c.flags|=128,y=!0,xh(x,!1),c.lanes=4194304);x.isBackwards?(P.sibling=c.child,c.child=P):(a=x.last,a!==null?a.sibling=P:c.child=P,x.last=P)}return x.tail!==null?(c=x.tail,x.rendering=c,x.tail=c.sibling,x.renderingStartTime=Br(),c.sibling=null,a=Dn.current,ke(Dn,y?a&1|2:a&1),c):(on(c),null);case 22:case 23:return Bo(c),Hv(),y=c.memoizedState!==null,a!==null?a.memoizedState!==null!==y&&(c.flags|=8192):y&&(c.flags|=8192),y?h&536870912&&!(c.flags&128)&&(on(c),c.subtreeFlags&6&&(c.flags|=8192)):on(c),h=c.updateQueue,h!==null&&ug(c,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==h&&(c.flags|=2048),a!==null&&Ie(Ql),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),c.memoizedState.cache!==h&&(c.flags|=2048),Ko(Ln),on(c),null;case 25:return null}throw Error(r(156,c.tag))}function BF(a,c){switch($v(c),c.tag){case 1:return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 3:return Ko(Ln),ft(),a=c.flags,a&65536&&!(a&128)?(c.flags=a&-65537|128,c):null;case 26:case 27:case 5:return dn(c),null;case 13:if(Bo(c),a=c.memoizedState,a!==null&&a.dehydrated!==null){if(c.alternate===null)throw Error(r(340));th()}return a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 19:return Ie(Dn),null;case 4:return ft(),null;case 10:return Ko(c.type),null;case 22:case 23:return Bo(c),Hv(),a!==null&&Ie(Ql),a=c.flags,a&65536?(c.flags=a&-65537|128,c):null;case 24:return Ko(Ln),null;case 25:return null;default:return null}}function PI(a,c){switch($v(c),c.tag){case 3:Ko(Ln),ft();break;case 26:case 27:case 5:dn(c);break;case 4:ft();break;case 13:Bo(c);break;case 19:Ie(Dn);break;case 10:Ko(c.type);break;case 22:case 23:Bo(c),Hv(),a!==null&&Ie(Ql);break;case 24:Ko(Ln)}}var FF={getCacheForType:function(a){var c=hr(Ln),h=c.data.get(a);return h===void 0&&(h=a(),c.data.set(a,h)),h}},UF=typeof WeakMap=="function"?WeakMap:Map,an=0,Kt=null,at=null,pt=0,Gt=0,gi=null,Wo=!1,mu=!1,N0=!1,Xo=0,pn=0,Va=0,ac=0,z0=0,Gi=0,yu=0,wh=null,Ys=null,$0=!1,B0=0,dg=1/0,hg=null,Wa=null,fg=!1,lc=null,Ch=0,F0=0,U0=null,_h=0,H0=null;function mi(){if(an&2&&pt!==0)return pt&-pt;if(G.T!==null){var a=lu;return a!==0?a:Z0()}return Hc()}function TI(){Gi===0&&(Gi=!(pt&536870912)||St?Uc():536870912);var a=Fi.current;return a!==null&&(a.flags|=32),Gi}function Mr(a,c,h){(a===Kt&&Gt===2||a.cancelPendingCommit!==null)&&(Su(a,0),Zo(a,pt,Gi,!1)),Ll(a,h),(!(an&2)||a!==Kt)&&(a===Kt&&(!(an&2)&&(ac|=h),pn===4&&Zo(a,pt,Gi,!1)),Vs(a))}function II(a,c,h){if(an&6)throw Error(r(327));var y=!h&&(c&60)===0&&(c&a.expiredLanes)===0||Ro(a,c),x=y?GF(a,c):Y0(a,c,!0),P=y;do{if(x===0){mu&&!y&&Zo(a,c,0,!1);break}else if(x===6)Zo(a,c,0,!Wo);else{if(h=a.current.alternate,P&&!HF(h)){x=Y0(a,c,!1),P=!1;continue}if(x===2){if(P=c,a.errorRecoveryDisabledLanes&P)var j=0;else j=a.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){c=j;e:{var z=a;x=wh;var q=z.current.memoizedState.isDehydrated;if(q&&(Su(z,j).flags|=256),j=Y0(z,j,!1),j!==2){if(N0&&!q){z.errorRecoveryDisabledLanes|=P,ac|=P,x=4;break e}P=Ys,Ys=x,P!==null&&K0(P)}x=j}if(P=!1,x!==2)continue}}if(x===1){Su(a,0),Zo(a,c,0,!0);break}e:{switch(y=a,x){case 0:case 1:throw Error(r(345));case 4:if((c&4194176)===c){Zo(y,c,Gi,!Wo);break e}break;case 2:Ys=null;break;case 3:case 5:break;default:throw Error(r(329))}if(y.finishedWork=h,y.finishedLanes=c,(c&62914560)===c&&(P=B0+300-Br(),10<P)){if(Zo(y,c,Gi,!Wo),Bs(y,0)!==0)break e;y.timeoutHandle=QI(MI.bind(null,y,h,Ys,hg,$0,c,Gi,ac,yu,Wo,2,-0,0),P);break e}MI(y,h,Ys,hg,$0,c,Gi,ac,yu,Wo,0,-0,0)}}break}while(!0);Vs(a)}function K0(a){Ys===null?Ys=a:Ys.push.apply(Ys,a)}function MI(a,c,h,y,x,P,j,z,q,Q,ue,ve,se){var ce=c.subtreeFlags;if((ce&8192||(ce&16785408)===16785408)&&(Ah={stylesheets:null,count:0,unsuspend:_U},vI(c),c=PU(),c!==null)){a.cancelPendingCommit=c(LI.bind(null,a,h,y,x,j,z,q,1,ve,se)),Zo(a,P,j,!Q);return}LI(a,h,y,x,j,z,q,ue,ve,se)}function HF(a){for(var c=a;;){var h=c.tag;if((h===0||h===11||h===15)&&c.flags&16384&&(h=c.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var y=0;y<h.length;y++){var x=h[y],P=x.getSnapshot;x=x.value;try{if(!hi(P(),x))return!1}catch{return!1}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===a)break;for(;c.sibling===null;){if(c.return===null||c.return===a)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Zo(a,c,h,y){c&=~z0,c&=~ac,a.suspendedLanes|=c,a.pingedLanes&=~c,y&&(a.warmLanes|=c),y=a.expirationTimes;for(var x=c;0<x;){var P=31-rn(x),j=1<<P;y[P]=-1,x&=~j}h!==0&&Pp(a,h,c)}function pg(){return an&6?!0:(Eh(0),!1)}function G0(){if(at!==null){if(Gt===0)var a=at.return;else a=at,Ho=rc=null,Zv(a),ou=null,sh=0,a=at;for(;a!==null;)PI(a.alternate,a),a=a.return;at=null}}function Su(a,c){a.finishedWork=null,a.finishedLanes=0;var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,lU(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),G0(),Kt=a,at=h=Ya(a.current,null),pt=c,Gt=0,gi=null,Wo=!1,mu=Ro(a,c),N0=!1,yu=Gi=z0=ac=Va=pn=0,Ys=wh=null,$0=!1,c&8&&(c|=c&32);var y=a.entangledLanes;if(y!==0)for(a=a.entanglements,y&=c;0<y;){var x=31-rn(y),P=1<<x;c|=a[x],y&=~P}return Xo=c,zp(),h}function AI(a,c){tt=null,G.H=qs,c===rh?(c=GP(),Gt=3):c===UP?(c=GP(),Gt=4):Gt=c===HT?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,gi=c,at===null&&(pn=1,ig(a,zi(c,a.current)))}function kI(){var a=G.H;return G.H=qs,a===null?qs:a}function RI(){var a=G.A;return G.A=FF,a}function q0(){pn=4,Wo||(pt&4194176)!==pt&&Fi.current!==null||(mu=!0),!(Va&134217727)&&!(ac&134217727)||Kt===null||Zo(Kt,pt,Gi,!1)}function Y0(a,c,h){var y=an;an|=2;var x=kI(),P=RI();(Kt!==a||pt!==c)&&(hg=null,Su(a,c)),c=!1;var j=pn;e:do try{if(Gt!==0&&at!==null){var z=at,q=gi;switch(Gt){case 8:G0(),j=6;break e;case 3:case 2:case 6:Fi.current===null&&(c=!0);var Q=Gt;if(Gt=0,gi=null,vu(a,z,q,Q),h&&mu){j=0;break e}break;default:Q=Gt,Gt=0,gi=null,vu(a,z,q,Q)}}KF(),j=pn;break}catch(ue){AI(a,ue)}while(!0);return c&&a.shellSuspendCounter++,Ho=rc=null,an=y,G.H=x,G.A=P,at===null&&(Kt=null,pt=0,zp()),j}function KF(){for(;at!==null;)OI(at)}function GF(a,c){var h=an;an|=2;var y=kI(),x=RI();Kt!==a||pt!==c?(hg=null,dg=Br()+500,Su(a,c)):mu=Ro(a,c);e:do try{if(Gt!==0&&at!==null){c=at;var P=gi;t:switch(Gt){case 1:Gt=0,gi=null,vu(a,c,P,1);break;case 2:if(HP(P)){Gt=0,gi=null,jI(c);break}c=function(){Gt===2&&Kt===a&&(Gt=7),Vs(a)},P.then(c,c);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:HP(P)?(Gt=0,gi=null,jI(c)):(Gt=0,gi=null,vu(a,c,P,7));break;case 5:var j=null;switch(at.tag){case 26:j=at.memoizedState;case 5:case 27:var z=at;if(!j||cM(j)){Gt=0,gi=null;var q=z.sibling;if(q!==null)at=q;else{var Q=z.return;Q!==null?(at=Q,gg(Q)):at=null}break t}}Gt=0,gi=null,vu(a,c,P,5);break;case 6:Gt=0,gi=null,vu(a,c,P,6);break;case 8:G0(),pn=6;break e;default:throw Error(r(462))}}qF();break}catch(ue){AI(a,ue)}while(!0);return Ho=rc=null,G.H=y,G.A=x,an=h,at!==null?0:(Kt=null,pt=0,zp(),pn)}function qF(){for(;at!==null&&!qe();)OI(at)}function OI(a){var c=tI(a.alternate,a,Xo);a.memoizedProps=a.pendingProps,c===null?gg(a):at=c}function jI(a){var c=a,h=c.alternate;switch(c.tag){case 15:case 0:c=WT(h,c,c.pendingProps,c.type,void 0,pt);break;case 11:c=WT(h,c,c.pendingProps,c.type.render,c.ref,pt);break;case 5:Zv(c);default:PI(h,c),c=at=CI(c,Xo),c=tI(h,c,Xo)}a.memoizedProps=a.pendingProps,c===null?gg(a):at=c}function vu(a,c,h,y){Ho=rc=null,Zv(c),ou=null,sh=0;var x=c.return;try{if(jF(a,x,c,h,pt)){pn=1,ig(a,zi(h,a.current)),at=null;return}}catch(P){if(x!==null)throw at=x,P;pn=1,ig(a,zi(h,a.current)),at=null;return}c.flags&32768?(St||y===1?a=!0:mu||pt&536870912?a=!1:(Wo=a=!0,(y===2||y===3||y===6)&&(y=Fi.current,y!==null&&y.tag===13&&(y.flags|=16384))),DI(c,a)):gg(c)}function gg(a){var c=a;do{if(c.flags&32768){DI(c,Wo);return}a=c.return;var h=$F(c.alternate,c,Xo);if(h!==null){at=h;return}if(c=c.sibling,c!==null){at=c;return}at=c=a}while(c!==null);pn===0&&(pn=5)}function DI(a,c){do{var h=BF(a.alternate,a);if(h!==null){h.flags&=32767,at=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!c&&(a=a.sibling,a!==null)){at=a;return}at=a=h}while(a!==null);pn=6,at=null}function LI(a,c,h,y,x,P,j,z,q,Q){var ue=G.T,ve=Se.p;try{Se.p=2,G.T=null,YF(a,c,h,y,ve,x,P,j,z,q,Q)}finally{G.T=ue,Se.p=ve}}function YF(a,c,h,y,x,P,j,z){do bu();while(lc!==null);if(an&6)throw Error(r(327));var q=a.finishedWork;if(y=a.finishedLanes,q===null)return null;if(a.finishedWork=null,a.finishedLanes=0,q===a.current)throw Error(r(177));a.callbackNode=null,a.callbackPriority=0,a.cancelPendingCommit=null;var Q=q.lanes|q.childLanes;if(Q|=Lv,xv(a,y,Q,P,j,z),a===Kt&&(at=Kt=null,pt=0),!(q.subtreeFlags&10256)&&!(q.flags&10256)||fg||(fg=!0,F0=Q,U0=h,ZF(cs,function(){return bu(),null})),h=(q.flags&15990)!==0,q.subtreeFlags&15990||h?(h=G.T,G.T=null,P=Se.p,Se.p=2,j=an,an|=4,LF(a,q),mI(q,a),yF(sb,a.containerInfo),Tg=!!ib,sb=ib=null,a.current=q,hI(a,q.alternate,q),jd(),an=j,Se.p=P,G.T=h):a.current=q,fg?(fg=!1,lc=a,Ch=y):NI(a,Q),Q=a.pendingLanes,Q===0&&(Wa=null),Fr(q.stateNode),Vs(a),c!==null)for(x=a.onRecoverableError,q=0;q<c.length;q++)Q=c[q],x(Q.value,{componentStack:Q.stack});return Ch&3&&bu(),Q=a.pendingLanes,y&4194218&&Q&42?a===H0?_h++:(_h=0,H0=a):_h=0,Eh(0),null}function NI(a,c){(a.pooledCacheLanes&=c)===0&&(c=a.pooledCache,c!=null&&(a.pooledCache=null,ah(c)))}function bu(){if(lc!==null){var a=lc,c=F0;F0=0;var h=zd(Ch),y=G.T,x=Se.p;try{if(Se.p=32>h?32:h,G.T=null,lc===null)var P=!1;else{h=U0,U0=null;var j=lc,z=Ch;if(lc=null,Ch=0,an&6)throw Error(r(331));var q=an;if(an|=4,xI(j.current),SI(j,j.current,z,h),an=q,Eh(0,!1),nn&&typeof nn.onPostCommitFiberRoot=="function")try{nn.onPostCommitFiberRoot(Ct,j)}catch{}P=!0}return P}finally{Se.p=x,G.T=y,NI(a,c)}}return!1}function zI(a,c,h){c=zi(h,c),c=d0(a.stateNode,c,2),a=Ha(a,c,2),a!==null&&(Ll(a,2),Vs(a))}function zt(a,c,h){if(a.tag===3)zI(a,a,h);else for(;c!==null;){if(c.tag===3){zI(c,a,h);break}else if(c.tag===1){var y=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Wa===null||!Wa.has(y))){a=zi(h,a),h=FT(2),y=Ha(c,h,2),y!==null&&(UT(h,y,c,a),Ll(y,2),Vs(y));break}}c=c.return}}function V0(a,c,h){var y=a.pingCache;if(y===null){y=a.pingCache=new UF;var x=new Set;y.set(c,x)}else x=y.get(c),x===void 0&&(x=new Set,y.set(c,x));x.has(h)||(N0=!0,x.add(h),a=VF.bind(null,a,c,h),c.then(a,a))}function VF(a,c,h){var y=a.pingCache;y!==null&&y.delete(c),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,Kt===a&&(pt&h)===h&&(pn===4||pn===3&&(pt&62914560)===pt&&300>Br()-B0?!(an&2)&&Su(a,0):z0|=h,yu===pt&&(yu=0)),Vs(a)}function $I(a,c){c===0&&(c=Ia()),a=Da(a,c),a!==null&&(Ll(a,c),Vs(a))}function WF(a){var c=a.memoizedState,h=0;c!==null&&(h=c.retryLane),$I(a,h)}function XF(a,c){var h=0;switch(a.tag){case 13:var y=a.stateNode,x=a.memoizedState;x!==null&&(h=x.retryLane);break;case 19:y=a.stateNode;break;case 22:y=a.stateNode._retryCache;break;default:throw Error(r(314))}y!==null&&y.delete(c),$I(a,h)}function ZF(a,c){return Tr(a,c)}var mg=null,xu=null,W0=!1,yg=!1,X0=!1,cc=0;function Vs(a){a!==xu&&a.next===null&&(xu===null?mg=xu=a:xu=xu.next=a),yg=!0,W0||(W0=!0,JF(QF))}function Eh(a,c){if(!X0&&yg){X0=!0;do for(var h=!1,y=mg;y!==null;){if(a!==0){var x=y.pendingLanes;if(x===0)var P=0;else{var j=y.suspendedLanes,z=y.pingedLanes;P=(1<<31-rn(42|a)+1)-1,P&=x&~(j&~z),P=P&201326677?P&201326677|1:P?P|2:0}P!==0&&(h=!0,UI(y,P))}else P=pt,P=Bs(y,y===Kt?P:0),!(P&3)||Ro(y,P)||(h=!0,UI(y,P));y=y.next}while(h);X0=!1}}function QF(){yg=W0=!1;var a=0;cc!==0&&(aU()&&(a=cc),cc=0);for(var c=Br(),h=null,y=mg;y!==null;){var x=y.next,P=BI(y,c);P===0?(y.next=null,h===null?mg=x:h.next=x,x===null&&(xu=h)):(h=y,(a!==0||P&3)&&(yg=!0)),y=x}Eh(a)}function BI(a,c){for(var h=a.suspendedLanes,y=a.pingedLanes,x=a.expirationTimes,P=a.pendingLanes&-62914561;0<P;){var j=31-rn(P),z=1<<j,q=x[j];q===-1?(!(z&h)||z&y)&&(x[j]=Ld(z,c)):q<=c&&(a.expiredLanes|=z),P&=~z}if(c=Kt,h=pt,h=Bs(a,a===c?h:0),y=a.callbackNode,h===0||a===c&&Gt===2||a.cancelPendingCommit!==null)return y!==null&&y!==null&&ls(y),a.callbackNode=null,a.callbackPriority=0;if(!(h&3)||Ro(a,h)){if(c=h&-h,c===a.callbackPriority)return c;switch(y!==null&&ls(y),zd(h)){case 2:case 8:h=Ao;break;case 32:h=cs;break;case 268435456:h=ae;break;default:h=cs}return y=FI.bind(null,a),h=Tr(h,y),a.callbackPriority=c,a.callbackNode=h,c}return y!==null&&y!==null&&ls(y),a.callbackPriority=2,a.callbackNode=null,2}function FI(a,c){var h=a.callbackNode;if(bu()&&a.callbackNode!==h)return null;var y=pt;return y=Bs(a,a===Kt?y:0),y===0?null:(II(a,y,c),BI(a,Br()),a.callbackNode!=null&&a.callbackNode===h?FI.bind(null,a):null)}function UI(a,c){if(bu())return null;II(a,c,!0)}function JF(a){cU(function(){an&6?Tr(Bc,a):a()})}function Z0(){return cc===0&&(cc=Uc()),cc}function HI(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Yc(""+a)}function KI(a,c){var h=c.ownerDocument.createElement("input");return h.name=c.name,h.value=c.value,a.id&&h.setAttribute("form",a.id),c.parentNode.insertBefore(h,c),a=new FormData(a),h.parentNode.removeChild(h),a}function eU(a,c,h,y,x){if(c==="submit"&&h&&h.stateNode===x){var P=HI((x[cr]||null).action),j=y.submitter;j&&(c=(c=j[cr]||null)?HI(c.formAction):j.getAttribute("formAction"),c!==null&&(P=c,j=null));var z=new Te("action","action",null,y,x);a.push({event:z,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(cc!==0){var q=j?KI(x,j):new FormData(x);o0(h,{pending:!0,data:q,method:x.method,action:P},null,q)}}else typeof P=="function"&&(z.preventDefault(),q=j?KI(x,j):new FormData(x),o0(h,{pending:!0,data:q,method:x.method,action:P},P,q))},currentTarget:x}]})}}for(var Q0=0;Q0<LP.length;Q0++){var J0=LP[Q0],tU=J0.toLowerCase(),nU=J0[0].toUpperCase()+J0.slice(1);bs(tU,"on"+nU)}bs(kP,"onAnimationEnd"),bs(RP,"onAnimationIteration"),bs(OP,"onAnimationStart"),bs("dblclick","onDoubleClick"),bs("focusin","onFocus"),bs("focusout","onBlur"),bs(vF,"onTransitionRun"),bs(bF,"onTransitionStart"),bs(xF,"onTransitionCancel"),bs(jP,"onTransitionEnd"),ka("onMouseEnter",["mouseout","mouseover"]),ka("onMouseLeave",["mouseout","mouseover"]),ka("onPointerEnter",["pointerout","pointerover"]),ka("onPointerLeave",["pointerout","pointerover"]),Li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Li("onBeforeInput",["compositionend","keypress","textInput","paste"]),Li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ph="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rU=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ph));function GI(a,c){c=(c&4)!==0;for(var h=0;h<a.length;h++){var y=a[h],x=y.event;y=y.listeners;e:{var P=void 0;if(c)for(var j=y.length-1;0<=j;j--){var z=y[j],q=z.instance,Q=z.currentTarget;if(z=z.listener,q!==P&&x.isPropagationStopped())break e;P=z,x.currentTarget=Q;try{P(x)}catch(ue){rg(ue)}x.currentTarget=null,P=q}else for(j=0;j<y.length;j++){if(z=y[j],q=z.instance,Q=z.currentTarget,z=z.listener,q!==P&&x.isPropagationStopped())break e;P=z,x.currentTarget=Q;try{P(x)}catch(ue){rg(ue)}x.currentTarget=null,P=q}}}}function dt(a,c){var h=c[$d];h===void 0&&(h=c[$d]=new Set);var y=a+"__bubble";h.has(y)||(qI(c,a,2,!1),h.add(y))}function eb(a,c,h){var y=0;c&&(y|=4),qI(h,a,y,c)}var Sg="_reactListening"+Math.random().toString(36).slice(2);function tb(a){if(!a[Sg]){a[Sg]=!0,Mp.forEach(function(h){h!=="selectionchange"&&(rU.has(h)||eb(h,!1,a),eb(h,!0,a))});var c=a.nodeType===9?a:a.ownerDocument;c===null||c[Sg]||(c[Sg]=!0,eb("selectionchange",!1,c))}}function qI(a,c,h,y){switch(gM(c)){case 2:var x=MU;break;case 8:x=AU;break;default:x=pb}h=x.bind(null,c,h,a),x=void 0,!Wc||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(x=!0),y?x!==void 0?a.addEventListener(c,h,{capture:!0,passive:x}):a.addEventListener(c,h,!0):x!==void 0?a.addEventListener(c,h,{passive:x}):a.addEventListener(c,h,!1)}function nb(a,c,h,y,x){var P=y;if(!(c&1)&&!(c&2)&&y!==null)e:for(;;){if(y===null)return;var j=y.tag;if(j===3||j===4){var z=y.stateNode.containerInfo;if(z===x||z.nodeType===8&&z.parentNode===x)break;if(j===4)for(j=y.return;j!==null;){var q=j.tag;if((q===3||q===4)&&(q=j.stateNode.containerInfo,q===x||q.nodeType===8&&q.parentNode===x))return;j=j.return}for(;z!==null;){if(j=jo(z),j===null)return;if(q=j.tag,q===5||q===6||q===26||q===27){y=P=j;continue e}z=z.parentNode}}y=y.return}Vc(function(){var Q=P,ue=ys(h),ve=[];e:{var se=DP.get(a);if(se!==void 0){var ce=Te,De=a;switch(a){case"keypress":if(Xc(h)===0)break e;case"keydown":case"keyup":ce=X7;break;case"focusin":De="focus",ce=dr;break;case"focusout":De="blur",ce=dr;break;case"beforeblur":case"afterblur":ce=dr;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=ur;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=Bn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=J7;break;case kP:case RP:case OP:ce=vs;break;case jP:ce=tF;break;case"scroll":case"scrollend":ce=Xe;break;case"wheel":ce=rF;break;case"copy":case"cut":case"paste":ce=Lp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=hP;break;case"toggle":case"beforetoggle":ce=sF}var Ve=(c&4)!==0,gn=!Ve&&(a==="scroll"||a==="scrollend"),J=Ve?se!==null?se+"Capture":null:se;Ve=[];for(var Z=Q,ie;Z!==null;){var ye=Z;if(ie=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ie===null||J===null||(ye=Hl(Z,J),ye!=null&&Ve.push(Th(Z,ye,ie))),gn)break;Z=Z.return}0<Ve.length&&(se=new ce(se,De,null,h,ue),ve.push({event:se,listeners:Ve}))}}if(!(c&7)){e:{if(se=a==="mouseover"||a==="pointerover",ce=a==="mouseout"||a==="pointerout",se&&h!==Yd&&(De=h.relatedTarget||h.fromElement)&&(jo(De)||De[Ma]))break e;if((ce||se)&&(se=ue.window===ue?ue:(se=ue.ownerDocument)?se.defaultView||se.parentWindow:window,ce?(De=h.relatedTarget||h.toElement,ce=Q,De=De?jo(De):null,De!==null&&(gn=W(De),Ve=De.tag,De!==gn||Ve!==5&&Ve!==27&&Ve!==6)&&(De=null)):(ce=null,De=Q),ce!==De)){if(Ve=ur,ye="onMouseLeave",J="onMouseEnter",Z="mouse",(a==="pointerout"||a==="pointerover")&&(Ve=hP,ye="onPointerLeave",J="onPointerEnter",Z="pointer"),gn=ce==null?se:zl(ce),ie=De==null?se:zl(De),se=new Ve(ye,Z+"leave",ce,h,ue),se.target=gn,se.relatedTarget=ie,ye=null,jo(ue)===Q&&(Ve=new Ve(J,Z+"enter",De,h,ue),Ve.target=ie,Ve.relatedTarget=gn,ye=Ve),gn=ye,ce&&De)t:{for(Ve=ce,J=De,Z=0,ie=Ve;ie;ie=wu(ie))Z++;for(ie=0,ye=J;ye;ye=wu(ye))ie++;for(;0<Z-ie;)Ve=wu(Ve),Z--;for(;0<ie-Z;)J=wu(J),ie--;for(;Z--;){if(Ve===J||J!==null&&Ve===J.alternate)break t;Ve=wu(Ve),J=wu(J)}Ve=null}else Ve=null;ce!==null&&YI(ve,se,ce,Ve,!1),De!==null&&gn!==null&&YI(ve,gn,De,Ve,!0)}}e:{if(se=Q?zl(Q):window,ce=se.nodeName&&se.nodeName.toLowerCase(),ce==="select"||ce==="input"&&se.type==="file")var Oe=bP;else if(SP(se))if(xP)Oe=gF;else{Oe=fF;var nt=hF}else ce=se.nodeName,!ce||ce.toLowerCase()!=="input"||se.type!=="checkbox"&&se.type!=="radio"?Q&&qd(Q.elementType)&&(Oe=bP):Oe=pF;if(Oe&&(Oe=Oe(a,Q))){vP(ve,Oe,h,ue);break e}nt&&nt(a,se,Q),a==="focusout"&&Q&&se.type==="number"&&Q.memoizedProps.value!=null&&Kd(se,"number",se.value)}switch(nt=Q?zl(Q):window,a){case"focusin":(SP(nt)||nt.contentEditable==="true")&&(eu=nt,Ov=Q,Jd=null);break;case"focusout":Jd=Ov=eu=null;break;case"mousedown":jv=!0;break;case"contextmenu":case"mouseup":case"dragend":jv=!1,MP(ve,h,ue);break;case"selectionchange":if(SF)break;case"keydown":case"keyup":MP(ve,h,ue)}var ze;if(Mv)e:{switch(a){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Jc?mP(a,h)&&(Ke="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(Ke="onCompositionStart");Ke&&(fP&&h.locale!=="ko"&&(Jc||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Jc&&(ze=Dp()):(Ss=ue,Lo="value"in Ss?Ss.value:Ss.textContent,Jc=!0)),nt=vg(Q,Ke),0<nt.length&&(Ke=new Gl(Ke,a,null,h,ue),ve.push({event:Ke,listeners:nt}),ze?Ke.data=ze:(ze=yP(h),ze!==null&&(Ke.data=ze)))),(ze=aF?lF(a,h):cF(a,h))&&(Ke=vg(Q,"onBeforeInput"),0<Ke.length&&(nt=new Gl("onBeforeInput","beforeinput",null,h,ue),ve.push({event:nt,listeners:Ke}),nt.data=ze)),eU(ve,a,Q,h,ue)}GI(ve,c)})}function Th(a,c,h){return{instance:a,listener:c,currentTarget:h}}function vg(a,c){for(var h=c+"Capture",y=[];a!==null;){var x=a,P=x.stateNode;x=x.tag,x!==5&&x!==26&&x!==27||P===null||(x=Hl(a,h),x!=null&&y.unshift(Th(a,x,P)),x=Hl(a,c),x!=null&&y.push(Th(a,x,P))),a=a.return}return y}function wu(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function YI(a,c,h,y,x){for(var P=c._reactName,j=[];h!==null&&h!==y;){var z=h,q=z.alternate,Q=z.stateNode;if(z=z.tag,q!==null&&q===y)break;z!==5&&z!==26&&z!==27||Q===null||(q=Q,x?(Q=Hl(h,P),Q!=null&&j.unshift(Th(h,Q,q))):x||(Q=Hl(h,P),Q!=null&&j.push(Th(h,Q,q)))),h=h.return}j.length!==0&&a.push({event:c,listeners:j})}var iU=/\r\n?/g,sU=/\u0000|\uFFFD/g;function VI(a){return(typeof a=="string"?a:""+a).replace(iU,`
`).replace(sU,"")}function WI(a,c){return c=VI(c),VI(a)===c}function bg(){}function Ot(a,c,h,y,x,P){switch(h){case"children":typeof y=="string"?c==="body"||c==="textarea"&&y===""||ui(a,y):(typeof y=="number"||typeof y=="bigint")&&c!=="body"&&ui(a,""+y);break;case"className":Gc(a,"class",y);break;case"tabIndex":Gc(a,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":Gc(a,h,y);break;case"style":ms(a,y,P);break;case"data":if(c!=="object"){Gc(a,"data",y);break}case"src":case"href":if(y===""&&(c!=="a"||h!=="href")){a.removeAttribute(h);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(h);break}y=Yc(""+y),a.setAttribute(h,y);break;case"action":case"formAction":if(typeof y=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof P=="function"&&(h==="formAction"?(c!=="input"&&Ot(a,c,"name",x.name,x,null),Ot(a,c,"formEncType",x.formEncType,x,null),Ot(a,c,"formMethod",x.formMethod,x,null),Ot(a,c,"formTarget",x.formTarget,x,null)):(Ot(a,c,"encType",x.encType,x,null),Ot(a,c,"method",x.method,x,null),Ot(a,c,"target",x.target,x,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){a.removeAttribute(h);break}y=Yc(""+y),a.setAttribute(h,y);break;case"onClick":y!=null&&(a.onclick=bg);break;case"onScroll":y!=null&&dt("scroll",a);break;case"onScrollEnd":y!=null&&dt("scrollend",a);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(h=y.__html,h!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"multiple":a.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":a.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){a.removeAttribute("xlink:href");break}h=Yc(""+y),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,""+y):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":y===!0?a.setAttribute(h,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?a.setAttribute(h,y):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?a.setAttribute(h,y):a.removeAttribute(h);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?a.removeAttribute(h):a.setAttribute(h,y);break;case"popover":dt("beforetoggle",a),dt("toggle",a),Kc(a,"popover",y);break;case"xlinkActuate":gs(a,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":gs(a,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":gs(a,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":gs(a,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":gs(a,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":gs(a,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":gs(a,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":gs(a,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":gs(a,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Kc(a,"is",y);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Pv.get(h)||h,Kc(a,h,y))}}function rb(a,c,h,y,x,P){switch(h){case"style":ms(a,y,P);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(r(61));if(h=y.__html,h!=null){if(x.children!=null)throw Error(r(60));a.innerHTML=h}}break;case"children":typeof y=="string"?ui(a,y):(typeof y=="number"||typeof y=="bigint")&&ui(a,""+y);break;case"onScroll":y!=null&&dt("scroll",a);break;case"onScrollEnd":y!=null&&dt("scrollend",a);break;case"onClick":y!=null&&(a.onclick=bg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ap.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(x=h.endsWith("Capture"),c=h.slice(2,x?h.length-7:void 0),P=a[cr]||null,P=P!=null?P[h]:null,typeof P=="function"&&a.removeEventListener(c,P,x),typeof y=="function")){typeof P!="function"&&P!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(c,y,x);break e}h in a?a[h]=y:y===!0?a.setAttribute(h,""):Kc(a,h,y)}}}function Wn(a,c,h){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dt("error",a),dt("load",a);var y=!1,x=!1,P;for(P in h)if(h.hasOwnProperty(P)){var j=h[P];if(j!=null)switch(P){case"src":y=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Ot(a,c,P,j,h,null)}}x&&Ot(a,c,"srcSet",h.srcSet,h,null),y&&Ot(a,c,"src",h.src,h,null);return;case"input":dt("invalid",a);var z=P=j=x=null,q=null,Q=null;for(y in h)if(h.hasOwnProperty(y)){var ue=h[y];if(ue!=null)switch(y){case"name":x=ue;break;case"type":j=ue;break;case"checked":q=ue;break;case"defaultChecked":Q=ue;break;case"value":P=ue;break;case"defaultValue":z=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,c));break;default:Ot(a,c,y,ue,h,null)}}Hd(a,P,z,q,Q,j,x,!1),Bl(a);return;case"select":dt("invalid",a),y=j=P=null;for(x in h)if(h.hasOwnProperty(x)&&(z=h[x],z!=null))switch(x){case"value":P=z;break;case"defaultValue":j=z;break;case"multiple":y=z;default:Ot(a,c,x,z,h,null)}c=P,h=j,a.multiple=!!y,c!=null?Ra(a,!!y,c,!1):h!=null&&Ra(a,!!y,h,!0);return;case"textarea":dt("invalid",a),P=x=y=null;for(j in h)if(h.hasOwnProperty(j)&&(z=h[j],z!=null))switch(j){case"value":y=z;break;case"defaultValue":x=z;break;case"children":P=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(r(91));break;default:Ot(a,c,j,z,h,null)}Fl(a,y,x,P),Bl(a);return;case"option":for(q in h)if(h.hasOwnProperty(q)&&(y=h[q],y!=null))switch(q){case"selected":a.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:Ot(a,c,q,y,h,null)}return;case"dialog":dt("cancel",a),dt("close",a);break;case"iframe":case"object":dt("load",a);break;case"video":case"audio":for(y=0;y<Ph.length;y++)dt(Ph[y],a);break;case"image":dt("error",a),dt("load",a);break;case"details":dt("toggle",a);break;case"embed":case"source":case"link":dt("error",a),dt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in h)if(h.hasOwnProperty(Q)&&(y=h[Q],y!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,c));default:Ot(a,c,Q,y,h,null)}return;default:if(qd(c)){for(ue in h)h.hasOwnProperty(ue)&&(y=h[ue],y!==void 0&&rb(a,c,ue,y,h,void 0));return}}for(z in h)h.hasOwnProperty(z)&&(y=h[z],y!=null&&Ot(a,c,z,y,h,null))}function oU(a,c,h,y){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,P=null,j=null,z=null,q=null,Q=null,ue=null;for(ce in h){var ve=h[ce];if(h.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":q=ve;default:y.hasOwnProperty(ce)||Ot(a,c,ce,null,y,ve)}}for(var se in y){var ce=y[se];if(ve=h[se],y.hasOwnProperty(se)&&(ce!=null||ve!=null))switch(se){case"type":P=ce;break;case"name":x=ce;break;case"checked":Q=ce;break;case"defaultChecked":ue=ce;break;case"value":j=ce;break;case"defaultValue":z=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(r(137,c));break;default:ce!==ve&&Ot(a,c,se,ce,y,ve)}}Ud(a,j,z,q,Q,ue,P,x);return;case"select":ce=j=z=se=null;for(P in h)if(q=h[P],h.hasOwnProperty(P)&&q!=null)switch(P){case"value":break;case"multiple":ce=q;default:y.hasOwnProperty(P)||Ot(a,c,P,null,y,q)}for(x in y)if(P=y[x],q=h[x],y.hasOwnProperty(x)&&(P!=null||q!=null))switch(x){case"value":se=P;break;case"defaultValue":z=P;break;case"multiple":j=P;default:P!==q&&Ot(a,c,x,P,y,q)}c=z,h=j,y=ce,se!=null?Ra(a,!!h,se,!1):!!y!=!!h&&(c!=null?Ra(a,!!h,c,!0):Ra(a,!!h,h?[]:"",!1));return;case"textarea":ce=se=null;for(z in h)if(x=h[z],h.hasOwnProperty(z)&&x!=null&&!y.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Ot(a,c,z,null,y,x)}for(j in y)if(x=y[j],P=h[j],y.hasOwnProperty(j)&&(x!=null||P!=null))switch(j){case"value":se=x;break;case"defaultValue":ce=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==P&&Ot(a,c,j,x,y,P)}Gd(a,se,ce);return;case"option":for(var De in h)if(se=h[De],h.hasOwnProperty(De)&&se!=null&&!y.hasOwnProperty(De))switch(De){case"selected":a.selected=!1;break;default:Ot(a,c,De,null,y,se)}for(q in y)if(se=y[q],ce=h[q],y.hasOwnProperty(q)&&se!==ce&&(se!=null||ce!=null))switch(q){case"selected":a.selected=se&&typeof se!="function"&&typeof se!="symbol";break;default:Ot(a,c,q,se,y,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ve in h)se=h[Ve],h.hasOwnProperty(Ve)&&se!=null&&!y.hasOwnProperty(Ve)&&Ot(a,c,Ve,null,y,se);for(Q in y)if(se=y[Q],ce=h[Q],y.hasOwnProperty(Q)&&se!==ce&&(se!=null||ce!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,c));break;default:Ot(a,c,Q,se,y,ce)}return;default:if(qd(c)){for(var gn in h)se=h[gn],h.hasOwnProperty(gn)&&se!==void 0&&!y.hasOwnProperty(gn)&&rb(a,c,gn,void 0,y,se);for(ue in y)se=y[ue],ce=h[ue],!y.hasOwnProperty(ue)||se===ce||se===void 0&&ce===void 0||rb(a,c,ue,se,y,ce);return}}for(var J in h)se=h[J],h.hasOwnProperty(J)&&se!=null&&!y.hasOwnProperty(J)&&Ot(a,c,J,null,y,se);for(ve in y)se=y[ve],ce=h[ve],!y.hasOwnProperty(ve)||se===ce||se==null&&ce==null||Ot(a,c,ve,se,y,ce)}var ib=null,sb=null;function xg(a){return a.nodeType===9?a:a.ownerDocument}function XI(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ZI(a,c){if(a===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&c==="foreignObject"?0:a}function ob(a,c){return a==="textarea"||a==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ab=null;function aU(){var a=window.event;return a&&a.type==="popstate"?a===ab?!1:(ab=a,!0):(ab=null,!1)}var QI=typeof setTimeout=="function"?setTimeout:void 0,lU=typeof clearTimeout=="function"?clearTimeout:void 0,JI=typeof Promise=="function"?Promise:void 0,cU=typeof queueMicrotask=="function"?queueMicrotask:typeof JI<"u"?function(a){return JI.resolve(null).then(a).catch(uU)}:QI;function uU(a){setTimeout(function(){throw a})}function lb(a,c){var h=c,y=0;do{var x=h.nextSibling;if(a.removeChild(h),x&&x.nodeType===8)if(h=x.data,h==="/$"){if(y===0){a.removeChild(x),Dh(c);return}y--}else h!=="$"&&h!=="$?"&&h!=="$!"||y++;h=x}while(h);Dh(c)}function cb(a){var c=a.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var h=c;switch(c=c.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":cb(h),Bd(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function dU(a,c,h,y){for(;a.nodeType===1;){var x=h;if(a.nodeName.toLowerCase()!==c.toLowerCase()){if(!y&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(y){if(!a[Nl])switch(c){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(P=a.getAttribute("rel"),P==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(P!==x.rel||a.getAttribute("href")!==(x.href==null?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(P=a.getAttribute("src"),(P!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&P&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(c==="input"&&a.type==="hidden"){var P=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===P)return a}else return a;if(a=Cs(a.nextSibling),a===null)break}return null}function hU(a,c,h){if(c==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=Cs(a.nextSibling),a===null))return null;return a}function Cs(a){for(;a!=null;a=a.nextSibling){var c=a.nodeType;if(c===1||c===3)break;if(c===8){if(c=a.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return a}function eM(a){a=a.previousSibling;for(var c=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return a;c--}else h==="/$"&&c++}a=a.previousSibling}return null}function tM(a,c,h){switch(c=xg(h),a){case"html":if(a=c.documentElement,!a)throw Error(r(452));return a;case"head":if(a=c.head,!a)throw Error(r(453));return a;case"body":if(a=c.body,!a)throw Error(r(454));return a;default:throw Error(r(451))}}var qi=new Map,nM=new Set;function wg(a){return typeof a.getRootNode=="function"?a.getRootNode():a.ownerDocument}var Qo=Se.d;Se.d={f:fU,r:pU,D:gU,C:mU,L:yU,m:SU,X:bU,S:vU,M:xU};function fU(){var a=Qo.f(),c=pg();return a||c}function pU(a){var c=Hr(a);c!==null&&c.tag===5&&c.type==="form"?MT(c):Qo.r(a)}var Cu=typeof document>"u"?null:document;function rM(a,c,h){var y=Cu;if(y&&typeof c=="string"&&c){var x=Kr(c);x='link[rel="'+a+'"][href="'+x+'"]',typeof h=="string"&&(x+='[crossorigin="'+h+'"]'),nM.has(x)||(nM.add(x),a={rel:a,crossOrigin:h,href:c},y.querySelector(x)===null&&(c=y.createElement("link"),Wn(c,"link",a),Pn(c),y.head.appendChild(c)))}}function gU(a){Qo.D(a),rM("dns-prefetch",a,null)}function mU(a,c){Qo.C(a,c),rM("preconnect",a,c)}function yU(a,c,h){Qo.L(a,c,h);var y=Cu;if(y&&a&&c){var x='link[rel="preload"][as="'+Kr(c)+'"]';c==="image"&&h&&h.imageSrcSet?(x+='[imagesrcset="'+Kr(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(x+='[imagesizes="'+Kr(h.imageSizes)+'"]')):x+='[href="'+Kr(a)+'"]';var P=x;switch(c){case"style":P=_u(a);break;case"script":P=Eu(a)}qi.has(P)||(a=k({rel:"preload",href:c==="image"&&h&&h.imageSrcSet?void 0:a,as:c},h),qi.set(P,a),y.querySelector(x)!==null||c==="style"&&y.querySelector(Ih(P))||c==="script"&&y.querySelector(Mh(P))||(c=y.createElement("link"),Wn(c,"link",a),Pn(c),y.head.appendChild(c)))}}function SU(a,c){Qo.m(a,c);var h=Cu;if(h&&a){var y=c&&typeof c.as=="string"?c.as:"script",x='link[rel="modulepreload"][as="'+Kr(y)+'"][href="'+Kr(a)+'"]',P=x;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":P=Eu(a)}if(!qi.has(P)&&(a=k({rel:"modulepreload",href:a},c),qi.set(P,a),h.querySelector(x)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Mh(P)))return}y=h.createElement("link"),Wn(y,"link",a),Pn(y),h.head.appendChild(y)}}}function vU(a,c,h){Qo.S(a,c,h);var y=Cu;if(y&&a){var x=Aa(y).hoistableStyles,P=_u(a);c=c||"default";var j=x.get(P);if(!j){var z={loading:0,preload:null};if(j=y.querySelector(Ih(P)))z.loading=5;else{a=k({rel:"stylesheet",href:a,"data-precedence":c},h),(h=qi.get(P))&&ub(a,h);var q=j=y.createElement("link");Pn(q),Wn(q,"link",a),q._p=new Promise(function(Q,ue){q.onload=Q,q.onerror=ue}),q.addEventListener("load",function(){z.loading|=1}),q.addEventListener("error",function(){z.loading|=2}),z.loading|=4,Cg(j,c,y)}j={type:"stylesheet",instance:j,count:1,state:z},x.set(P,j)}}}function bU(a,c){Qo.X(a,c);var h=Cu;if(h&&a){var y=Aa(h).hoistableScripts,x=Eu(a),P=y.get(x);P||(P=h.querySelector(Mh(x)),P||(a=k({src:a,async:!0},c),(c=qi.get(x))&&db(a,c),P=h.createElement("script"),Pn(P),Wn(P,"link",a),h.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},y.set(x,P))}}function xU(a,c){Qo.M(a,c);var h=Cu;if(h&&a){var y=Aa(h).hoistableScripts,x=Eu(a),P=y.get(x);P||(P=h.querySelector(Mh(x)),P||(a=k({src:a,async:!0,type:"module"},c),(c=qi.get(x))&&db(a,c),P=h.createElement("script"),Pn(P),Wn(P,"link",a),h.head.appendChild(P)),P={type:"script",instance:P,count:1,state:null},y.set(x,P))}}function iM(a,c,h,y){var x=(x=ot.current)?wg(x):null;if(!x)throw Error(r(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(c=_u(h.href),h=Aa(x).hoistableStyles,y=h.get(c),y||(y={type:"style",instance:null,count:0,state:null},h.set(c,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=_u(h.href);var P=Aa(x).hoistableStyles,j=P.get(a);if(j||(x=x.ownerDocument||x,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},P.set(a,j),(P=x.querySelector(Ih(a)))&&!P._p&&(j.instance=P,j.state.loading=5),qi.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},qi.set(a,h),P||wU(x,a,h,j.state))),c&&y===null)throw Error(r(528,""));return j}if(c&&y!==null)throw Error(r(529,""));return null;case"script":return c=h.async,h=h.src,typeof h=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Eu(h),h=Aa(x).hoistableScripts,y=h.get(c),y||(y={type:"script",instance:null,count:0,state:null},h.set(c,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,a))}}function _u(a){return'href="'+Kr(a)+'"'}function Ih(a){return'link[rel="stylesheet"]['+a+"]"}function sM(a){return k({},a,{"data-precedence":a.precedence,precedence:null})}function wU(a,c,h,y){a.querySelector('link[rel="preload"][as="style"]['+c+"]")?y.loading=1:(c=a.createElement("link"),y.preload=c,c.addEventListener("load",function(){return y.loading|=1}),c.addEventListener("error",function(){return y.loading|=2}),Wn(c,"link",h),Pn(c),a.head.appendChild(c))}function Eu(a){return'[src="'+Kr(a)+'"]'}function Mh(a){return"script[async]"+a}function oM(a,c,h){if(c.count++,c.instance===null)switch(c.type){case"style":var y=a.querySelector('style[data-href~="'+Kr(h.href)+'"]');if(y)return c.instance=y,Pn(y),y;var x=k({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return y=(a.ownerDocument||a).createElement("style"),Pn(y),Wn(y,"style",x),Cg(y,h.precedence,a),c.instance=y;case"stylesheet":x=_u(h.href);var P=a.querySelector(Ih(x));if(P)return c.state.loading|=4,c.instance=P,Pn(P),P;y=sM(h),(x=qi.get(x))&&ub(y,x),P=(a.ownerDocument||a).createElement("link"),Pn(P);var j=P;return j._p=new Promise(function(z,q){j.onload=z,j.onerror=q}),Wn(P,"link",y),c.state.loading|=4,Cg(P,h.precedence,a),c.instance=P;case"script":return P=Eu(h.src),(x=a.querySelector(Mh(P)))?(c.instance=x,Pn(x),x):(y=h,(x=qi.get(P))&&(y=k({},h),db(y,x)),a=a.ownerDocument||a,x=a.createElement("script"),Pn(x),Wn(x,"link",y),a.head.appendChild(x),c.instance=x);case"void":return null;default:throw Error(r(443,c.type))}else c.type==="stylesheet"&&!(c.state.loading&4)&&(y=c.instance,c.state.loading|=4,Cg(y,h.precedence,a));return c.instance}function Cg(a,c,h){for(var y=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=y.length?y[y.length-1]:null,P=x,j=0;j<y.length;j++){var z=y[j];if(z.dataset.precedence===c)P=z;else if(P!==x)break}P?P.parentNode.insertBefore(a,P.nextSibling):(c=h.nodeType===9?h.head:h,c.insertBefore(a,c.firstChild))}function ub(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.title==null&&(a.title=c.title)}function db(a,c){a.crossOrigin==null&&(a.crossOrigin=c.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=c.referrerPolicy),a.integrity==null&&(a.integrity=c.integrity)}var _g=null;function aM(a,c,h){if(_g===null){var y=new Map,x=_g=new Map;x.set(h,y)}else x=_g,y=x.get(h),y||(y=new Map,x.set(h,y));if(y.has(a))return y;for(y.set(a,null),h=h.getElementsByTagName(a),x=0;x<h.length;x++){var P=h[x];if(!(P[Nl]||P[$n]||a==="link"&&P.getAttribute("rel")==="stylesheet")&&P.namespaceURI!=="http://www.w3.org/2000/svg"){var j=P.getAttribute(c)||"";j=a+j;var z=y.get(j);z?z.push(P):y.set(j,[P])}}return y}function lM(a,c,h){a=a.ownerDocument||a,a.head.insertBefore(h,c==="title"?a.querySelector("head > title"):null)}function CU(a,c,h){if(h===1||c.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return a=c.disabled,typeof c.precedence=="string"&&a==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function cM(a){return!(a.type==="stylesheet"&&!(a.state.loading&3))}var Ah=null;function _U(){}function EU(a,c,h){if(Ah===null)throw Error(r(475));var y=Ah;if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&!(c.state.loading&4)){if(c.instance===null){var x=_u(h.href),P=a.querySelector(Ih(x));if(P){a=P._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(y.count++,y=Eg.bind(y),a.then(y,y)),c.state.loading|=4,c.instance=P,Pn(P);return}P=a.ownerDocument||a,h=sM(h),(x=qi.get(x))&&ub(h,x),P=P.createElement("link"),Pn(P);var j=P;j._p=new Promise(function(z,q){j.onload=z,j.onerror=q}),Wn(P,"link",h),c.instance=P}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(c,a),(a=c.state.preload)&&!(c.state.loading&3)&&(y.count++,c=Eg.bind(y),a.addEventListener("load",c),a.addEventListener("error",c))}}function PU(){if(Ah===null)throw Error(r(475));var a=Ah;return a.stylesheets&&a.count===0&&hb(a,a.stylesheets),0<a.count?function(c){var h=setTimeout(function(){if(a.stylesheets&&hb(a,a.stylesheets),a.unsuspend){var y=a.unsuspend;a.unsuspend=null,y()}},6e4);return a.unsuspend=c,function(){a.unsuspend=null,clearTimeout(h)}}:null}function Eg(){if(this.count--,this.count===0){if(this.stylesheets)hb(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Pg=null;function hb(a,c){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Pg=new Map,c.forEach(TU,a),Pg=null,Eg.call(a))}function TU(a,c){if(!(c.state.loading&4)){var h=Pg.get(a);if(h)var y=h.get(null);else{h=new Map,Pg.set(a,h);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),P=0;P<x.length;P++){var j=x[P];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(h.set(j.dataset.precedence,j),y=j)}y&&h.set(null,y)}x=c.instance,j=x.getAttribute("data-precedence"),P=h.get(j)||y,P===y&&h.set(null,x),h.set(j,x),this.count++,y=Eg.bind(this),x.addEventListener("load",y),x.addEventListener("error",y),P?P.parentNode.insertBefore(x,P.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),c.state.loading|=4}}var kh={$$typeof:S,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function IU(a,c,h,y,x,P,j,z){this.tag=1,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Nd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nd(0),this.hiddenUpdates=Nd(null),this.identifierPrefix=y,this.onUncaughtError=x,this.onCaughtError=P,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function uM(a,c,h,y,x,P,j,z,q,Q,ue,ve){return a=new IU(a,c,h,j,z,q,Q,ve),c=1,P===!0&&(c|=24),P=Ki(3,null,null,c),a.current=P,P.stateNode=a,c=Kv(),c.refCount++,a.pooledCache=c,c.refCount++,P.memoizedState={element:y,isDehydrated:h,cache:c},_0(P),a}function dM(a){return a?(a=ru,a):ru}function hM(a,c,h,y,x,P){x=dM(x),y.context===null?y.context=x:y.pendingContext=x,y=Ua(c),y.payload={element:h},P=P===void 0?null:P,P!==null&&(y.callback=P),h=Ha(a,y,c),h!==null&&(Mr(h,a,c),ph(h,a,c))}function fM(a,c){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<c?h:c}}function fb(a,c){fM(a,c),(a=a.alternate)&&fM(a,c)}function pM(a){if(a.tag===13){var c=Da(a,67108864);c!==null&&Mr(c,a,67108864),fb(a,67108864)}}var Tg=!0;function MU(a,c,h,y){var x=G.T;G.T=null;var P=Se.p;try{Se.p=2,pb(a,c,h,y)}finally{Se.p=P,G.T=x}}function AU(a,c,h,y){var x=G.T;G.T=null;var P=Se.p;try{Se.p=8,pb(a,c,h,y)}finally{Se.p=P,G.T=x}}function pb(a,c,h,y){if(Tg){var x=gb(y);if(x===null)nb(a,c,y,Ig,h),mM(a,y);else if(RU(x,a,c,h,y))y.stopPropagation();else if(mM(a,y),c&4&&-1<kU.indexOf(a)){for(;x!==null;){var P=Hr(x);if(P!==null)switch(P.tag){case 3:if(P=P.stateNode,P.current.memoizedState.isDehydrated){var j=hs(P.pendingLanes);if(j!==0){var z=P;for(z.pendingLanes|=2,z.entangledLanes|=2;j;){var q=1<<31-rn(j);z.entanglements[1]|=q,j&=~q}Vs(P),!(an&6)&&(dg=Br()+500,Eh(0))}}break;case 13:z=Da(P,2),z!==null&&Mr(z,P,2),pg(),fb(P,2)}if(P=gb(y),P===null&&nb(a,c,y,Ig,h),P===x)break;x=P}x!==null&&y.stopPropagation()}else nb(a,c,y,null,h)}}function gb(a){return a=ys(a),mb(a)}var Ig=null;function mb(a){if(Ig=null,a=jo(a),a!==null){var c=W(a);if(c===null)a=null;else{var h=c.tag;if(h===13){if(a=ee(c),a!==null)return a;a=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;a=null}else c!==a&&(a=null)}}return Ig=a,null}function gM(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Dd()){case Bc:return 2;case Ao:return 8;case cs:case Fc:return 32;case ae:return 268435456;default:return 32}default:return 32}}var yb=!1,Xa=null,Za=null,Qa=null,Rh=new Map,Oh=new Map,Ja=[],kU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mM(a,c){switch(a){case"focusin":case"focusout":Xa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":Rh.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oh.delete(c.pointerId)}}function jh(a,c,h,y,x,P){return a===null||a.nativeEvent!==P?(a={blockedOn:c,domEventName:h,eventSystemFlags:y,nativeEvent:P,targetContainers:[x]},c!==null&&(c=Hr(c),c!==null&&pM(c)),a):(a.eventSystemFlags|=y,c=a.targetContainers,x!==null&&c.indexOf(x)===-1&&c.push(x),a)}function RU(a,c,h,y,x){switch(c){case"focusin":return Xa=jh(Xa,a,c,h,y,x),!0;case"dragenter":return Za=jh(Za,a,c,h,y,x),!0;case"mouseover":return Qa=jh(Qa,a,c,h,y,x),!0;case"pointerover":var P=x.pointerId;return Rh.set(P,jh(Rh.get(P)||null,a,c,h,y,x)),!0;case"gotpointercapture":return P=x.pointerId,Oh.set(P,jh(Oh.get(P)||null,a,c,h,y,x)),!0}return!1}function yM(a){var c=jo(a.target);if(c!==null){var h=W(c);if(h!==null){if(c=h.tag,c===13){if(c=ee(h),c!==null){a.blockedOn=c,Oo(a.priority,function(){if(h.tag===13){var y=mi(),x=Da(h,y);x!==null&&Mr(x,h,y),fb(h,y)}});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Mg(a){if(a.blockedOn!==null)return!1;for(var c=a.targetContainers;0<c.length;){var h=gb(a.nativeEvent);if(h===null){h=a.nativeEvent;var y=new h.constructor(h.type,h);Yd=y,h.target.dispatchEvent(y),Yd=null}else return c=Hr(h),c!==null&&pM(c),a.blockedOn=h,!1;c.shift()}return!0}function SM(a,c,h){Mg(a)&&h.delete(c)}function OU(){yb=!1,Xa!==null&&Mg(Xa)&&(Xa=null),Za!==null&&Mg(Za)&&(Za=null),Qa!==null&&Mg(Qa)&&(Qa=null),Rh.forEach(SM),Oh.forEach(SM)}function Ag(a,c){a.blockedOn===c&&(a.blockedOn=null,yb||(yb=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,OU)))}var kg=null;function vM(a){kg!==a&&(kg=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){kg===a&&(kg=null);for(var c=0;c<a.length;c+=3){var h=a[c],y=a[c+1],x=a[c+2];if(typeof y!="function"){if(mb(y||h)===null)continue;break}var P=Hr(h);P!==null&&(a.splice(c,3),c-=3,o0(P,{pending:!0,data:x,method:h.method,action:y},y,x))}}))}function Dh(a){function c(q){return Ag(q,a)}Xa!==null&&Ag(Xa,a),Za!==null&&Ag(Za,a),Qa!==null&&Ag(Qa,a),Rh.forEach(c),Oh.forEach(c);for(var h=0;h<Ja.length;h++){var y=Ja[h];y.blockedOn===a&&(y.blockedOn=null)}for(;0<Ja.length&&(h=Ja[0],h.blockedOn===null);)yM(h),h.blockedOn===null&&Ja.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(y=0;y<h.length;y+=3){var x=h[y],P=h[y+1],j=x[cr]||null;if(typeof P=="function")j||vM(h);else if(j){var z=null;if(P&&P.hasAttribute("formAction")){if(x=P,j=P[cr]||null)z=j.formAction;else if(mb(x)!==null)continue}else z=j.action;typeof z=="function"?h[y+1]=z:(h.splice(y,3),y-=3),vM(h)}}}function Sb(a){this._internalRoot=a}Rg.prototype.render=Sb.prototype.render=function(a){var c=this._internalRoot;if(c===null)throw Error(r(409));var h=c.current,y=mi();hM(h,y,a,c,null,null)},Rg.prototype.unmount=Sb.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var c=a.containerInfo;a.tag===0&&bu(),hM(a.current,2,null,a,null,null),pg(),c[Ma]=null}};function Rg(a){this._internalRoot=a}Rg.prototype.unstable_scheduleHydration=function(a){if(a){var c=Hc();a={blockedOn:null,target:a,priority:c};for(var h=0;h<Ja.length&&c!==0&&c<Ja[h].priority;h++);Ja.splice(h,0,a),h===0&&yM(a)}};var bM=e.version;if(bM!=="19.0.0")throw Error(r(527,bM,"19.0.0"));Se.findDOMNode=function(a){var c=a._reactInternals;if(c===void 0)throw typeof a.render=="function"?Error(r(188)):(a=Object.keys(a).join(","),Error(r(268,a)));return a=te(c),a=a!==null?ge(a):null,a=a===null?null:a.stateNode,a};var jU={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:G,findFiberByHostInstance:jo,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Og=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Og.isDisabled&&Og.supportsFiber)try{Ct=Og.inject(jU),nn=Og}catch{}}return Nh.createRoot=function(a,c){if(!i(a))throw Error(r(299));var h=!1,y="",x=NT,P=zT,j=$T,z=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(P=c.onCaughtError),c.onRecoverableError!==void 0&&(j=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(z=c.unstable_transitionCallbacks)),c=uM(a,1,!1,null,null,h,y,x,P,j,z,null),a[Ma]=c.current,tb(a.nodeType===8?a.parentNode:a),new Sb(c)},Nh.hydrateRoot=function(a,c,h){if(!i(a))throw Error(r(299));var y=!1,x="",P=NT,j=zT,z=$T,q=null,Q=null;return h!=null&&(h.unstable_strictMode===!0&&(y=!0),h.identifierPrefix!==void 0&&(x=h.identifierPrefix),h.onUncaughtError!==void 0&&(P=h.onUncaughtError),h.onCaughtError!==void 0&&(j=h.onCaughtError),h.onRecoverableError!==void 0&&(z=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(q=h.unstable_transitionCallbacks),h.formState!==void 0&&(Q=h.formState)),c=uM(a,1,!0,c,h??null,y,x,P,j,z,q,Q),c.context=dM(null),h=c.current,y=mi(),x=Ua(y),x.callback=null,Ha(h,x,y),c.current.lanes=y,Ll(c,y),Vs(c),a[Ma]=c.current,tb(a),new Rg(c)},Nh.version="19.0.0",Nh}var AM;function qU(){if(AM)return xb.exports;AM=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xb.exports=GU(),xb.exports}var AD=qU();const Eb="__TLDRAW_LIBRARY_VERSIONS__";function YU(){if(globalThis[Eb])return globalThis[Eb];const t={versions:[],didWarn:!1,scheduledNotice:null};return Object.defineProperty(globalThis,Eb,{value:t,writable:!1,configurable:!1,enumerable:!1}),t}function El(t,e,n){if(!t)throw new Error("Missing name/version/module system in built version of tldraw library");const r=YU();if(r.versions.push({name:t,version:e,modules:n}),!r.scheduledNotice)try{r.scheduledNotice=setTimeout(()=>{r.scheduledNotice=null,kM(r)},100)}catch{kM(r)}}function kM(t){if(!t.versions.length||t.didWarn)return;const e=t.versions.sort((l,u)=>RM(l.version,u.version)),n=e[e.length-1].version,r=new Set,i=new Map;for(const l of e){if(i.has(l.name)){r.delete(l.name),Pb(i,l.name,new Set).add(l.version);continue}l.version===n?r.add(l.name):(r.delete(l.name),Pb(i,l.name,new Set).add(l.version))}if(i.size>0){const l=[`${Jo("[tldraw]",["bold","bgRed","textWhite"])} ${Jo("You have multiple versions of tldraw libraries installed. This can lead to bugs and unexpected behavior.",["textRed","bold"])}`,"",`The latest version you have installed is ${Jo(`v${n}`,["bold","textBlue"])}. The following libraries are on the latest version:`,...Array.from(r,u=>`    ${Jo(u,["bold"])}`),"","The following libraries are not on the latest version, or have multiple versions installed:",...Array.from(i,([u,d])=>{const f=Array.from(d).sort(RM).map(g=>Jo(`v${g}`,g===n?["textGreen"]:["textRed"]));return`    ${Jo(u,["bold"])} (${f.join(", ")})`})];console.log(l.join(`
`)),t.didWarn=!0;return}const s=new Map;for(const l of e)Pb(s,l.name,{version:l.version,modules:[]}).modules.push(l.modules);const o=new Map;for(const[l,u]of s)u.modules.length>1&&o.set(l,u);if(o.size>0){const l=[`${Jo("[tldraw]",["bold","bgRed","textWhite"])} ${Jo("You have multiple instances of some tldraw libraries active. This can lead to bugs and unexpected behavior. ",["textRed","bold"])}`,"","This usually means that your bundler is misconfigured, and is importing the same library multiple times - usually once as an ES Module, and once as a CommonJS module.","","The following libraries have been imported multiple times:",...Array.from(o,([u,d])=>{const f=d.modules.map((g,m)=>g==="esm"?`      ${m+1}. ES Modules`:`      ${m+1}. CommonJS`).join(`
`);return`    ${Jo(u,["bold"])} v${d.version}: 
${f}`}),"","You should configure your bundler to only import one version of each library."];console.log(l.join(`
`)),t.didWarn=!0;return}}function RM(t,e){const n=t.match(/^(\d+)\.(\d+)\.(\d+)(?:-(\w+))?$/),r=e.match(/^(\d+)\.(\d+)\.(\d+)(?:-(\w+))?$/);return!n||!r?t.localeCompare(e):n[1]!==r[1]?Number(n[1])-Number(r[1]):n[2]!==r[2]?Number(n[2])-Number(r[2]):n[3]!==r[3]?Number(n[3])-Number(r[3]):n[4]&&r[4]?n[4].localeCompare(r[4]):n[4]?1:r[4]?-1:0}const VU={bold:"1",textBlue:"94",textRed:"31",textGreen:"32",bgRed:"41",textWhite:"97"};function Jo(t,e=[]){return`\x1B[${e.map(n=>VU[n]).join(";")}m${t}\x1B[m`}function Pb(t,e,n){return t.has(e)?t.get(e):(t.set(e,n),n)}var Tb,OM;function WU(){if(OM)return Tb;OM=1;var t="Expected a function",e=NaN,n="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt,u=typeof ti=="object"&&ti&&ti.Object===Object&&ti,d=typeof self=="object"&&self&&self.Object===Object&&self,f=u||d||Function("return this")(),g=Object.prototype,m=g.toString,S=Math.max,b=Math.min,v=function(){return f.Date.now()};function w(R,D,L){var G,k,$,F,N,B,Y=0,K=!1,V=!1,W=!0;if(typeof R!="function")throw new TypeError(t);D=A(D)||0,_(L)&&(K=!!L.leading,V="maxWait"in L,$=V?S(A(L.maxWait)||0,D):$,W="trailing"in L?!!L.trailing:W);function ee(we){var Ie=G,ke=k;return G=k=void 0,Y=we,F=R.apply(ke,Ie),F}function H(we){return Y=we,N=setTimeout(de,D),K?ee(we):F}function te(we){var Ie=we-B,ke=we-Y,Ue=D-Ie;return V?b(Ue,$-ke):Ue}function ge(we){var Ie=we-B,ke=we-Y;return B===void 0||Ie>=D||Ie<0||V&&ke>=$}function de(){var we=v();if(ge(we))return Se(we);N=setTimeout(de,te(we))}function Se(we){return N=void 0,W&&G?ee(we):(G=k=void 0,F)}function me(){N!==void 0&&clearTimeout(N),Y=0,G=B=k=N=void 0}function Me(){return N===void 0?F:Se(v())}function Ne(){var we=v(),Ie=ge(we);if(G=arguments,k=this,B=we,Ie){if(N===void 0)return H(B);if(V)return N=setTimeout(de,D),ee(B)}return N===void 0&&(N=setTimeout(de,D)),F}return Ne.cancel=me,Ne.flush=Me,Ne}function C(R,D,L){var G=!0,k=!0;if(typeof R!="function")throw new TypeError(t);return _(L)&&(G="leading"in L?!!L.leading:G,k="trailing"in L?!!L.trailing:k),w(R,D,{leading:G,maxWait:D,trailing:k})}function _(R){var D=typeof R;return!!R&&(D=="object"||D=="function")}function M(R){return!!R&&typeof R=="object"}function I(R){return typeof R=="symbol"||M(R)&&m.call(R)==n}function A(R){if(typeof R=="number")return R;if(I(R))return e;if(_(R)){var D=typeof R.valueOf=="function"?R.valueOf():R;R=_(D)?D+"":D}if(typeof R!="string")return R===0?R:+R;R=R.replace(r,"");var L=s.test(R);return L||o.test(R)?l(R.slice(2),L?2:8):i.test(R)?e:+R}return Tb=C,Tb}var XU=WU();const kD=_l(XU);var Ib,jM;function ZU(){if(jM)return Ib;jM=1;var t=200,e="__lodash_hash_undefined__",n=1/0,r="[object Function]",i="[object GeneratorFunction]",s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,l=typeof ti=="object"&&ti&&ti.Object===Object&&ti,u=typeof self=="object"&&self&&self.Object===Object&&self,d=l||u||Function("return this")();function f(ae,Ce){var He=ae?ae.length:0;return!!He&&m(ae,Ce,0)>-1}function g(ae,Ce,He,Ct){for(var nn=ae.length,Fr=He+-1;++Fr<nn;)if(Ce(ae[Fr],Fr,ae))return Fr;return-1}function m(ae,Ce,He){if(Ce!==Ce)return g(ae,S,He);for(var Ct=He-1,nn=ae.length;++Ct<nn;)if(ae[Ct]===Ce)return Ct;return-1}function S(ae){return ae!==ae}function b(ae,Ce){return ae.has(Ce)}function v(ae,Ce){return ae==null?void 0:ae[Ce]}function w(ae){var Ce=!1;if(ae!=null&&typeof ae.toString!="function")try{Ce=!!(ae+"")}catch{}return Ce}function C(ae){var Ce=-1,He=Array(ae.size);return ae.forEach(function(Ct){He[++Ce]=Ct}),He}var _=Array.prototype,M=Function.prototype,I=Object.prototype,A=d["__core-js_shared__"],R=function(){var ae=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||"");return ae?"Symbol(src)_1."+ae:""}(),D=M.toString,L=I.hasOwnProperty,G=I.toString,k=RegExp("^"+D.call(L).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$=_.splice,F=ls(d,"Map"),N=ls(d,"Set"),B=ls(Object,"create");function Y(ae){var Ce=-1,He=ae?ae.length:0;for(this.clear();++Ce<He;){var Ct=ae[Ce];this.set(Ct[0],Ct[1])}}function K(){this.__data__=B?B(null):{}}function V(ae){return this.has(ae)&&delete this.__data__[ae]}function W(ae){var Ce=this.__data__;if(B){var He=Ce[ae];return He===e?void 0:He}return L.call(Ce,ae)?Ce[ae]:void 0}function ee(ae){var Ce=this.__data__;return B?Ce[ae]!==void 0:L.call(Ce,ae)}function H(ae,Ce){var He=this.__data__;return He[ae]=B&&Ce===void 0?e:Ce,this}Y.prototype.clear=K,Y.prototype.delete=V,Y.prototype.get=W,Y.prototype.has=ee,Y.prototype.set=H;function te(ae){var Ce=-1,He=ae?ae.length:0;for(this.clear();++Ce<He;){var Ct=ae[Ce];this.set(Ct[0],Ct[1])}}function ge(){this.__data__=[]}function de(ae){var Ce=this.__data__,He=ft(Ce,ae);if(He<0)return!1;var Ct=Ce.length-1;return He==Ct?Ce.pop():$.call(Ce,He,1),!0}function Se(ae){var Ce=this.__data__,He=ft(Ce,ae);return He<0?void 0:Ce[He][1]}function me(ae){return ft(this.__data__,ae)>-1}function Me(ae,Ce){var He=this.__data__,Ct=ft(He,ae);return Ct<0?He.push([ae,Ce]):He[Ct][1]=Ce,this}te.prototype.clear=ge,te.prototype.delete=de,te.prototype.get=Se,te.prototype.has=me,te.prototype.set=Me;function Ne(ae){var Ce=-1,He=ae?ae.length:0;for(this.clear();++Ce<He;){var Ct=ae[Ce];this.set(Ct[0],Ct[1])}}function we(){this.__data__={hash:new Y,map:new(F||te),string:new Y}}function Ie(ae){return Tr(this,ae).delete(ae)}function ke(ae){return Tr(this,ae).get(ae)}function Ue(ae){return Tr(this,ae).has(ae)}function Nt(ae,Ce){return Tr(this,ae).set(ae,Ce),this}Ne.prototype.clear=we,Ne.prototype.delete=Ie,Ne.prototype.get=ke,Ne.prototype.has=Ue,Ne.prototype.set=Nt;function ot(ae){var Ce=-1,He=ae?ae.length:0;for(this.__data__=new Ne;++Ce<He;)this.add(ae[Ce])}function Mt(ae){return this.__data__.set(ae,e),this}function wt(ae){return this.__data__.has(ae)}ot.prototype.add=ot.prototype.push=Mt,ot.prototype.has=wt;function ft(ae,Ce){for(var He=ae.length;He--;)if(Bc(ae[He][0],Ce))return He;return-1}function jn(ae){if(!cs(ae)||jd(ae))return!1;var Ce=Ao(ae)||w(ae)?k:o;return Ce.test(Br(ae))}function dn(ae,Ce,He){var Ct=-1,nn=f,Fr=ae.length,Ur=!0,rn=[],us=rn;if(Fr>=t){var ji=lr(ae);if(ji)return C(ji);Ur=!1,nn=b,us=new ot}else us=rn;e:for(;++Ct<Fr;){var ds=ae[Ct],Di=ds;if(ds=ds!==0?ds:0,Ur&&Di===Di){for(var ko=us.length;ko--;)if(us[ko]===Di)continue e;rn.push(ds)}else nn(us,Di,He)||(us!==rn&&us.push(Di),rn.push(ds))}return rn}var lr=N&&1/C(new N([,-0]))[1]==n?function(ae){return new N(ae)}:Fc;function Tr(ae,Ce){var He=ae.__data__;return qe(Ce)?He[typeof Ce=="string"?"string":"hash"]:He.map}function ls(ae,Ce){var He=v(ae,Ce);return jn(He)?He:void 0}function qe(ae){var Ce=typeof ae;return Ce=="string"||Ce=="number"||Ce=="symbol"||Ce=="boolean"?ae!=="__proto__":ae===null}function jd(ae){return!!R&&R in ae}function Br(ae){if(ae!=null){try{return D.call(ae)}catch{}try{return ae+""}catch{}}return""}function Dd(ae){return ae&&ae.length?dn(ae):[]}function Bc(ae,Ce){return ae===Ce||ae!==ae&&Ce!==Ce}function Ao(ae){var Ce=cs(ae)?G.call(ae):"";return Ce==r||Ce==i}function cs(ae){var Ce=typeof ae;return!!ae&&(Ce=="object"||Ce=="function")}function Fc(){}return Ib=Dd,Ib}var QU=ZU();const JU=_l(QU);function RD(t){const e=(...n)=>{try{return t(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,e),r}};return e}const Tf=()=>{},fl={ok(t){return{ok:!0,value:t}},err(t){return{ok:!1,error:t}}};function An(t,e){const n=e&&t&&typeof t=="object"&&e in t?t[e]:t;throw new Error(`Unknown switch case ${n}`)}const xt=RD((t,e)=>{if(!t)throw new Error(e||"Assertion Error")}),Qr=RD((t,e)=>{if(t==null)throw new Error(e??"value must be defined");return t});function __(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});return Object.assign(n,{resolve:t,reject:e})}function Z1(t){return new Promise(e=>setTimeout(e,t))}const tf={Good:"#40C057",Mid:"#FFC078",Poor:"#E03131"},eH=tf.Good;class OD{constructor(){O(this,"startTime",0);O(this,"name","");O(this,"frames",0);O(this,"started",!1);O(this,"frame",null);O(this,"recordFrame",()=>{this.frames++,this.started&&(this.frame=requestAnimationFrame(this.recordFrame))})}start(e){this.name=e,this.frames=0,this.started=!0,this.frame!==null&&cancelAnimationFrame(this.frame),this.frame=requestAnimationFrame(this.recordFrame),this.startTime=performance.now()}stop(){this.started=!1,this.frame!==null&&cancelAnimationFrame(this.frame);const e=(performance.now()-this.startTime)/1e3,n=e===0?0:Math.floor(this.frames/e),r=n>55?tf.Good:n>30?tf.Mid:tf.Poor,i=r===tf.Mid?"black":"white",s=this.name[0].toUpperCase()+this.name.slice(1);console.debug(`%cPerf%c ${s} %c${n}%c fps`,`color: white; background: ${eH};padding: 2px;border-radius: 3px;`,"font-weight: normal",`font-weight: bold; padding: 2px; background: ${r};color: ${i};`,"font-weight: normal")}isStarted(){return this.started}}function E_(t,e){const n=[];e:for(const r of t){for(const i of n)if(e?e(r,i):r===i)continue e;n.push(r)}return n}function We(t){return t.filter(e=>e!=null)}function Qn(t){return t[t.length-1]}function tH(t,e){let n,r=1/0;for(const i of t){const s=e(i);s<r&&(n=i,r=s)}return n}function nH(t,e){let n,r=-1/0;for(const i of t){const s=e(i);s>r&&(n=i,r=s)}return n}function jD(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Object.is(t[n],e[n]))return!1;return!0}function Mb(t,e,n){const r=new Set(e.map(s=>s[t])),i=[];for(const s of n)r.has(s[t])||i.push(s);for(const s of e)i.push(s);return i}function ni(...t){if(t.length===2){const[e,n]=t;n.addInitializer(function(){xt(Reflect.isExtensible(this),"Cannot bind to a non-extensible class.");const i=e.bind(this),s=Reflect.defineProperty(this,n.name,{value:i,writable:!0,configurable:!0});xt(s,"Cannot bind a non-configurable class method.")})}else{const[e,n,r]=t;if(!r||typeof r.value!="function")throw new TypeError(`Only methods can be decorated with @bind. <${n}> is not a method!`);return{configurable:!0,get(){const i=r.value.bind(this);return Object.defineProperty(this,n,{value:i,configurable:!0,writable:!0}),i}}}}class po{constructor(){O(this,"items",new WeakMap)}get(e,n){return this.items.has(e)||this.items.set(e,n(e)),this.items.get(e)}}function P_(t,e){let n;const r=(...i)=>(n||(n={},n.promise=new Promise((s,o)=>{n.resolve=s,n.reject=o})),clearTimeout(n.timeout),n.latestArgs=i,n.timeout=setTimeout(()=>{const s=n;n=void 0;try{s.resolve(t(...s.latestArgs))}catch(o){s.reject(o)}},e),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const DM=new WeakMap;function T_(t,e){if(typeof t!="object"||t===null)return;let n=DM.get(t);n||(n={tags:{},extras:{}},DM.set(t,n)),e.tags&&(n.tags={...n.tags,...e.tags}),e.extras&&(n.extras={...n.extras,...e.extras})}async function go(t,e){return window.fetch(t,{referrerPolicy:"strict-origin-when-cross-origin",...e})}const If=(t,e)=>{const n=new window.Image(t,e);return n.referrerPolicy="strict-origin-when-cross-origin",n};class Ts{static async dataUrlToArrayBuffer(e){return go(e).then(function(n){return n.arrayBuffer()})}static async blobToDataUrl(e){return await new Promise((n,r)=>{if(e){const i=new FileReader;i.onload=()=>n(i.result),i.onerror=s=>r(s),i.onabort=s=>r(s),i.readAsDataURL(e)}})}static async blobToText(e){return await new Promise((n,r)=>{if(e){const i=new FileReader;i.onload=()=>n(i.result),i.onerror=s=>r(s),i.onabort=s=>r(s),i.readAsText(e)}})}static rewriteMimeType(e,n){return e.type===n?e:e instanceof File?new File([e],e.name,{type:n}):new Blob([e],{type:n})}}function I_(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e+""}function DD(t){const e=new DataView(t);let n=0;for(let r=0;r<e.byteLength;r++)n=(n<<5)-n+e.getUint8(r),n|=0;return n+""}/*!
 * MIT License: https://github.com/ai/nanoid/blob/main/LICENSE
 * Modified code originally from <https://github.com/ai/nanoid>
 * Copyright 2017 Andrey Sitnik <andrey@sitnik.ru>
 *
 * `nanoid` is currently only distributed as an ES module. Some tools (jest, playwright) don't
 * properly support ESM-only code yet, and tldraw itself is distributed as both an ES module and a
 * CommonJS module. By including nanoid here, we can make sure it works well in every environment
 * where tldraw is used. We can also remove some unused features like custom alphabets.
 */const LM=globalThis.crypto,rH="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",iH=128;let hc,Hu;function sH(t){!hc||hc.length<t?(hc=new Uint8Array(t*iH),LM.getRandomValues(hc),Hu=0):Hu+t>hc.length&&(LM.getRandomValues(hc),Hu=0),Hu+=t}function oH(t=21){sH(t-=0);let e="";for(let n=Hu-t;n<Hu;n++)e+=rH[hc[n]&63];return e}let aH=oH;function At(t){return aH(t)}/*!
 * MIT License: https://github.com/vHeemstra/is-apng/blob/main/license
 * Copyright (c) Philip van Heemstra
 */function lH(t){const e=new Uint8Array(t);if(!e||!(typeof Buffer<"u"&&Buffer.isBuffer(e)||e instanceof Uint8Array)||e.length<16||!(e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10))return!1;function r(s,o,l,u,d=1024){if(!o)return-1;o=new RegExp(o,"g");const f=o.source.length,g=new TextDecoder,m=s.length;if(typeof u>"u"&&(u=m),l>=m||u<=0||l>=u)return-1;s=s.subarray(l,u);let S=-1,b=0,v=0,w="";e:for(;b<s.length;){const C=b+d,_=s.subarray(b,C),M=g.decode(_,{stream:!0}),I=w+M;let A,R=-1;for(;(A=o.exec(I))!==null;){R=A.index-w.length,S=v+R;break e}b=C,v+=M.length;const D=R>-1?R+f:M.length-f;w=M.slice(D)}return S>=0&&(S+=l>=0?l:m+l),S}const i=r(e,"IDAT",12);return i>=12?r(e,"acTL",8,i)>=8:!1}const cH=t=>new Uint8Array(t)[3]===44;/*!
 * MIT License
 * Modified code originally from <https://github.com/qzb/is-animated>
 * Copyright (c) 2016 Jzef Sokoowski <j.k.sokolowski@gmail.com>
 */function NM(t,e){let n=0;for(;t[e+n];)n+=t[e+n]+1;return n+1}function uH(t){return new TextDecoder("ascii").decode(t.slice(0,3))==="GIF"}function dH(t){const e=new Uint8Array(t);let n,r,i=0,s=0;if(!uH(t))return!1;for(n=e[10]&128,r=e[10]&7,i+=6,i+=7,i+=n?3*Math.pow(2,r+1):0;s<2&&i<e.length;)switch(e[i]){case 44:s+=1,n=e[i+9]&128,r=e[i+9]&7,i+=10,i+=n?3*Math.pow(2,r+1):0,i+=NM(e,i+1)+1;break;case 33:i+=2,i+=NM(e,i);break;case 59:i=e.length;break;default:i=e.length;break}return s>1}/*!
 * MIT License: https://github.com/alexgorbatchev/crc/blob/master/LICENSE
 * Copyright: 2014 Alex Gorbatchev
 * Code: crc32, https://github.com/alexgorbatchev/crc/blob/master/src/calculators/crc32.ts
 */let Q1=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(Q1=new Int32Array(Q1));const hH=(t,e)=>{let n=-1;for(let r=0;r<t.length;r++)n=Q1[(n^t[r])&255]^n>>>8;return n^-1},zM=4,$M=4;class no{static isPng(e,n){return e.getUint8(n+0)===137&&e.getUint8(n+1)===80&&e.getUint8(n+2)===78&&e.getUint8(n+3)===71&&e.getUint8(n+4)===13&&e.getUint8(n+5)===10&&e.getUint8(n+6)===26&&e.getUint8(n+7)===10}static getChunkType(e,n){return[String.fromCharCode(e.getUint8(n)),String.fromCharCode(e.getUint8(n+1)),String.fromCharCode(e.getUint8(n+2)),String.fromCharCode(e.getUint8(n+3))].join("")}static readChunks(e,n=0){const r={};if(!no.isPng(e,n))throw new Error("Not a PNG");for(n+=8;n<=e.buffer.byteLength;){const i=n,s=e.getInt32(n);n+=4;const o=no.getChunkType(e,n);if(o==="IDAT"&&r[o]){n+=s+zM+$M;continue}if(o==="IEND")break;r[o]={start:i,dataOffset:n+4,size:s},n+=s+zM+$M}return r}static parsePhys(e,n){return{ppux:e.getUint32(n),ppuy:e.getUint32(n+4),unit:e.getUint8(n+4)}}static findChunk(e,n){return no.readChunks(e)[n]}static setPhysChunk(e,n=1,r){let i=46,s=0;const o=no.findChunk(e,"pHYs");o&&(i=o.start,s=o.size);const l=no.findChunk(e,"IDAT");l&&(i=l.start,s=0);const u=new ArrayBuffer(21),d=new DataView(u);d.setUint32(0,9),d.setUint8(4,112),d.setUint8(5,72),d.setUint8(6,89),d.setUint8(7,115);const f=2835.5;d.setInt32(8,f*n),d.setInt32(12,f*n),d.setInt8(16,1);const g=new Uint8Array(u.slice(4,17));d.setInt32(17,hH(g));const m=e.buffer.slice(0,i),S=e.buffer.slice(i+s);return new Blob([m,u,S],r)}}/*!
 * MIT License: https://github.com/sindresorhus/is-webp/blob/main/license
 * Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (https://sindresorhus.com)
 */function fH(t){return!t||t.length<12?!1:t[8]===87&&t[9]===69&&t[10]===66&&t[11]===80}function pH(t){const e=new Uint8Array(t);return!fH(e)||!e||e.length<21?!1:(e[20]>>1&1)===1}const LD=Object.freeze(["image/svg+xml"]),ND=Object.freeze(["image/jpeg","image/png","image/webp"]),zD=Object.freeze(["image/gif","image/apng","image/avif"]),Vf=Object.freeze([...ND,...LD,...zD]),Zy=Object.freeze(["video/mp4","video/webm","video/quicktime"]),gH=[...Vf,...Zy].join(",");class bi{static loadVideo(e){return new Promise((n,r)=>{const i=document.createElement("video");i.onloadeddata=()=>n(i),i.onerror=s=>{console.error(s),r(new Error("Could not load video"))},i.crossOrigin="anonymous",i.src=e})}static async getVideoFrameAsDataUrl(e,n=0){const r=__();let i=!1;const s=()=>{if(!i)if(e.readyState>=e.HAVE_METADATA)i=!0,e.currentTime=n;else return;if(e.readyState>=e.HAVE_CURRENT_DATA){const l=document.createElement("canvas");l.width=e.videoWidth,l.height=e.videoHeight;const u=l.getContext("2d");if(!u)throw new Error("Could not get 2d context");u.drawImage(e,0,0),r.resolve(l.toDataURL())}},o=l=>{console.error(l),r.reject(new Error("Could not get video frame"))};e.addEventListener("loadedmetadata",s),e.addEventListener("loadeddata",s),e.addEventListener("canplay",s),e.addEventListener("seeked",s),e.addEventListener("error",o),e.addEventListener("stalled",o),s();try{return await r}finally{e.removeEventListener("loadedmetadata",s),e.removeEventListener("loadeddata",s),e.removeEventListener("canplay",s),e.removeEventListener("seeked",s),e.removeEventListener("error",o),e.removeEventListener("stalled",o)}}static loadImage(e){return new Promise((n,r)=>{const i=If();i.onload=()=>n(i),i.onerror=s=>{console.error(s),r(new Error("Could not load image"))},i.crossOrigin="anonymous",i.referrerPolicy="strict-origin-when-cross-origin",i.src=e})}static async getVideoSize(e){return bi.usingObjectURL(e,async n=>{const r=await bi.loadVideo(n);return{w:r.videoWidth,h:r.videoHeight}})}static async getImageSize(e){const n=await bi.usingObjectURL(e,bi.loadImage);try{if(e.type==="image/png"){const r=new DataView(await e.arrayBuffer());if(no.isPng(r,0)){const i=no.findChunk(r,"pHYs");if(i){const s=no.parsePhys(r,i.dataOffset);if(s.unit===0&&s.ppux===s.ppuy){const o=Math.max(s.ppux/2834.5,1);return{w:Math.round(n.naturalWidth/o),h:Math.round(n.naturalHeight/o)}}}}}}catch(r){return console.error(r),{w:n.naturalWidth,h:n.naturalHeight}}return{w:n.naturalWidth,h:n.naturalHeight}}static async isAnimated(e){return e.type==="image/gif"?dH(await e.arrayBuffer()):e.type==="image/avif"?cH(await e.arrayBuffer()):e.type==="image/webp"?pH(await e.arrayBuffer()):e.type==="image/apng"?lH(await e.arrayBuffer()):!1}static isAnimatedImageType(e){return zD.includes(e||"")}static isStaticImageType(e){return ND.includes(e||"")}static isVectorImageType(e){return LD.includes(e||"")}static isImageType(e){return Vf.includes(e)}static async usingObjectURL(e,n){const r=URL.createObjectURL(e);try{return await n(r)}finally{URL.revokeObjectURL(r)}}}function ct(t,e,n){return t+(e-t)*n}function Ds(t=""){let e=0,n=0,r=0,i=0;function s(){const o=e^e<<11;return e=n,n=r,r=i,i^=(i>>>19^o^o>>>8)>>>0,i/4294967296*2}for(let o=0;o<t.length+64;o++)e^=t.charCodeAt(o)|0,s();return s}function sd(t,e,n,r=!1){const[i,s]=e,[o,l]=n,u=o+(t-i)/(s-i)*(l-o);return r?o<l?Math.max(Math.min(u,l),o):Math.max(Math.min(u,o),l):u}function es(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xr(t,e){if(es(t,e))return t[e]}function BM(t){return Object.keys(t)}function ln(t){return Object.values(t)}function ri(t){return Object.entries(t)}function M_(t){return Object.fromEntries(t)}function gf(t,e){const n={};let r=!1;for(const[i,s]of ri(t))e(i,s)?n[i]=s:r=!0;return r?n:t}function Wf(t,e){const n={};for(const[r,i]of ri(t)){const s=e(r,i);n[r]=s}return n}function $D(t,e){if(t===e)return!0;const n=new Set(Object.keys(t)),r=new Set(Object.keys(e));if(n.size!==r.size)return!1;for(const i of n)if(!r.has(i)||!Object.is(t[i],e[i]))return!1;return!0}function mH(t){const e=yH(t.chars),n=SH(e,t.firstPositive,t.mostPositive,t.mostNegative),r=t.jitterRange??Math.floor(Math.pow(e.length,3)/5),i=vH(r,e.length);return{chars:t.chars,byChar:e.byChar,byCode:e.byCode,length:e.length,first:e.byCode[0],last:e.byCode[e.length-1],firstPositive:n.firstPositive,mostPositive:n.mostPositive,firstNegative:n.firstNegative,mostNegative:n.mostNegative,jitterRange:r,paddingDict:i}}function yH(t){const e={},n={},r=t.length;for(let i=0;i<r;i++){const s=t[i];e[i]=s,n[s]=i}return{byCode:e,byChar:n,length:r}}function SH(t,e,n,r){const i=t.byChar[e],s=t.byChar[n],o=t.byChar[r];if(i===void 0||s===void 0||o===void 0)throw new Error("invalid charSet");if(s-i<3)throw new Error("mostPositive must be at least 3 characters away from neutral");if(i-o<3)throw new Error("mostNegative must be at least 3 characters away from neutral");return{firstPositive:t.byCode[i],mostPositive:t.byCode[s],firstNegative:t.byCode[i-1],mostNegative:t.byCode[o]}}function vH(t,e){const n={};for(let r=0;r<100&&(n[r]=Math.pow(e,r),!(n[r]>t));r++);return n}var Ab=null;function A_(){return Ab||(Ab=mH({chars:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",firstPositive:"a",mostPositive:"z",mostNegative:"A"}))}function ul(t,e,n){const r=n.byChar[t],i=n.byChar[e];return Math.abs(r-i)}function k_(t,e){const n=t[0];if(n>e.mostPositive||n<e.mostNegative)throw new Error("invalid firstChar on key");return n===e.mostPositive?ul(n,e.firstPositive,e)+1+ay(t.slice(1),"positive",e):n===e.mostNegative?ul(n,e.firstNegative,e)+1+ay(t.slice(1),"negative",e):n>=e.firstPositive?ul(n,e.firstPositive,e)+2:ul(n,e.firstNegative,e)+2}function ay(t,e,n){const r=t[0];if(r>n.mostPositive||r<n.mostNegative)throw new Error("invalid firstChar on key");return r===n.mostPositive&&e==="positive"?ul(r,n.mostNegative,n)+1+ay(t.slice(1),e,n):r===n.mostNegative&&e==="negative"?ul(r,n.mostPositive,n)+1+ay(t.slice(1),e,n):e==="positive"?ul(r,n.mostNegative,n)+2:ul(r,n.mostPositive,n)+2}function Qy(t,e,n,r,i){const s=Math.max(t.length,e.length);return n==="start"?[t.padStart(s,r),e.padStart(s,r)]:[t.padEnd(s,r),e.padEnd(s,r)]}function bH(t,e,n){let[r,i]=Qy(t,e,"end",n.first),s=J1(r,i,n);s===1&&(r=r.padEnd(r.length+1,n.first),s=n.length);const o=UD(Math.floor(s/2),n);return R_(r,o,n)}function J1(t,e,n){const[r,i]=Qy(t,e,"end",n.first).sort(),s=BD(i,r,n);return xH(s,n)}function R_(t,e,n){const r=n.length,[i,s]=Qy(t,e,"start",n.first),o=[];let l=0;for(let u=i.length-1;u>=0;u--){const d=n.byChar[i[u]],f=n.byChar[s[u]],g=d+f+l;l=Math.floor(g/r);const m=g%r;o.unshift(n.byCode[m])}return l>0&&o.unshift(n.byCode[l]),o.join("")}function BD(t,e,n){const r=n.length,[i,s]=Qy(t,e,"start",n.first),o=[];let l=0;for(let u=i.length-1;u>=0;u--){let d=n.byChar[i[u]];const f=n.byChar[s[u]]+l;d<f?(l=1,d+=r):l=0;const g=d-f;o.unshift(n.byCode[g])}if(l>0)throw new Error("Subtraction result is negative. Ensure a is greater than or equal to b.");for(;o.length>1&&o[0]===n.byCode[0];)o.shift();return o.join("")}function FD(t,e){return R_(t,e.byCode[1],e)}function eC(t,e){return BD(t,e.byCode[1],e)}function UD(t,e){if(t===0)return e.byCode[0];let n="";const r=e.length;for(;t>0;)n=e.byCode[t%r]+n,t=Math.floor(t/r);return n}function xH(t,e){let n=0;const r=t.length,i=e.length;for(let s=0;s<r;s++)n+=e.byChar[t[s]]*Math.pow(i,r-s-1);return n}function wH(t){return t.firstPositive+t.byCode[0]}function CH(t,e){return k_(t,e)===t.length}function FM(t,e){ly(t,e)}function ly(t,e){const n=GD(t,e),r=k_(n,e);if(r>t.length)throw new Error("invalid order key length: "+t);return t.slice(0,r)}function HD(t,e){if(!CH(t,e))throw new Error("invalid integer length: "+t)}function KD(t,e){HD(t,e);const[n,r]=qD(t,e);if(r.split("").some(o=>o!==e.byCode[e.length-1])){const o=FD(r,e);return n+o}const s=EH(n,e);return YD(s,"lower",e)}function _H(t,e){HD(t,e);const[n,r]=qD(t,e);if(r.split("").some(o=>o!==e.byCode[0])){const o=eC(r,e);return n+o}const s=PH(n,e);return YD(s,"upper",e)}function GD(t,e){let n=0;if(t[0]===e.mostPositive)for(;t[n]===e.mostPositive;)n=n+1;if(t[0]===e.mostNegative)for(;t[n]===e.mostNegative;)n=n+1;return t.slice(0,n+1)}function qD(t,e){const n=GD(t,e),r=t.slice(n.length);return[n,r]}function EH(t,e){const n=t>=e.firstPositive,r=FD(t,e),i=t[t.length-1]===e.mostPositive,s=r[r.length-1]===e.mostPositive;return n&&s?r+e.mostNegative:!n&&i?t.slice(0,t.length-1):r}function PH(t,e){const n=t>=e.firstPositive,r=t[t.length-1]===e.mostNegative;if(n&&r){const i=t.slice(0,t.length-1);return eC(i,e)}return!n&&r?t+e.mostPositive:eC(t,e)}function YD(t,e,n){const r=k_(t,n),i=e==="upper"?n.byCode[n.length-1]:n.byCode[0];return t+i.repeat(r-t.length)}function VD(t,e){const n=UD(Math.floor(Math.random()*e.jitterRange),e);return R_(t,n,e)}function TH(t,e,n){const r=t.padEnd(t.length+e,n.first);return VD(r,n)}function IH(t,e,n){const r=ly(t,n),i=KD(r,n);let s=0;if(e!==null){const l=J1(t,e,n);l<n.jitterRange+1&&(s=Math.max(s,UM(l,n)))}const o=J1(t,i,n);return o<n.jitterRange+1&&(s=Math.max(s,UM(o,n))),s}function UM(t,e){const n=e.jitterRange-t,r=Object.entries(e.paddingDict).find(([i,s])=>s>n);return r?parseInt(r[0]):0}function MH(t,e,n=A_()){if(t!==null&&FM(t,n),e!==null&&FM(e,n),t===null&&e===null)return wH(n);if(t===null){const r=ly(e,n);return _H(r,n)}if(e===null){const r=ly(t,n);return KD(r,n)}if(t>=e)throw new Error(t+" >= "+e);return bH(t,e,n)}function WD(t,e,n=A_()){const r=MH(t,e,n),i=IH(r,e,n);return i?TH(r,i,n):VD(r,n)}function XD(t,e,n,r=A_()){return AH(t,e,n,r,WD,XD)}function AH(t,e,n,r,i,s){if(n===0)return[];if(n===1)return[i(t,e,r)];if(e==null){let u=i(t,e,r);const d=[u];for(let f=0;f<n-1;f++)u=i(u,e,r),d.push(u);return d}if(t==null){let u=i(t,e,r);const d=[u];for(let f=0;f<n-1;f++)u=i(t,u,r),d.push(u);return d.reverse(),d}const o=Math.floor(n/2),l=i(t,e,r);return[...s(t,l,o,r),l,...s(l,e,n-o-1,r)]}const md=XD,ZD="a0";function kH(t){try{WD(t,null)}catch{throw new Error("invalid index: "+t)}}function od(t,e,n){return md(t??null,e??null,n)}function kb(t,e){return md(t??null,null,e)}function Mf(t,e){return md(t??null,e??null,1)[0]}function so(t=null){return md(t,null,1)[0]}function RH(t=null){return md(null,t,1)[0]}function Af(t,e="a1"){return[e,...md(e,null,t)]}function vr(t,e){return t.index<e.index?-1:t.index>e.index?1:0}function OH(t,e){return t.id>e.id?1:-1}function O_(t){try{return localStorage.getItem(t)}catch{return null}}function j_(t,e){try{localStorage.setItem(t,e)}catch{}}function jH(){try{localStorage.clear()}catch{}}function QD(t){try{return sessionStorage.getItem(t)}catch{return null}}function D_(t,e){try{sessionStorage.setItem(t,e)}catch{}}function JD(t){try{sessionStorage.removeItem(t)}catch{}}function DH(){try{sessionStorage.clear()}catch{}}const Ku=[],LH=60,bm=Math.ceil(1e3/LH);let zh,Rb=0,tC=0;const NH=()=>{const t=Ku.splice(0,Ku.length);for(const e of t)e()};function e5(){if(zh)return;const t=Date.now(),e=t-tC;if(Rb+e<bm){zh=requestAnimationFrame(()=>{zh=void 0,e5()});return}zh=requestAnimationFrame(()=>{zh=void 0,tC=t,Rb=Math.min(Rb+e-bm,bm*10),NH()})}let HM=!1;function t5(t){return Ku.includes(t)||(Ku.push(t),HM||(HM=!0,tC=Date.now()-bm-1),e5()),()=>{const e=Ku.indexOf(t);e>-1&&Ku.splice(e,1)}}class zH{constructor(){O(this,"timeouts",new Map);O(this,"intervals",new Map);O(this,"rafs",new Map);this.setTimeout=this.setTimeout.bind(this),this.setInterval=this.setInterval.bind(this),this.requestAnimationFrame=this.requestAnimationFrame.bind(this),this.dispose=this.dispose.bind(this)}setTimeout(e,n,r,...i){const s=window.setTimeout(n,r,i),o=this.timeouts.get(e)??[];return this.timeouts.set(e,[...o,s]),s}setInterval(e,n,r,...i){const s=window.setInterval(n,r,i),o=this.intervals.get(e)??[];return this.intervals.set(e,[...o,s]),s}requestAnimationFrame(e,n){const r=window.requestAnimationFrame(n),i=this.rafs.get(e)??[];return this.rafs.set(e,[...i,r]),r}dispose(e){var n,r,i;(n=this.timeouts.get(e))==null||n.forEach(s=>clearTimeout(s)),(r=this.intervals.get(e))==null||r.forEach(s=>clearInterval(s)),(i=this.rafs.get(e))==null||i.forEach(s=>cancelAnimationFrame(s)),this.timeouts.delete(e),this.intervals.delete(e),this.rafs.delete(e)}disposeAll(){for(const e of this.timeouts.keys())this.dispose(e)}forContext(e){return{setTimeout:(n,r,...i)=>this.setTimeout(e,n,r,i),setInterval:(n,r,...i)=>this.setInterval(e,n,r,i),requestAnimationFrame:n=>this.requestAnimationFrame(e,n),dispose:()=>this.dispose(e)}}}const Ge=(t,e)=>{try{return new URL(t,e)}catch{return}};function $H(t){return t!==void 0}function BH(){return typeof globalThis<"u"&&globalThis.structuredClone?[globalThis.structuredClone,!0]:typeof global<"u"&&global.structuredClone?[global.structuredClone,!0]:typeof window<"u"&&window.structuredClone?[window.structuredClone,!0]:[t=>t&&JSON.parse(JSON.stringify(t)),!1]}const n5=BH(),Xt=n5[0];n5[1];const FH=Object.getPrototypeOf(Xt({}));El("@tldraw/utils","3.8.1","esm");var KM={},$h,GM;function Or(){if(GM)return $h;GM=1;var t=function(e){return e&&e.Math===Math&&e};return $h=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof ti=="object"&&ti)||t(typeof $h=="object"&&$h)||function(){return this}()||Function("return this")(),$h}var Ob={},jb,qM;function jr(){return qM||(qM=1,jb=function(t){try{return!!t()}catch{return!0}}),jb}var Db,YM;function Pl(){if(YM)return Db;YM=1;var t=jr();return Db=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Db}var Lb,VM;function Jy(){if(VM)return Lb;VM=1;var t=jr();return Lb=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Lb}var Nb,WM;function xa(){if(WM)return Nb;WM=1;var t=Jy(),e=Function.prototype.call;return Nb=t?e.bind(e):function(){return e.apply(e,arguments)},Nb}var zb={},XM;function UH(){if(XM)return zb;XM=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return zb.f=n?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,zb}var $b,ZM;function r5(){return ZM||(ZM=1,$b=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),$b}var Bb,QM;function Gn(){if(QM)return Bb;QM=1;var t=Jy(),e=Function.prototype,n=e.call,r=t&&e.bind.bind(n,n);return Bb=t?r:function(i){return function(){return n.apply(i,arguments)}},Bb}var Fb,JM;function yd(){if(JM)return Fb;JM=1;var t=Gn(),e=t({}.toString),n=t("".slice);return Fb=function(r){return n(e(r),8,-1)},Fb}var Ub,eA;function HH(){if(eA)return Ub;eA=1;var t=Gn(),e=jr(),n=yd(),r=Object,i=t("".split);return Ub=e(function(){return!r("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?i(s,""):r(s)}:r,Ub}var Hb,tA;function eS(){return tA||(tA=1,Hb=function(t){return t==null}),Hb}var Kb,nA;function Sd(){if(nA)return Kb;nA=1;var t=eS(),e=TypeError;return Kb=function(n){if(t(n))throw new e("Can't call method on "+n);return n},Kb}var Gb,rA;function tS(){if(rA)return Gb;rA=1;var t=HH(),e=Sd();return Gb=function(n){return t(e(n))},Gb}var qb,iA;function Dr(){if(iA)return qb;iA=1;var t=typeof document=="object"&&document.all;return qb=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},qb}var Yb,sA;function Oc(){if(sA)return Yb;sA=1;var t=Dr();return Yb=function(e){return typeof e=="object"?e!==null:t(e)},Yb}var Vb,oA;function nS(){if(oA)return Vb;oA=1;var t=Or(),e=Dr(),n=function(r){return e(r)?r:void 0};return Vb=function(r,i){return arguments.length<2?n(t[r]):t[r]&&t[r][i]},Vb}var Wb,aA;function i5(){if(aA)return Wb;aA=1;var t=Gn();return Wb=t({}.isPrototypeOf),Wb}var Xb,lA;function KH(){if(lA)return Xb;lA=1;var t=Or(),e=t.navigator,n=e&&e.userAgent;return Xb=n?String(n):"",Xb}var Zb,cA;function GH(){if(cA)return Zb;cA=1;var t=Or(),e=KH(),n=t.process,r=t.Deno,i=n&&n.versions||r&&r.version,s=i&&i.v8,o,l;return s&&(o=s.split("."),l=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!l&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(l=+o[1]))),Zb=l,Zb}var Qb,uA;function s5(){if(uA)return Qb;uA=1;var t=GH(),e=jr(),n=Or(),r=n.String;return Qb=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),Qb}var Jb,dA;function o5(){if(dA)return Jb;dA=1;var t=s5();return Jb=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Jb}var ex,hA;function a5(){if(hA)return ex;hA=1;var t=nS(),e=Dr(),n=i5(),r=o5(),i=Object;return ex=r?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&n(o.prototype,i(s))},ex}var tx,fA;function qH(){if(fA)return tx;fA=1;var t=String;return tx=function(e){try{return t(e)}catch{return"Object"}},tx}var nx,pA;function L_(){if(pA)return nx;pA=1;var t=Dr(),e=qH(),n=TypeError;return nx=function(r){if(t(r))return r;throw new n(e(r)+" is not a function")},nx}var rx,gA;function N_(){if(gA)return rx;gA=1;var t=L_(),e=eS();return rx=function(n,r){var i=n[r];return e(i)?void 0:t(i)},rx}var ix,mA;function YH(){if(mA)return ix;mA=1;var t=xa(),e=Dr(),n=Oc(),r=TypeError;return ix=function(i,s){var o,l;if(s==="string"&&e(o=i.toString)&&!n(l=t(o,i))||e(o=i.valueOf)&&!n(l=t(o,i))||s!=="string"&&e(o=i.toString)&&!n(l=t(o,i)))return l;throw new r("Can't convert object to primitive value")},ix}var sx={exports:{}},ox,yA;function l5(){return yA||(yA=1,ox=!1),ox}var ax,SA;function z_(){if(SA)return ax;SA=1;var t=Or(),e=Object.defineProperty;return ax=function(n,r){try{e(t,n,{value:r,configurable:!0,writable:!0})}catch{t[n]=r}return r},ax}var vA;function $_(){if(vA)return sx.exports;vA=1;var t=l5(),e=Or(),n=z_(),r="__core-js_shared__",i=sx.exports=e[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.40.0",mode:t?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.40.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sx.exports}var lx,bA;function B_(){if(bA)return lx;bA=1;var t=$_();return lx=function(e,n){return t[e]||(t[e]=n||{})},lx}var cx,xA;function Xf(){if(xA)return cx;xA=1;var t=Sd(),e=Object;return cx=function(n){return e(t(n))},cx}var ux,wA;function Tl(){if(wA)return ux;wA=1;var t=Gn(),e=Xf(),n=t({}.hasOwnProperty);return ux=Object.hasOwn||function(i,s){return n(e(i),s)},ux}var dx,CA;function c5(){if(CA)return dx;CA=1;var t=Gn(),e=0,n=Math.random(),r=t(1 .toString);return dx=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++e+n,36)},dx}var hx,_A;function wa(){if(_A)return hx;_A=1;var t=Or(),e=B_(),n=Tl(),r=c5(),i=s5(),s=o5(),o=t.Symbol,l=e("wks"),u=s?o.for||o:o&&o.withoutSetter||r;return hx=function(d){return n(l,d)||(l[d]=i&&n(o,d)?o[d]:u("Symbol."+d)),l[d]},hx}var fx,EA;function VH(){if(EA)return fx;EA=1;var t=xa(),e=Oc(),n=a5(),r=N_(),i=YH(),s=wa(),o=TypeError,l=s("toPrimitive");return fx=function(u,d){if(!e(u)||n(u))return u;var f=r(u,l),g;if(f){if(d===void 0&&(d="default"),g=t(f,u,d),!e(g)||n(g))return g;throw new o("Can't convert object to primitive value")}return d===void 0&&(d="number"),i(u,d)},fx}var px,PA;function u5(){if(PA)return px;PA=1;var t=VH(),e=a5();return px=function(n){var r=t(n,"string");return e(r)?r:r+""},px}var gx,TA;function d5(){if(TA)return gx;TA=1;var t=Or(),e=Oc(),n=t.document,r=e(n)&&e(n.createElement);return gx=function(i){return r?n.createElement(i):{}},gx}var mx,IA;function h5(){if(IA)return mx;IA=1;var t=Pl(),e=jr(),n=d5();return mx=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),mx}var MA;function f5(){if(MA)return Ob;MA=1;var t=Pl(),e=xa(),n=UH(),r=r5(),i=tS(),s=u5(),o=Tl(),l=h5(),u=Object.getOwnPropertyDescriptor;return Ob.f=t?u:function(f,g){if(f=i(f),g=s(g),l)try{return u(f,g)}catch{}if(o(f,g))return r(!e(n.f,f,g),f[g])},Ob}var yx={},Sx,AA;function p5(){if(AA)return Sx;AA=1;var t=Pl(),e=jr();return Sx=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Sx}var vx,kA;function jc(){if(kA)return vx;kA=1;var t=Oc(),e=String,n=TypeError;return vx=function(r){if(t(r))return r;throw new n(e(r)+" is not an object")},vx}var RA;function Zf(){if(RA)return yx;RA=1;var t=Pl(),e=h5(),n=p5(),r=jc(),i=u5(),s=TypeError,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u="enumerable",d="configurable",f="writable";return yx.f=t?n?function(m,S,b){if(r(m),S=i(S),r(b),typeof m=="function"&&S==="prototype"&&"value"in b&&f in b&&!b[f]){var v=l(m,S);v&&v[f]&&(m[S]=b.value,b={configurable:d in b?b[d]:v[d],enumerable:u in b?b[u]:v[u],writable:!1})}return o(m,S,b)}:o:function(m,S,b){if(r(m),S=i(S),r(b),e)try{return o(m,S,b)}catch{}if("get"in b||"set"in b)throw new s("Accessors not supported");return"value"in b&&(m[S]=b.value),m},yx}var bx,OA;function F_(){if(OA)return bx;OA=1;var t=Pl(),e=Zf(),n=r5();return bx=t?function(r,i,s){return e.f(r,i,n(1,s))}:function(r,i,s){return r[i]=s,r},bx}var xx={exports:{}},wx,jA;function WH(){if(jA)return wx;jA=1;var t=Pl(),e=Tl(),n=Function.prototype,r=t&&Object.getOwnPropertyDescriptor,i=e(n,"name"),s=i&&(function(){}).name==="something",o=i&&(!t||t&&r(n,"name").configurable);return wx={EXISTS:i,PROPER:s,CONFIGURABLE:o},wx}var Cx,DA;function g5(){if(DA)return Cx;DA=1;var t=Gn(),e=Dr(),n=$_(),r=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),Cx=n.inspectSource,Cx}var _x,LA;function XH(){if(LA)return _x;LA=1;var t=Or(),e=Dr(),n=t.WeakMap;return _x=e(n)&&/native code/.test(String(n)),_x}var Ex,NA;function m5(){if(NA)return Ex;NA=1;var t=B_(),e=c5(),n=t("keys");return Ex=function(r){return n[r]||(n[r]=e(r))},Ex}var Px,zA;function U_(){return zA||(zA=1,Px={}),Px}var Tx,$A;function y5(){if($A)return Tx;$A=1;var t=XH(),e=Or(),n=Oc(),r=F_(),i=Tl(),s=$_(),o=m5(),l=U_(),u="Object already initialized",d=e.TypeError,f=e.WeakMap,g,m,S,b=function(_){return S(_)?m(_):g(_,{})},v=function(_){return function(M){var I;if(!n(M)||(I=m(M)).type!==_)throw new d("Incompatible receiver, "+_+" required");return I}};if(t||s.state){var w=s.state||(s.state=new f);w.get=w.get,w.has=w.has,w.set=w.set,g=function(_,M){if(w.has(_))throw new d(u);return M.facade=_,w.set(_,M),M},m=function(_){return w.get(_)||{}},S=function(_){return w.has(_)}}else{var C=o("state");l[C]=!0,g=function(_,M){if(i(_,C))throw new d(u);return M.facade=_,r(_,C,M),M},m=function(_){return i(_,C)?_[C]:{}},S=function(_){return i(_,C)}}return Tx={set:g,get:m,has:S,enforce:b,getterFor:v},Tx}var BA;function ZH(){if(BA)return xx.exports;BA=1;var t=Gn(),e=jr(),n=Dr(),r=Tl(),i=Pl(),s=WH().CONFIGURABLE,o=g5(),l=y5(),u=l.enforce,d=l.get,f=String,g=Object.defineProperty,m=t("".slice),S=t("".replace),b=t([].join),v=i&&!e(function(){return g(function(){},"length",{value:8}).length!==8}),w=String(String).split("String"),C=xx.exports=function(_,M,I){m(f(M),0,7)==="Symbol("&&(M="["+S(f(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),I&&I.getter&&(M="get "+M),I&&I.setter&&(M="set "+M),(!r(_,"name")||s&&_.name!==M)&&(i?g(_,"name",{value:M,configurable:!0}):_.name=M),v&&I&&r(I,"arity")&&_.length!==I.arity&&g(_,"length",{value:I.arity});try{I&&r(I,"constructor")&&I.constructor?i&&g(_,"prototype",{writable:!1}):_.prototype&&(_.prototype=void 0)}catch{}var A=u(_);return r(A,"source")||(A.source=b(w,typeof M=="string"?M:"")),_};return Function.prototype.toString=C(function(){return n(this)&&d(this).source||o(this)},"toString"),xx.exports}var Ix,FA;function S5(){if(FA)return Ix;FA=1;var t=Dr(),e=Zf(),n=ZH(),r=z_();return Ix=function(i,s,o,l){l||(l={});var u=l.enumerable,d=l.name!==void 0?l.name:s;if(t(o)&&n(o,d,l),l.global)u?i[s]=o:r(s,o);else{try{l.unsafe?i[s]&&(u=!0):delete i[s]}catch{}u?i[s]=o:e.f(i,s,{value:o,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return i},Ix}var Mx={},Ax,UA;function QH(){if(UA)return Ax;UA=1;var t=Math.ceil,e=Math.floor;return Ax=Math.trunc||function(r){var i=+r;return(i>0?e:t)(i)},Ax}var kx,HA;function Dc(){if(HA)return kx;HA=1;var t=QH();return kx=function(e){var n=+e;return n!==n||n===0?0:t(n)},kx}var Rx,KA;function JH(){if(KA)return Rx;KA=1;var t=Dc(),e=Math.max,n=Math.min;return Rx=function(r,i){var s=t(r);return s<0?e(s+i,0):n(s,i)},Rx}var Ox,GA;function v5(){if(GA)return Ox;GA=1;var t=Dc(),e=Math.min;return Ox=function(n){var r=t(n);return r>0?e(r,9007199254740991):0},Ox}var jx,qA;function Qf(){if(qA)return jx;qA=1;var t=v5();return jx=function(e){return t(e.length)},jx}var Dx,YA;function eK(){if(YA)return Dx;YA=1;var t=tS(),e=JH(),n=Qf(),r=function(i){return function(s,o,l){var u=t(s),d=n(u);if(d===0)return!i&&-1;var f=e(l,d),g;if(i&&o!==o){for(;d>f;)if(g=u[f++],g!==g)return!0}else for(;d>f;f++)if((i||f in u)&&u[f]===o)return i||f||0;return!i&&-1}};return Dx={includes:r(!0),indexOf:r(!1)},Dx}var Lx,VA;function b5(){if(VA)return Lx;VA=1;var t=Gn(),e=Tl(),n=tS(),r=eK().indexOf,i=U_(),s=t([].push);return Lx=function(o,l){var u=n(o),d=0,f=[],g;for(g in u)!e(i,g)&&e(u,g)&&s(f,g);for(;l.length>d;)e(u,g=l[d++])&&(~r(f,g)||s(f,g));return f},Lx}var Nx,WA;function H_(){return WA||(WA=1,Nx=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Nx}var XA;function tK(){if(XA)return Mx;XA=1;var t=b5(),e=H_(),n=e.concat("length","prototype");return Mx.f=Object.getOwnPropertyNames||function(i){return t(i,n)},Mx}var zx={},ZA;function nK(){return ZA||(ZA=1,zx.f=Object.getOwnPropertySymbols),zx}var $x,QA;function rK(){if(QA)return $x;QA=1;var t=nS(),e=Gn(),n=tK(),r=nK(),i=jc(),s=e([].concat);return $x=t("Reflect","ownKeys")||function(l){var u=n.f(i(l)),d=r.f;return d?s(u,d(l)):u},$x}var Bx,JA;function iK(){if(JA)return Bx;JA=1;var t=Tl(),e=rK(),n=f5(),r=Zf();return Bx=function(i,s,o){for(var l=e(s),u=r.f,d=n.f,f=0;f<l.length;f++){var g=l[f];!t(i,g)&&!(o&&t(o,g))&&u(i,g,d(s,g))}},Bx}var Fx,ek;function sK(){if(ek)return Fx;ek=1;var t=jr(),e=Dr(),n=/#|\.prototype\./,r=function(u,d){var f=s[i(u)];return f===l?!0:f===o?!1:e(d)?t(d):!!d},i=r.normalize=function(u){return String(u).replace(n,".").toLowerCase()},s=r.data={},o=r.NATIVE="N",l=r.POLYFILL="P";return Fx=r,Fx}var Ux,tk;function vd(){if(tk)return Ux;tk=1;var t=Or(),e=f5().f,n=F_(),r=S5(),i=z_(),s=iK(),o=sK();return Ux=function(l,u){var d=l.target,f=l.global,g=l.stat,m,S,b,v,w,C;if(f?S=t:g?S=t[d]||i(d,{}):S=t[d]&&t[d].prototype,S)for(b in u){if(w=u[b],l.dontCallGetSet?(C=e(S,b),v=C&&C.value):v=S[b],m=o(f?b:d+(g?".":"#")+b,l.forced),!m&&v!==void 0){if(typeof w==typeof v)continue;s(w,v)}(l.sham||v&&v.sham)&&n(w,"sham",!0),r(S,b,w,l)}},Ux}var Hx={},Kx,nk;function oK(){if(nk)return Kx;nk=1;var t=b5(),e=H_();return Kx=Object.keys||function(r){return t(r,e)},Kx}var rk;function aK(){if(rk)return Hx;rk=1;var t=Pl(),e=p5(),n=Zf(),r=jc(),i=tS(),s=oK();return Hx.f=t&&!e?Object.defineProperties:function(l,u){r(l);for(var d=i(u),f=s(u),g=f.length,m=0,S;g>m;)n.f(l,S=f[m++],d[S]);return l},Hx}var Gx,ik;function lK(){if(ik)return Gx;ik=1;var t=nS();return Gx=t("document","documentElement"),Gx}var qx,sk;function x5(){if(sk)return qx;sk=1;var t=jc(),e=aK(),n=H_(),r=U_(),i=lK(),s=d5(),o=m5(),l=">",u="<",d="prototype",f="script",g=o("IE_PROTO"),m=function(){},S=function(_){return u+f+l+_+u+"/"+f+l},b=function(_){_.write(S("")),_.close();var M=_.parentWindow.Object;return _=null,M},v=function(){var _=s("iframe"),M="java"+f+":",I;return _.style.display="none",i.appendChild(_),_.src=String(M),I=_.contentWindow.document,I.open(),I.write(S("document.F=Object")),I.close(),I.F},w,C=function(){try{w=new ActiveXObject("htmlfile")}catch{}C=typeof document<"u"?document.domain&&w?b(w):v():b(w);for(var _=n.length;_--;)delete C[d][n[_]];return C()};return r[g]=!0,qx=Object.create||function(M,I){var A;return M!==null?(m[d]=t(M),A=new m,m[d]=null,A[g]=M):A=C(),I===void 0?A:e.f(A,I)},qx}var Yx,ok;function K_(){if(ok)return Yx;ok=1;var t=wa(),e=x5(),n=Zf().f,r=t("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:e(null)}),Yx=function(s){i[r][s]=!0},Yx}var ak;function cK(){if(ak)return KM;ak=1;var t=vd(),e=Xf(),n=Qf(),r=Dc(),i=K_();return t({target:"Array",proto:!0},{at:function(o){var l=e(this),u=n(l),d=r(o),f=d>=0?d:u+d;return f<0||f>=u?void 0:l[f]}}),i("at"),KM}var Vx,lk;function Jf(){if(lk)return Vx;lk=1;var t=Or(),e=Gn();return Vx=function(n,r){return e(t[n].prototype[r])},Vx}var Wx,ck;function uK(){if(ck)return Wx;ck=1,cK();var t=Jf();return Wx=t("Array","at"),Wx}var Xx,uk;function dK(){if(uk)return Xx;uk=1;var t=uK();return Xx=t,Xx}dK();var dk={},Zx,hk;function w5(){if(hk)return Zx;hk=1;var t=yd();return Zx=Array.isArray||function(n){return t(n)==="Array"},Zx}var Qx,fk;function hK(){if(fk)return Qx;fk=1;var t=TypeError,e=9007199254740991;return Qx=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},Qx}var Jx,pk;function fK(){if(pk)return Jx;pk=1;var t=yd(),e=Gn();return Jx=function(n){if(t(n)==="Function")return e(n)},Jx}var ew,gk;function pK(){if(gk)return ew;gk=1;var t=fK(),e=L_(),n=Jy(),r=t(t.bind);return ew=function(i,s){return e(i),s===void 0?i:n?r(i,s):function(){return i.apply(s,arguments)}},ew}var tw,mk;function C5(){if(mk)return tw;mk=1;var t=w5(),e=Qf(),n=hK(),r=pK(),i=function(s,o,l,u,d,f,g,m){for(var S=d,b=0,v=g?r(g,m):!1,w,C;b<u;)b in l&&(w=v?v(l[b],b,o):l[b],f>0&&t(w)?(C=e(w),S=i(s,o,w,C,S,f-1)-1):(n(S+1),s[S]=w),S++),b++;return S};return tw=i,tw}var nw,yk;function gK(){if(yk)return nw;yk=1;var t=wa(),e=t("toStringTag"),n={};return n[e]="z",nw=String(n)==="[object z]",nw}var rw,Sk;function _5(){if(Sk)return rw;Sk=1;var t=gK(),e=Dr(),n=yd(),r=wa(),i=r("toStringTag"),s=Object,o=n(function(){return arguments}())==="Arguments",l=function(u,d){try{return u[d]}catch{}};return rw=t?n:function(u){var d,f,g;return u===void 0?"Undefined":u===null?"Null":typeof(f=l(d=s(u),i))=="string"?f:o?n(d):(g=n(d))==="Object"&&e(d.callee)?"Arguments":g},rw}var iw,vk;function mK(){if(vk)return iw;vk=1;var t=Gn(),e=jr(),n=Dr(),r=_5(),i=nS(),s=g5(),o=function(){},l=i("Reflect","construct"),u=/^\s*(?:class|function)\b/,d=t(u.exec),f=!u.test(o),g=function(b){if(!n(b))return!1;try{return l(o,[],b),!0}catch{return!1}},m=function(b){if(!n(b))return!1;switch(r(b)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(u,s(b))}catch{return!0}};return m.sham=!0,iw=!l||e(function(){var S;return g(g.call)||!g(Object)||!g(function(){S=!0})||S})?m:g,iw}var sw,bk;function yK(){if(bk)return sw;bk=1;var t=w5(),e=mK(),n=Oc(),r=wa(),i=r("species"),s=Array;return sw=function(o){var l;return t(o)&&(l=o.constructor,e(l)&&(l===s||t(l.prototype))?l=void 0:n(l)&&(l=l[i],l===null&&(l=void 0))),l===void 0?s:l},sw}var ow,xk;function E5(){if(xk)return ow;xk=1;var t=yK();return ow=function(e,n){return new(t(e))(n===0?0:n)},ow}var wk;function SK(){if(wk)return dk;wk=1;var t=vd(),e=C5(),n=L_(),r=Xf(),i=Qf(),s=E5();return t({target:"Array",proto:!0},{flatMap:function(l){var u=r(this),d=i(u),f;return n(l),f=s(u,0),f.length=e(f,u,u,d,0,1,l,arguments.length>1?arguments[1]:void 0),f}}),dk}var Ck={},_k;function vK(){if(_k)return Ck;_k=1;var t=K_();return t("flatMap"),Ck}var aw,Ek;function bK(){if(Ek)return aw;Ek=1,SK(),vK();var t=Jf();return aw=t("Array","flatMap"),aw}var lw,Pk;function xK(){if(Pk)return lw;Pk=1;var t=bK();return lw=t,lw}xK();var Tk={},Ik;function wK(){if(Ik)return Tk;Ik=1;var t=vd(),e=C5(),n=Xf(),r=Qf(),i=Dc(),s=E5();return t({target:"Array",proto:!0},{flat:function(){var l=arguments.length?arguments[0]:void 0,u=n(this),d=r(u),f=s(u,0);return f.length=e(f,u,u,d,0,l===void 0?1:i(l)),f}}),Tk}var Mk={},Ak;function CK(){if(Ak)return Mk;Ak=1;var t=K_();return t("flat"),Mk}var cw,kk;function _K(){if(kk)return cw;kk=1,wK(),CK();var t=Jf();return cw=t("Array","flat"),cw}var uw,Rk;function EK(){if(Rk)return uw;Rk=1;var t=_K();return uw=t,uw}EK();var Ok={},dw,jk;function ep(){if(jk)return dw;jk=1;var t=_5(),e=String;return dw=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},dw}var Dk;function PK(){if(Dk)return Ok;Dk=1;var t=vd(),e=Gn(),n=Sd(),r=Dc(),i=ep(),s=jr(),o=e("".charAt),l=s(function(){return"".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:l},{at:function(d){var f=i(n(this)),g=f.length,m=r(d),S=m>=0?m:g+m;return S<0||S>=g?void 0:o(f,S)}}),Ok}var hw,Lk;function TK(){if(Lk)return hw;Lk=1,PK();var t=Jf();return hw=t("String","at"),hw}var fw,Nk;function IK(){if(Nk)return fw;Nk=1;var t=TK();return fw=t,fw}IK();var zk={},pw,$k;function P5(){if($k)return pw;$k=1;var t=jc();return pw=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},pw}var gw,Bk;function MK(){if(Bk)return gw;Bk=1;var t=jr(),e=Or(),n=e.RegExp,r=t(function(){var o=n("a","y");return o.lastIndex=2,o.exec("abcd")!==null}),i=r||t(function(){return!n("a","y").sticky}),s=r||t(function(){var o=n("^r","gy");return o.lastIndex=2,o.exec("str")!==null});return gw={BROKEN_CARET:s,MISSED_STICKY:i,UNSUPPORTED_Y:r},gw}var mw,Fk;function AK(){if(Fk)return mw;Fk=1;var t=jr(),e=Or(),n=e.RegExp;return mw=t(function(){var r=n(".","s");return!(r.dotAll&&r.test(`
`)&&r.flags==="s")}),mw}var yw,Uk;function kK(){if(Uk)return yw;Uk=1;var t=jr(),e=Or(),n=e.RegExp;return yw=t(function(){var r=n("(?<a>b)","g");return r.exec("b").groups.a!=="b"||"b".replace(r,"$<a>c")!=="bc"}),yw}var Sw,Hk;function G_(){if(Hk)return Sw;Hk=1;var t=xa(),e=Gn(),n=ep(),r=P5(),i=MK(),s=B_(),o=x5(),l=y5().get,u=AK(),d=kK(),f=s("native-string-replace",String.prototype.replace),g=RegExp.prototype.exec,m=g,S=e("".charAt),b=e("".indexOf),v=e("".replace),w=e("".slice),C=function(){var A=/a/,R=/b*/g;return t(g,A,"a"),t(g,R,"a"),A.lastIndex!==0||R.lastIndex!==0}(),_=i.BROKEN_CARET,M=/()??/.exec("")[1]!==void 0,I=C||M||_||u||d;return I&&(m=function(R){var D=this,L=l(D),G=n(R),k=L.raw,$,F,N,B,Y,K,V;if(k)return k.lastIndex=D.lastIndex,$=t(m,k,G),D.lastIndex=k.lastIndex,$;var W=L.groups,ee=_&&D.sticky,H=t(r,D),te=D.source,ge=0,de=G;if(ee&&(H=v(H,"y",""),b(H,"g")===-1&&(H+="g"),de=w(G,D.lastIndex),D.lastIndex>0&&(!D.multiline||D.multiline&&S(G,D.lastIndex-1)!==`
`)&&(te="(?: "+te+")",de=" "+de,ge++),F=new RegExp("^(?:"+te+")",H)),M&&(F=new RegExp("^"+te+"$(?!\\s)",H)),C&&(N=D.lastIndex),B=t(g,ee?F:D,de),ee?B?(B.input=w(B.input,ge),B[0]=w(B[0],ge),B.index=D.lastIndex,D.lastIndex+=B[0].length):D.lastIndex=0:C&&B&&(D.lastIndex=D.global?B.index+B[0].length:N),M&&B&&B.length>1&&t(f,B[0],F,function(){for(Y=1;Y<arguments.length-2;Y++)arguments[Y]===void 0&&(B[Y]=void 0)}),B&&W)for(B.groups=K=o(null),Y=0;Y<W.length;Y++)V=W[Y],K[V[0]]=B[V[1]];return B}),Sw=m,Sw}var Kk;function T5(){if(Kk)return zk;Kk=1;var t=vd(),e=G_();return t({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e}),zk}var Gk={},vw,qk;function RK(){if(qk)return vw;qk=1;var t=Jy(),e=Function.prototype,n=e.apply,r=e.call;return vw=typeof Reflect=="object"&&Reflect.apply||(t?r.bind(n):function(){return r.apply(n,arguments)}),vw}var bw,Yk;function OK(){if(Yk)return bw;Yk=1,T5();var t=xa(),e=S5(),n=G_(),r=jr(),i=wa(),s=F_(),o=i("species"),l=RegExp.prototype;return bw=function(u,d,f,g){var m=i(u),S=!r(function(){var C={};return C[m]=function(){return 7},""[u](C)!==7}),b=S&&!r(function(){var C=!1,_=/a/;return u==="split"&&(_={},_.constructor={},_.constructor[o]=function(){return _},_.flags="",_[m]=/./[m]),_.exec=function(){return C=!0,null},_[m](""),!C});if(!S||!b||f){var v=/./[m],w=d(m,""[u],function(C,_,M,I,A){var R=_.exec;return R===n||R===l.exec?S&&!A?{done:!0,value:t(v,_,M,I)}:{done:!0,value:t(C,M,_,I)}:{done:!1}});e(String.prototype,u,w[0]),e(l,m,w[1])}g&&s(l[m],"sham",!0)},bw}var xw,Vk;function jK(){if(Vk)return xw;Vk=1;var t=Gn(),e=Dc(),n=ep(),r=Sd(),i=t("".charAt),s=t("".charCodeAt),o=t("".slice),l=function(u){return function(d,f){var g=n(r(d)),m=e(f),S=g.length,b,v;return m<0||m>=S?u?"":void 0:(b=s(g,m),b<55296||b>56319||m+1===S||(v=s(g,m+1))<56320||v>57343?u?i(g,m):b:u?o(g,m,m+2):(b-55296<<10)+(v-56320)+65536)}};return xw={codeAt:l(!1),charAt:l(!0)},xw}var ww,Wk;function DK(){if(Wk)return ww;Wk=1;var t=jK().charAt;return ww=function(e,n,r){return n+(r?t(e,n).length:1)},ww}var Cw,Xk;function I5(){if(Xk)return Cw;Xk=1;var t=Gn(),e=Xf(),n=Math.floor,r=t("".charAt),i=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;return Cw=function(u,d,f,g,m,S){var b=f+u.length,v=g.length,w=l;return m!==void 0&&(m=e(m),w=o),i(S,w,function(C,_){var M;switch(r(_,0)){case"$":return"$";case"&":return u;case"`":return s(d,0,f);case"'":return s(d,b);case"<":M=m[s(_,1,-1)];break;default:var I=+_;if(I===0)return C;if(I>v){var A=n(I/10);return A===0?C:A<=v?g[A-1]===void 0?r(_,1):g[A-1]+r(_,1):C}M=g[I-1]}return M===void 0?"":M})},Cw}var _w,Zk;function LK(){if(Zk)return _w;Zk=1;var t=xa(),e=jc(),n=Dr(),r=yd(),i=G_(),s=TypeError;return _w=function(o,l){var u=o.exec;if(n(u)){var d=t(u,o,l);return d!==null&&e(d),d}if(r(o)==="RegExp")return t(i,o,l);throw new s("RegExp#exec called on incompatible receiver")},_w}var Qk;function NK(){if(Qk)return Gk;Qk=1;var t=RK(),e=xa(),n=Gn(),r=OK(),i=jr(),s=jc(),o=Dr(),l=eS(),u=Dc(),d=v5(),f=ep(),g=Sd(),m=DK(),S=N_(),b=I5(),v=LK(),w=wa(),C=w("replace"),_=Math.max,M=Math.min,I=n([].concat),A=n([].push),R=n("".indexOf),D=n("".slice),L=function(F){return F===void 0?F:String(F)},G=function(){return"a".replace(/./,"$0")==="$0"}(),k=function(){return/./[C]?/./[C]("a","$0")==="":!1}(),$=!i(function(){var F=/./;return F.exec=function(){var N=[];return N.groups={a:"7"},N},"".replace(F,"$<a>")!=="7"});return r("replace",function(F,N,B){var Y=k?"$":"$0";return[function(V,W){var ee=g(this),H=l(V)?void 0:S(V,C);return H?e(H,V,ee,W):e(N,f(ee),V,W)},function(K,V){var W=s(this),ee=f(K);if(typeof V=="string"&&R(V,Y)===-1&&R(V,"$<")===-1){var H=B(N,W,ee,V);if(H.done)return H.value}var te=o(V);te||(V=f(V));var ge=W.global,de;ge&&(de=W.unicode,W.lastIndex=0);for(var Se=[],me;me=v(W,ee),!(me===null||(A(Se,me),!ge));){var Me=f(me[0]);Me===""&&(W.lastIndex=m(ee,d(W.lastIndex),de))}for(var Ne="",we=0,Ie=0;Ie<Se.length;Ie++){me=Se[Ie];for(var ke=f(me[0]),Ue=_(M(u(me.index),ee.length),0),Nt=[],ot,Mt=1;Mt<me.length;Mt++)A(Nt,L(me[Mt]));var wt=me.groups;if(te){var ft=I([ke],Nt,Ue,ee);wt!==void 0&&A(ft,wt),ot=f(t(V,void 0,ft))}else ot=b(ke,ee,Ue,Nt,wt,V);Ue>=we&&(Ne+=D(ee,we,Ue)+ot,we=Ue+ke.length)}return Ne+D(ee,we)}]},!$||!G||k),Gk}var Jk={},Ew,eR;function zK(){if(eR)return Ew;eR=1;var t=Oc(),e=yd(),n=wa(),r=n("match");return Ew=function(i){var s;return t(i)&&((s=i[r])!==void 0?!!s:e(i)==="RegExp")},Ew}var Pw,tR;function $K(){if(tR)return Pw;tR=1;var t=xa(),e=Tl(),n=i5(),r=P5(),i=RegExp.prototype;return Pw=function(s){var o=s.flags;return o===void 0&&!("flags"in i)&&!e(s,"flags")&&n(i,s)?t(r,s):o},Pw}var nR;function BK(){if(nR)return Jk;nR=1;var t=vd(),e=xa(),n=Gn(),r=Sd(),i=Dr(),s=eS(),o=zK(),l=ep(),u=N_(),d=$K(),f=I5(),g=wa(),m=l5(),S=g("replace"),b=TypeError,v=n("".indexOf),w=n("".replace),C=n("".slice),_=Math.max;return t({target:"String",proto:!0},{replaceAll:function(I,A){var R=r(this),D,L,G,k,$,F,N,B,Y,K,V=0,W="";if(!s(I)){if(D=o(I),D&&(L=l(r(d(I))),!~v(L,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(G=u(I,S),G)return e(G,I,R,A);if(m&&D)return w(l(R),I,A)}for(k=l(R),$=l(I),F=i(A),F||(A=l(A)),N=$.length,B=_(1,N),Y=v(k,$);Y!==-1;)K=F?l(A($,Y,k)):f($,k,Y,[],void 0,A),W+=C(k,V,Y)+K,V=Y+N,Y=Y+B>k.length?-1:v(k,$,Y+B);return V<k.length&&(W+=C(k,V)),W}}),Jk}var Tw,rR;function FK(){if(rR)return Tw;rR=1,T5(),NK(),BK();var t=Jf();return Tw=t("String","replaceAll"),Tw}var Iw,iR;function UK(){if(iR)return Iw;iR=1;var t=FK();return Iw=t,Iw}UK();function M5(t){return t&&typeof t=="object"&&"parents"in t}function A5(t){for(let e=0,n=t.parents.length;e<n;e++)if(t.parents[e].__unsafe__getWithoutCapture(!0),t.parents[e].lastChangedEpoch!==t.parentEpochs[e])return!0;return!1}function cy(t,e){if(t.children.remove(e)&&t.children.isEmpty&&M5(t))for(let n=0,r=t.parents.length;n<r;n++)cy(t.parents[n],t)}function q_(t,e){if(t.children.add(e)&&M5(t))for(let n=0,r=t.parents.length;n<r;n++)q_(t.parents[n],t)}function k5(t,e){return t===e||Object.is(t,e)||!!(t&&e&&typeof t.equals=="function"&&t.equals(e))}function Il(t,e){const n=Symbol.for(`com.tldraw.state/${t}`),r=globalThis;return r[n]??(r[n]=e()),r[n]}const ha=Il("empty_array",()=>Object.freeze([])),sR=8;class uy{constructor(){O(this,"arraySize",0);O(this,"array",Array(sR));O(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(e){if(this.array)return this.array.indexOf(e)!==-1?!1:this.arraySize<sR?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0);if(this.set)return this.set.has(e)?!1:(this.set.add(e),!0);throw new Error("no set or array")}remove(e){if(this.array){const n=this.array.indexOf(e);return n===-1?!1:(this.array[n]=void 0,this.arraySize--,n!==this.arraySize&&(this.array[n]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(e)?(this.set.delete(e),!0):!1;throw new Error("no set or array")}visit(e){if(this.array){for(let n=0;n<this.arraySize;n++){const r=this.array[n];typeof r<"u"&&e(r)}return}if(this.set){this.set.forEach(e);return}throw new Error("no set or array")}has(e){return this.array?this.array.indexOf(e)!==-1:this.set.has(e)}clear(){this.set?this.set.clear():(this.arraySize=0,this.array=[])}size(){return this.set?this.set.size:this.arraySize}}const wi=Symbol.for("com.tldraw.state/RESET_VALUE");class R5{constructor(e){O(this,"index",0);O(this,"buffer");this.capacity=e,this.buffer=new Array(e)}pushEntry(e,n,r){if(r!==void 0){if(r===wi){this.clear();return}this.buffer[this.index]=[e,n,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){const{index:n,capacity:r,buffer:i}=this;for(let s=0;s<r;s++){const o=(n-1+r-s)%r,l=i[o];if(!l)return wi;const[u,d]=l;if(s===0&&e>=d)return[];if(u<=e&&e<d){const f=s+1,g=new Array(f);for(let m=0;m<f;m++)g[m]=i[(o+m)%r][2];return g}}return wi}}class HK{constructor(e,n){O(this,"offset",0);O(this,"maybeRemoved");this.below=e,this.child=n}}const Jt=Il("capture",()=>({stack:null}));function jg(t){const e=Jt.stack;Jt.stack=null;try{return t()}finally{Jt.stack=e}}function O5(t){Jt.stack=new HK(Jt.stack,t),t.parentSet.clear()}function j5(){const t=Jt.stack;if(Jt.stack=t.below,t.offset<t.child.parents.length){for(let e=t.offset;e<t.child.parents.length;e++){const n=t.child.parents[e];t.child.parentSet.has(n)||cy(n,t.child)}t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset}if(t.maybeRemoved)for(let e=0;e<t.maybeRemoved.length;e++){const n=t.maybeRemoved[e];t.child.parentSet.has(n)||cy(n,t.child)}}function dy(t){if(Jt.stack){if(Jt.stack.child.parentSet.has(t))return;if(Jt.stack.child.parentSet.add(t),Jt.stack.child.isActivelyListening&&q_(t,Jt.stack.child),Jt.stack.offset<Jt.stack.child.parents.length){const n=Jt.stack.child.parents[Jt.stack.offset];n!==t&&(Jt.stack.maybeRemoved?Jt.stack.maybeRemoved.push(n):Jt.stack.maybeRemoved=[n])}Jt.stack.child.parents[Jt.stack.offset]=t,Jt.stack.child.parentEpochs[Jt.stack.offset]=t.lastChangedEpoch,Jt.stack.offset++}}const dl=-1;class KK{constructor(e,n,r){O(this,"_isActivelyListening",!1);O(this,"lastTraversedEpoch",dl);O(this,"lastReactedEpoch",dl);O(this,"_scheduleCount",0);O(this,"parentSet",new uy);O(this,"parentEpochs",[]);O(this,"parents",[]);O(this,"_scheduleEffect");O(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=e,this.runEffect=n,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==Xr()){if(this.parents.length&&!A5(this)){this.lastReactedEpoch=Xr();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let e=0,n=this.parents.length;e<n;e++)q_(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,n=this.parents.length;e<n;e++)cy(this.parents[e],this)}execute(){try{O5(this);const e=Xr(),n=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=e,n}finally{j5()}}}const bd=Il("EffectScheduler",()=>KK);function co(t,e,n){const r=new bd(t,e,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function GK(t,e,n){const r=new bd(t,e,n);return{scheduler:r,start:i=>{const s=(i==null?void 0:i.force)??!1;r.attach(),s?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class qK{constructor(e){O(this,"initialAtomValues",new Map);this.parent=e}get isRoot(){return this.parent===null}commit(){if(bt.globalIsReacting)for(const e of this.initialAtomValues.keys())L5(e);else this.isRoot?D5(this.initialAtomValues.keys()):this.initialAtomValues.forEach((e,n)=>{this.parent.initialAtomValues.has(n)||this.parent.initialAtomValues.set(n,e)})}abort(){bt.globalEpoch++,this.initialAtomValues.forEach((e,n)=>{var r;n.set(e),(r=n.historyBuffer)==null||r.clear()}),this.commit()}}const bt=Il("transactions",()=>({globalEpoch:dl+1,globalIsReacting:!1,currentTransaction:null,cleanupReactors:null,reactionEpoch:dl+1}));function YK(){return bt.reactionEpoch}function Xr(){return bt.globalEpoch}function VK(){return bt.globalIsReacting}function Y_(t,e){e.lastTraversedEpoch!==bt.globalEpoch&&(e.lastTraversedEpoch=bt.globalEpoch,e instanceof bd?t.add(e):e.children.visit(n=>Y_(t,n)))}function D5(t){var n;if(bt.globalIsReacting)throw new Error("flushChanges cannot be called during a reaction");const e=bt.currentTransaction;try{bt.currentTransaction=null,bt.globalIsReacting=!0,bt.reactionEpoch=bt.globalEpoch;const r=new Set;for(const s of t)s.children.visit(o=>Y_(r,o));for(const s of r)s.maybeScheduleEffect();let i=0;for(;(n=bt.cleanupReactors)!=null&&n.size;){if(i++>1e3)throw new Error("Reaction update depth limit exceeded");const s=bt.cleanupReactors;bt.cleanupReactors=null;for(const o of s)o.maybeScheduleEffect()}}finally{bt.cleanupReactors=null,bt.globalIsReacting=!1,bt.currentTransaction=e}}function WK(t,e){bt.currentTransaction?bt.currentTransaction.initialAtomValues.has(t)||bt.currentTransaction.initialAtomValues.set(t,e):bt.globalIsReacting?L5(t):D5([t])}function L5(t){const e=bt.cleanupReactors??(bt.cleanupReactors=new Set);t.children.visit(n=>Y_(e,n))}function XK(){bt.globalEpoch++}function ZK(t){const e=new qK(bt.currentTransaction);bt.currentTransaction=e;try{let n,r=!1;try{n=t(()=>r=!0)}catch(i){throw e.abort(),i}return r?e.abort():e.commit(),n}finally{bt.currentTransaction=bt.currentTransaction.parent}}function uo(t){return bt.currentTransaction?t():ZK(t)}class QK{constructor(e,n,r){O(this,"isEqual");O(this,"computeDiff");O(this,"lastChangedEpoch",Xr());O(this,"children",new uy);O(this,"historyBuffer");this.name=e,this.current=n,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new R5(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(e){return this.current}get(){return dy(this),this.current}set(e,n){var i,s;if(((i=this.isEqual)==null?void 0:i.call(this,this.current,e))??k5(this.current,e))return this.current;XK(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,Xr(),n??((s=this.computeDiff)==null?void 0:s.call(this,this.current,e,this.lastChangedEpoch,Xr()))??wi),this.lastChangedEpoch=Xr();const r=this.current;return this.current=e,WK(this,r),e}update(e){return this.set(e(this.current))}getDiffSince(e){var n;return dy(this),e>=this.lastChangedEpoch?ha:((n=this.historyBuffer)==null?void 0:n.getChangesSince(e))??wi}}const JK=Il("Atom",()=>QK);function On(t,e,n){return new JK(t,e,n)}let oR=!1;function eG(){oR||(oR=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const nf=Symbol.for("com.tldraw.state/UNINITIALIZED");function mc(t){return t===nf}const nC=Il("WithDiff",()=>class{constructor(e,n){this.value=e,this.diff=n}});function rf(t,e){return new nC(t,e)}class tG{constructor(e,n,r){O(this,"lastChangedEpoch",dl);O(this,"lastTraversedEpoch",dl);O(this,"lastCheckedEpoch",dl);O(this,"parentSet",new uy);O(this,"parents",[]);O(this,"parentEpochs",[]);O(this,"children",new uy);O(this,"historyBuffer");O(this,"state",nf);O(this,"error",null);O(this,"computeDiff");O(this,"isEqual");this.name=e,this.derive=n,r!=null&&r.historyLength&&(this.historyBuffer=new R5(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??k5}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(e){var i;const n=this.lastChangedEpoch===dl,r=Xr();if(!n&&(this.lastCheckedEpoch===r||this.isActivelyListening&&VK()&&this.lastTraversedEpoch<YK()||!A5(this)))if(this.lastCheckedEpoch=r,this.error){if(e)return this.state;throw this.error.thrownValue}else return this.state;try{O5(this);const s=this.derive(this.state,this.lastCheckedEpoch),o=s instanceof nC?s.value:s,l=this.state===nf;if(l||!this.isEqual(o,this.state)){if(this.historyBuffer&&!l){const u=s instanceof nC?s.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,Xr(),u??((i=this.computeDiff)==null?void 0:i.call(this,this.state,o,this.lastCheckedEpoch,Xr()))??wi)}this.lastChangedEpoch=Xr(),this.state=o}return this.error=null,this.lastCheckedEpoch=Xr(),this.state}catch(s){if(this.state!==nf&&(this.state=nf,this.lastChangedEpoch=Xr()),this.lastCheckedEpoch=Xr(),this.historyBuffer&&this.historyBuffer.clear(),this.error={thrownValue:s},!e)throw s;return this.state}finally{j5()}}get(){try{return this.__unsafe__getWithoutCapture()}finally{dy(this)}}getDiffSince(e){var n;return this.__unsafe__getWithoutCapture(!0),dy(this),e>=this.lastChangedEpoch?ha:((n=this.historyBuffer)==null?void 0:n.getChangesSince(e))??wi}}const rS=Il("Computed",()=>tG);function nG(t={},e,n,r){const i=r.value,s=Symbol.for("__@tldraw/state__computed__"+n);return r.value=function(){let o=this[s];return o||(o=new rS(n,i.bind(this),t),Object.defineProperty(this,s,{enumerable:!1,configurable:!1,writable:!1,value:o})),o.get()},r.value[N5]=!0,r}function rG(t={},e,n,r){const i=r.get,s=Symbol.for("__@tldraw/state__computed__"+n);return r.get=function(){let o=this[s];return o||(o=new rS(n,i.bind(this),t),Object.defineProperty(this,s,{enumerable:!1,configurable:!1,writable:!1,value:o})),o.get()},r}function iG(t,e,n){xt(n.kind==="method","@computed can only be used on methods");const r=Symbol.for("__@tldraw/state__computed__"+String(n.name)),i=function(){let s=this[r];return s||(s=new rS(String(n.name),e.bind(this),t),Object.defineProperty(this,r,{enumerable:!1,configurable:!1,writable:!1,value:s})),s.get()};return i[N5]=!0,i}function aR(t={},e){if(e.length===2){const[n,r]=e;return iG(t,n,r)}else{const[n,r,i]=e;return i.get?(eG(),rG(t,n,r,i)):nG(t,n,r,i)}}const N5="@@__isComputedMethod__@@";function he(){if(arguments.length===1){const t=arguments[0];return(...e)=>aR(t,e)}else return typeof arguments[0]=="string"?new rS(arguments[0],arguments[1],arguments[2]):aR(void 0,arguments)}const z5=1,sG=Il("apiVersion",()=>z5);if(sG!==z5)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");El("@tldraw/state","3.8.1","esm");function iS(t,e,n=[]){const r=et.useRef(e);r.current=e;const[i,s,o]=et.useMemo(()=>{let l=null;const u=g=>(l=g,()=>{l=null}),d=new bd(`useStateTracking(${t})`,()=>{var g;return(g=r.current)==null?void 0:g.call(r)},{scheduleEffect(){l==null||l()}});return[d,u,()=>d.scheduleCount]},[t,...n]);return et.useSyncExternalStore(s,o,o),et.useEffect(()=>(i.attach(),i.maybeScheduleEffect(),()=>{i.detach()}),[i]),i.execute()}const lR={apply(t,e,n){return iS(t.displayName??t.name??"tracked(???)",()=>t.apply(e,n))}},oG=Symbol.for("react.memo"),aG=Symbol.for("react.forward_ref");function ir(t){let e=null;const n=t.$$typeof;return n===oG&&(t=t.type,e=t.compare),n===aG?E.memo(E.forwardRef(new Proxy(t.render,lR))):E.memo(new Proxy(t,lR),e)}function V_(t,e,n){return E.useState(()=>{const r=typeof e=="function"?e():e;return On(`useAtom(${t})`,r,n)})[0]}function lG(){const t=arguments[0],e=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return E.useMemo(()=>he(`useComputed(${t})`,e,n),r)}function pl(t,e,n=ha){E.useEffect(()=>{const r=new bd(t,e);return r.attach(),r.execute(),()=>{r.detach()}},n)}function oe(){const t=arguments,e=t.length===3?t[2]:[t[0]],n=t.length===3?t[0]:`useValue(${t[0].name})`,r=E.useRef(!0);r.current=!0;const i=E.useMemo(()=>t.length===1?t[0]:he(n,()=>{if(r.current)return t[1]();try{return t[1]()}catch{return{}}}),e);try{const{subscribe:s,getSnapshot:o}=E.useMemo(()=>({subscribe:l=>co(`useValue(${n})`,()=>{i.get(),l()}),getSnapshot:()=>i.get()}),[i]);return E.useSyncExternalStore(s,o,o)}finally{r.current=!1}}El("@tldraw/state-react","3.8.1","esm");const Kn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2};function mt(t){return`${ne(t.x)},${ne(t.y)} `}function Jr(t,e){return`${ne((t.x+e.x)/2)},${ne((t.y+e.y)/2)} `}const yt=Math.PI,Yt=yt/2,It=yt*2,cG=Math.sin;function Xn(t,e,n){return Math.max(e,typeof n<"u"?Math.min(t,n):t)}function Dg(t,e=1e10){return t?Math.round(t*e)/e:0}function gl(t,e,n=1e-6){return Math.abs(t-e)<=n}function $5(t,e){const n=Math.pow(t-e,2)/Math.pow(t+e,2);return yt*(t+e)*(1+3*n/(10+Math.sqrt(4-3*n)))}function yc(t){return t=t%It,t<0?t=t+It:t===0&&(t=0),t}function tp(t,e){return t=yc(t),e=yc(e),t>e&&(e+=It),e-t}function B5(t,e){return It-tp(t,e)}function xm(t,e){const n=(e-t)%It;return 2*n%It-n}function rC(t){return(It+t)%It}function hy(t,e){const n=It/e;let r=Math.floor((rC(t)+n/2)/n)*n%It;return r<yt&&(r+=It),r>yt&&(r-=It),r}function F5(t,e){return t===e||gl(t%(Math.PI/2)-e%(Math.PI/2),0)}function uG(t){return t*yt/180}function dG(t){return t*180/yt}function bc(t,e,n){return new T(t.x,t.y).add(T.FromAngle(n,e))}function Mw(t,e,n){const r=t/2,i=e/2,s=[];let o=1/0,l=-1/0,u=1/0,d=-1/0;for(let b=0;b<n;b++){const v=It/n,w=-Yt+b*v,C=r+r*Math.cos(w),_=i+i*Math.sin(w);C<o&&(o=C),_<u&&(u=_),C>l&&(l=C),_>d&&(d=_),s.push(new T(C,_))}const f=l-o,g=d-u,m=t-f,S=e-g;if(m!==0||S!==0)for(let b=0;b<s.length;b++){const v=s[b];v.x=(v.x-o)/f*t,v.y=(v.y-u)/g*e}return s}function Bh(t,e,n,r){return t<r&&n<e}function _s(t,e,n,r){const i=Math.max(t,n),s=Math.min(e,r);return i<=s?[i,s]:null}function cR(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}function Ci(t,e){let n=0,r,i;for(let s=0;s<e.length;s++){if(r=e[s],r.x===t.x&&r.y===t.y||(i=e[(s+1)%e.length],T.Dist(t,r)+T.Dist(t,i)===T.Dist(r,i)))return!0;r.y<=t.y?i.y>t.y&&cR(r,i,t)>0&&(n+=1):i.y<=t.y&&cR(r,i,t)<0&&(n-=1)}return n!==0}function ne(t){return Math.round(t*1e4)/1e4}function la(t){return Math.round(t*100)/100}const uR=t=>Math.abs(t)<Number.MAX_SAFE_INTEGER;function ll(t,e,n){return n<0?tp(t,e):B5(t,e)}function iC(t,e,n,r){let i;if(Math.abs(t)>yt){i=xm(e,r);const s=xm(r,n);return Math.abs(i)<Math.abs(s)?i/t:(t-s)/t}else{i=xm(e,r);const s=i/t;return Math.sign(i)!==Math.sign(t)?Math.abs(s)>.5?1:0:s}}function hG(t,e,n,r){const i=2*((e-t)%It)%It-(e-t)%It;return r?(It-Math.abs(i))*(n?1:-1):i}function W_(t,e,n){const r=-2*(t.x*(e.y-n.y)-t.y*(e.x-n.x)+e.x*n.y-n.x*e.y),i=((t.x*t.x+t.y*t.y)*(n.y-e.y)+(e.x*e.x+e.y*e.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(e.y-t.y))/r,s=((t.x*t.x+t.y*t.y)*(e.x-n.x)+(e.x*e.x+e.y*e.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-e.x))/r;return!Number.isFinite(i)||!Number.isFinite(s)?null:new T(i,s)}function fG(t,e,n,r,i){if(n===null)return[T.From(t),T.From(e)];const s=[],o=T.Angle(n,t),l=T.Angle(n,e),u=tp(o,l);for(let d=0;d<i;d++){const f=d/(i-1),g=o+u*f,m=bc(n,r,g);s.push(m)}return s}class T{constructor(e=0,n=0,r=1){this.x=e,this.y=n,this.z=r}get pressure(){return this.z}set(e=this.x,n=this.y,r=this.z){return this.x=e,this.y=n,this.z=r,this}setTo({x:e=0,y:n=0,z:r=1}){return this.x=e,this.y=n,this.z=r,this}rot(e){if(e===0)return this;const{x:n,y:r}=this,i=Math.sin(e),s=Math.cos(e);return this.x=n*s-r*i,this.y=n*i+r*s,this}rotWith(e,n){if(n===0)return this;const r=this.x-e.x,i=this.y-e.y,s=Math.sin(n),o=Math.cos(n);return this.x=e.x+(r*o-i*s),this.y=e.y+(r*s+i*o),this}clone(){const{x:e,y:n,z:r}=this;return new T(e,n,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,n){return this.x-=e,this.y-=n,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,n){return this.x+=e,this.y+=n,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,n){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,n){const r=T.Tan(e,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return T.Dpr(this,e)}cpr(e){return T.Cpr(this,e)}len2(){return T.Len2(this)}len(){return T.Len(this)}pry(e){return T.Pry(this,e)}per(){const{x:e,y:n}=this;return this.x=n,this.y=-e,this}uni(){return T.Uni(this)}tan(e){return T.Tan(this,e)}dist(e){return T.Dist(this,e)}distanceToLineSegment(e,n){return T.DistanceToLineSegment(e,n,this)}slope(e){return T.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return T.Angle(this,e)}toAngle(){return T.ToAngle(this)}lrp(e,n){return this.x=this.x+(e.x-this.x)*n,this.y=this.y+(e.y-this.y)*n,this}equals(e){return T.Equals(this,e)}equalsXY(e,n){return T.EqualsXY(this,e,n)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return T.ToFixed(this)}toString(){return T.ToString(T.ToFixed(this))}toJson(){return T.ToJson(this)}toArray(){return T.ToArray(this)}static Add(e,n){return new T(e.x+n.x,e.y+n.y)}static AddXY(e,n,r){return new T(e.x+n,e.y+r)}static Sub(e,n){return new T(e.x-n.x,e.y-n.y)}static SubXY(e,n,r){return new T(e.x-n,e.y-r)}static AddScalar(e,n){return new T(e.x+n,e.y+n)}static SubScalar(e,n){return new T(e.x-n,e.y-n)}static Div(e,n){return new T(e.x/n,e.y/n)}static Mul(e,n){return new T(e.x*n,e.y*n)}static DivV(e,n){return new T(e.x/n.x,e.y/n.y)}static MulV(e,n){return new T(e.x*n.x,e.y*n.y)}static Neg(e){return new T(-e.x,-e.y)}static Per(e){return new T(e.y,-e.x)}static Abs(e){return new T(Math.abs(e.x),Math.abs(e.y))}static Dist(e,n){return((e.y-n.y)**2+(e.x-n.x)**2)**.5}static DistMin(e,n,r){return(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y)<r**2}static Dist2(e,n){return(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y)}static Dpr(e,n){return e.x*n.x+e.y*n.y}static Cross(e,n){return new T(e.y*n.z-e.z*n.y,e.z*n.x-e.x*n.z)}static Cpr(e,n){return e.x*n.y-n.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return(e.x*e.x+e.y*e.y)**.5}static Pry(e,n){return T.Dpr(e,n)/T.Len(n)}static Uni(e){return T.Div(e,T.Len(e))}static Tan(e,n){return T.Uni(T.Sub(e,n))}static Min(e,n){return new T(Math.min(e.x,n.x),Math.min(e.y,n.y))}static Max(e,n){return new T(Math.max(e.x,n.x),Math.max(e.y,n.y))}static From({x:e,y:n,z:r=1}){return new T(e,n,r)}static FromArray(e){return new T(e[0],e[1])}static Rot(e,n=0){const r=Math.sin(n),i=Math.cos(n);return new T(e.x*i-e.y*r,e.x*r+e.y*i)}static RotWith(e,n,r){const i=e.x-n.x,s=e.y-n.y,o=Math.sin(r),l=Math.cos(r);return new T(n.x+(i*l-s*o),n.y+(i*o+s*l))}static NearestPointOnLineThroughPoint(e,n,r){return T.Mul(n,T.Sub(r,e).pry(n)).add(e)}static NearestPointOnLineSegment(e,n,r,i=!0){if(T.Equals(e,r)||T.Equals(n,r))return T.From(r);const s=T.Tan(n,e),o=T.Add(e,T.Mul(s,T.Sub(r,e).pry(s)));if(i){if(o.x<Math.min(e.x,n.x))return T.Cast(e.x<n.x?e:n);if(o.x>Math.max(e.x,n.x))return T.Cast(e.x>n.x?e:n);if(o.y<Math.min(e.y,n.y))return T.Cast(e.y<n.y?e:n);if(o.y>Math.max(e.y,n.y))return T.Cast(e.y>n.y?e:n)}return o}static DistanceToLineThroughPoint(e,n,r){return T.Dist(r,T.NearestPointOnLineThroughPoint(e,n,r))}static DistanceToLineSegment(e,n,r,i=!0){return T.Dist(r,T.NearestPointOnLineSegment(e,n,r,i))}static Snap(e,n=1){return new T(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}static Cast(e){return e instanceof T?e:T.From(e)}static Slope(e,n){return e.x===n.y?NaN:(e.y-n.y)/(e.x-n.x)}static IsNaN(e){return isNaN(e.x)||isNaN(e.y)}static Angle(e,n){return Math.atan2(n.y-e.y,n.x-e.x)}static Lrp(e,n,r){return T.Sub(n,e).mul(r).add(e)}static Med(e,n){return new T((e.x+n.x)/2,(e.y+n.y)/2)}static Equals(e,n){return Math.abs(e.x-n.x)<1e-4&&Math.abs(e.y-n.y)<1e-4}static EqualsXY(e,n,r){return e.x===n&&e.y===r}static Clockwise(e,n,r){return(r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y)<0}static Rescale(e,n){const r=T.Len(e);return new T(n*e.x/r,n*e.y/r)}static ScaleWithOrigin(e,n,r){return T.Sub(e,r).mul(n).add(r)}static ToFixed(e){return new T(la(e.x),la(e.y))}static ToInt(e){return new T(parseInt(e.x.toFixed(0)),parseInt(e.y.toFixed(0)),parseInt((e.z??0).toFixed(0)))}static ToCss(e){return`${e.x},${e.y}`}static Nudge(e,n,r){return T.Add(e,T.Tan(n,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let n=Math.atan2(e.y,e.x);return n<0&&(n+=Math.PI*2),n}static FromAngle(e,n=1){return new T(Math.cos(e)*n,Math.sin(e)*n)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:n,y:r,z:i}=e;return{x:n,y:r,z:i}}static Average(e){const n=e.length,r=new T(0,0);if(n===0)return r;for(let i=0;i<n;i++)r.add(e[i]);return r.div(n)}static Clamp(e,n,r){return r===void 0?new T(Math.min(Math.max(e.x,n)),Math.min(Math.max(e.y,n))):new T(Math.min(Math.max(e.x,n),r),Math.min(Math.max(e.y,n),r))}static PointsBetween(e,n,r=6){const i=[];for(let s=0;s<r;s++){const o=Kn.easeInQuad(s/(r-1)),l=T.Lrp(e,n,o);l.z=Math.min(1,.5+Math.abs(.5-pG(o))*.65),i.push(l)}return i}static SnapToGrid(e,n=8){return new T(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}}const pG=t=>t<.5?2*t*t:-1+(4-2*t)*t;function U5(t,{initialBounds:e,scaleX:n,scaleY:r,newPoint:i,handle:s}){let o;switch(s){case"bottom_left":case"bottom_right":case"top_left":case"top_right":{o=Math.max(.01,Math.max(Math.abs(n),Math.abs(r)));break}case"left":case"right":{o=Math.max(.01,Math.abs(n));break}case"bottom":case"top":{o=Math.max(.01,Math.abs(r));break}default:throw An(s)}const l=new T(0,0);n<0&&(l.x=-(e.width*o)),r<0&&(l.y=-(e.height*o));const{x:u,y:d}=T.Add(i,l.rot(t.rotation));return{x:u,y:d,props:{scale:o*t.props.scale}}}const gG=(t,e)=>e.some(n=>t instanceof n);let dR,hR;function mG(){return dR||(dR=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yG(){return hR||(hR=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const H5=new WeakMap,sC=new WeakMap,K5=new WeakMap,Aw=new WeakMap,X_=new WeakMap;function SG(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(fa(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&H5.set(n,t)}).catch(()=>{}),X_.set(e,t),e}function vG(t){if(sC.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});sC.set(t,e)}let oC={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return sC.get(t);if(e==="objectStoreNames")return t.objectStoreNames||K5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return fa(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bG(t){oC=t(oC)}function xG(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(kw(this),e,...n);return K5.set(r,e.sort?e.sort():[e]),fa(r)}:yG().includes(t)?function(...e){return t.apply(kw(this),e),fa(H5.get(this))}:function(...e){return fa(t.apply(kw(this),e))}}function wG(t){return typeof t=="function"?xG(t):(t instanceof IDBTransaction&&vG(t),gG(t,mG())?new Proxy(t,oC):t)}function fa(t){if(t instanceof IDBRequest)return SG(t);if(Aw.has(t))return Aw.get(t);const e=wG(t);return e!==t&&(Aw.set(t,e),X_.set(e,t)),e}const kw=t=>X_.get(t);function G5(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=fa(o);return r&&o.addEventListener("upgradeneeded",u=>{r(fa(o.result),u.oldVersion,u.newVersion,fa(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}function q5(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),fa(n).then(()=>{})}const CG=["get","getKey","getAll","getAllKeys","count"],_G=["put","add","delete","clear"],Rw=new Map;function fR(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rw.get(e))return Rw.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=_G.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||CG.includes(n)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),i&&u.done]))[0]};return Rw.set(e,s),s}bG(t=>({...t,get:(e,n,r)=>fR(e,n)||t.get(e,n,r),has:(e,n)=>!!fR(e,n)||t.has(e,n)}));const EG="TLDRAW_DOCUMENT_v2",PG="TLDRAW_ASSET_STORE_v1",Y5="TLDRAW_DB_NAME_INDEX_v2",lt={Records:"records",Schema:"schema",SessionState:"session_state",Assets:"assets"};async function V5(t){const e=EG+t;return IG(e),await G5(e,4,{upgrade(n){n.objectStoreNames.contains(lt.Records)||n.createObjectStore(lt.Records),n.objectStoreNames.contains(lt.Schema)||n.createObjectStore(lt.Schema),n.objectStoreNames.contains(lt.SessionState)||n.createObjectStore(lt.SessionState),n.objectStoreNames.contains(lt.Assets)||n.createObjectStore(lt.Assets)}})}async function TG(t){const e=window.indexedDB.databases?(await window.indexedDB.databases()).map(m=>m.name):Z_(),n=PG+t;if(!e.find(m=>m===n))return;const i=await G5(n,1,{upgrade(m){m.objectStoreNames.contains("assets")||m.createObjectStore("assets")}});if(!i.objectStoreNames.contains("assets"))return;const s=i.transaction(["assets"],"readonly"),o=s.objectStore("assets"),l=await o.getAllKeys(),u=await Promise.all(l.map(async m=>[m,await o.get(m)]));await s.done;const d=await V5(t),f=d.transaction([lt.Assets],"readwrite"),g=f.objectStore(lt.Assets);for(const[m,S]of u)g.put(S,m);await f.done,i.close(),d.close(),await q5(n)}const Pf=class Pf{constructor(e){O(this,"getDbPromise");O(this,"isClosed",!1);O(this,"pendingTransactionSet",new Set);Pf.connectedInstances.add(this),this.getDbPromise=(async()=>(await TG(e),await V5(e)))()}getDb(){return this.getDbPromise}pending(){return Promise.allSettled([this.getDbPromise,...this.pendingTransactionSet]).then(Tf)}async close(){this.isClosed||(this.isClosed=!0,await this.pending(),(await this.getDb()).close(),Pf.connectedInstances.delete(this))}tx(e,n,r){const i=(async()=>{xt(!this.isClosed,"db is closed");const o=(await this.getDb()).transaction(n,e),l=o.done.catch(u=>{if(!this.isClosed)throw u});try{return await r(o)}finally{this.isClosed?o.abort():await l}})();return this.pendingTransactionSet.add(i),i.finally(()=>this.pendingTransactionSet.delete(i)),i}async load({sessionId:e}={}){return await this.tx("readonly",[lt.Records,lt.Schema,lt.SessionState],async n=>{var u,d;const r=n.objectStore(lt.Records),i=n.objectStore(lt.Schema),s=n.objectStore(lt.SessionState);let o=e?(u=await s.get(e))==null?void 0:u.snapshot:null;return o||(o=(d=(await s.getAll()).sort((g,m)=>g.updatedAt-m.updatedAt).pop())==null?void 0:d.snapshot),{records:await r.getAll(),schema:await i.get(lt.Schema),sessionStateSnapshot:o}})}async storeChanges({schema:e,changes:n,sessionId:r,sessionStateSnapshot:i}){await this.tx("readwrite",[lt.Records,lt.Schema,lt.SessionState],async s=>{const o=s.objectStore(lt.Records),l=s.objectStore(lt.Schema),u=s.objectStore(lt.SessionState);for(const[d,f]of Object.entries(n.added))await o.put(f,d);for(const[d,f]of Object.values(n.updated))await o.put(f,f.id);for(const d of Object.keys(n.removed))await o.delete(d);l.put(e.serialize(),lt.Schema),i&&r?u.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together")})}async storeSnapshot({schema:e,snapshot:n,sessionId:r,sessionStateSnapshot:i}){await this.tx("readwrite",[lt.Records,lt.Schema,lt.SessionState],async s=>{const o=s.objectStore(lt.Records),l=s.objectStore(lt.Schema),u=s.objectStore(lt.SessionState);await o.clear();for(const[d,f]of Object.entries(n))await o.put(f,d);l.put(e.serialize(),lt.Schema),i&&r?u.put({snapshot:i,updatedAt:Date.now(),id:r},r):(i||r)&&console.error("sessionStateSnapshot and instanceId must be provided together")})}async pruneSessions(){await this.tx("readwrite",[lt.SessionState],async e=>{const n=e.objectStore(lt.SessionState),r=(await n.getAll()).sort((s,o)=>s.updatedAt-o.updatedAt);if(r.length<10){await e.done;return}const i=r.slice(0,r.length-10);for(const{id:s}of i)await n.delete(s)})}async getAsset(e){return await this.tx("readonly",[lt.Assets],async n=>await n.objectStore(lt.Assets).get(e))}async storeAsset(e,n){await this.tx("readwrite",[lt.Assets],async r=>{await r.objectStore(lt.Assets).put(n,e)})}};O(Pf,"connectedInstances",new Set);let fy=Pf;function Z_(){const t=JSON.parse(O_(Y5)||"[]")??[];return Array.isArray(t)?t:[]}function IG(t){const e=new Set(Z_());e.add(t),j_(Y5,JSON.stringify([...e]))}class wm{constructor(e){O(this,"nextValue");O(this,"diff");this.previousValue=e}get(){var r,i,s,o;const e=((i=(r=this.diff)==null?void 0:r.removed)==null?void 0:i.size)??0,n=((o=(s=this.diff)==null?void 0:s.added)==null?void 0:o.size)??0;if(!(e===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(e,n){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(e):((i=this.diff).added??(i.added=new Set),this.diff.added.add(e))}add(e){var i,s,o;const n=this.previousValue.has(e);if(n)return((s=(i=this.diff)==null?void 0:i.removed)==null?void 0:s.has(e))?this._add(e,n):void 0;(o=this.nextValue)!=null&&o.has(e)||this._add(e,n)}_remove(e,n){var r,i;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(e)):(i=this.diff.added)==null||i.delete(e)}remove(e){var i,s,o,l;const n=this.previousValue.has(e);if(!n)return((s=(i=this.diff)==null?void 0:i.added)==null?void 0:s.has(e))?this._remove(e,n):void 0;(l=(o=this.diff)==null?void 0:o.removed)!=null&&l.has(e)||this._remove(e,n)}}class sS{constructor(e,n){O(this,"createDefaultProperties");O(this,"validator");O(this,"ephemeralKeys");O(this,"ephemeralKeySet");O(this,"scope");this.typeName=e,this.createDefaultProperties=n.createDefaultProperties,this.validator=n.validator??{validate:i=>i},this.scope=n.scope??"document",this.ephemeralKeys=n.ephemeralKeys;const r=new Set;if(n.ephemeralKeys)for(const[i,s]of ri(n.ephemeralKeys))s&&r.add(i);this.ephemeralKeySet=r}create(e){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,i]of Object.entries(e))i!==void 0&&(n[r]=i);return n.typeName=this.typeName,n}clone(e){return{...Xt(e),id:this.createId()}}createId(e){return this.typeName+":"+(e??At())}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw new Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isInstance(e){return(e==null?void 0:e.typeName)===this.typeName}isId(e){if(!e)return!1;for(let n=0;n<this.typeName.length;n++)if(e[n]!==this.typeName[n])return!1;return e[this.typeName.length]===":"}withDefaultProperties(e){return new sS(this.typeName,{createDefaultProperties:e,validator:this.validator,scope:this.scope,ephemeralKeys:this.ephemeralKeys})}validate(e,n){return n&&this.validator.validateUsingKnownGoodVersion?this.validator.validateUsingKnownGoodVersion(n,e):this.validator.validate(e)}}function wo(t,e){return new sS(t,{createDefaultProperties:()=>({}),validator:e.validator,scope:e.scope,ephemeralKeys:e.ephemeralKeys})}function py(){return{added:{},updated:{},removed:{}}}function aC(t){const e={added:t.removed,removed:t.added,updated:{}};for(const[n,r]of Object.values(t.updated))e.updated[n.id]=[r,n];return e}function W5(t){return Object.keys(t.added).length===0&&Object.keys(t.updated).length===0&&Object.keys(t.removed).length===0}function Q_(t){const e={added:{},removed:{},updated:{}};return mf(e,t),e}function mf(t,e){for(const n of e){for(const[r,i]of ri(n.added))if(t.removed[r]){const s=t.removed[r];delete t.removed[r],s!==i&&(t.updated[r]=[s,i])}else t.added[r]=i;for(const[r,[i,s]]of ri(n.updated)){if(t.added[r]){t.added[r]=s,delete t.updated[r],delete t.removed[r];continue}if(t.updated[r]){t.updated[r]=[t.updated[r][0],s],delete t.removed[r];continue}t.updated[r]=n.updated[r],delete t.removed[r]}for(const[r,i]of ri(n.removed))t.added[r]?delete t.added[r]:t.updated[r]?(t.removed[r]=t.updated[r][0],delete t.updated[r]):t.removed[r]=i}}var sf={exports:{}};sf.exports;var pR;function MG(){return pR||(pR=1,function(t,e){var n=200,r="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,l="[object Arguments]",u="[object Array]",d="[object AsyncFunction]",f="[object Boolean]",g="[object Date]",m="[object Error]",S="[object Function]",b="[object GeneratorFunction]",v="[object Map]",w="[object Number]",C="[object Null]",_="[object Object]",M="[object Promise]",I="[object Proxy]",A="[object RegExp]",R="[object Set]",D="[object String]",L="[object Symbol]",G="[object Undefined]",k="[object WeakMap]",$="[object ArrayBuffer]",F="[object DataView]",N="[object Float32Array]",B="[object Float64Array]",Y="[object Int8Array]",K="[object Int16Array]",V="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",H="[object Uint16Array]",te="[object Uint32Array]",ge=/[\\^$.*+?()[\]{}|]/g,de=/^\[object .+?Constructor\]$/,Se=/^(?:0|[1-9]\d*)$/,me={};me[N]=me[B]=me[Y]=me[K]=me[V]=me[W]=me[ee]=me[H]=me[te]=!0,me[l]=me[u]=me[$]=me[f]=me[F]=me[g]=me[m]=me[S]=me[v]=me[w]=me[_]=me[A]=me[R]=me[D]=me[k]=!1;var Me=typeof ti=="object"&&ti&&ti.Object===Object&&ti,Ne=typeof self=="object"&&self&&self.Object===Object&&self,we=Me||Ne||Function("return this")(),Ie=e&&!e.nodeType&&e,ke=Ie&&!0&&t&&!t.nodeType&&t,Ue=ke&&ke.exports===Ie,Nt=Ue&&Me.process,ot=function(){try{return Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Mt=ot&&ot.isTypedArray;function wt(U,X){for(var pe=-1,Te=U==null?0:U.length,_t=0,Xe=[];++pe<Te;){var Ht=U[pe];X(Ht,pe,U)&&(Xe[_t++]=Ht)}return Xe}function ft(U,X){for(var pe=-1,Te=X.length,_t=U.length;++pe<Te;)U[_t+pe]=X[pe];return U}function jn(U,X){for(var pe=-1,Te=U==null?0:U.length;++pe<Te;)if(X(U[pe],pe,U))return!0;return!1}function dn(U,X){for(var pe=-1,Te=Array(U);++pe<U;)Te[pe]=X(pe);return Te}function lr(U){return function(X){return U(X)}}function Tr(U,X){return U.has(X)}function ls(U,X){return U==null?void 0:U[X]}function qe(U){var X=-1,pe=Array(U.size);return U.forEach(function(Te,_t){pe[++X]=[_t,Te]}),pe}function jd(U,X){return function(pe){return U(X(pe))}}function Br(U){var X=-1,pe=Array(U.size);return U.forEach(function(Te){pe[++X]=Te}),pe}var Dd=Array.prototype,Bc=Function.prototype,Ao=Object.prototype,cs=we["__core-js_shared__"],Fc=Bc.toString,ae=Ao.hasOwnProperty,Ce=function(){var U=/[^.]+$/.exec(cs&&cs.keys&&cs.keys.IE_PROTO||"");return U?"Symbol(src)_1."+U:""}(),He=Ao.toString,Ct=RegExp("^"+Fc.call(ae).replace(ge,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nn=Ue?we.Buffer:void 0,Fr=we.Symbol,Ur=we.Uint8Array,rn=Ao.propertyIsEnumerable,us=Dd.splice,ji=Fr?Fr.toStringTag:void 0,ds=Object.getOwnPropertySymbols,Di=nn?nn.isBuffer:void 0,ko=jd(Object.keys,Object),hs=ui(we,"DataView"),Bs=ui(we,"Map"),Ro=ui(we,"Promise"),Ld=ui(we,"Set"),Uc=ui(we,"WeakMap"),Ia=ui(Object,"create"),Nd=ys(hs),Ll=ys(Bs),xv=ys(Ro),Pp=ys(Ld),Tp=ys(Uc),zd=Fr?Fr.prototype:void 0,Hc=zd?zd.valueOf:void 0;function Oo(U){var X=-1,pe=U==null?0:U.length;for(this.clear();++X<pe;){var Te=U[X];this.set(Te[0],Te[1])}}function Fs(){this.__data__=Ia?Ia(null):{},this.size=0}function $n(U){var X=this.has(U)&&delete this.__data__[U];return this.size-=X?1:0,X}function cr(U){var X=this.__data__;if(Ia){var pe=X[U];return pe===r?void 0:pe}return ae.call(X,U)?X[U]:void 0}function Ma(U){var X=this.__data__;return Ia?X[U]!==void 0:ae.call(X,U)}function $d(U,X){var pe=this.__data__;return this.size+=this.has(U)?0:1,pe[U]=Ia&&X===void 0?r:X,this}Oo.prototype.clear=Fs,Oo.prototype.delete=$n,Oo.prototype.get=cr,Oo.prototype.has=Ma,Oo.prototype.set=$d;function fs(U){var X=-1,pe=U==null?0:U.length;for(this.clear();++X<pe;){var Te=U[X];this.set(Te[0],Te[1])}}function wv(){this.__data__=[],this.size=0}function Ip(U){var X=this.__data__,pe=qn(X,U);if(pe<0)return!1;var Te=X.length-1;return pe==Te?X.pop():us.call(X,pe,1),--this.size,!0}function Nl(U){var X=this.__data__,pe=qn(X,U);return pe<0?void 0:X[pe][1]}function Bd(U){return qn(this.__data__,U)>-1}function jo(U,X){var pe=this.__data__,Te=qn(pe,U);return Te<0?(++this.size,pe.push([U,X])):pe[Te][1]=X,this}fs.prototype.clear=wv,fs.prototype.delete=Ip,fs.prototype.get=Nl,fs.prototype.has=Bd,fs.prototype.set=jo;function Hr(U){var X=-1,pe=U==null?0:U.length;for(this.clear();++X<pe;){var Te=U[X];this.set(Te[0],Te[1])}}function zl(){this.size=0,this.__data__={hash:new Oo,map:new(Bs||fs),string:new Oo}}function Aa(U){var X=Fl(this,U).delete(U);return this.size-=X?1:0,X}function Pn(U){return Fl(this,U).get(U)}function Mp(U){return Fl(this,U).has(U)}function Ap(U,X){var pe=Fl(this,U),Te=pe.size;return pe.set(U,X),this.size+=pe.size==Te?0:1,this}Hr.prototype.clear=zl,Hr.prototype.delete=Aa,Hr.prototype.get=Pn,Hr.prototype.has=Mp,Hr.prototype.set=Ap;function Li(U){var X=-1,pe=U==null?0:U.length;for(this.__data__=new Hr;++X<pe;)this.add(U[X])}function ka(U){return this.__data__.set(U,r),this}function ps(U){return this.__data__.has(U)}Li.prototype.add=Li.prototype.push=ka,Li.prototype.has=ps;function Us(U){var X=this.__data__=new fs(U);this.size=X.size}function kp(){this.__data__=new fs,this.size=0}function Rp(U){var X=this.__data__,pe=X.delete(U);return this.size=X.size,pe}function Cv(U){return this.__data__.get(U)}function Kc(U){return this.__data__.has(U)}function Gc(U,X){var pe=this.__data__;if(pe instanceof fs){var Te=pe.__data__;if(!Bs||Te.length<n-1)return Te.push([U,X]),this.size=++pe.size,this;pe=this.__data__=new Hr(Te)}return pe.set(U,X),this.size=pe.size,this}Us.prototype.clear=kp,Us.prototype.delete=Rp,Us.prototype.get=Cv,Us.prototype.has=Kc,Us.prototype.set=Gc;function gs(U,X){var pe=Ul(U),Te=!pe&&Oa(U),_t=!pe&&!Te&&Vc(U),Xe=!pe&&!Te&&!_t&&Kl(U),Ht=pe||Te||_t||Xe,hn=Ht?dn(U.length,String):[],sn=hn.length;for(var kt in U)ae.call(U,kt)&&!(Ht&&(kt=="length"||_t&&(kt=="offset"||kt=="parent")||Xe&&(kt=="buffer"||kt=="byteLength"||kt=="byteOffset")||qd(kt,sn)))&&hn.push(kt);return hn}function qn(U,X){for(var pe=U.length;pe--;)if(Do(U[pe][0],X))return pe;return-1}function Op(U,X,pe){var Te=X(U);return Ul(U)?Te:ft(Te,pe(U))}function $l(U){return U==null?U===void 0?G:C:ji&&ji in Object(U)?Ev(U):Yd(U)}function Bl(U){return Lo(U)&&$l(U)==l}function Fd(U,X,pe,Te,_t){return U===X?!0:U==null||X==null||!Lo(U)&&!Lo(X)?U!==U&&X!==X:qc(U,X,pe,Te,Fd,_t)}function qc(U,X,pe,Te,_t,Xe){var Ht=Ul(U),hn=Ul(X),sn=Ht?u:ms(U),kt=hn?u:ms(X);sn=sn==l?_:sn,kt=kt==l?_:kt;var ur=sn==_,di=kt==_,Bn=sn==kt;if(Bn&&Vc(U)){if(!Vc(X))return!1;Ht=!0,ur=!1}if(Bn&&!ur)return Xe||(Xe=new Us),Ht||Kl(U)?Hd(U,X,pe,Te,_t,Xe):Kd(U,X,sn,pe,Te,_t,Xe);if(!(pe&i)){var Gr=ur&&ae.call(U,"__wrapped__"),dr=di&&ae.call(X,"__wrapped__");if(Gr||dr){var Hs=Gr?U.value():U,vs=dr?X.value():X;return Xe||(Xe=new Us),_t(Hs,vs,pe,Te,Xe)}}return Bn?(Xe||(Xe=new Us),Ra(U,X,pe,Te,_t,Xe)):!1}function _v(U){if(!Ss(U)||Tv(U))return!1;var X=Wc(U)?Ct:de;return X.test(ys(U))}function Kr(U){return Lo(U)&&ja(U.length)&&!!me[$l(U)]}function Ud(U){if(!Yc(U))return ko(U);var X=[];for(var pe in Object(U))ae.call(U,pe)&&pe!="constructor"&&X.push(pe);return X}function Hd(U,X,pe,Te,_t,Xe){var Ht=pe&i,hn=U.length,sn=X.length;if(hn!=sn&&!(Ht&&sn>hn))return!1;var kt=Xe.get(U);if(kt&&Xe.get(X))return kt==X;var ur=-1,di=!0,Bn=pe&s?new Li:void 0;for(Xe.set(U,X),Xe.set(X,U);++ur<hn;){var Gr=U[ur],dr=X[ur];if(Te)var Hs=Ht?Te(dr,Gr,ur,X,U,Xe):Te(Gr,dr,ur,U,X,Xe);if(Hs!==void 0){if(Hs)continue;di=!1;break}if(Bn){if(!jn(X,function(vs,No){if(!Tr(Bn,No)&&(Gr===vs||_t(Gr,vs,pe,Te,Xe)))return Bn.push(No)})){di=!1;break}}else if(!(Gr===dr||_t(Gr,dr,pe,Te,Xe))){di=!1;break}}return Xe.delete(U),Xe.delete(X),di}function Kd(U,X,pe,Te,_t,Xe,Ht){switch(pe){case F:if(U.byteLength!=X.byteLength||U.byteOffset!=X.byteOffset)return!1;U=U.buffer,X=X.buffer;case $:return!(U.byteLength!=X.byteLength||!Xe(new Ur(U),new Ur(X)));case f:case g:case w:return Do(+U,+X);case m:return U.name==X.name&&U.message==X.message;case A:case D:return U==X+"";case v:var hn=qe;case R:var sn=Te&i;if(hn||(hn=Br),U.size!=X.size&&!sn)return!1;var kt=Ht.get(U);if(kt)return kt==X;Te|=s,Ht.set(U,X);var ur=Hd(hn(U),hn(X),Te,_t,Xe,Ht);return Ht.delete(U),ur;case L:if(Hc)return Hc.call(U)==Hc.call(X)}return!1}function Ra(U,X,pe,Te,_t,Xe){var Ht=pe&i,hn=Gd(U),sn=hn.length,kt=Gd(X),ur=kt.length;if(sn!=ur&&!Ht)return!1;for(var di=sn;di--;){var Bn=hn[di];if(!(Ht?Bn in X:ae.call(X,Bn)))return!1}var Gr=Xe.get(U);if(Gr&&Xe.get(X))return Gr==X;var dr=!0;Xe.set(U,X),Xe.set(X,U);for(var Hs=Ht;++di<sn;){Bn=hn[di];var vs=U[Bn],No=X[Bn];if(Te)var Lp=Ht?Te(No,vs,Bn,X,U,Xe):Te(vs,No,Bn,U,X,Xe);if(!(Lp===void 0?vs===No||_t(vs,No,pe,Te,Xe):Lp)){dr=!1;break}Hs||(Hs=Bn=="constructor")}if(dr&&!Hs){var Qc=U.constructor,Gl=X.constructor;Qc!=Gl&&"constructor"in U&&"constructor"in X&&!(typeof Qc=="function"&&Qc instanceof Qc&&typeof Gl=="function"&&Gl instanceof Gl)&&(dr=!1)}return Xe.delete(U),Xe.delete(X),dr}function Gd(U){return Op(U,Dp,jp)}function Fl(U,X){var pe=U.__data__;return Pv(X)?pe[typeof X=="string"?"string":"hash"]:pe.map}function ui(U,X){var pe=ls(U,X);return _v(pe)?pe:void 0}function Ev(U){var X=ae.call(U,ji),pe=U[ji];try{U[ji]=void 0;var Te=!0}catch{}var _t=He.call(U);return Te&&(X?U[ji]=pe:delete U[ji]),_t}var jp=ds?function(U){return U==null?[]:(U=Object(U),wt(ds(U),function(X){return rn.call(U,X)}))}:Xc,ms=$l;(hs&&ms(new hs(new ArrayBuffer(1)))!=F||Bs&&ms(new Bs)!=v||Ro&&ms(Ro.resolve())!=M||Ld&&ms(new Ld)!=R||Uc&&ms(new Uc)!=k)&&(ms=function(U){var X=$l(U),pe=X==_?U.constructor:void 0,Te=pe?ys(pe):"";if(Te)switch(Te){case Nd:return F;case Ll:return v;case xv:return M;case Pp:return R;case Tp:return k}return X});function qd(U,X){return X=X??o,!!X&&(typeof U=="number"||Se.test(U))&&U>-1&&U%1==0&&U<X}function Pv(U){var X=typeof U;return X=="string"||X=="number"||X=="symbol"||X=="boolean"?U!=="__proto__":U===null}function Tv(U){return!!Ce&&Ce in U}function Yc(U){var X=U&&U.constructor,pe=typeof X=="function"&&X.prototype||Ao;return U===pe}function Yd(U){return He.call(U)}function ys(U){if(U!=null){try{return Fc.call(U)}catch{}try{return U+""}catch{}}return""}function Do(U,X){return U===X||U!==U&&X!==X}var Oa=Bl(function(){return arguments}())?Bl:function(U){return Lo(U)&&ae.call(U,"callee")&&!rn.call(U,"callee")},Ul=Array.isArray;function Vd(U){return U!=null&&ja(U.length)&&!Wc(U)}var Vc=Di||Zc;function Hl(U,X){return Fd(U,X)}function Wc(U){if(!Ss(U))return!1;var X=$l(U);return X==S||X==b||X==d||X==I}function ja(U){return typeof U=="number"&&U>-1&&U%1==0&&U<=o}function Ss(U){var X=typeof U;return U!=null&&(X=="object"||X=="function")}function Lo(U){return U!=null&&typeof U=="object"}var Kl=Mt?lr(Mt):Kr;function Dp(U){return Vd(U)?gs(U):Ud(U)}function Xc(){return[]}function Zc(){return!1}t.exports=Hl}(sf,sf.exports)),sf.exports}var AG=MG();const X5=_l(AG);function kG(t){if(t.length===0)return new Set;const e=t[0],n=t.slice(1),r=new Set;for(const i of e)n.every(s=>s.has(i))&&r.add(i);return r}function RG(t,e){const n={};for(const r of e)t.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of t)e.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function gR(t,e){for(const[n,r]of Object.entries(t)){const i=r,s=e[n];if("eq"in i&&s!==i.eq||"neq"in i&&s===i.neq||"gt"in i&&(typeof s!="number"||s<=i.gt))return!1}return!0}function mR(t,e,n){const r=Object.fromEntries(Object.keys(n).map(i=>[i,new Set]));for(const[i,s]of Object.entries(n))if("eq"in s){const l=t.index(e,i).get().get(s.eq);if(l)for(const u of l)r[i].add(u)}else if("neq"in s){const o=t.index(e,i);for(const[l,u]of o.get())if(l!==s.neq)for(const d of u)r[i].add(d)}else if("gt"in s){const o=t.index(e,i);for(const[l,u]of o.get())if(l>s.gt)for(const d of u)r[i].add(d)}return kG(Object.values(r))}class OG{constructor(e,n){O(this,"indexCache",new Map);O(this,"historyCache",new Map);this.atoms=e,this.history=n}filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);const n=he("filterHistory:"+e,(r,i)=>{if(mc(r))return this.history.get();const s=this.history.getDiffSince(i);if(s===wi)return this.history.get();const o={added:{},removed:{},updated:{}};let l=0,u=0,d=0;for(const f of s){for(const g of ln(f.added))if(g.typeName===e)if(o.removed[g.id]){const m=o.removed[g.id];delete o.removed[g.id],u--,m!==g&&(o.updated[g.id]=[m,g],d++)}else o.added[g.id]=g,l++;for(const[g,m]of ln(f.updated))m.typeName===e&&(o.added[m.id]?o.added[m.id]=m:o.updated[m.id]?o.updated[m.id]=[o.updated[m.id][0],m]:(o.updated[m.id]=[g,m],d++));for(const g of ln(f.removed))g.typeName===e&&(o.added[g.id]?(delete o.added[g.id],l--):o.updated[g.id]?(o.removed[g.id]=o.updated[g.id][0],delete o.updated[g.id],d--,u++):(o.removed[g.id]=g,u++))}return l||u||d?rf(this.history.get(),o):r},{historyLength:100});return this.historyCache.set(e,n),n}index(e,n){const r=e+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const i=this.__uncached_createIndex(e,n);return this.indexCache.set(r,i),i}__uncached_createIndex(e,n){const r=this.filterHistory(e),i=()=>{r.get();const s=new Map;for(const o of ln(this.atoms.get())){const l=o.get();if(l.typeName===e){const u=l[n];s.has(u)||s.set(u,new Set),s.get(u).add(l.id)}}return s};return he("index:"+e+":"+n,(s,o)=>{if(mc(s))return i();const l=r.getDiffSince(o);if(l===wi)return i();const u=new Map,d=(S,b)=>{let v=u.get(S);v||(v=new wm(s.get(S)??new Set)),v.add(b),u.set(S,v)},f=(S,b)=>{let v=u.get(S);v||(v=new wm(s.get(S)??new Set)),v.remove(b),u.set(S,v)};for(const S of l){for(const b of ln(S.added))if(b.typeName===e){const v=b[n];d(v,b.id)}for(const[b,v]of ln(S.updated))if(v.typeName===e){const w=b[n],C=v[n];w!==C&&(f(w,v.id),d(C,v.id))}for(const b of ln(S.removed))if(b.typeName===e){const v=b[n];f(v,b.id)}}let g,m;for(const[S,b]of u){const v=b.get();v&&(g||(g=new Map(s)),m||(m=new Map),v.value.size===0?g.delete(S):g.set(S,v.value),m.set(S,v.diff))}return g&&m?rf(g,m):s},{historyLength:100})}record(e,n=()=>({}),r="record:"+e+(n?":"+n.toString():"")){const i=this.ids(e,n,r);return he(r,()=>{var s;for(const o of i.get())return(s=this.atoms.get()[o])==null?void 0:s.get()})}records(e,n=()=>({}),r="records:"+e+(n?":"+n.toString():"")){const i=this.ids(e,n,"ids:"+r);return he(r,()=>{const s=this.atoms.get();return[...i.get()].map(o=>{const l=s[o];if(!l)throw new Error("no atom found for record id: "+o);return l.get()})},{isEqual:jD})}ids(e,n=()=>({}),r="ids:"+e+(n?":"+n.toString():"")){const i=this.filterHistory(e),s=()=>{i.get();const u=n();return Object.keys(u).length===0?new Set(ln(this.atoms.get()).flatMap(d=>{const f=d.get();return f.typeName===e?f.id:[]})):mR(this,e,u)},o=u=>{const d=s(),f=RG(u,d);return f?rf(d,f):u},l=he("ids_query:"+r,n,{isEqual:X5});return he("query:"+r,(u,d)=>{const f=l.get();if(mc(u))return s();if(d<l.lastChangedEpoch)return o(u);const g=i.getDiffSince(d);if(g===wi)return o(u);const m=new wm(u);for(const b of g){for(const v of ln(b.added))v.typeName===e&&gR(f,v)&&m.add(v.id);for(const[v,w]of ln(b.updated))w.typeName===e&&(gR(f,w)?m.add(w.id):m.remove(w.id));for(const v of ln(b.removed))v.typeName===e&&m.remove(v.id)}const S=m.get();return S?rf(S.value,S.diff):u},{historyLength:50})}exec(e,n){const r=mR(this,e,n);if(r.size===0)return ha;const i=this.atoms.get();return[...r].map(s=>i[s].get())}}class jG{constructor(e){O(this,"_beforeCreateHandlers",{});O(this,"_afterCreateHandlers",{});O(this,"_beforeChangeHandlers",{});O(this,"_afterChangeHandlers",{});O(this,"_beforeDeleteHandlers",{});O(this,"_afterDeleteHandlers",{});O(this,"_operationCompleteHandlers",[]);O(this,"_isEnabled",!0);this.store=e}isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}handleBeforeCreate(e,n){if(!this._isEnabled)return e;const r=this._beforeCreateHandlers[e.typeName];if(r){let i=e;for(const s of r)i=s(i,n);return i}return e}handleAfterCreate(e,n){if(!this._isEnabled)return;const r=this._afterCreateHandlers[e.typeName];if(r)for(const i of r)i(e,n)}handleBeforeChange(e,n,r){if(!this._isEnabled)return n;const i=this._beforeChangeHandlers[n.typeName];if(i){let s=n;for(const o of i)s=o(e,s,r);return s}return n}handleAfterChange(e,n,r){if(!this._isEnabled)return;const i=this._afterChangeHandlers[n.typeName];if(i)for(const s of i)s(e,n,r)}handleBeforeDelete(e,n){if(!this._isEnabled)return!0;const r=this._beforeDeleteHandlers[e.typeName];if(r){for(const i of r)if(i(e,n)===!1)return!1}return!0}handleAfterDelete(e,n){if(!this._isEnabled)return;const r=this._afterDeleteHandlers[e.typeName];if(r)for(const i of r)i(e,n)}handleOperationComplete(e){if(this._isEnabled)for(const n of this._operationCompleteHandlers)n(e)}register(e){const n=[];for(const[r,i]of Object.entries(e))i!=null&&i.beforeCreate&&n.push(this.registerBeforeCreateHandler(r,i.beforeCreate)),i!=null&&i.afterCreate&&n.push(this.registerAfterCreateHandler(r,i.afterCreate)),i!=null&&i.beforeChange&&n.push(this.registerBeforeChangeHandler(r,i.beforeChange)),i!=null&&i.afterChange&&n.push(this.registerAfterChangeHandler(r,i.afterChange)),i!=null&&i.beforeDelete&&n.push(this.registerBeforeDeleteHandler(r,i.beforeDelete)),i!=null&&i.afterDelete&&n.push(this.registerAfterDeleteHandler(r,i.afterDelete));return()=>{for(const r of n)r()}}registerBeforeCreateHandler(e,n){return this._beforeCreateHandlers[e]||(this._beforeCreateHandlers[e]=[]),this._beforeCreateHandlers[e].push(n),()=>uc(this._beforeCreateHandlers[e],n)}registerAfterCreateHandler(e,n){return this._afterCreateHandlers[e]||(this._afterCreateHandlers[e]=[]),this._afterCreateHandlers[e].push(n),()=>uc(this._afterCreateHandlers[e],n)}registerBeforeChangeHandler(e,n){return this._beforeChangeHandlers[e]||(this._beforeChangeHandlers[e]=[]),this._beforeChangeHandlers[e].push(n),()=>uc(this._beforeChangeHandlers[e],n)}registerAfterChangeHandler(e,n){return this._afterChangeHandlers[e]||(this._afterChangeHandlers[e]=[]),this._afterChangeHandlers[e].push(n),()=>uc(this._afterChangeHandlers[e],n)}registerBeforeDeleteHandler(e,n){return this._beforeDeleteHandlers[e]||(this._beforeDeleteHandlers[e]=[]),this._beforeDeleteHandlers[e].push(n),()=>uc(this._beforeDeleteHandlers[e],n)}registerAfterDeleteHandler(e,n){return this._afterDeleteHandlers[e]||(this._afterDeleteHandlers[e]=[]),this._afterDeleteHandlers[e].push(n),()=>uc(this._afterDeleteHandlers[e],n)}registerOperationCompleteHandler(e){return this._operationCompleteHandlers.push(e),()=>uc(this._operationCompleteHandlers,e)}}function uc(t,e){const n=t.indexOf(e);n>=0&&t.splice(n,1)}class J_{constructor(e){O(this,"id");O(this,"atoms",On("store_atoms",{}));O(this,"history",On("history",0,{historyLength:1e3}));O(this,"query",new OG(this.atoms,this.history));O(this,"listeners",new Set);O(this,"historyAccumulator",new LG);O(this,"historyReactor");O(this,"schema");O(this,"props");O(this,"scopedTypes");O(this,"sideEffects",new jG(this));O(this,"isMergingRemoteChanges",!1);O(this,"_integrityChecker");O(this,"_isPossiblyCorrupted",!1);O(this,"pendingAfterEvents",null);O(this,"_isInAtomicOp",!1);const{initialData:n,schema:r,id:i}=e;this.id=i??At(),this.schema=r,this.props=e.props,n&&this.atoms.set(M_(ri(n).map(([s,o])=>[s,On("atom:"+s,this.schema.validateRecord(this,o,"initialize",null))]))),this.historyReactor=GK("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:s=>this.cancelHistoryReactor=t5(s)}),this.scopedTypes={document:new Set(ln(this.schema.types).filter(s=>s.scope==="document").map(s=>s.typeName)),session:new Set(ln(this.schema.types).filter(s=>s.scope==="session").map(s=>s.typeName)),presence:new Set(ln(this.schema.types).filter(s=>s.scope==="presence").map(s=>s.typeName))}}cancelHistoryReactor(){}_flushHistory(){if(this.historyAccumulator.hasChanges()){const e=this.historyAccumulator.flush();for(const{changes:n,source:r}of e){let i=null,s=null,o=null;for(const{onHistory:l,filters:u}of this.listeners)if(!(u.source!=="all"&&u.source!==r))if(u.scope!=="all")if(u.scope==="document"){if(s??(s=this.filterChangesByScope(n,"document")),!s)continue;l({changes:s,source:r})}else if(u.scope==="session"){if(i??(i=this.filterChangesByScope(n,"session")),!i)continue;l({changes:i,source:r})}else{if(o??(o=this.filterChangesByScope(n,"presence")),!o)continue;l({changes:o,source:r})}else l({changes:n,source:r})}}}dispose(){this.cancelHistoryReactor()}filterChangesByScope(e,n){const r={added:gf(e.added,(i,s)=>this.scopedTypes[n].has(s.typeName)),updated:gf(e.updated,(i,s)=>this.scopedTypes[n].has(s[1].typeName)),removed:gf(e.removed,(i,s)=>this.scopedTypes[n].has(s.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,e)}validate(e){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,e,null))}put(e,n){this.atomic(()=>{const r={},i={},s=this.atoms.__unsafe__getWithoutCapture();let o=null,l,u=!1;const d=this.isMergingRemoteChanges?"remote":"user";for(let f=0,g=e.length;f<g;f++){l=e[f];const m=(o??s)[l.id];if(m){const S=m.__unsafe__getWithoutCapture();if(l=this.sideEffects.handleBeforeChange(S,l,d),this.schema.validateRecord(this,l,n??"updateRecord",S)===S)continue;m.set(l),u=!0;const v=m.__unsafe__getWithoutCapture();r[l.id]=[S,v],this.addDiffForAfterEvent(S,v)}else l=this.sideEffects.handleBeforeCreate(l,d),u=!0,l=this.schema.validateRecord(this,l,n??"createRecord",null),i[l.id]=l,this.addDiffForAfterEvent(null,l),o||(o={...s}),o[l.id]=On("atom:"+l.id,l)}o&&this.atoms.set(o),u&&this.updateHistory({added:i,updated:r,removed:{}})})}remove(e){this.atomic(()=>{const n=new Set,r=this.isMergingRemoteChanges?"remote":"user";if(this.sideEffects.isEnabled())for(const s of e){const o=this.atoms.__unsafe__getWithoutCapture()[s];o&&this.sideEffects.handleBeforeDelete(o.get(),r)===!1&&n.add(s)}let i;this.atoms.update(s=>{let o;for(const l of e){if(n.has(l)||!(l in s))continue;o||(o={...s}),i||(i={}),delete o[l];const u=s[l].get();i[l]=u,this.addDiffForAfterEvent(u,null)}return o??s}),i&&this.updateHistory({added:{},updated:{},removed:i})})}get(e){var n;return(n=this.atoms.get()[e])==null?void 0:n.get()}unsafeGetWithoutCapture(e){var n;return(n=this.atoms.__unsafe__getWithoutCapture()[e])==null?void 0:n.__unsafe__getWithoutCapture()}serialize(e="document"){const n={};for(const[r,i]of ri(this.atoms.get())){const s=i.get();(e==="all"||this.scopedTypes[e].has(s.typeName))&&(n[r]=s)}return n}getStoreSnapshot(e="document"){return{store:this.serialize(e),schema:this.schema.serialize()}}getSnapshot(e="document"){return console.warn("[tldraw] `Store.getSnapshot` is deprecated and will be removed in a future release. Use `getSnapshot` from the `tldraw` package instead."),this.getStoreSnapshot(e)}migrateSnapshot(e){const n=this.schema.migrateStoreSnapshot(e);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);return{store:n.value,schema:this.schema.serialize()}}loadStoreSnapshot(e){const n=this.schema.migrateStoreSnapshot(e);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);const r=this.sideEffects.isEnabled();try{this.sideEffects.setIsEnabled(!1),this.atomic(()=>{this.clear(),this.put(Object.values(n.value)),this.ensureStoreIsUsable()})}finally{this.sideEffects.setIsEnabled(r)}}loadSnapshot(e){console.warn("[tldraw] `Store.loadSnapshot` is deprecated and will be removed in a future release. Use `loadSnapshot` from the 'tldraw' package instead."),this.loadStoreSnapshot(e)}allRecords(){return ln(this.atoms.get()).map(e=>e.get())}clear(){this.remove(BM(this.atoms.get()))}update(e,n){const r=this.atoms.get()[e];if(!r){console.error(`Record ${e} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])}has(e){return!!this.atoms.get()[e]}listen(e,n){this._flushHistory();const r={onHistory:e,filters:{source:(n==null?void 0:n.source)??"all",scope:(n==null?void 0:n.scope)??"all"}};return this.historyReactor.scheduler.isActivelyListening||(this.historyReactor.start(),this.historyReactor.scheduler.execute()),this.listeners.add(r),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}}mergeRemoteChanges(e){if(this.isMergingRemoteChanges)return e();if(this._isInAtomicOp)throw new Error("Cannot merge remote changes while in atomic operation");try{this.isMergingRemoteChanges=!0,uo(e)}finally{this.isMergingRemoteChanges=!1,this.ensureStoreIsUsable()}}extractingChanges(e){const n=[],r=this.historyAccumulator.addInterceptor(i=>n.push(i.changes));try{return uo(e),Q_(n)}finally{r()}}applyDiff(e,{runCallbacks:n=!0,ignoreEphemeralKeys:r=!1}={}){this.atomic(()=>{const i=ln(e.added);for(const[o,l]of ln(e.updated)){const u=this.schema.getType(l.typeName);if(r&&u.ephemeralKeySet.size){const d=this.get(l.id);if(!d){i.push(l);continue}let f=null;for(const[g,m]of Object.entries(l))u.ephemeralKeySet.has(g)||Object.is(m,xr(d,g))||(f||(f={...d}),f[g]=m);f&&i.push(f)}else i.push(l)}const s=BM(e.removed);i.length&&this.put(i),s.length&&this.remove(s)},n)}createComputedCache(e,n,r){const i=new po;return{get:s=>{const o=this.atoms.get()[s];if(o)return i.get(o,()=>{const l=r?he(o.name+":equals",()=>o.get(),{isEqual:r}):o;return he(e+":"+s,()=>n(l.get()))}).get()}}}createSelectedComputedCache(e,n,r){const i=new po;return{get:s=>{const o=this.atoms.get()[s];if(o)return i.get(o,()=>{const l=he(e+":"+s+":selector",()=>n(o.get()));return he(e+":"+s,()=>r(l.get()))}).get()}}}ensureStoreIsUsable(){this.atomic(()=>{var e;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(e=this._integrityChecker)==null||e.call(this)})}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}addDiffForAfterEvent(e,n){if(xt(this.pendingAfterEvents,"must be in event operation"),e===n||(e&&n&&xt(e.id===n.id),!e&&!n))return;const r=(e||n).id,i=this.pendingAfterEvents.get(r);i?i.after=n:this.pendingAfterEvents.set(r,{before:e,after:n})}flushAtomicCallbacks(){let e=0;const n=this.isMergingRemoteChanges?"remote":"user";for(;this.pendingAfterEvents;){const r=this.pendingAfterEvents;if(this.pendingAfterEvents=null,!!this.sideEffects.isEnabled()){if(e++,e>100)throw new Error("Maximum store update depth exceeded, bailing out");for(const{before:i,after:s}of r.values())i&&s?this.sideEffects.handleAfterChange(i,s,n):i&&!s?this.sideEffects.handleAfterDelete(i,n):!i&&s&&this.sideEffects.handleAfterCreate(s,n);this.pendingAfterEvents||this.sideEffects.handleOperationComplete(n)}}}atomic(e,n=!0){return uo(()=>{if(this._isInAtomicOp)return this.pendingAfterEvents||(this.pendingAfterEvents=new Map),e();this.pendingAfterEvents=new Map;const r=this.sideEffects.isEnabled();this.sideEffects.setIsEnabled(n??r),this._isInAtomicOp=!0;try{const i=e();return this.flushAtomicCallbacks(),i}finally{this.pendingAfterEvents=null,this.sideEffects.setIsEnabled(r),this._isInAtomicOp=!1}})}addHistoryInterceptor(e){return this.historyAccumulator.addInterceptor(n=>e(n,this.isMergingRemoteChanges?"remote":"user"))}}function DG(t){if(t.length===0)return[];const e=[];let n=[t[0]],r;for(let i=1,s=t.length;i<s;i++)r=t[i],n[0].source!==r.source&&(e.push(n),n=[]),n.push(r);return e.push(n),e.map(i=>({source:i[0].source,changes:Q_(i.map(s=>s.changes))}))}class LG{constructor(){O(this,"_history",[]);O(this,"_interceptors",new Set)}addInterceptor(e){return this._interceptors.add(e),()=>{this._interceptors.delete(e)}}add(e){this._history.push(e);for(const n of this._interceptors)n(e)}flush(){const e=DG(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function NG(t,e,n){const r=new po;return{get(i,s){return r.get(i,()=>(i instanceof J_?i:i.store).createComputedCache(t,u=>e(i,u),n)).get(s)}}}function zG(t){const e=[];for(let n=t.length-1;n>=0;n--){const r=t[n];if("id"in r)e.unshift(r);else{const i=r.dependsOn,s=e[0];s&&(e[0]={...s,dependsOn:i.concat(s.dependsOn??[])})}}return e}function Xu({sequence:t,sequenceId:e,retroactive:n=!0}){const r={sequenceId:e,retroactive:n,sequence:zG(t)};return Z5(r),r}function ai(t,e){return Object.fromEntries(ri(e).map(([n,r])=>[n,`${t}/${r}`]))}function ki(t){const e=t.sequenceId;return Xu({sequenceId:e,retroactive:t.retroactive??!0,sequence:t.sequence.map(n=>"id"in n?{...n,scope:"record",filter:r=>{var i,s;return r.typeName===t.recordType&&(((i=n.filter)==null?void 0:i.call(n,r))??!0)&&(((s=t.filter)==null?void 0:s.call(t,r))??!0)}}:n)})}function $G(t){const e=new Map(t.map(s=>[s.id,s])),n=new Set,r=[];function i(s){xt(!n.has(s.id),`Circular dependency in migrations: ${s.id}`),n.add(s.id);const{version:o,sequenceId:l}=gy(s.id),u=e.get(`${l}/${o-1}`);if(u&&i(u),s.dependsOn)for(const d of s.dependsOn){const f=e.get(d);f&&i(f)}e.delete(s.id),r.push(s)}for(const s of e.values())i(s);return r}function gy(t){const[e,n]=t.split("/");return{sequenceId:e,version:parseInt(n)}}function yR(t,e){e&&xt(t.startsWith(e+"/"),`Every migration in sequence '${e}' must have an id starting with '${e}/'. Got invalid id: '${t}'`),xt(t.match(/^(.*?)\/(0|[1-9]\d*)$/),`Invalid migration id: '${t}'`)}function Z5(t){if(xt(!t.sequenceId.includes("/"),`sequenceId cannot contain a '/', got ${t.sequenceId}`),xt(t.sequenceId.length,"sequenceId must be a non-empty string"),t.sequence.length===0)return;yR(t.sequence[0].id,t.sequenceId);let e=gy(t.sequence[0].id).version;xt(e===1,`Expected the first migrationId to be '${t.sequenceId}/1' but got '${t.sequence[0].id}'`);for(let n=1;n<t.sequence.length;n++){const r=t.sequence[n].id;yR(r,t.sequenceId);const i=gy(r).version;xt(i===e+1,`Migration id numbers must increase in increments of 1, expected ${t.sequenceId}/${e+1} but got '${t.sequence[n].id}'`),e=i}}var sl=(t=>(t.IncompatibleSubtype="incompatible-subtype",t.UnknownType="unknown-type",t.TargetVersionTooNew="target-version-too-new",t.TargetVersionTooOld="target-version-too-old",t.MigrationError="migration-error",t.UnrecognizedSubtype="unrecognized-subtype",t))(sl||{});function BG(t){if(t.schemaVersion>2||t.schemaVersion<1)return fl.err("Bad schema version");if(t.schemaVersion===2)return fl.ok(t);const e={schemaVersion:2,sequences:{"com.tldraw.store":t.storeVersion}};for(const[n,r]of Object.entries(t.recordVersions))if(e.sequences[`com.tldraw.${n}`]=r.version,"subTypeKey"in r)for(const[i,s]of Object.entries(r.subTypeVersions))e.sequences[`com.tldraw.${n}.${i}`]=s;return fl.ok(e)}class e2{constructor(e,n){O(this,"migrations",{});O(this,"sortedMigrations");var i;this.types=e,this.options=n;for(const s of n.migrations??[])xt(!this.migrations[s.sequenceId],`Duplicate migration sequenceId ${s.sequenceId}`),Z5(s),this.migrations[s.sequenceId]=s;const r=Object.values(this.migrations).flatMap(s=>s.sequence);this.sortedMigrations=$G(r);for(const s of this.sortedMigrations)if((i=s.dependsOn)!=null&&i.length)for(const o of s.dependsOn){const l=r.find(u=>u.id===o);xt(l,`Migration '${s.id}' depends on missing migration '${o}'`)}}static create(e,n){return new e2(e,n??{})}validateRecord(e,n,r,i){try{const s=xr(this.types,n.typeName);if(!s)throw new Error(`Missing definition for record type ${n.typeName}`);return s.validate(n,i??void 0)}catch(s){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:n,phase:r,recordBefore:i,error:s});throw s}}getMigrationsSince(e){const n=BG(e);if(!n.ok)return n;const r=n.value,i=new Set(Object.keys(r.sequences).filter(o=>this.migrations[o]));for(const o in this.migrations)r.sequences[o]===void 0&&this.migrations[o].retroactive&&i.add(o);if(i.size===0)return fl.ok([]);const s=new Set;for(const o of i){const l=r.sequences[o];if(typeof l!="number"&&this.migrations[o].retroactive||l===0){for(const f of this.migrations[o].sequence)s.add(f.id);continue}const u=`${o}/${l}`,d=this.migrations[o].sequence.findIndex(f=>f.id===u);if(d===-1)return fl.err("Incompatible schema?");for(const f of this.migrations[o].sequence.slice(d+1))s.add(f.id)}return fl.ok(this.sortedMigrations.filter(({id:o})=>s.has(o)))}migratePersistedRecord(e,n,r="up"){const i=this.getMigrationsSince(n);if(!i.ok)return console.error("Error migrating record",i.error),{type:"error",reason:sl.MigrationError};let s=i.value;if(s.length===0)return{type:"success",value:e};if(s.some(o=>o.scope==="store"))return{type:"error",reason:r==="down"?sl.TargetVersionTooOld:sl.TargetVersionTooNew};if(r==="down"){if(!s.every(o=>o.down))return{type:"error",reason:sl.TargetVersionTooOld};s=s.slice().reverse()}e=Xt(e);try{for(const o of s){if(o.scope==="store")throw new Error;if(!(o.filter?o.filter(e):!0))continue;const u=o[r](e);u&&(e=Xt(u))}}catch(o){return console.error("Error migrating record",o),{type:"error",reason:sl.MigrationError}}return{type:"success",value:e}}migrateStoreSnapshot(e){let{store:n}=e;const r=this.getMigrationsSince(e.schema);if(!r.ok)return console.error("Error migrating store",r.error),{type:"error",reason:sl.MigrationError};const i=r.value;if(i.length===0)return{type:"success",value:n};n=Xt(n);try{for(const s of i)if(s.scope==="record")for(const[o,l]of Object.entries(n)){if(!(s.filter?s.filter(l):!0))continue;const d=s.up(l);d&&(n[o]=Xt(d))}else if(s.scope==="store"){const o=s.up(n);o&&(n=Xt(o))}else An(s)}catch(s){return console.error("Error migrating store",s),{type:"error",reason:sl.MigrationError}}return{type:"success",value:n}}createIntegrityChecker(e){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,e))??void 0}serialize(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e,sequence:n})=>[e,n.length?gy(n.at(-1).id).version:0]))}}serializeEarliestVersion(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e})=>[e,0]))}}getType(e){const n=xr(this.types,e);return xt(n,"record type does not exists"),n}}El("@tldraw/store","3.8.1","esm");function FG(t){if(!t.length)return null;let e="";for(const n of t)typeof n=="number"?e+=`.${n}`:n.startsWith("(")?e.endsWith(")")?e=`${e.slice(0,-1)}, ${n.slice(1)}`:e+=n:e+=`.${n}`;return e=e.replace(/id = [^,]+, /,"").replace(/id = [^)]+/,""),e.startsWith(".")?e.slice(1):e}class ht extends Error{constructor(n,r=[]){const i=FG(r),s=n.split(`
`).map((o,l)=>l===0?o:`  ${o}`).join(`
`);super(r?`At ${i}: ${s}`:s);O(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function ii(t,e){try{return e()}catch(n){throw n instanceof ht?new ht(n.rawMessage,[t,...n.path]):new ht(n.toString(),[t])}}function ml(t){if(t===null)return"null";if(Array.isArray(t))return"an array";const e=typeof t;switch(e){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${e}`;case"object":return`an ${e}`;case"undefined":return"undefined";default:An(e)}}class Lr{constructor(e,n){this.validationFn=e,this.validateUsingKnownGoodVersionFn=n}validate(e){return this.validationFn(e)}validateUsingKnownGoodVersion(e,n){return Object.is(e,n)?e:this.validateUsingKnownGoodVersionFn?this.validateUsingKnownGoodVersionFn(e,n):this.validate(n)}isValid(e){try{return this.validate(e),!0}catch{return!1}}nullable(){return YG(this)}optional(){return J5(this)}refine(e){return new Lr(n=>e(this.validate(n)),(n,r)=>{const i=this.validateUsingKnownGoodVersion(n,r);return Object.is(n,i)?n:e(i)})}check(e,n){return typeof e=="string"?this.refine(r=>(ii(`(check ${e})`,()=>n(r)),r)):this.refine(r=>(e(r),r))}}class UG extends Lr{constructor(e){super(n=>{const r=SR.validate(n);for(let i=0;i<r.length;i++)ii(i,()=>e.validate(r[i]));return r},(n,r)=>{if(!e.validateUsingKnownGoodVersion)return this.validate(r);const i=SR.validate(r);let s=n.length!==i.length;for(let o=0;o<i.length;o++){const l=i[o];if(o>=n.length){s=!0,ii(o,()=>e.validate(l));continue}if(Object.is(n[o],l))continue;const u=ii(o,()=>e.validateUsingKnownGoodVersion(n[o],l));Object.is(u,n[o])||(s=!0)}return s?r:n}),this.itemValidator=e}nonEmpty(){return this.check(e=>{if(e.length===0)throw new ht("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(e=>{if(e.length<=1)throw new ht("Expected an array with length greater than 1")})}}class my extends Lr{constructor(e,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new ht(`Expected object, got ${ml(r)}`);for(const[i,s]of Object.entries(e))ii(i,()=>{s.validate(xr(r,i))});if(!n){for(const i of Object.keys(r))if(!es(e,i))throw new ht("Unexpected property",[i])}return r},(r,i)=>{if(typeof i!="object"||i===null)throw new ht(`Expected object, got ${ml(i)}`);let s=!1;for(const[o,l]of Object.entries(e)){const u=xr(r,o),d=xr(i,o);if(Object.is(u,d))continue;const f=ii(o,()=>{const g=l;return g.validateUsingKnownGoodVersion?g.validateUsingKnownGoodVersion(u,d):g.validate(d)});Object.is(f,u)||(s=!0)}if(!n){for(const o of Object.keys(i))if(!es(e,o))throw new ht("Unexpected property",[o])}for(const o of Object.keys(r))if(!es(i,o)){s=!0;break}return s?i:r}),this.config=e,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new my(this.config,!0)}extend(e){return new my({...this.config,...e})}}class oS extends Lr{constructor(e,n,r,i){super(s=>{this.expectObject(s);const{matchingSchema:o,variant:l}=this.getMatchingSchemaAndVariant(s);return o===void 0?this.unknownValueValidation(s,l):ii(`(${e} = ${l})`,()=>o.validate(s))},(s,o)=>{this.expectObject(o),this.expectObject(s);const{matchingSchema:l,variant:u}=this.getMatchingSchemaAndVariant(o);return l===void 0?this.unknownValueValidation(o,u):xr(s,e)!==xr(o,e)?ii(`(${e} = ${u})`,()=>l.validate(o)):ii(`(${e} = ${u})`,()=>l.validateUsingKnownGoodVersion?l.validateUsingKnownGoodVersion(s,o):l.validate(o))}),this.key=e,this.config=n,this.unknownValueValidation=r,this.useNumberKeys=i}expectObject(e){if(typeof e!="object"||e===null)throw new ht(`Expected an object, got ${ml(e)}`,[])}getMatchingSchemaAndVariant(e){const n=xr(e,this.key);if(!this.useNumberKeys&&typeof n!="string")throw new ht(`Expected a string for key "${this.key}", got ${ml(n)}`);if(this.useNumberKeys&&!Number.isFinite(Number(n)))throw new ht(`Expected a number for key "${this.key}", got "${n}"`);return{matchingSchema:es(this.config,n)?this.config[n]:void 0,variant:n}}validateUnknownVariants(e){return new oS(this.key,this.config,e,this.useNumberKeys)}}class HG extends Lr{constructor(e,n){super(r=>{if(typeof r!="object"||r===null)throw new ht(`Expected object, got ${ml(r)}`);for(const[i,s]of Object.entries(r))ii(i,()=>{e.validate(i),n.validate(s)});return r},(r,i)=>{if(typeof i!="object"||i===null)throw new ht(`Expected object, got ${ml(i)}`);let s=!1;for(const[o,l]of Object.entries(i)){if(!es(r,o)){s=!0,ii(o,()=>{e.validate(o),n.validate(l)});continue}const u=xr(r,o),d=l;if(Object.is(u,d))continue;const f=ii(o,()=>n.validateUsingKnownGoodVersion?n.validateUsingKnownGoodVersion(u,d):n.validate(d));Object.is(f,u)||(s=!0)}for(const o of Object.keys(r))if(!es(i,o)){s=!0;break}return s?i:r}),this.keyValidator=e,this.valueValidator=n}}function t2(t){return new Lr(e=>{if(typeof e!==t)throw new ht(`Expected ${t}, got ${ml(e)}`);return e})}const KG=new Lr(t=>t),Ye=t2("string"),Le=t2("number").check(t=>{if(Number.isNaN(t))throw new ht("Expected a number, got NaN");if(!Number.isFinite(t))throw new ht(`Expected a finite number, got ${t}`)}),yy=Le.check(t=>{if(t<0)throw new ht(`Expected a positive number, got ${t}`)}),Cn=Le.check(t=>{if(t<=0)throw new ht(`Expected a non-zero positive number, got ${t}`)}),Q5=Le.check(t=>{if(!Number.isInteger(t))throw new ht(`Expected an integer, got ${t}`)}),Cm=Q5.check(t=>{if(t<0)throw new ht(`Expected a positive integer, got ${t}`)}),GG=Q5.check(t=>{if(t<=0)throw new ht(`Expected a non-zero positive integer, got ${t}`)}),rt=t2("boolean");function _r(t){return new Lr(e=>{if(e!==t)throw new ht(`Expected ${t}, got ${JSON.stringify(e)}`);return t})}const SR=new Lr(t=>{if(!Array.isArray(t))throw new ht(`Expected an array, got ${ml(t)}`);return t});function er(t){return new UG(t)}function st(t){return new my(t)}function lC(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null||Object.getPrototypeOf(t)===FH)}function cC(t){return t===null||typeof t=="number"||typeof t=="string"||typeof t=="boolean"?!0:Array.isArray(t)?t.every(cC):lC(t)?Object.values(t).every(cC):!1}const tr=new Lr(t=>{if(cC(t))return t;throw new ht(`Expected json serializable value, got ${typeof t}`)},(t,e)=>{if(Array.isArray(t)&&Array.isArray(e)){let n=t.length!==e.length;for(let r=0;r<e.length;r++){if(r>=t.length){n=!0,tr.validate(e[r]);continue}const i=t[r],s=e[r];if(Object.is(i,s))continue;const o=tr.validateUsingKnownGoodVersion(i,s);Object.is(o,i)||(n=!0)}return n?e:t}else if(lC(t)&&lC(e)){let n=!1;for(const r of Object.keys(e)){if(!es(t,r)){n=!0,tr.validate(e[r]);continue}const i=t[r],s=e[r];if(Object.is(i,s))continue;const o=tr.validateUsingKnownGoodVersion(i,s);Object.is(o,i)||(n=!0)}for(const r of Object.keys(t))if(!es(e,r)){n=!0;break}return n?e:t}else return tr.validate(e)});function Sy(t,e){return new HG(t,e)}function n2(t,e){return new oS(t,e,(n,r)=>{throw new ht(`Expected one of ${Object.keys(e).map(i=>JSON.stringify(i)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!1)}function qG(t,e){return new oS(t,e,(n,r)=>{throw new ht(`Expected one of ${Object.keys(e).map(i=>JSON.stringify(i)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!0)}function Co(t,e){return new Lr(n=>ii(t,()=>e.validate(n)),(n,r)=>ii(t,()=>e.validateUsingKnownGoodVersion?e.validateUsingKnownGoodVersion(n,r):e.validate(r)))}function aS(t){return new Lr(e=>{if(!t.has(e)){const n=Array.from(t,r=>JSON.stringify(r)).join(" or ");throw new ht(`Expected ${n}, got ${e}`)}return e})}function J5(t){return new Lr(e=>{if(e!==void 0)return t.validate(e)},(e,n)=>{if(!(e===void 0&&n===void 0)&&n!==void 0)return t.validateUsingKnownGoodVersion&&e!==void 0?t.validateUsingKnownGoodVersion(e,n):t.validate(n)})}function YG(t){return new Lr(e=>e===null?null:t.validate(e),(e,n)=>n===null?null:t.validateUsingKnownGoodVersion&&e!==null?t.validateUsingKnownGoodVersion(e,n):t.validate(n))}function lS(...t){return aS(new Set(t))}function r2(t){try{return new URL(t)}catch{if(t.startsWith("/")||t.startsWith("./"))try{return new URL(t,"http://example.com")}catch{throw new ht(`Expected a valid url, got ${JSON.stringify(t)}`)}throw new ht(`Expected a valid url, got ${JSON.stringify(t)}`)}}const VG=new Set(["http:","https:","mailto:"]),Ii=Ye.check(t=>{if(t==="")return;const e=r2(t);if(!VG.has(e.protocol.toLowerCase()))throw new ht(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),WG=new Set(["http:","https:","data:","asset:"]),xc=Ye.check(t=>{if(t==="")return;const e=r2(t);if(!WG.has(e.protocol.toLowerCase()))throw new ht(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)});Ye.check(t=>{if(t==="")return;if(!r2(t).protocol.toLowerCase().match(/^https?:$/))throw new ht(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)});const i2=Ye.refine(t=>{try{return kH(t),t}catch{throw new ht(`Expected an index key, got ${JSON.stringify(t)}`)}});El("@tldraw/validate","3.8.1","esm");function _i(t){return Ye.refine(e=>{if(!e.startsWith(`${t}:`))throw new Error(`${t} ID must start with "${t}:"`);return e})}const cS=_i("asset");function s2(t,e){return st({id:cS,typeName:_r("asset"),type:_r(t),props:e,meta:tr})}const wc=st({x:Le,y:Le,z:Le.optional()}),yf=st({x:Le,y:Le,w:Le,h:Le}),e3=Le.check(t=>{if(t<0||t>1)throw new ht("Opacity must be between 0 and 1")}),XG=Ye.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return t}),Yi=_i("shape");function ZG(t,e,n){return st({id:Yi,typeName:_r("shape"),x:Le,y:Le,rotation:Le,index:i2,parentId:XG,type:_r(t),isLocked:rt,opacity:e3,props:e?st(e):tr,meta:n?st(n):tr})}const QG=_i("binding");function JG(t,e,n){return st({id:QG,typeName:_r("binding"),type:_r(t),fromId:Yi,toId:Yi,props:e?st(e):tr,meta:n?st(n):tr})}ai("com.tldraw.binding",{});ki({sequenceId:"com.tldraw.binding",recordType:"binding",sequence:[]});function Sc(t){return`binding:${At()}`}function eq(t){return wo("binding",{scope:"document",validator:Co("binding",n2("type",Wf(t,(e,{props:n,meta:r})=>JG(e,n,r))))}).withDefaultProperties(()=>({meta:{}}))}class sr{constructor(e,n,r){this.id=e,this.defaultValue=n,this.type=r}static define(e,n){const{defaultValue:r,type:i=KG}=n;return new sr(e,r,i)}static defineEnum(e,n){const{defaultValue:r,values:i}=n;return new tq(e,r,i)}setDefaultValue(e){this.defaultValue=e}validate(e){return this.type.validate(e)}validateUsingKnownGoodVersion(e,n){return this.type.validateUsingKnownGoodVersion?this.type.validateUsingKnownGoodVersion(e,n):this.validate(n)}}class tq extends sr{constructor(e,n,r){super(e,n,lS(...r)),this.values=r}}const Lg=ai("com.tldraw.shape",{AddIsLocked:1,HoistOpacity:2,AddMeta:3,AddWhite:4}),nq=ki({sequenceId:"com.tldraw.shape",recordType:"shape",sequence:[{id:Lg.AddIsLocked,up:t=>{t.isLocked=!1},down:t=>{delete t.isLocked}},{id:Lg.HoistOpacity,up:t=>{t.opacity=Number(t.props.opacity??"1"),delete t.props.opacity},down:t=>{const e=t.opacity;delete t.opacity,t.props.opacity=e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}},{id:Lg.AddMeta,up:t=>{t.meta={}}},{id:Lg.AddWhite,up:t=>{},down:t=>{t.props.color==="white"&&(t.props.color="black")}}]});function Gu(t){return t?t.typeName==="shape":!1}function Zr(t){return t?t.startsWith("shape:"):!1}function Lt(t){return`shape:${t??At()}`}function t3(t){const e=new Map;for(const[n,r]of Object.entries(t))if(r instanceof sr){if(e.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);e.set(r,n)}return e}function Ls(t,e){return Wf(e,(n,r)=>`com.tldraw.shape.${t}/${r}`)}function rq(t){return wo("shape",{scope:"document",validator:Co("shape",n2("type",Wf(t,(e,{props:n,meta:r})=>ZG(e,n,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}function vR(t,e){const n=[];for(const[r,{migrations:i}]of Object.entries(e)){const s=`com.tldraw.${t}.${r}`;i?"sequenceId"in i?(xt(s===i.sequenceId,`sequenceId mismatch for ${r} ${sS} migrations. Expected '${s}', got '${i.sequenceId}'`),n.push(i)):"sequence"in i?n.push(Xu({sequenceId:s,retroactive:!1,sequence:i.sequence.map(o=>"id"in o?n3(t,r,o):o)})):n.push(Xu({sequenceId:s,retroactive:!1,sequence:Object.keys(i.migrators).map(o=>Number(o)).sort((o,l)=>o-l).map(o=>({id:`${s}/${o}`,scope:"record",filter:l=>l.typeName===t&&l.type===r,up:l=>{const u=i.migrators[o].up(l);if(u)return u},down:l=>{const u=i.migrators[o].down(l);if(u)return u}}))})):n.push(Xu({sequenceId:s,retroactive:!1,sequence:[]}))}return n}function n3(t,e,n){return{id:n.id,dependsOn:n.dependsOn,scope:"record",filter:r=>r.typeName===t&&r.type===e,up:r=>{const i=n.up(r.props);i&&(r.props=i)},down:typeof n.down=="function"?r=>{const i=n.down(r.props);i&&(r.props=i)}:void 0}}const r3=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red","white"],vy={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",fill:"#1d1d1d",note:{fill:"#FCE19C",text:"#000000"},semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4465e9",fill:"#4465e9",note:{fill:"#8AA3FF",text:"#000000"},semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#6FC896",text:"#000000"},semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#9fa8b2",fill:"#9fa8b2",note:{fill:"#C0CAD3",text:"#000000"},semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4ba1f1",fill:"#4ba1f1",note:{fill:"#9BC4FD",text:"#000000"},semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#4cb05e",fill:"#4cb05e",note:{fill:"#98D08A",text:"#000000"},semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#f87777",fill:"#f87777",note:{fill:"#F7A5A1",text:"#000000"},semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e085f4",fill:"#e085f4",note:{fill:"#DFB0F9",text:"#000000"},semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#e16919",fill:"#e16919",note:{fill:"#FAA475",text:"#000000"},semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#FC8282",text:"#000000"},semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#DB91FD",text:"#000000"},semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#f1ac4b",fill:"#f1ac4b",note:{fill:"#FED49A",text:"#000000"},semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},white:{solid:"#FFFFFF",fill:"#FFFFFF",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#FFFFFF",text:"#000000"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}},darkMode:{id:"dark",text:"hsl(210, 17%, 98%)",background:"hsl(240, 5%, 6.5%)",solid:"#010403",black:{solid:"#f2f2f2",fill:"#f2f2f2",note:{fill:"#2c2c2c",text:"#f2f2f2"},semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4f72fc",fill:"#4f72fc",note:{fill:"#2A3F98",text:"#f2f2f2"},semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#014429",text:"#f2f2f2"},semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#9398b0",fill:"#9398b0",note:{fill:"#56595F",text:"#f2f2f2"},semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#4dabf7",fill:"#4dabf7",note:{fill:"#1F5495",text:"#f2f2f2"},semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#40c057",fill:"#40c057",note:{fill:"#21581D",text:"#f2f2f2"},semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#ff8787",fill:"#ff8787",note:{fill:"#923632",text:"#f2f2f2"},semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#e599f7",fill:"#e599f7",note:{fill:"#762F8E",text:"#f2f2f2"},semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#f76707",fill:"#f76707",note:{fill:"#843906",text:"#f2f2f2"},semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#89231A",text:"#f2f2f2"},semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#681683",text:"#f2f2f2"},semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#ffc034",fill:"#ffc034",note:{fill:"#98571B",text:"#f2f2f2"},semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},white:{solid:"#f3f3f3",fill:"#f3f3f3",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#eaeaea",text:"#1d1d1d"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}}};function Ca(t){return t.isDarkMode?vy.darkMode:vy.lightMode}const Mi=sr.defineEnum("tldraw:color",{defaultValue:"black",values:r3}),o2=sr.defineEnum("tldraw:labelColor",{defaultValue:"black",values:r3}),Cc=sr.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),_c=sr.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern","fill"]}),mo=sr.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),i3={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},yo=sr.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),s3=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],by=sr.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:s3}),xy=sr.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:s3}),o3={labelColor:o2,color:Mi,fill:_c,dash:Cc,size:yo,arrowheadStart:by,arrowheadEnd:xy,font:mo,start:wc,end:wc,bend:Le,text:Ye,labelPosition:Le,scale:Cn},Bu=Ls("arrow",{AddLabelColor:1,AddIsPrecise:2,AddLabelPosition:3,ExtractBindings:4,AddScale:5});function Ng(t){return n3("shape","arrow",t)}const a3=Xu({sequenceId:"com.tldraw.shape.arrow",retroactive:!1,sequence:[Ng({id:Bu.AddLabelColor,up:t=>{t.labelColor="black"},down:"retired"}),Ng({id:Bu.AddIsPrecise,up:({start:t,end:e})=>{t.type==="binding"&&(t.isPrecise=!(t.normalizedAnchor.x===.5&&t.normalizedAnchor.y===.5)),e.type==="binding"&&(e.isPrecise=!(e.normalizedAnchor.x===.5&&e.normalizedAnchor.y===.5))},down:({start:t,end:e})=>{t.type==="binding"&&(t.isPrecise||(t.normalizedAnchor={x:.5,y:.5}),delete t.isPrecise),e.type==="binding"&&(e.isPrecise||(e.normalizedAnchor={x:.5,y:.5}),delete e.isPrecise)}}),Ng({id:Bu.AddLabelPosition,up:t=>{t.labelPosition=.5},down:t=>{delete t.labelPosition}}),{id:Bu.ExtractBindings,scope:"store",up:t=>{const e=Object.values(t).filter(n=>n.typeName==="shape"&&n.type==="arrow");for(const n of e){const{start:r,end:i}=n.props;if(r.type==="binding"){const s=Sc(),o={typeName:"binding",id:s,type:"arrow",fromId:n.id,toId:r.boundShapeId,meta:{},props:{terminal:"start",normalizedAnchor:r.normalizedAnchor,isExact:r.isExact,isPrecise:r.isPrecise}};t[s]=o,n.props.start={x:0,y:0}}else delete n.props.start.type;if(i.type==="binding"){const s=Sc(),o={typeName:"binding",id:s,type:"arrow",fromId:n.id,toId:i.boundShapeId,meta:{},props:{terminal:"end",normalizedAnchor:i.normalizedAnchor,isExact:i.isExact,isPrecise:i.isPrecise}};t[s]=o,n.props.end={x:0,y:0}}else delete n.props.end.type}}},Ng({id:Bu.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}})]}),l3={terminal:lS("start","end"),normalizedAnchor:wc,isExact:rt,isPrecise:rt},c3={sequence:[{dependsOn:[Bu.ExtractBindings]}]},iq=Co("camera",st({typeName:_r("camera"),id:_i("camera"),x:Le,y:Le,z:Le,meta:tr})),sq=ai("com.tldraw.camera",{AddMeta:1}),oq=ki({sequenceId:"com.tldraw.camera",recordType:"camera",sequence:[{id:sq.AddMeta,up:t=>{t.meta={}}}]}),oo=wo("camera",{validator:iq,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),aq=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),u3=aS(aq),lq=st({type:u3,rotation:Le}),cq=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),uq=aS(cq),dq=new Set(["starting","paused","active","stopping"]),d3=st({id:Ye,points:er(wc),size:yy,color:uq,opacity:Le,state:aS(dq),delay:Le,shrink:Le,taper:rt}),kf=_i("page"),hq=Co("page",st({typeName:_r("page"),id:kf,name:Ye,index:i2,meta:tr})),fq=ai("com.tldraw.page",{AddMeta:1}),pq=ki({sequenceId:"com.tldraw.page",recordType:"page",sequence:[{id:fq.AddMeta,up:t=>{t.meta={}}}]}),Ai=wo("page",{validator:hq,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function Vr(t){return Ai.isId(t)}const gq={id:!1,typeName:!1,currentPageId:!1,opacityForNextShape:!1,stylesForNextShape:!1,followingUserId:!1,highlightedUserIds:!1,brush:!1,cursor:!1,scribbles:!1,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!1,chatMessage:!1,isChatting:!1,isPenMode:!1,isGridMode:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!1,openMenus:!1,isChangingStyle:!1,isReadonly:!0,meta:!1,duplicateProps:!1};function h3(t){return t?gf(t,e=>gq[e]):null}_i("instance");function mq(t){const e={};for(const[r,i]of t)e[r]=J5(i);const n=Co("instance",st({typeName:_r("instance"),id:_i("instance"),currentPageId:kf,followingUserId:Ye.nullable(),brush:yf.nullable(),opacityForNextShape:e3,stylesForNextShape:st(e),cursor:lq,scribbles:er(d3),isFocusMode:rt,isDebugMode:rt,isToolLocked:rt,exportBackground:rt,screenBounds:yf,insets:er(rt),zoomBrush:yf.nullable(),isPenMode:rt,isGridMode:rt,chatMessage:Ye,isChatting:rt,highlightedUserIds:er(Ye),isFocused:rt,devicePixelRatio:Le,isCoarsePointer:rt,isHoveringCanvas:rt.nullable(),openMenus:er(Ye),isChangingStyle:rt,isReadonly:rt,meta:tr,duplicateProps:st({shapeIds:er(_i("shape")),offset:st({x:Le,y:Le})}).nullable()}));return wo("instance",{validator:n,scope:"session",ephemeralKeys:{currentPageId:!1,meta:!1,followingUserId:!0,opacityForNextShape:!0,stylesForNextShape:!0,brush:!0,cursor:!0,scribbles:!0,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!0,isPenMode:!0,isGridMode:!0,chatMessage:!0,isChatting:!0,highlightedUserIds:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!0,openMenus:!0,isChangingStyle:!0,isReadonly:!0,duplicateProps:!0}}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},insets:[!1,!1,!1,!1],zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{},duplicateProps:null}))}const Wt=ai("com.tldraw.instance",{AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22,AddInset:23,AddDuplicateProps:24,RemoveCanMoveCamera:25}),yq=ki({sequenceId:"com.tldraw.instance",recordType:"instance",sequence:[{id:Wt.AddTransparentExportBgs,up:t=>({...t,exportBackground:!0})},{id:Wt.RemoveDialog,up:({dialog:t,...e})=>e},{id:Wt.AddToolLockMode,up:t=>({...t,isToolLocked:!1})},{id:Wt.RemoveExtraPropsForNextShape,up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([n])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(n)))})},{id:Wt.AddLabelColor,up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:{...t,labelColor:"black"}})},{id:Wt.AddFollowingUserId,up:t=>({...t,followingUserId:null})},{id:Wt.RemoveAlignJustify,up:t=>{let e=t.propsForNextShape.align;return e==="justify"&&(e="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:e}}}},{id:Wt.AddZoom,up:t=>({...t,zoomBrush:null})},{id:Wt.AddVerticalAlign,up:t=>({...t,propsForNextShape:{...t.propsForNextShape,verticalAlign:"middle"}})},{id:Wt.AddScribbleDelay,up:t=>t.scribble!==null?{...t,scribble:{...t.scribble,delay:0}}:{...t}},{id:Wt.RemoveUserId,up:({userId:t,...e})=>e},{id:Wt.AddIsPenModeAndIsGridMode,up:t=>({...t,isPenMode:!1,isGridMode:!1})},{id:Wt.HoistOpacity,up:({propsForNextShape:{opacity:t,...e},...n})=>({...n,opacityForNextShape:Number(t??"1"),propsForNextShape:e})},{id:Wt.AddChat,up:t=>({...t,chatMessage:"",isChatting:!1})},{id:Wt.AddHighlightedUserIds,up:t=>({...t,highlightedUserIds:[]})},{id:Wt.ReplacePropsForNextShapeWithStylesForNextShape,up:({propsForNextShape:t,...e})=>({...e,stylesForNextShape:{}})},{id:Wt.AddMeta,up:t=>({...t,meta:{}})},{id:Wt.RemoveCursorColor,up:t=>{const{color:e,...n}=t.cursor;return{...t,cursor:n}}},{id:Wt.AddLonelyProperties,up:t=>({...t,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1})},{id:Wt.ReadOnlyReadonly,up:({isReadOnly:t,...e})=>({...e,isReadonly:t})},{id:Wt.AddHoveringCanvas,up:t=>({...t,isHoveringCanvas:null})},{id:Wt.AddScribbles,up:({scribble:t,...e})=>({...e,scribbles:[]})},{id:Wt.AddInset,up:t=>({...t,insets:[!1,!1,!1,!1]}),down:({insets:t,...e})=>({...e})},{id:Wt.AddDuplicateProps,up:t=>({...t,duplicateProps:null}),down:({duplicateProps:t,...e})=>({...e})},{id:Wt.RemoveCanMoveCamera,up:({canMoveCamera:t,...e})=>({...e}),down:t=>({...t,canMoveCamera:!0})}]}),kr="instance:instance",Sq=Co("instance_page_state",st({typeName:_r("instance_page_state"),id:_i("instance_page_state"),pageId:kf,selectedShapeIds:er(Yi),hintingShapeIds:er(Yi),erasingShapeIds:er(Yi),hoveredShapeId:Yi.nullable(),editingShapeId:Yi.nullable(),croppingShapeId:Yi.nullable(),focusedGroupId:Yi.nullable(),meta:tr})),Fh=ai("com.tldraw.instance_page_state",{AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5}),vq=ki({sequenceId:"com.tldraw.instance_page_state",recordType:"instance_page_state",sequence:[{id:Fh.AddCroppingId,up(t){t.croppingShapeId=null}},{id:Fh.RemoveInstanceIdAndCameraId,up(t){delete t.instanceId,delete t.cameraId}},{id:Fh.AddMeta,up:t=>{t.meta={}}},{id:Fh.RenameProperties,up:t=>{},down:t=>{}},{id:Fh.RenamePropertiesAgain,up:t=>{t.selectedShapeIds=t.selectedIds,delete t.selectedIds,t.hintingShapeIds=t.hintingIds,delete t.hintingIds,t.erasingShapeIds=t.erasingIds,delete t.erasingIds,t.hoveredShapeId=t.hoveredId,delete t.hoveredId,t.editingShapeId=t.editingId,delete t.editingId,t.croppingShapeId=t.croppingShapeId??t.croppingId??null,delete t.croppingId,t.focusedGroupId=t.focusLayerId,delete t.focusLayerId},down:t=>{t.selectedIds=t.selectedShapeIds,delete t.selectedShapeIds,t.hintingIds=t.hintingShapeIds,delete t.hintingShapeIds,t.erasingIds=t.erasingShapeIds,delete t.erasingShapeIds,t.hoveredId=t.hoveredShapeId,delete t.hoveredShapeId,t.editingId=t.editingShapeId,delete t.editingShapeId,t.croppingId=t.croppingShapeId,delete t.croppingShapeId,t.focusLayerId=t.focusedGroupId,delete t.focusedGroupId}}]}),Is=wo("instance_page_state",{validator:Sq,scope:"session",ephemeralKeys:{pageId:!1,selectedShapeIds:!1,editingShapeId:!1,croppingShapeId:!1,meta:!1,hintingShapeIds:!0,erasingShapeIds:!0,hoveredShapeId:!0,focusedGroupId:!0}}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),bq=Co("pointer",st({typeName:_r("pointer"),id:_i("pointer"),x:Le,y:Le,lastActivityTimestamp:Le,meta:tr})),xq=ai("com.tldraw.pointer",{AddMeta:1}),wq=ki({sequenceId:"com.tldraw.pointer",recordType:"pointer",sequence:[{id:xq.AddMeta,up:t=>{t.meta={}}}]}),a2=wo("pointer",{validator:bq,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),wy=a2.createId("pointer"),Cq=Co("instance_presence",st({typeName:_r("instance_presence"),id:_i("instance_presence"),userId:Ye,userName:Ye,lastActivityTimestamp:Le.nullable(),followingUserId:Ye.nullable(),cursor:st({x:Le,y:Le,type:u3,rotation:Le}).nullable(),color:Ye,camera:st({x:Le,y:Le,z:Le}).nullable(),screenBounds:yf.nullable(),selectedShapeIds:er(_i("shape")),currentPageId:_i("page"),brush:yf.nullable(),scribbles:er(d3),chatMessage:Ye,meta:tr})),Pu=ai("com.tldraw.instance_presence",{AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5,NullableCameraCursor:6}),_q=ki({sequenceId:"com.tldraw.instance_presence",recordType:"instance_presence",sequence:[{id:Pu.AddScribbleDelay,up:t=>{t.scribble!==null&&(t.scribble.delay=0)}},{id:Pu.RemoveInstanceId,up:t=>{delete t.instanceId}},{id:Pu.AddChatMessage,up:t=>{t.chatMessage=""}},{id:Pu.AddMeta,up:t=>{t.meta={}}},{id:Pu.RenameSelectedShapeIds,up:t=>{}},{id:Pu.NullableCameraCursor,up:t=>{},down:t=>{t.camera===null&&(t.camera={x:0,y:0,z:1}),t.lastActivityTimestamp===null&&(t.lastActivityTimestamp=0),t.cursor===null&&(t.cursor={type:"default",x:0,y:0,rotation:0}),t.screenBounds===null&&(t.screenBounds={x:0,y:0,w:1,h:1})}}]}),Eq=wo("instance_presence",{validator:Cq,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:null,followingUserId:null,color:"#FF0000",camera:null,cursor:null,screenBounds:null,selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),Pq=Co("document",st({typeName:_r("document"),id:_r("document:document"),gridSize:Le,name:Ye,meta:tr})),bR=ai("com.tldraw.document",{AddName:1,AddMeta:2}),Tq=ki({sequenceId:"com.tldraw.document",recordType:"document",sequence:[{id:bR.AddName,up:t=>{t.name=""},down:t=>{delete t.name}},{id:bR.AddMeta,up:t=>{t.meta={}}}]}),l2=wo("document",{validator:Pq,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),uC=l2.createId("document");function Iq(t,e){return t.index<e.index?-1:t.index>e.index?1:0}function xR(t){t.typeName==="asset"&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}function Mq({error:t,phase:e,record:n,recordBefore:r}){throw T_(t,{tags:{origin:"store.validateRecord",storePhase:e,isExistingValidationIssue:e==="initialize"},extras:{recordBefore:r?xR(Xt(r)):void 0,recordAfter:xR(Xt(n))}}),t}function Aq(){return[Ai.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function kq(t){const e=t.query.ids("page"),n=t.query.records("instance_page_state"),r=()=>{if(!t.has(uC))return t.put([l2.create({id:uC,name:t.props.defaultName})]),r();if(!t.has(wy))return t.put([a2.create({id:wy})]),r();const i=e.get();if(i.size===0)return t.put(Aq()),r();const s=()=>[...i].map(f=>t.get(f)).sort(Iq)[0].id,o=t.get(kr);if(o){if(!i.has(o.currentPageId))return t.put([{...o,currentPageId:s()}]),r()}else return t.put([t.schema.types.instance.create({id:kr,currentPageId:s(),exportBackground:!0})]),r();const l=new Set,u=new Set;for(const f of i){const g=Is.createId(f);t.get(g)||l.add(g);const S=oo.createId(f);t.has(S)||u.add(S)}l.size>0&&t.put([...l].map(f=>Is.create({id:f,pageId:Is.parseId(f)}))),u.size>0&&t.put([...u].map(f=>oo.create({id:f})));const d=n.get();for(const f of d){if(!i.has(f.pageId)){t.remove([f.id]);continue}if(f.croppingShapeId&&!t.has(f.croppingShapeId))return t.put([{...f,croppingShapeId:null}]),r();if(f.focusedGroupId&&!t.has(f.focusedGroupId))return t.put([{...f,focusedGroupId:null}]),r();if(f.hoveredShapeId&&!t.has(f.hoveredShapeId))return t.put([{...f,hoveredShapeId:null}]),r();const g=f.selectedShapeIds.filter(b=>t.has(b));if(g.length!==f.selectedShapeIds.length)return t.put([{...f,selectedShapeIds:g}]),r();const m=f.hintingShapeIds.filter(b=>t.has(b));if(m.length!==f.hintingShapeIds.length)return t.put([{...f,hintingShapeIds:m}]),r();const S=f.erasingShapeIds.filter(b=>t.has(b));if(S.length!==f.erasingShapeIds.length)return t.put([{...f,erasingShapeIds:S}]),r()}};return r}const Rq=s2("bookmark",st({title:Ye,description:Ye,image:Ye,favicon:Ye,src:xc.nullable()})),wR=ai("com.tldraw.asset.bookmark",{MakeUrlsValid:1,AddFavicon:2}),Oq=ki({sequenceId:"com.tldraw.asset.bookmark",recordType:"asset",filter:t=>t.type==="bookmark",sequence:[{id:wR.MakeUrlsValid,up:t=>{xc.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:wR.AddFavicon,up:t=>{xc.isValid(t.props.favicon)||(t.props.favicon="")},down:t=>{delete t.props.favicon}}]}),jq=s2("image",st({w:Le,h:Le,name:Ye,isAnimated:rt,mimeType:Ye.nullable(),src:xc.nullable(),fileSize:Cn.optional()})),Uh=ai("com.tldraw.asset.image",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4,MakeFileSizeOptional:5}),Dq=ki({sequenceId:"com.tldraw.asset.image",recordType:"asset",filter:t=>t.type==="image",sequence:[{id:Uh.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:Uh.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:Uh.MakeUrlsValid,up:t=>{xc.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:Uh.AddFileSize,up:t=>{t.props.fileSize=-1},down:t=>{delete t.props.fileSize}},{id:Uh.MakeFileSizeOptional,up:t=>{t.props.fileSize===-1&&(t.props.fileSize=void 0)},down:t=>{t.props.fileSize===void 0&&(t.props.fileSize=-1)}}]}),Lq=s2("video",st({w:Le,h:Le,name:Ye,isAnimated:rt,mimeType:Ye.nullable(),src:xc.nullable(),fileSize:Le.optional()})),Hh=ai("com.tldraw.asset.video",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4,MakeFileSizeOptional:5}),Nq=ki({sequenceId:"com.tldraw.asset.video",recordType:"asset",filter:t=>t.type==="video",sequence:[{id:Hh.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:Hh.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:Hh.MakeUrlsValid,up:t=>{xc.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:Hh.AddFileSize,up:t=>{t.props.fileSize=-1},down:t=>{delete t.props.fileSize}},{id:Hh.MakeFileSizeOptional,up:t=>{t.props.fileSize===-1&&(t.props.fileSize=void 0)},down:t=>{t.props.fileSize===void 0&&(t.props.fileSize=-1)}}]}),zq=Co("asset",n2("type",{image:jq,video:Lq,bookmark:Rq})),$q=ai("com.tldraw.asset",{AddMeta:1}),Bq=ki({sequenceId:"com.tldraw.asset",recordType:"asset",sequence:[{id:$q.AddMeta,up:t=>{t.meta={}}}]}),yl=wo("asset",{validator:zq,scope:"document"}).withDefaultProperties(()=>({meta:{}})),f3={w:Cn,h:Cn,assetId:cS.nullable(),url:Ii},CR=Ls("bookmark",{NullAssetId:1,MakeUrlsValid:2}),p3={sequence:[{id:CR.NullAssetId,up:t=>{t.assetId===void 0&&(t.assetId=null)},down:"retired"},{id:CR.MakeUrlsValid,up:t=>{Ii.isValid(t.url)||(t.url="")},down:t=>{}}]},g3=st({type:lS("free","straight"),points:er(wc)}),m3={color:Mi,fill:_c,dash:Cc,size:yo,segments:er(g3),isComplete:rt,isClosed:rt,isPen:rt,scale:Cn},_R=Ls("draw",{AddInPen:1,AddScale:2}),y3={sequence:[{id:_R.AddInPen,up:t=>{const{points:e}=t.segments[0];if(e.length===0){t.isPen=!1;return}let n=!(e[0].z===0||e[0].z===.5);e[1]&&(n=n&&!(e[1].z===0||e[1].z===.5)),t.isPen=n},down:"retired"},{id:_R.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},Fq=/(^\/r\/[^/]+\/?$)/,Uq=[{hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(Fq))return t}},{hostnames:["figma.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/?$/)){const n=e.searchParams.get("url");if(n)return n}}},{hostnames:["google.*"],fromEmbedUrl:t=>{const e=Ge(t);if(!e)return;if(e.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&e.searchParams.has("center")&&e.searchParams.get("zoom")){const r=e.searchParams.get("zoom"),[i,s]=e.searchParams.get("center").split(",");return`https://www.google.com/maps/@${i},${s},${r}z`}}},{hostnames:["val.town"],fromEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/embed\/(.+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{hostnames:["codesandbox.io"],fromEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{hostnames:["codepen.io"],fromEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,i,s]=n;return`https://codepen.io/${i}/pen/${s}`}}},{hostnames:["scratch.mit.edu"],fromEmbedUrl:t=>{const e=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,i]=n;return`https://scratch.mit.edu/projects/${i}`}}},{hostnames:["*.youtube.com","youtube.com","youtu.be"],fromEmbedUrl:t=>{const e=Ge(t);if(!e)return;if(e.hostname.replace(/^www./,"")==="youtube.com"){const r=e.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{hostnames:["calendar.google.*"],fromEmbedUrl:t=>{const e=Ge(t),n=e==null?void 0:e.searchParams.get("src");if(e!=null&&e.pathname.match(/\/calendar\/embed/)&&n){e.pathname="/calendar/u/0";const r=Array.from(e.searchParams.keys());for(const i of r)e.searchParams.delete(i);return e.searchParams.set("cid",n),e.href}}},{hostnames:["docs.google.*"],fromEmbedUrl:t=>{const e=Ge(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/embed\/?$/))){e.pathname=e.pathname.replace(/\/embed$/,"/pub");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}}},{hostnames:["gist.github.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0}},{hostnames:["replit.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/)&&e.searchParams.has("embed"))return e.searchParams.delete("embed"),e.href}},{hostnames:["felt.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/map\//))return e.pathname=e.pathname.replace(/^\/embed/,""),e.href}},{hostnames:["open.spotify.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/(artist|album)\//))return e.origin+e.pathname.replace(/^\/embed/,"")}},{hostnames:["vimeo.com","player.vimeo.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="player.vimeo.com"){const n=e.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{hostnames:["excalidraw.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hash.match(/#room=/))return t}},{hostnames:["observablehq.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","")}#cell-*`;if(e&&e.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","/d")}#cell-*`}},{hostnames:["desmos.com"],fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search==="?embed"&&e.hash==="")return t.replace("?embed","")}}],S3={w:Cn,h:Cn,url:Ye},zg=Ls("embed",{GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4}),v3={sequence:[{id:zg.GenOriginalUrlInEmbed,up:t=>{try{const e=t.url,n=new URL(e).host.replace("www.","");let r;for(const i of Uq)if(i.hostnames.includes(n))try{r=i.fromEmbedUrl(e)}catch(s){console.warn(s)}t.tmpOldUrl=t.url,t.url=r??""}catch{t.url="",t.tmpOldUrl=t.url}},down:"retired"},{id:zg.RemoveDoesResize,up:t=>{delete t.doesResize},down:"retired"},{id:zg.RemoveTmpOldUrl,up:t=>{delete t.tmpOldUrl},down:"retired"},{id:zg.RemovePermissionOverrides,up:t=>{delete t.overridePermissions},down:"retired"}]},b3={w:Cn,h:Cn,name:Ye},x3={sequence:[]},Cy=sr.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),_y=sr.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),Ms=sr.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box","heart"]}),w3={geo:Ms,labelColor:o2,color:Mi,fill:_c,dash:Cc,size:yo,font:mo,align:Cy,verticalAlign:_y,url:Ii,w:Cn,h:Cn,growY:yy,text:Ye,scale:Cn},ea=Ls("geo",{AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8,AddScale:9}),C3={sequence:[{id:ea.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:ea.AddLabelColor,up:t=>{t.labelColor="black"},down:"retired"},{id:ea.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:ea.AddCheckBox,up:t=>{},down:"retired"},{id:ea.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:"retired"},{id:ea.MigrateLegacyAlign,up:t=>{let e;switch(t.align){case"start":e="start-legacy";break;case"end":e="end-legacy";break;default:e="middle-legacy";break}t.align=e},down:"retired"},{id:ea.AddCloud,up:t=>{},down:"retired"},{id:ea.MakeUrlsValid,up:t=>{Ii.isValid(t.url)||(t.url="")},down:t=>{}},{id:ea.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},_3={},E3={sequence:[]},P3={color:Mi,size:yo,segments:er(g3),isComplete:rt,isPen:rt,scale:Cn},Hq=Ls("highlight",{AddScale:1}),T3={sequence:[{id:Hq.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},Kq=st({topLeft:wc,bottomRight:wc}),I3={w:Cn,h:Cn,playing:rt,url:Ii,assetId:cS.nullable(),crop:Kq.nullable(),flipX:rt,flipY:rt},$g=Ls("image",{AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3,AddFlipProps:4}),M3={sequence:[{id:$g.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:$g.AddCropProp,up:t=>{t.crop=null},down:t=>{delete t.crop}},{id:$g.MakeUrlsValid,up:t=>{Ii.isValid(t.url)||(t.url="")},down:t=>{}},{id:$g.AddFlipProps,up:t=>{t.flipX=!1,t.flipY=!1},down:t=>{delete t.flipX,delete t.flipY}}]},Ey=sr.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),Gq=st({id:Ye,index:i2,x:Le,y:Le}),A3={color:Mi,dash:Cc,size:yo,spline:Ey,points:Sy(Ye,Gq),scale:Cn},Kh=Ls("line",{AddSnapHandles:1,RemoveExtraHandleProps:2,HandlesToPoints:3,PointIndexIds:4,AddScale:5}),k3={sequence:[{id:Kh.AddSnapHandles,up:t=>{for(const e of Object.values(t.handles))e.canSnap=!0},down:"retired"},{id:Kh.RemoveExtraHandleProps,up:t=>{t.handles=M_(Object.values(t.handles).map(e=>[e.index,{x:e.x,y:e.y}]))},down:t=>{const e=Object.entries(t.handles).map(([n,r])=>({index:n,...r})).sort(vr);t.handles=Object.fromEntries(e.map((n,r)=>{const i=r===0?"start":r===e.length-1?"end":`handle:${n.index}`;return[i,{id:i,type:"vertex",canBind:!1,canSnap:!0,index:n.index,x:n.x,y:n.y}]}))}},{id:Kh.HandlesToPoints,up:t=>{const e=Object.entries(t.handles).map(([n,{x:r,y:i}])=>({x:r,y:i,index:n})).sort(vr);t.points=e.map(({x:n,y:r})=>({x:n,y:r})),delete t.handles},down:t=>{const e=Af(t.points.length);t.handles=Object.fromEntries(t.points.map((n,r)=>[e[r],{x:n.x,y:n.y}])),delete t.points}},{id:Kh.PointIndexIds,up:t=>{const e=Af(t.points.length);t.points=Object.fromEntries(t.points.map((n,r)=>{const i=e[r];return[i,{id:i,index:i,x:n.x,y:n.y}]}))},down:t=>{const e=Object.values(t.points).sort(vr);t.points=e.map(({x:n,y:r})=>({x:n,y:r}))}},{id:Kh.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},R3={color:Mi,labelColor:o2,size:yo,font:mo,fontSizeAdjustment:yy,align:Cy,verticalAlign:_y,growY:yy,url:Ii,text:Ye,scale:Cn},tl=Ls("note",{AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5,AddFontSizeAdjustment:6,AddScale:7,AddLabelColor:8}),O3={sequence:[{id:tl.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:tl.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:tl.MigrateLegacyAlign,up:t=>{switch(t.align){case"start":t.align="start-legacy";return;case"end":t.align="end-legacy";return;default:t.align="middle-legacy";return}},down:"retired"},{id:tl.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:"retired"},{id:tl.MakeUrlsValid,up:t=>{Ii.isValid(t.url)||(t.url="")},down:t=>{}},{id:tl.AddFontSizeAdjustment,up:t=>{t.fontSizeAdjustment=0},down:t=>{delete t.fontSizeAdjustment}},{id:tl.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}},{id:tl.AddLabelColor,up:t=>{t.labelColor="black"},down:t=>{delete t.labelColor}}]},dC=sr.defineEnum("tldraw:textAlign",{defaultValue:"start",values:["start","middle","end"]}),j3={color:Mi,size:yo,font:mo,textAlign:dC,w:Cn,text:Ye,scale:Cn,autoSize:rt},ER=Ls("text",{RemoveJustify:1,AddTextAlign:2}),D3={sequence:[{id:ER.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:ER.AddTextAlign,up:t=>{t.textAlign=t.align,delete t.align},down:t=>{t.align=t.textAlign,delete t.textAlign}}]},L3={w:Cn,h:Cn,time:Le,playing:rt,url:Ii,assetId:cS.nullable()},PR=Ls("video",{AddUrlProp:1,MakeUrlsValid:2}),N3={sequence:[{id:PR.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:PR.MakeUrlsValid,up:t=>{Ii.isValid(t.url)||(t.url="")},down:t=>{}}]},Bg=ai("com.tldraw.store",{RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4}),qq=Xu({sequenceId:"com.tldraw.store",retroactive:!1,sequence:[{id:Bg.RemoveCodeAndIconShapeTypes,scope:"store",up:t=>{for(const[e,n]of ri(t))n.typeName==="shape"&&(n.type==="icon"||n.type==="code")&&delete t[e]}},{id:Bg.AddInstancePresenceType,scope:"store",up(t){}},{id:Bg.RemoveTLUserAndPresenceAndAddPointer,scope:"store",up:t=>{for(const[e,n]of ri(t))n.typeName.match(/^(user|user_presence)$/)&&delete t[e]}},{id:Bg.RemoveUserDocument,scope:"store",up:t=>{for(const[e,n]of ri(t))n.typeName.match("user_document")&&delete t[e]}}]}),Yq={arrow:{migrations:a3,props:o3},bookmark:{migrations:p3,props:f3},draw:{migrations:y3,props:m3},embed:{migrations:v3,props:S3},frame:{migrations:x3,props:b3},geo:{migrations:C3,props:w3},group:{migrations:E3,props:_3},highlight:{migrations:T3,props:P3},image:{migrations:M3,props:I3},line:{migrations:k3,props:A3},note:{migrations:O3,props:R3},text:{migrations:D3,props:j3},video:{migrations:N3,props:L3}},Vq={arrow:{migrations:c3,props:l3}};function Wq({shapes:t=Yq,bindings:e=Vq,migrations:n}={}){const r=new Map;for(const l of ln(t))for(const u of t3(l.props??{}).keys()){if(r.has(u.id)&&r.get(u.id)!==u)throw new Error(`Multiple StyleProp instances with the same id: ${u.id}`);r.set(u.id,u)}const i=rq(t),s=eq(e),o=mq(r);return e2.create({asset:yl,binding:s,camera:oo,document:l2,instance:o,instance_page_state:Is,page:Ai,instance_presence:Eq,pointer:a2,shape:i},{migrations:[qq,Bq,oq,Tq,yq,vq,pq,_q,wq,nq,Oq,Dq,Nq,...vR("shape",t),...vR("binding",e),...n??[]],onValidationFailure:Mq,createIntegrityChecker:kq})}const Rf=[{locale:"id",label:"Bahasa Indonesia"},{locale:"ms",label:"Bahasa Melayu"},{locale:"ca",label:"Catal"},{locale:"cs",label:"etina"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espaol"},{locale:"tl",label:"Filipino"},{locale:"fr",label:"Franais"},{locale:"gl",label:"Galego"},{locale:"hr",label:"Hrvatski"},{locale:"it",label:"Italiano"},{locale:"hu",label:"Magyar"},{locale:"nl",label:"Nederlands"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugus - Brasil"},{locale:"pt-pt",label:"Portugus - Europeu"},{locale:"ro",label:"Romn"},{locale:"sl",label:"Slovenina"},{locale:"so",label:"Somali"},{locale:"fi",label:"Suomi"},{locale:"sv",label:"Svenska"},{locale:"vi",label:"Ting Vit"},{locale:"tr",label:"Trke"},{locale:"el",label:""},{locale:"ru",label:""},{locale:"uk",label:""},{locale:"he",label:""},{locale:"ur",label:""},{locale:"ar",label:""},{locale:"fa",label:""},{locale:"ne",label:""},{locale:"mr",label:""},{locale:"hi-in",label:""},{locale:"bn",label:""},{locale:"pa",label:""},{locale:"gu-in",label:""},{locale:"ta",label:""},{locale:"te",label:""},{locale:"kn",label:""},{locale:"ml",label:""},{locale:"th",label:""},{locale:"km-kh",label:""},{locale:"ko-kr",label:""},{locale:"ja",label:""},{locale:"zh-cn",label:""},{locale:"zh-tw",label:" ()"}];function Xq(){const t=typeof window<"u"?window.navigator.languages??["en"]:["en"];return Zq(t)}function Zq(t){for(const e of t){const n=Qq(e);if(n)return n}return"en"}const TR={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function Qq(t){const e=Rf.find(i=>i.locale===t.toLowerCase());if(e)return e.locale;const[n,r]=t.split(/[-_]/).map(i=>i.toLowerCase());if(r){const i=Rf.find(s=>s.locale===n);if(i)return i.locale}return n in TR?TR[n]:null}El("@tldraw/tlschema","3.8.1","esm");var Ow={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var IR;function Jq(){return IR||(IR=1,function(t){(function(){var e={}.hasOwnProperty;function n(){for(var s="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(s=i(s,r(l)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return n.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var l in s)e.call(s,l)&&s[l]&&(o=i(o,l));return o}function i(s,o){return o?s?s+" "+o:s+o:s}t.exports?(n.default=n,t.exports=n):window.classNames=n})()}(Ow)),Ow.exports}var eY=Jq();const je=_l(eY),z3="3.8.1",MR={major:"2024-09-13T14:36:29.063Z",minor:"2025-02-12T15:48:24.555Z"},tY={error:null};class c2 extends E.Component{constructor(){super(...arguments);O(this,"state",tY)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,i;(i=(r=this.props).onError)==null||i.call(r,n)}render(){const{error:n}=this.state;if(n!==null){const{fallback:r}=this.props;return p.jsx(r,{error:n})}return this.props.children}}function Of({children:t,fallback:e,...n}){return e===null?t:p.jsx(c2,{fallback:e,...n,children:t})}function u2(t,e){return uS(`${t}_${e}`)}function xd(t){return uS(`${E.useId()}${t??""}`)}function As(t){const e=Qr(E.useContext($3));return uS(`${e}_${t}`)}function uS(t){return t.replace(/:/g,"_")}const $3=E.createContext(null);function nY({children:t}){const e=xd();return p.jsx($3.Provider,{value:e,children:t})}const d2=E.createContext(null);function re(){const t=et.useContext(d2);if(!t)throw new Error("useEditor must be used inside of the <Tldraw /> or <TldrawEditor /> components");return t}function Ml(){return et.useContext(d2)}function h2({editor:t,children:e}){return p.jsx(d2.Provider,{value:t,children:p.jsx(nY,{children:e})})}function rY(){return p.jsx("div",{className:"tl-background"})}function wd(t,e,n,r,i,s){E.useLayoutEffect(()=>{const o=t.current;if(!o||e===void 0)return;let l=`translate(${e}px, ${n}px)`;r!==void 0&&(l+=` scale(${r})`),i!==void 0&&(l+=` rotate(${i}rad)`),s&&(l+=` translate(${s.x}px, ${s.y}px)`),o.style.transform=l})}const jw=({brush:t,color:e,opacity:n,className:r})=>{const i=E.useRef(null);wd(i,t.x,t.y);const s=ne(Math.max(1,t.w)),o=ne(Math.max(1,t.h));return p.jsx("svg",{className:"tl-overlays__item",ref:i,children:e?p.jsxs("g",{className:"tl-brush",opacity:n,children:[p.jsx("rect",{width:s,height:o,fill:e,opacity:.75}),p.jsx("rect",{width:s,height:o,fill:"none",stroke:e,opacity:.1})]}):p.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:s,height:o})})},Ft={isSafari:!1,isIos:!1,isChromeForIos:!1,isFirefox:!1,isAndroid:!1,isWebview:!1,isDarwin:!1};typeof window<"u"&&"navigator"in window&&(Ft.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Ft.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),Ft.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),Ft.isFirefox=/firefox/i.test(navigator.userAgent),Ft.isAndroid=/android/i.test(navigator.userAgent),Ft.isDarwin=window.navigator.userAgent.toLowerCase().indexOf("mac")>-1);const AR={isLocked:!1,wheelBehavior:"pan",panSpeed:1,zoomSpeed:1,zoomSteps:[.1,.25,.5,1,2,4,8]},Dw={duration:0,easing:Kn.easeInOutCubic},kR={CAMERA_MOVE:-10},iY=["top","right","bottom","left"],RR=0,f2=2,Fg=1,OR=5,sY=128;var Lw={};const oY={},B3=Yr("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),xn={logPreventDefaults:Yr("logPreventDefaults",{defaults:{all:!1}}),logPointerCaptures:Yr("logPointerCaptures",{defaults:{all:!1}}),logElementRemoves:Yr("logElementRemoves",{defaults:{all:!1}}),debugSvg:Yr("debugSvg",{defaults:{all:!1}}),showFps:Yr("showFps",{defaults:{all:!1}}),measurePerformance:Yr("measurePerformance",{defaults:{all:!1}}),throwToBlob:Yr("throwToBlob",{defaults:{all:!1}}),reconnectOnPing:Yr("reconnectOnPing",{defaults:{all:!1}}),debugCursors:Yr("debugCursors",{defaults:{all:!1}}),forceSrgb:Yr("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:Yr("debugGeometry",{defaults:{all:!1}}),hideShapes:Yr("hideShapes",{defaults:{all:!1}}),editOnType:Yr("editOnType",{defaults:{all:!1}})};if(typeof Element<"u"){const t=Element.prototype.removeChild;co("element removal logging",()=>{xn.logElementRemoves.get()?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),t.call(this,e)}:Element.prototype.removeChild=t})}function Yr(t,{defaults:e,shouldStoreForSession:n=!0}){return aY({name:t,defaults:e,shouldStoreForSession:n})}function aY(t){const e=cY(t),n=t.shouldStoreForSession?lY(t.name):null,r=On(`debug:${t.name}`,n??e);return typeof window<"u"&&(t.shouldStoreForSession&&co(`debug:${t.name}`,()=>{const i=r.get();i===e?JD(`tldraw_debug:${t.name}`):D_(`tldraw_debug:${t.name}`,JSON.stringify(i))}),Object.defineProperty(window,`tldraw${t.name.replace(/^[a-z]/,i=>i.toUpperCase())}`,{get(){return r.get()},set(i){r.set(i)},configurable:!0})),Object.assign(r,t)}function lY(t){try{return JSON.parse(QD(`tldraw_debug:${t}`)??"null")}catch{return null}}function Nw(t){try{return t()}catch{return null}}function cY(t){switch(Nw(()=>Lw.TLDRAW_ENV)??Nw(()=>Lw.VERCEL_PUBLIC_TLDRAW_ENV)??Nw(()=>Lw.NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return t.defaults.production??t.defaults.all;case"preview":case"staging":return t.defaults.staging??t.defaults.all;default:return t.defaults.development??t.defaults.all}}function Py(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return Py(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Je(t){t.preventDefault(),xn.logPreventDefaults.get()&&console.warn("preventDefault called on event:",t)}function np(t,e){if(t.setPointerCapture(e.pointerId),xn.logPointerCaptures.get()){const n=B3.get();n.set(t,(n.get(t)??0)+1),console.warn("setPointerCapture called on element:",t,e)}}function rp(t,e){if(t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),xn.logPointerCaptures.get())){const n=B3.get();n.get(t)===1?n.delete(t):n.has(t)?n.set(t,n.get(t)-1):console.warn("Release without capture"),console.warn("releasePointerCapture called on element:",t,e)}}const _n=t=>t.stopPropagation(),gr=(t,e,n)=>{t&&t.style.setProperty(e,n)},uY=["input","select","button","textarea"];function F3(){const{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||uY.indexOf(t.tagName.toLowerCase())>-1))}const br=t=>Ft.isDarwin?t.metaKey:t.ctrlKey||t.metaKey;function xi(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,metaKey:t.metaKey,accelKey:br(t),pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}function p2(){const t=re();return E.useMemo(function(){let r,i;function s(v){if(!v.isKilled){if(v.button===f2){t.dispatch({type:"pointer",target:"canvas",name:"right_click",...xi(v)});return}v.button!==0&&v.button!==1&&v.button!==5||(np(v.currentTarget,v),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...xi(v)}))}}function o(v){v.isKilled||v.clientX===r&&v.clientY===i||(r=v.clientX,i=v.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...xi(v)}))}function l(v){v.isKilled||v.button!==0&&v.button!==1&&v.button!==2&&v.button!==5||(r=v.clientX,i=v.clientY,rp(v.currentTarget,v),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...xi(v)}))}function u(v){if(v.isKilled||t.getInstanceState().isPenMode&&v.pointerType!=="pen")return;const w=v.pointerType==="mouse"||v.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:w?!0:null})}function d(v){if(v.isKilled||t.getInstanceState().isPenMode&&v.pointerType!=="pen")return;const w=v.pointerType==="mouse"||v.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:w?!1:null})}function f(v){v.isKilled=!0,Je(v)}function g(v){v.isKilled=!0,v.target instanceof HTMLElement&&v.target.tagName!=="A"&&v.target.tagName!=="TEXTAREA"&&!(t.getEditingShape()&&v.target.className.includes("tl-text-content"))&&Je(v)}function m(v){Je(v)}async function S(v){var C,_;if(Je(v),_n(v),(_=(C=v.dataTransfer)==null?void 0:C.files)!=null&&_.length){const M=Array.from(v.dataTransfer.files);await t.putExternalContent({type:"files",files:M,point:t.screenToPage({x:v.clientX,y:v.clientY}),ignoreParent:!1});return}const w=v.dataTransfer.getData("url");if(w){await t.putExternalContent({type:"url",url:w,point:t.screenToPage({x:v.clientX,y:v.clientY})});return}}function b(v){_n(v)}return{onPointerDown:s,onPointerMove:o,onPointerUp:l,onPointerEnter:u,onPointerLeave:d,onDragOver:m,onDrop:S,onTouchStart:f,onTouchEnd:g,onClick:b}},[t])}function dY(){const t=re();E.useEffect(()=>{let e=t.getInstanceState().isCoarsePointer;const n=o=>{const l=o.pointerType!=="mouse";e!==l&&(e=l,t.updateInstanceState({isCoarsePointer:l}))};window.addEventListener("pointerdown",n,{capture:!0});const r=window.matchMedia&&window.matchMedia("(any-pointer: coarse)"),i=Ft.isFirefox&&!Ft.isAndroid&&!Ft.isIos,s=()=>{const o=i?!1:r.matches;e===o&&(e=o,t.updateInstanceState({isCoarsePointer:o}))};return r&&(r.addEventListener("change",s),s()),()=>{window.removeEventListener("pointerdown",n,{capture:!0}),r&&r.removeEventListener("change",s)}},[t])}const U3=E.createContext(null);function H3({container:t,children:e}){return p.jsx(U3.Provider,{value:t,children:e})}function zn(){return Qr(E.useContext(U3),"useContainer used outside of <Tldraw />")}function hY(){const t=re(),e=zn(),n=oe("isFocused",()=>t.getIsFocused(),[t]);E.useEffect(()=>{if(!e)return;function r(i){if(i.isSpecialRedispatchedEvent)return;Je(i),_n(i);const s=e.querySelector(".tl-canvas");if(!s)return;const o=new DragEvent(i.type,i);o.isSpecialRedispatchedEvent=!0,s.dispatchEvent(o)}return e.addEventListener("dragover",r),e.addEventListener("drop",r),()=>{e.removeEventListener("dragover",r),e.removeEventListener("drop",r)}},[e]),E.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;let r=null;const i=()=>{r!=null&&r();const s=`(resolution: ${window.devicePixelRatio}dppx)`,o=matchMedia(s),l=u=>{u.type==="change"&&i()};o.addEventListener?o.addEventListener("change",i):o.addListener&&o.addListener(l),r=()=>{o.removeEventListener?o.removeEventListener("change",i):o.removeListener&&o.removeListener(l)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return i(),()=>{r==null||r()}},[t]),E.useEffect(()=>{if(!n)return;const r=l=>{if(l.altKey&&(t.isIn("zoom")||!t.getPath().endsWith(".idle"))&&!Ug(t)&&Je(l),l.isKilled)return;switch(l.isKilled=!0,l.key){case"=":case"-":case"0":{if(l.metaKey||l.ctrlKey){Je(l);return}break}case"Tab":{if(Ug(t))return;break}case",":return;case"Escape":{if((t.getEditingShape()||t.getSelectedShapeIds().length>0)&&Je(l),t.menus.getOpenMenus().length>0)return;t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),e.focus());return}default:if(Ug(t))return}const u={type:"keyboard",name:l.repeat?"key_repeat":"key_down",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey,metaKey:l.metaKey,accelKey:br(l)};t.dispatch(u)},i=l=>{if(l.isKilled||(l.isKilled=!0,Ug(t))||l.key===",")return;const u={type:"keyboard",name:"key_up",key:l.key,code:l.code,shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey,metaKey:l.metaKey,accelKey:br(l)};t.dispatch(u)};function s(l){var u,d;if(e.contains(l.target)){const f=l.touches[0].pageX,g=l.touches[0].radiusX||0;(f-g<10||f+g>t.getViewportScreenBounds().width-10)&&(((u=l.target)==null?void 0:u.tagName)==="BUTTON"&&((d=l.target)==null||d.click()),Je(l))}}const o=l=>{e.contains(l.target)&&(l.ctrlKey||l.metaKey)&&Je(l)};return e.addEventListener("touchstart",s,{passive:!1}),e.addEventListener("wheel",o,{passive:!1}),document.addEventListener("gesturestart",Je),document.addEventListener("gesturechange",Je),document.addEventListener("gestureend",Je),e.addEventListener("keydown",r),e.addEventListener("keyup",i),()=>{e.removeEventListener("touchstart",s),e.removeEventListener("wheel",o),document.removeEventListener("gesturestart",Je),document.removeEventListener("gesturechange",Je),document.removeEventListener("gestureend",Je),e.removeEventListener("keydown",r),e.removeEventListener("keyup",i)}},[t,e,n])}function Ug(t){return t.menus.hasOpenMenus()||F3()}const fY=["textarea","input"];function pY(t){const e=re();E.useEffect(()=>{const n=t.current;if(!n)return;const r=i=>{var s;if(i instanceof PointerEvent&&i.pointerType==="pen"){i.isKilled=!0;const{target:o}=i;if(fY.includes((s=o.tagName)==null?void 0:s.toLocaleLowerCase())||e.isIn("select.editing_shape"))return;Je(i)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.removeEventListener("touchend",r)}},[e,t])}function gY(t,e,n){return Math.max(e,Math.min(t,n))}const nr={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function jR(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function DR(t,e,n,r=.15){return r===0?gY(t,e,n):t<e?-jR(e-t,n-e,r)+e:t>n?+jR(t-n,n-e,r)+n:t}function mY(t,[e,n],[r,i]){const[[s,o],[l,u]]=t;return[DR(e,s,o,r),DR(n,l,u,i)]}function yY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SY(t){var e=yY(t,"string");return typeof e=="symbol"?e:String(e)}function yr(t,e,n){return e=SY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LR(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function cn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LR(Object(n),!0).forEach(function(r){yr(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LR(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const K3={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function NR(t){return t?t[0].toUpperCase()+t.slice(1):""}const vY=["enter","leave"];function bY(t=!1,e){return t&&!vY.includes(e)}function xY(t,e="",n=!1){const r=K3[t],i=r&&r[e]||e;return"on"+NR(t)+NR(i)+(bY(n,i)?"Capture":"")}const wY=["gotpointercapture","lostpointercapture"];function CY(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const r=wY.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(r);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:n}}function _Y(t,e=""){const n=K3[t],r=n&&n[e]||e;return t+r}function G3(t){return"touches"in t}function EY(t){return G3(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function PY(t){return Array.from(t.touches).filter(e=>{var n,r;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,e.target))})}function hC(t,e){try{const n=e.clientX-t.clientX,r=e.clientY-t.clientY,i=(e.clientX+t.clientX)/2,s=(e.clientY+t.clientY)/2,o=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:o,origin:[i,s]}}catch{}return null}function TY(t){return PY(t).map(e=>e.identifier)}function zR(t,e){const[n,r]=Array.from(t.touches).filter(i=>e.includes(i.identifier));return hC(n,r)}const $R=40,BR=800;function q3(t){let{deltaX:e,deltaY:n,deltaMode:r}=t;return r===1?(e*=$R,n*=$R):r===2&&(e*=BR,n*=BR),[e,n]}function IY(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:i,ctrlKey:s}=t;Object.assign(e,{shiftKey:n,altKey:r,metaKey:i,ctrlKey:s})}return e}function Ty(t,...e){return typeof t=="function"?t(...e):t}function MY(){}function AY(...t){return t.length===0?MY:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function FR(t,e){return Object.assign({},e,t||{})}const kY=32;class Y3{constructor(e,n,r){this.ctrl=e,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:r,args:i}=this;n[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=r.from?Ty(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:r,shared:i}=this;n.args=this.args;let s=0;if(e&&(n.event=e,r.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,IY(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,s=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const R=n._delta.map(Math.abs);nr.addTo(n._distance,R)}this.axisIntent&&this.axisIntent(e);const[o,l]=n._movement,[u,d]=r.threshold,{_step:f,values:g}=n;if(r.hasCustomTransform?(f[0]===!1&&(f[0]=Math.abs(o)>=u&&g[0]),f[1]===!1&&(f[1]=Math.abs(l)>=d&&g[1])):(f[0]===!1&&(f[0]=Math.abs(o)>=u&&Math.sign(o)*u),f[1]===!1&&(f[1]=Math.abs(l)>=d&&Math.sign(l)*d)),n.intentional=f[0]!==!1||f[1]!==!1,!n.intentional)return;const m=[0,0];if(r.hasCustomTransform){const[R,D]=g;m[0]=f[0]!==!1?R-f[0]:0,m[1]=f[1]!==!1?D-f[1]:0}else m[0]=f[0]!==!1?o-f[0]:0,m[1]=f[1]!==!1?l-f[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(m);const S=n.offset,b=n._active&&!n._blocked||n.active;b&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=i[this.ingKey]=n._active,e&&(n.first&&("bounds"in r&&(n._bounds=Ty(r.bounds,n)),this.setup&&this.setup()),n.movement=m,this.computeOffset()));const[v,w]=n.offset,[[C,_],[M,I]]=n._bounds;n.overflow=[v<C?-1:v>_?1:0,w<M?-1:w>I?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const A=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=mY(n._bounds,n.offset,A),n.delta=nr.sub(n.offset,S),this.computeMovement(),b&&(!n.last||s>kY)){n.delta=nr.sub(n.offset,S);const R=n.delta.map(Math.abs);nr.addTo(n.distance,R),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&s>0&&(n.velocity=[R[0]/s,R[1]/s],n.timeDelta=s)}}emit(){const e=this.state,n=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const i=this.handler(cn(cn(cn({},n),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function RY([t,e],n){const r=Math.abs(t),i=Math.abs(e);if(r>i&&r>n)return"x";if(i>r&&i>n)return"y"}class OY extends Y3{constructor(...e){super(...e),yr(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=nr.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=nr.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,r=this.config;if(!n.axis&&e){const i=typeof r.axisThreshold=="object"?r.axisThreshold[EY(e)]:r.axisThreshold;n.axis=RY(n._movement,i)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const jY=t=>t,UR=.15,V3={enabled(t=!0){return t},eventOptions(t,e,n){return cn(cn({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[UR,UR];case!1:return[0,0];default:return nr.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return nr.toVector(t)},transform(t,e,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||jY},threshold(t){return nr.toVector(t,0)}},DY=0,ip=cn(cn({},V3),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=DY){return t},bounds(t={}){if(typeof t=="function")return s=>ip.bounds(t(s));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:r=-1/0,bottom:i=1/0}=t;return[[e,n],[r,i]]}}),sp=typeof window<"u"&&window.document&&window.document.createElement;function W3(){return sp&&"ontouchstart"in window}function LY(){return W3()||sp&&window.navigator.maxTouchPoints>1}function NY(){return sp&&"onpointerdown"in window}function zY(){return sp&&"exitPointerLock"in window.document}function $Y(){try{return"constructor"in GestureEvent}catch{return!1}}const Xi={isBrowser:sp,gesture:$Y(),touch:W3(),touchscreen:LY(),pointer:NY(),pointerLock:zY()},BY=250,FY=180,UY=.5,HY=50,KY=250,GY=10,HR={mouse:0,touch:0,pen:8};cn(cn({},ip),{},{device(t,e,{pointer:{touch:n=!1,lock:r=!1,mouse:i=!1}={}}){return this.pointerLock=r&&Xi.pointerLock,Xi.touch&&n?"touch":this.pointerLock?"mouse":Xi.pointer&&!i?"pointer":Xi.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?BY:void 0,!(!Xi.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:r=1,keys:i=!0}={}}){return this.pointerButtons=r,this.keys=i,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:r=3,axis:i=void 0}){const s=nr.toVector(t,n?r:i?1:0);return this.filterTaps=n,this.tapsThreshold=r,s},swipe({velocity:t=UY,distance:e=HY,duration:n=KY}={}){return{velocity:this.transform(nr.toVector(t)),distance:this.transform(nr.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return FY;case!1:return 0;default:return t}},axisThreshold(t){return t?cn(cn({},HR),t):HR},keyboardDisplacement(t=GY){return t}});function X3(t){const[e,n]=t.overflow,[r,i]=t._delta,[s,o]=t._direction;(e<0&&r>0&&s<0||e>0&&r<0&&s>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&i>0&&o<0||n>0&&i<0&&o>0)&&(t._movement[1]=t._movementBound[1])}const qY=30,YY=100;class VY extends Y3{constructor(...e){super(...e),yr(this,"ingKey","pinching"),yr(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:r}=this.state;e==="wheel"?this.state.offset=nr.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,r]=e._movement;if(!e.axis){const i=Math.abs(n)*qY-Math.abs(r);i<0?e.axis="angle":i>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(s=>r.has(s))||r.size<2)return;this.start(e),n._touchIds=Array.from(r).slice(0,2);const i=zR(e,n._touchIds);i&&this.pinchStart(e,i)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,r=n._pointerEvents,i=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(o=>i.has(o))||(r.size<2&&r.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const s=hC(...Array.from(r.values()));s&&this.pinchStart(e,s)}pinchStart(e,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=zR(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const r=hC(...Array.from(n.values()));r&&this.pinchMove(e,r)}pinchMove(e,n){const r=this.state,i=r._values[1],s=n.angle-i;let o=0;Math.abs(s)>270&&(o+=Math.sign(s)),this.computeValues([n.distance,n.angle-360*o]),r.origin=n.origin,r.turns=o,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const r=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=nr.sub(n._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>e[r]):!e[n])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const r=this.state;r._delta=[-q3(e)[1]/YY*r.offset[0],0],nr.addTo(r._movement,r._delta),X3(r),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this)),e("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const WY=cn(cn({},V3),{},{device(t,e,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Xi.touch&&Xi.gesture)return"gesture";if(Xi.touch&&r)return"touch";if(Xi.touchscreen){if(Xi.pointer)return"pointer";if(Xi.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:r={}}){const i=o=>{const l=FR(Ty(n,o),{min:-1/0,max:1/0});return[l.min,l.max]},s=o=>{const l=FR(Ty(r,o),{min:-1/0,max:1/0});return[l.min,l.max]};return typeof n!="function"&&typeof r!="function"?[i(),s()]:o=>[i(o),s(o)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",nr.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});cn(cn({},ip),{},{mouseOnly:(t=!0)=>t});class XY extends OY{constructor(...e){super(...e),yr(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=q3(e),nr.addTo(n._movement,n._delta),X3(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const ZY=ip;cn(cn({},ip),{},{mouseOnly:(t=!0)=>t});const g2=new Map,fC=new Map;function QY(t){g2.set(t.key,t.engine),fC.set(t.key,t.resolver)}const JY={key:"pinch",engine:VY,resolver:WY},eV={key:"wheel",engine:XY,resolver:ZY};function tV(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function nV(t,e){if(t==null)return{};var n=tV(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const rV={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=Xi.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},iV=["target","eventOptions","window","enabled","transform"];function _m(t={},e){const n={};for(const[r,i]of Object.entries(e))switch(typeof i){case"function":n[r]=i.call(n,t[r],r,t);break;case"object":n[r]=_m(t[r],i);break;case"boolean":i&&(n[r]=t[r]);break}return n}function sV(t,e,n={}){const r=t,{target:i,eventOptions:s,window:o,enabled:l,transform:u}=r,d=nV(r,iV);if(n.shared=_m({target:i,eventOptions:s,window:o,enabled:l,transform:u},rV),e){const f=fC.get(e);n[e]=_m(cn({shared:n.shared},d),f)}else for(const f in d){const g=fC.get(f);g&&(n[f]=_m(cn({shared:n.shared},d[f]),g))}return n}class Z3{constructor(e,n){yr(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,r,i,s){const o=this._listeners,l=_Y(n,r),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},d=cn(cn({},u),s);e.addEventListener(l,i,d);const f=()=>{e.removeEventListener(l,i,d),o.delete(f)};return o.add(f),f}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class oV{constructor(){yr(this,"_timeouts",new Map)}add(e,n,r=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(n,r,...i))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class aV{constructor(e){yr(this,"gestures",new Set),yr(this,"_targetEventStore",new Z3(this)),yr(this,"gestureEventStores",{}),yr(this,"gestureTimeoutStores",{}),yr(this,"handlers",{}),yr(this,"config",{}),yr(this,"pointerIds",new Set),yr(this,"touchIds",new Set),yr(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),lV(this,e)}setEventIds(e){if(G3(e))return this.touchIds=new Set(TY(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=sV(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,r={};let i;if(!(n.target&&(i=n.target(),!i))){if(n.enabled){for(const o of this.gestures){const l=this.config[o],u=KR(r,l.eventOptions,!!i);if(l.enabled){const d=g2.get(o);new d(this,e,o).bind(u)}}const s=KR(r,n.eventOptions,!!i);for(const o in this.nativeHandlers)s(o,"",l=>this.nativeHandlers[o](cn(cn({},this.state.shared),{},{event:l,args:e})),void 0,!0)}for(const s in r)r[s]=AY(...r[s]);if(!i)return r;for(const s in r){const{device:o,capture:l,passive:u}=CY(s);this._targetEventStore.add(i,o,"",r[s],{capture:l,passive:u})}}}}function Tu(t,e){t.gestures.add(e),t.gestureEventStores[e]=new Z3(t,e),t.gestureTimeoutStores[e]=new oV}function lV(t,e){e.drag&&Tu(t,"drag"),e.wheel&&Tu(t,"wheel"),e.scroll&&Tu(t,"scroll"),e.move&&Tu(t,"move"),e.pinch&&Tu(t,"pinch"),e.hover&&Tu(t,"hover")}const KR=(t,e,n)=>(r,i,s,o={},l=!1)=>{var u,d;const f=(u=o.capture)!==null&&u!==void 0?u:e.capture,g=(d=o.passive)!==null&&d!==void 0?d:e.passive;let m=l?r:xY(r,i,f);n&&g&&(m+="Passive"),t[m]=t[m]||[],t[m].push(s)},cV=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function uV(t){const e={},n={},r=new Set;for(let i in t)cV.test(i)?(r.add(RegExp.lastMatch),n[i]=t[i]):e[i]=t[i];return[n,e,r]}function Iu(t,e,n,r,i,s){if(!t.has(n)||!g2.has(r))return;const o=n+"Start",l=n+"End",u=d=>{let f;return d.first&&o in e&&e[o](d),n in e&&(f=e[n](d)),d.last&&l in e&&e[l](d),f};i[r]=u,s[r]=s[r]||{}}function dV(t,e){const[n,r,i]=uV(t),s={};return Iu(i,n,"onDrag","drag",s,e),Iu(i,n,"onWheel","wheel",s,e),Iu(i,n,"onScroll","scroll",s,e),Iu(i,n,"onPinch","pinch",s,e),Iu(i,n,"onMove","move",s,e),Iu(i,n,"onHover","hover",s,e),{handlers:s,config:e,nativeHandlers:r}}function hV(t,e={},n,r){const i=et.useMemo(()=>new aV(t),[]);if(i.applyHandlers(t,r),i.applyConfig(e,n),et.useEffect(i.effect.bind(i)),et.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function fV(t){return t.forEach(QY),function(n,r){const{handlers:i,nativeHandlers:s,config:o}=dV(n,r||{});return hV(i,o,void 0,s)}}const GR=10,pV=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function Q3(t){let{deltaY:e,deltaX:n}=t,r=0;return t.ctrlKey||t.altKey||t.metaKey?r=(Math.abs(e)>GR?GR*Math.sign(e):e)/100:t.shiftKey&&!pV&&(n=e,e=0),{x:-n,y:-e,z:-r}}const gV=fV([eV,JY]);let Mu;const mV=t=>Mu===void 0?(Mu=t,!1):t-Mu>120&&t-Mu<160?(Mu=t,!0):(Mu=t,!1);function yV(t){const e=re(),n=E.useMemo(()=>{let r="not sure";const i=({event:v})=>{if(!e.getInstanceState().isFocused||(r="not sure",mV(Date.now())))return;const w=e.getEditingShapeId();if(w){const M=e.getShape(w);if(M&&e.getShapeUtil(M).canScroll(M)){const A=e.getShapePageBounds(w);if(A!=null&&A.containsPoint(e.inputs.currentPagePoint))return}}Je(v),_n(v);const C=Q3(v);if(C.x===0&&C.y===0)return;const _={type:"wheel",name:"wheel",delta:C,point:new T(v.clientX,v.clientY),shiftKey:v.shiftKey,altKey:v.altKey,ctrlKey:v.metaKey||v.ctrlKey,metaKey:v.metaKey,accelKey:br(v)};e.dispatch(_)};let s=1,o=1,l=1,u=0;const d=new T,f=new T,g=v=>{const w=t.current;r="not sure";const{event:C,origin:_,da:M}=v;C instanceof WheelEvent||(C.target===w||w!=null&&w.contains(C.target))&&(f.x=_[0],f.y=_[1],d.x=_[0],d.y=_[1],s=M[0],o=e.getZoomLevel(),e.dispatch({type:"pinch",name:"pinch_start",point:{x:_[0],y:_[1],z:e.getZoomLevel()},delta:{x:0,y:0},shiftKey:C.shiftKey,altKey:C.altKey,ctrlKey:C.metaKey||C.ctrlKey,metaKey:C.metaKey,accelKey:br(C)}))},m=v=>{if(v&&(r="zooming"),r==="zooming")return;const w=Math.abs(u-s),C=T.Dist(d,f);switch(r){case"not sure":{w>24?r="zooming":C>16&&(r="panning");break}case"panning":{w>64&&(r="zooming");break}}};return{onWheel:i,onPinchStart:g,onPinchEnd:v=>{const w=t.current,{event:C,origin:_,offset:M}=v;if(C instanceof WheelEvent||!(C.target===w||w!=null&&w.contains(C.target)))return;const I=M[0];r="not sure",e.timers.requestAnimationFrame(()=>{e.dispatch({type:"pinch",name:"pinch_end",point:{x:_[0],y:_[1],z:I},delta:{x:_[0],y:_[1]},shiftKey:C.shiftKey,altKey:C.altKey,ctrlKey:C.metaKey||C.ctrlKey,metaKey:C.metaKey,accelKey:br(C)})})},onPinch:v=>{const w=t.current,{event:C,origin:_,offset:M,da:I}=v;if(C instanceof WheelEvent||!(C.target===w||w!=null&&w.contains(C.target)))return;const A=v.type==="gesturechange"||v.type==="gestureend";u=I[0];const R=_[0]-f.x,D=_[1]-f.y;switch(f.x=_[0],f.y=_[1],m(A),r){case"zooming":{l=M[0],e.dispatch({type:"pinch",name:"pinch",point:{x:_[0],y:_[1],z:l},delta:{x:R,y:D},shiftKey:C.shiftKey,altKey:C.altKey,ctrlKey:C.metaKey||C.ctrlKey,metaKey:C.metaKey,accelKey:br(C)});break}case"panning":{e.dispatch({type:"pinch",name:"pinch",point:{x:_[0],y:_[1],z:o},delta:{x:R,y:D},shiftKey:C.shiftKey,altKey:C.altKey,ctrlKey:C.metaKey||C.ctrlKey,metaKey:C.metaKey,accelKey:br(C)});break}}}}},[e,t]);gV(n,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[e.getZoomLevel(),0],scaleBounds:()=>{const r=e.getBaseZoom(),i=e.getCameraOptions().zoomSteps,s=i[0]*r,o=i[i.length-1]*r;return{from:e.getZoomLevel(),max:o,min:s}}}})}function zw(t,e,n){const r=t.getShape(e),i=t.getShapeHandles(r);return{shape:r,handle:i.find(s=>s.id===n)}}function SV(t,e){const n=re();return E.useMemo(()=>{const r=u=>{if(u.isKilled)return;const d=Py(u.currentTarget);np(d,u);const{shape:f,handle:g}=zw(n,t,e);g&&n.dispatch({type:"pointer",target:"handle",handle:g,shape:f,name:"pointer_down",...xi(u)})};let i,s;return{onPointerDown:r,onPointerMove:u=>{if(u.isKilled||u.clientX===i&&u.clientY===s)return;i=u.clientX,s=u.clientY;const{shape:d,handle:f}=zw(n,t,e);f&&n.dispatch({type:"pointer",target:"handle",handle:f,shape:d,name:"pointer_move",...xi(u)})},onPointerUp:u=>{if(u.isKilled)return;const d=Py(u.currentTarget);rp(d,u);const{shape:f,handle:g}=zw(n,t,e);g&&n.dispatch({type:"pointer",target:"handle",handle:g,shape:f,name:"pointer_up",...xi(u)})}}},[n,t,e])}function vV(t){const e=re();E.useLayoutEffect(()=>{const n=kD(()=>{t.current&&e.updateViewportScreenBounds(t.current)},200,{trailing:!0}),r=e.timers.setInterval(n,1e3);window.addEventListener("resize",n);const i=new ResizeObserver(l=>{l[0].contentRect&&n()}),s=t.current;let o=null;return s&&(i.observe(s),o=bV(s),o.addEventListener("scroll",n)),()=>{clearInterval(r),window.removeEventListener("resize",n),i.disconnect(),o==null||o.removeEventListener("scroll",n),n.cancel()}},[e,t])}/*!
 * Author: excalidraw
 * MIT License: https://github.com/excalidraw/excalidraw/blob/master/LICENSE
 * https://github.com/excalidraw/excalidraw/blob/48c3465b19f10ec755b3eb84e21a01a468e96e43/packages/excalidraw/utils.ts#L600
 */const bV=t=>{let e=t.parentElement;for(;e;){if(e===document.body)return document;const{overflowY:n}=window.getComputedStyle(e);if(e.scrollHeight>e.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return e;e=e.parentElement}return document};class xe{constructor(e=0,n=0,r=0,i=0){O(this,"x",0);O(this,"y",0);O(this,"w",0);O(this,"h",0);this.x=e,this.y=n,this.w=r,this.h=i}get point(){return new T(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new T(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new T(this.minX,this.minY),new T(this.maxX,this.minY),new T(this.maxX,this.maxY),new T(this.minX,this.maxY)]}get cornersAndCenter(){return[new T(this.minX,this.minY),new T(this.maxX,this.minY),new T(this.maxX,this.maxY),new T(this.minX,this.maxY),this.center]}get sides(){const{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new T(this.w,this.h)}toFixed(){return this.x=Dg(this.x),this.y=Dg(this.y),this.w=Dg(this.w),this.h=Dg(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,n=0,r=0,i=0){return this.x=e,this.y=n,this.w=r,this.h=i,this}expand(e){const n=Math.min(this.minX,e.minX),r=Math.min(this.minY,e.minY),i=Math.max(this.maxX,e.maxX),s=Math.max(this.maxY,e.maxY);return this.x=n,this.y=r,this.w=i-n,this.h=s-r,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=e*2,this.h+=e*2,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){const{x:e,y:n,w:r,h:i}=this;return new xe(e,n,r,i)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){const n=Math.round(this.minX/e)*e,r=Math.round(this.minY/e)*e,i=Math.round(this.maxX/e)*e,s=Math.round(this.maxY/e)*e;this.minX=n,this.minY=r,this.width=Math.max(1,i-n),this.height=Math.max(1,s-r)}collides(e){return xe.Collides(this,e)}contains(e){return xe.Contains(this,e)}includes(e){return xe.Includes(this,e)}containsPoint(e,n=0){return xe.ContainsPoint(this,e,n)}getHandlePoint(e){switch(e){case"top_left":return new T(this.minX,this.minY);case"top_right":return new T(this.maxX,this.minY);case"bottom_left":return new T(this.minX,this.maxY);case"bottom_right":return new T(this.maxX,this.maxY);case"top":return new T(this.midX,this.minY);case"right":return new T(this.maxX,this.midY);case"bottom":return new T(this.midX,this.maxY);case"left":return new T(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,n,r){const{minX:i,minY:s,maxX:o,maxY:l}=this;let{minX:u,minY:d,maxX:f,maxY:g}=this;switch(e){case"left":case"top_left":case"bottom_left":{u+=n;break}case"right":case"top_right":case"bottom_right":{f+=n;break}}switch(e){case"top":case"top_left":case"top_right":{d+=r;break}case"bottom":case"bottom_left":case"bottom_right":{g+=r;break}}const m=(f-u)/(o-i),S=(g-d)/(l-s),b=m<0,v=S<0;if(b){const w=f;f=u,u=w}if(v){const w=g;g=d,d=w}this.minX=u,this.minY=d,this.width=Math.abs(f-u),this.height=Math.abs(g-d)}union(e){const n=Math.min(this.minX,e.x),r=Math.min(this.minY,e.y),i=Math.max(this.maxX,e.w+e.x),s=Math.max(this.maxY,e.h+e.y);return this.x=n,this.y=r,this.width=i-n,this.height=s-r,this}static From(e){return new xe(e.x,e.y,e.w,e.h)}static FromCenter(e,n){return new xe(e.x-n.x/2,e.y-n.y/2,n.x,n.y)}static FromPoints(e){if(e.length===0)return new xe;let n=1/0,r=1/0,i=-1/0,s=-1/0,o;for(let l=0,u=e.length;l<u;l++)o=e[l],n=Math.min(o.x,n),r=Math.min(o.y,r),i=Math.max(o.x,i),s=Math.max(o.y,s);return new xe(n,r,i-n,s-r)}static Expand(e,n){const r=Math.min(n.minX,e.minX),i=Math.min(n.minY,e.minY),s=Math.max(n.maxX,e.maxX),o=Math.max(n.maxY,e.maxY);return new xe(r,i,s-r,o-i)}static ExpandBy(e,n){return new xe(e.minX-n,e.minY-n,e.width+n*2,e.height+n*2)}static Collides(e,n){return!(e.maxX<n.minX||e.minX>n.maxX||e.maxY<n.minY||e.minY>n.maxY)}static Contains(e,n){return e.minX<n.minX&&e.minY<n.minY&&e.maxY>n.maxY&&e.maxX>n.maxX}static Includes(e,n){return xe.Collides(e,n)||xe.Contains(e,n)}static ContainsPoint(e,n,r=0){return!(n.x<e.minX-r||n.y<e.minY-r||n.x>e.maxX+r||n.y>e.maxY+r)}static Common(e){let n=1/0,r=1/0,i=-1/0,s=-1/0;for(let o=0;o<e.length;o++){const l=e[o];n=Math.min(n,l.minX),r=Math.min(r,l.minY),i=Math.max(i,l.maxX),s=Math.max(s,l.maxY)}return new xe(n,r,i-n,s-r)}static Sides(e,n=0){const{corners:r}=e;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]}static Resize(e,n,r,i,s=!1){const{minX:o,minY:l,maxX:u,maxY:d}=e;let{minX:f,minY:g,maxX:m,maxY:S}=e;switch(n){case"left":case"top_left":case"bottom_left":{f+=r;break}case"right":case"top_right":case"bottom_right":{m+=r;break}}switch(n){case"top":case"top_left":case"top_right":{g+=i;break}case"bottom":case"bottom_left":case"bottom_right":{S+=i;break}}const b=(m-f)/(u-o),v=(S-g)/(d-l),w=b<0,C=v<0;if(s){const M=(u-o)/(d-l),I=Math.abs(m-f),A=Math.abs(S-g),R=I*(v<0?1:-1)*(1/M),D=A*(b<0?1:-1)*M,L=M<I/A;switch(n){case"top_left":{L?g=S+R:f=m+D;break}case"top_right":{L?g=S+R:m=f-D;break}case"bottom_right":{L?S=g-R:m=f-D;break}case"bottom_left":{L?S=g-R:f=m+D;break}case"bottom":case"top":{const G=(f+m)/2,k=A*M;f=G-k/2,m=G+k/2;break}case"left":case"right":{const G=(g+S)/2,k=I/M;g=G-k/2,S=G+k/2;break}}}if(w){const M=m;m=f,f=M}if(C){const M=S;S=g,g=M}const _=new xe(f,g,Math.abs(m-f),Math.abs(S-g));return{box:_,scaleX:+(_.width/e.width*(b>0?1:-1)).toFixed(5),scaleY:+(_.height/e.height*(v>0?1:-1)).toFixed(5)}}equals(e){return xe.Equals(this,e)}static Equals(e,n){return n.x===e.x&&n.y===e.y&&n.w===e.w&&n.h===e.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(e){return new xe(e.x,e.y,Math.max(1,e.w),Math.max(1,e.h))}}function xV(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function wV(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}function CV(t){return t==="top_left"||t==="top_right"||t==="bottom_right"||t==="bottom_left"}class be{constructor(e,n,r,i,s,o){O(this,"a",1);O(this,"b",0);O(this,"c",0);O(this,"d",1);O(this,"e",0);O(this,"f",0);this.a=e,this.b=n,this.c=r,this.d=i,this.e=s,this.f=o}equals(e){return this===e||this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){const n=e,{a:r,b:i,c:s,d:o,e:l,f:u}=this;return this.a=r*n.a+s*n.b,this.c=r*n.c+s*n.d,this.e=r*n.e+s*n.f+l,this.b=i*n.a+o*n.b,this.d=i*n.c+o*n.d,this.f=i*n.e+o*n.f+u,this}rotate(e,n,r){return e===0?this:n===void 0?this.multiply(be.Rotate(e)):this.translate(n,r).multiply(be.Rotate(e)).translate(-n,-r)}translate(e,n){return this.multiply(be.Translate(e,n))}scale(e,n){return this.multiply(be.Scale(e,n))}invert(){const{a:e,b:n,c:r,d:i,e:s,f:o}=this,l=e*i-n*r;return this.a=i/l,this.b=n/-l,this.c=r/-l,this.d=e/l,this.e=(i*s-r*o)/-l,this.f=(n*s-e*o)/l,this}applyToPoint(e){return be.applyToPoint(this,e)}applyToPoints(e){return be.applyToPoints(this,e)}rotation(){return be.Rotation(this)}point(){return be.Point(this)}decomposed(){return be.Decompose(this)}toCssString(){return be.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return be.Decompose(this)}clone(){return new be(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new be(1,0,0,1,0,0)}static Translate(e,n){return new be(1,0,0,1,e,n)}static Rotate(e,n,r){if(e===0)return be.Identity();const i=Math.cos(e),s=Math.sin(e),o=new be(i,s,-s,i,0,0);return n===void 0?o:be.Compose(be.Translate(n,r),o,be.Translate(-n,-r))}static Scale(e,n,r,i){const s=new be(e,0,0,n,0,0);return r===void 0?s:be.Compose(be.Translate(r,i),s,be.Translate(-r,-i))}static Multiply(e,n){return{a:e.a*n.a+e.c*n.b,c:e.a*n.c+e.c*n.d,e:e.a*n.e+e.c*n.f+e.e,b:e.b*n.a+e.d*n.b,d:e.b*n.c+e.d*n.d,f:e.b*n.e+e.d*n.f+e.f}}static Inverse(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/-n,f:(e.b*e.e-e.a*e.f)/n}}static Absolute(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/n,f:(e.b*e.e-e.a*e.f)/-n}}static Compose(...e){const n=be.Identity();for(let r=0,i=e.length;r<i;r++)n.multiply(e[r]);return n}static Point(e){return new T(e.e,e.f)}static Rotation(e){let n;if(e.a!==0||e.c!==0){const r=(e.a*e.a+e.c*e.c)**.5;n=Math.acos(e.a/r)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const r=(e.b*e.b+e.d*e.d)**.5;n=Yt+Math.acos(e.b/r)*(e.d>0?-1:1)}else n=0;return rC(n)}static Decompose(e){let n,r,i;if(e.a!==0||e.c!==0){const s=(e.a*e.a+e.c*e.c)**.5;n=s,r=(e.a*e.d-e.b*e.c)/s,i=Math.acos(e.a/s)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const s=(e.b*e.b+e.d*e.d)**.5;n=(e.a*e.d-e.b*e.c)/s,r=s,i=Yt+Math.acos(e.b/s)*(e.d>0?-1:1)}else n=0,r=0,i=0;return{x:e.e,y:e.f,scaleX:n,scaleY:r,rotation:rC(i)}}static Smooth(e,n=1e10){return e.a=Math.round(e.a*n)/n,e.b=Math.round(e.b*n)/n,e.c=Math.round(e.c*n)/n,e.d=Math.round(e.d*n)/n,e.e=Math.round(e.e*n)/n,e.f=Math.round(e.f*n)/n,e}static toCssString(e){return`matrix(${ne(e.a)}, ${ne(e.b)}, ${ne(e.c)}, ${ne(e.d)}, ${ne(e.e)}, ${ne(e.f)})`}static applyToPoint(e,n){return new T(e.a*n.x+e.c*n.y+e.e,e.b*n.x+e.d*n.y+e.f,n.z)}static applyToXY(e,n,r){return[e.a*n+e.c*r+e.e,e.b*n+e.d*r+e.f]}static applyToPoints(e,n){return n.map(r=>new T(e.a*r.x+e.c*r.y+e.e,e.b*r.x+e.d*r.y+e.f,r.z))}static applyToBounds(e,n){return new xe(e.e+n.minX,e.f+n.minY,n.width,n.height)}static From(e){return new be(e.a,e.b,e.c,e.d,e.e,e.f)}static Cast(e){return e instanceof be?e:be.From(e)}}class Al{constructor(e){O(this,"isFilled",!1);O(this,"isClosed",!0);O(this,"isLabel",!1);O(this,"debugColor");O(this,"ignore");O(this,"_vertices");O(this,"_bounds");O(this,"_area");O(this,"_length");this.isFilled=e.isFilled,this.isClosed=e.isClosed,this.isLabel=e.isLabel??!1,this.debugColor=e.debugColor,this.ignore=e.ignore}hitTestPoint(e,n=0,r=!1){return this.isClosed&&(this.isFilled||r)&&Ci(e,this.vertices)?!0:T.Dist2(e,this.nearestPoint(e))<=n*n}distanceToPoint(e,n=!1){return e.dist(this.nearestPoint(e))*(this.isClosed&&(this.isFilled||n)&&Ci(e,this.vertices)?-1:1)}distanceToLineSegment(e,n){if(e.equals(n))return this.distanceToPoint(e);const{vertices:r}=this;let i,s=1/0,o,l,u;for(let d=0;d<r.length;d++)l=r[d],u=T.NearestPointOnLineSegment(e,n,l,!0),o=T.Dist2(l,u),o<s&&(s=o,i=u);if(!i)throw Error("nearest point not found");return this.isClosed&&this.isFilled&&Ci(i,this.vertices)?-s:s}hitTestLineSegment(e,n,r=0){return this.distanceToLineSegment(e,n)<=r}nearestPointOnLineSegment(e,n){const{vertices:r}=this;let i,s=1/0,o,l,u;for(let d=0;d<r.length;d++)l=r[d],u=T.NearestPointOnLineSegment(e,n,l,!0),o=T.Dist2(l,u),o<s&&(s=o,i=u);if(!i)throw Error("nearest point not found");return i}isPointInBounds(e,n=0){const{bounds:r}=this;return!(e.x<r.minX-n||e.y<r.minY-n||e.x>r.maxX+n||e.y>r.maxY+n)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return xe.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:e}=this;let n=0;for(let r=0,i=e.length;r<i;r++){const s=e[r],o=e[(r+1)%i];n+=s.x*o.y-o.x*s.y}return n/2}toSimpleSvgPath(){let e="";const{vertices:n}=this,r=n.length;if(r===0)return e;e+=`M${n[0].x},${n[0].y}`;for(let i=1;i<r;i++)e+=`L${n[i].x},${n[i].y}`;return this.isClosed&&(e+="Z"),e}get length(){return this._length?this._length:(this._length=this.getLength(),this._length)}getLength(){const{vertices:e}=this;let n,r=e[0],i=0;for(let s=1;s<e.length;s++)n=e[s],i+=T.Dist2(r,n),r=n;return Math.sqrt(i)}}class ns extends Al{constructor(n){super({...n,isClosed:!0,isFilled:!1});O(this,"children",[]);O(this,"ignoredChildren",[]);for(const r of n.children)r.ignore?this.ignoredChildren.push(r):this.children.push(r);if(this.children.length===0)throw Error("Group2d must have at least one child")}getVertices(){return this.children.filter(n=>!n.isLabel).flatMap(n=>n.vertices)}nearestPoint(n){let r=1/0,i;const{children:s}=this;if(s.length===0)throw Error("no children");let o,l;for(const u of s)o=u.nearestPoint(n),l=T.Dist2(o,n),l<r&&(r=l,i=o);if(!i)throw Error("nearest point not found");return i}distanceToPoint(n,r=!1){return Math.min(...this.children.map((i,s)=>i.distanceToPoint(n,r||s>0)))}hitTestPoint(n,r,i){return!!this.children.filter(s=>!s.isLabel).find(s=>s.hitTestPoint(n,r,i))}hitTestLineSegment(n,r,i){return!!this.children.filter(s=>!s.isLabel).find(s=>s.hitTestLineSegment(n,r,i))}getArea(){return this.children[0].area}toSimpleSvgPath(){let n="";for(const i of this.children)n+=i.toSimpleSvgPath();const r=xe.FromPoints(this.vertices).corners;for(let i=0,s=r.length;i<s;i++){const o=r[i],l=r[(i-1+s)%s],u=o.dist(l),d=r[(i+1)%s],f=o.dist(d),g=o.clone().lrp(l,4/u),m=o,S=o.clone().lrp(d,4/f);n+=`M${g.x},${g.y} L${m.x},${m.y} L${S.x},${S.y} `}return n}getLength(){return this.children.reduce((n,r)=>r.isLabel?n:n+r.length,0)}getSvgPathData(){return this.children.map((n,r)=>n.isLabel?"":n.getSvgPathData(r===0)).join(" ")}}function _V(t=!0){const[e,n]=E.useState(0),r=re();E.useEffect(()=>{if(!t)return;const i=()=>n(s=>s+1);return r.on("tick",i),()=>{r.off("tick",i)}},[r,t])}const EV=ir(function({showStroke:e=!0,showVertices:n=!0,showClosestPointOnOutline:r=!0}){const i=re();_V(r);const s=i.getZoomLevel(),o=i.getRenderingShapes(),{inputs:{currentPagePoint:l}}=i;return p.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:o.map(u=>{const d=i.getShape(u.id);if(d.type==="group")return null;const f=i.getShapeGeometry(d),g=i.getShapePageTransform(d),m=i.getPointInShapeSpace(d,l),S=f.nearestPoint(m),b=f.distanceToPoint(m,!0),v=Math.abs(b)*s,w=b<0,{vertices:C}=f;return p.jsxs("g",{transform:g.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[e&&p.jsx("g",{stroke:f.debugColor??"red",opacity:"1",strokeWidth:2/s,fill:"none",children:p.jsx(J3,{geometry:f})}),n&&C.map((_,M)=>p.jsx("circle",{cx:_.x,cy:_.y,r:2/s,fill:`hsl(${sd(M,[0,C.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:1/s},`v${M}`)),r&&v<150&&p.jsx("line",{x1:S.x,y1:S.y,x2:m.x,y2:m.y,opacity:1-v/150,stroke:w?"goldenrod":"dodgerblue",strokeWidth:2/s})]},u.id+"_outline")})})});function J3({geometry:t}){return t instanceof ns?p.jsx(p.Fragment,{children:[...t.children,...t.ignoredChildren].map((e,n)=>p.jsx(J3,{geometry:e},n))}):p.jsx("path",{d:t.toSimpleSvgPath()})}function e4(t){return JU(t)}function t4(){const t=re(),e=lG("userIds",()=>e4(t.getCollaborators().map(n=>n.userId)).sort(),{isEqual:(n,r)=>{var i;return n.join(",")===((i=r.join)==null?void 0:i.call(r,","))}},[t]);return oe(e)}function dS(t){const e=re();return oe(`latestPresence:${t}`,()=>e.getCollaborators().find(r=>r.userId===t),[e,t])??null}const PV=ir(function(){return t4().map(n=>p.jsx(TV,{collaboratorId:n},n))}),TV=ir(function({collaboratorId:e}){const n=re(),r=dS(e),i=MV(n,r);if(!(r&&r.currentPageId===n.getCurrentPageId()))return null;switch(i){case"inactive":{const{followingUserId:s,highlightedUserIds:o}=n.getInstanceState();if(!(s===r.userId||o.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:s}=n.getInstanceState();if(r.followingUserId===n.user.getId()&&!(r.chatMessage||s.includes(r.userId)))return null;break}}return p.jsx(IV,{latestPresence:r})}),IV=ir(function({latestPresence:e}){const n=re(),{CollaboratorBrush:r,CollaboratorScribble:i,CollaboratorCursor:s,CollaboratorHint:o,CollaboratorShapeIndicator:l}=Zt(),u=n.getZoomLevel(),d=n.getViewportPageBounds(),{userId:f,chatMessage:g,brush:m,scribbles:S,selectedShapeIds:b,userName:v,cursor:w,color:C}=e;if(!w)return null;const _=!(w.x<d.minX-12/u||w.y<d.minY-16/u||w.x>d.maxX-12/u||w.y>d.maxY-16/u);return p.jsxs(p.Fragment,{children:[m&&r?p.jsx(r,{className:"tl-collaborator__brush",brush:m,color:C,opacity:.1},f+"_brush"):null,_&&s?p.jsx(s,{className:"tl-collaborator__cursor",point:w,color:C,zoom:u,name:v!=="New User"?v:null,chatMessage:g??""},f+"_cursor"):o?p.jsx(o,{className:"tl-collaborator__cursor-hint",point:w,color:C,zoom:u,viewport:d},f+"_cursor_hint"):null,i&&S.length?p.jsx(p.Fragment,{children:S.map(M=>p.jsx(i,{className:"tl-collaborator__scribble",scribble:M,color:C,zoom:u,opacity:M.color==="laser"?.5:.1},f+"_scribble_"+M.id))}):null,l&&b.filter(M=>!n.isShapeHidden(M)).map(M=>p.jsx(l,{className:"tl-collaborator__shape-indicator",shapeId:M,color:C,opacity:.5},f+"_"+M))]})});function qR(t,e){return e>t.options.collaboratorInactiveTimeoutMs?"inactive":e>t.options.collaboratorIdleTimeoutMs?"idle":"active"}function MV(t,e){const n=E.useRef((e==null?void 0:e.lastActivityTimestamp)??-1),[r,i]=E.useState(()=>qR(t,Date.now()-n.current));return E.useEffect(()=>{const s=t.timers.setInterval(()=>{i(qR(t,Date.now()-n.current))},t.options.collaboratorCheckIntervalMs);return()=>clearInterval(s)},[t]),e&&(n.current=e.lastActivityTimestamp??1/0),r}function AV(){const t=re(),e=oe("is menu open",()=>t.menus.hasAnyOpenMenus(),[t]),[n,r]=E.useState(!1),i=e||n,s=p2(),o=E.useRef({isDown:!1,isDragging:!1,start:new T}),l=E.useCallback(f=>{f.button===0&&(r(!0),o.current={isDown:!0,isDragging:!1,start:new T(f.clientX,f.clientY)}),t.menus.clearOpenMenus()},[t]),u=E.useCallback(f=>{var g,m,S;if(o.current.isDown){if(o.current.isDragging){(g=s.onPointerMove)==null||g.call(s,f);return}if(T.Dist2(o.current.start,new T(f.clientX,f.clientY))>t.options.dragDistanceSquared){o.current={...o.current,isDown:!0,isDragging:!0};const{x:b,y:v}=o.current.start;(m=s.onPointerDown)==null||m.call(s,{...f,clientX:b,clientY:v,button:0}),(S=s.onPointerMove)==null||S.call(s,f)}}},[s,t]),d=E.useCallback(f=>{var g;(g=s.onPointerUp)==null||g.call(s,f),r(!1),o.current={isDown:!1,isDragging:!1,start:new T(f.clientX,f.clientY)}},[s]);return i&&p.jsx("div",{className:"tlui-menu-click-capture","data-testid":"menu-click-capture.content",...s,onPointerDown:l,onPointerMove:u,onPointerUp:d})}const n4=E.memo(function({id:e,shape:n,util:r,index:i,backgroundIndex:s,opacity:o}){const l=re(),{ShapeErrorFallback:u}=Zt(),d=E.useRef(null),f=E.useRef(null),g=E.useRef({transform:"",clipPath:"none",width:0,height:0,x:0,y:0,isCulled:!1});pl("set shape stuff",()=>{const b=l.getShape(e);if(!b)return;const v=g.current,w=l.getShapeClipPath(e)??"none";w!==v.clipPath&&(gr(d.current,"clip-path",w),gr(f.current,"clip-path",w),v.clipPath=w);const C=l.getShapePageTransform(e),_=be.toCssString(C),M=l.getShapeGeometry(b).bounds;_!==v.transform&&(gr(d.current,"transform",_),gr(f.current,"transform",_),v.transform=_);const I=Math.max(M.width,1),A=Math.max(M.height,1);(I!==v.width||A!==v.height)&&(gr(d.current,"width",I+"px"),gr(d.current,"height",A+"px"),gr(f.current,"width",I+"px"),gr(f.current,"height",A+"px"),v.width=I,v.height=A)},[l]),pl("set opacity and z-index",()=>{const b=d.current,v=f.current;gr(b,"opacity",o),gr(v,"opacity",o),gr(b,"z-index",i),gr(v,"z-index",s)},[o,i,s]),pl("set display",()=>{if(!l.getShape(e))return;const w=l.getCulledShapes().has(e);w!==g.current.isCulled&&(gr(d.current,"display",w?"none":"block"),gr(f.current,"display",w?"none":"block"),g.current.isCulled=w)},[l]);const m=E.useCallback(b=>l.annotateError(b,{origin:"shape",willCrashApp:!1}),[l]);if(!n)return null;const S="fill"in n.props&&n.props.fill!=="none";return p.jsxs(p.Fragment,{children:[r.backgroundComponent&&p.jsx("div",{ref:f,className:"tl-shape tl-shape-background","data-shape-type":n.type,"data-shape-id":n.id,draggable:!1,children:p.jsx(Of,{fallback:u,onError:m,children:p.jsx(i4,{shape:n,util:r})})}),p.jsx("div",{ref:d,className:"tl-shape","data-shape-type":n.type,"data-shape-is-filled":S,"data-shape-id":n.id,draggable:!1,children:p.jsx(Of,{fallback:u,onError:m,children:p.jsx(r4,{shape:n,util:r})})})]})}),r4=E.memo(function({shape:e,util:n}){return iS("InnerShape:"+e.type,()=>n.component(n.editor.store.unsafeGetWithoutCapture(e.id)),[n,e.id])},(t,e)=>t.shape.props===e.shape.props&&t.shape.meta===e.shape.meta&&t.util===e.util),i4=E.memo(function({shape:e,util:n}){return iS("InnerShape:"+e.type,()=>{var r;return(r=n.backgroundComponent)==null?void 0:r.call(n,n.editor.store.unsafeGetWithoutCapture(e.id))},[n,e.id])},(t,e)=>t.shape.props===e.shape.props&&t.shape.meta===e.shape.meta&&t.util===e.util);function kV({className:t}){const e=re(),{Background:n,SvgDefs:r,ShapeIndicators:i}=Zt(),s=E.useRef(null),o=E.useRef(null),l=E.useRef(null),u=zn();vV(s),hY(),dY(),yV(s),pY(s);const d=E.useRef({lodDisableTextOutline:!1,allowTextOutline:!0});pl("position layers",function(){const{x:_,y:M,z:I}=e.getCamera();if(d.current.allowTextOutline&&Ft.isSafari&&(u.style.setProperty("--tl-text-outline","none"),d.current.allowTextOutline=!1),d.current.allowTextOutline&&I<e.options.textShadowLod!==d.current.lodDisableTextOutline){const D=I<e.options.textShadowLod;u.style.setProperty("--tl-text-outline",D?"none":"var(--tl-text-outline-reference)"),d.current.lodDisableTextOutline=D}const A=I>=1?sd(I,[1,8],[.125,.5],!0):sd(I,[.1,1],[-2,.125],!0),R=`scale(${ne(I)}) translate(${ne(_+A)}px,${ne(M+A)}px)`;gr(o.current,"transform",R),gr(l.current,"transform",R)},[e,u]);const f=p2(),g=oe("shapeSvgDefs",()=>{const C=new Map;for(const _ of ln(e.shapeUtils)){if(!_)return;const M=_.getCanvasSvgDefs();for(const{key:I,component:A}of M)C.has(I)||C.set(I,p.jsx(A,{},I))}return[...C.values()]},[e]),m=oe("debug_shapes",()=>xn.hideShapes.get(),[xn]),S=oe("debug_svg",()=>xn.debugSvg.get(),[xn]),b=oe("debug_geometry",()=>xn.debugGeometry.get(),[xn]),v=oe("isEditingAnything",()=>e.getEditingShapeId()!==null,[e]),w=oe("isSelectingAnything",()=>!!e.getSelectedShapeIds().length,[e]);return p.jsxs(p.Fragment,{children:[p.jsxs("div",{ref:s,draggable:!1,"data-iseditinganything":v,"data-isselectinganything":w,className:je("tl-canvas",t),"data-testid":"canvas",...f,children:[p.jsx("svg",{className:"tl-svg-context",children:p.jsxs("defs",{children:[g,p.jsx(GV,{}),p.jsx(qV,{}),r&&p.jsx(r,{})]})}),n&&p.jsx("div",{className:"tl-background__wrapper",children:p.jsx(n,{})}),p.jsx(OV,{}),p.jsxs("div",{ref:o,className:"tl-html-layer tl-shapes",draggable:!1,children:[p.jsx(XV,{}),p.jsx(WV,{}),m?null:S?p.jsx(FV,{}):p.jsx(HV,{})]}),p.jsx("div",{className:"tl-overlays",children:p.jsxs("div",{ref:l,className:"tl-html-layer",children:[b?p.jsx(EV,{}):null,p.jsx(DV,{}),p.jsx(jV,{}),p.jsx(LV,{}),i&&p.jsx(i,{}),p.jsx(KV,{}),p.jsx(NV,{}),p.jsx(VV,{}),p.jsx(zV,{}),p.jsx(PV,{})]})}),p.jsx(ZV,{})]}),p.jsx(AV,{}),p.jsx(RV,{})]})}function RV(){const{InFrontOfTheCanvas:t}=Zt();return t?p.jsx(t,{}):null}function OV(){const t=re(),e=oe("gridSize",()=>t.getDocumentSettings().gridSize,[t]),{x:n,y:r,z:i}=oe("camera",()=>t.getCamera(),[t]),s=oe("isGridMode",()=>t.getInstanceState().isGridMode,[t]),{Grid:o}=Zt();return o&&s?p.jsx(o,{x:n,y:r,z:i,size:e}):null}function jV(){const t=re(),e=oe("scribbles",()=>t.getInstanceState().scribbles,[t]),n=oe("zoomLevel",()=>t.getZoomLevel(),[t]),{Scribble:r}=Zt();return r&&e.length?e.map(i=>p.jsx(r,{className:"tl-user-scribble",scribble:i,zoom:n},i.id)):null}function DV(){const t=re(),e=oe("brush",()=>t.getInstanceState().brush,[t]),{Brush:n}=Zt();return n&&e?p.jsx(n,{className:"tl-user-brush",brush:e}):null}function LV(){const t=re(),e=oe("zoomBrush",()=>t.getInstanceState().zoomBrush,[t]),{ZoomBrush:n}=Zt();return n&&e?p.jsx(n,{className:"tl-user-brush tl-zoom-brush",brush:e}):null}function NV(){const t=re(),e=oe("snapLines",()=>t.snaps.getIndicators(),[t]),n=oe("zoomLevel",()=>t.getZoomLevel(),[t]),{SnapIndicator:r}=Zt();return r&&e.length>0?e.map(i=>p.jsx(r,{className:"tl-user-snapline",line:i,zoom:n},i.id)):null}function zV(){const t=re(),e=oe("handles shapeIdWithHandles",()=>{const{isReadonly:n,isChangingStyle:r}=t.getInstanceState();if(n||r)return!1;const i=t.getOnlySelectedShape();return!i||!t.getShapeHandles(i)?!1:i.id},[t]);return e?p.jsx($V,{shapeId:e}):null}function $V({shapeId:t}){const e=re(),{Handles:n}=Zt(),r=oe("zoomLevel",()=>e.getZoomLevel(),[e]),i=oe("coarse pointer",()=>e.getInstanceState().isCoarsePointer,[e]),s=oe("handles transform",()=>e.getShapePageTransform(t),[e,t]),o=oe("handles",()=>{const u=e.getShapeHandles(t);if(!u)return null;const d=(i?e.options.coarseHandleRadius:e.options.handleRadius)/r*2;return u.filter(f=>f.type!=="virtual"||!u.some(g=>g!==f&&g.type==="vertex"&&T.Dist(f,g)<d)).sort(f=>f.type==="vertex"?1:-1)},[e,r,i,t]),l=oe("isHidden",()=>e.isShapeHidden(t),[e,t]);return!n||!o||!s||l?null:p.jsx(n,{children:p.jsx("g",{transform:be.toCssString(s),children:o.map(u=>p.jsx(BV,{shapeId:t,handle:u,zoom:r,isCoarse:i},u.id))})})}function BV({shapeId:t,handle:e,zoom:n,isCoarse:r}){const i=SV(t,e.id),{Handle:s}=Zt();return s?p.jsx("g",{"aria-label":"handle",transform:`translate(${e.x}, ${e.y})`,...i,children:p.jsx(s,{shapeId:t,handle:e,zoom:n,isCoarse:r})}):null}function FV(){const t=re();return oe("rendering shapes",()=>t.getRenderingShapes(),[t]).map(n=>p.jsxs(E.Fragment,{children:[p.jsx(n4,{...n}),p.jsx(YV,{id:n.id,mode:"iframe"})]},n.id+"_fragment"))}function UV(){const t=re(),e=E.useRef(new Set);return pl("reflow for culled shapes",()=>{const n=t.getCulledShapes();if(e.current.size===n.size&&[...n].every(i=>e.current.has(i)))return;e.current=n;const r=document.getElementsByClassName("tl-canvas");r.length!==0&&r[0].offsetHeight},[t]),null}function HV(){const t=re(),e=oe("rendering shapes",()=>t.getRenderingShapes(),[t]);return p.jsxs(p.Fragment,{children:[e.map(n=>p.jsx(n4,{...n},n.id+"_shape")),Ft.isSafari&&p.jsx(UV,{})]})}function KV(){const t=re(),{ShapeIndicator:e}=Zt(),n=oe("hinting shape ids",()=>E_(t.getHintingShapeIds()),[t]);return!n.length||!e?null:n.map(r=>p.jsx(e,{className:"tl-user-indicator__hint",shapeId:r},r+"_hinting"))}function GV(){return p.jsxs("g",{id:As("cursor"),children:[p.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[p.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),p.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),p.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[p.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),p.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),p.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[p.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),p.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function qV(){const t=As("cursor_hint");return p.jsx("path",{id:t,fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function YV({id:t,mode:e}){const n=re(),[r,i]=E.useState(null),s=oe("is in root",()=>{const o=n.getShape(t);return(o==null?void 0:o.parentId)===n.getCurrentPageId()},[n,t]);return E.useEffect(()=>{if(!s)return;let o=null;const l=co("shape to svg",async()=>{const u=Math.random();o=u;const f=n.isShapeOfType(t,"frame")?0:10;let g=n.getShapePageBounds(t);if(!g)return;g=g.clone().expandBy(f);const m=await n.getSvgString([t],{padding:f});if(o!==u||!m)return;const S=`data:image/svg+xml;utf8,${encodeURIComponent(m.svg)}`;i({src:S,bounds:g})});return()=>{o=null,l()}},[n,t,s]),!s||!r?null:e==="iframe"?p.jsx("iframe",{src:r.src,width:r.bounds.width,height:r.bounds.height,referrerPolicy:"no-referrer",style:{position:"absolute",top:0,left:0,border:"none",transform:`translate(${r.bounds.x}px, ${r.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}}):p.jsx("img",{src:r.src,width:r.bounds.width,height:r.bounds.height,referrerPolicy:"no-referrer",style:{position:"absolute",top:0,left:0,transform:`translate(${r.bounds.x}px, ${r.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}})}function VV(){const t=re(),e=oe("selection rotation",()=>t.getSelectionRotation(),[t]),n=oe("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionForeground:r}=Zt();return!n||!r?null:p.jsx(r,{bounds:n,rotation:e})}function WV(){const t=re(),e=oe("selection rotation",()=>t.getSelectionRotation(),[t]),n=oe("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionBackground:r}=Zt();return!n||!r?null:p.jsx(r,{bounds:n,rotation:e})}function XV(){const{OnTheCanvas:t}=Zt();return t?p.jsx(t,{}):null}function ZV(){const t=re(),e=oe("camera state",()=>t.getCameraState(),[t]);return p.jsx("div",{className:je("tl-hit-test-blocker",{"tl-hit-test-blocker__hidden":e==="idle"})})}function QV({className:t,zoom:e,point:n,color:r,viewport:i,opacity:s=1}){const o=E.useRef(null);wd(o,Xn(n.x,i.minX+5/e,i.maxX-5/e),Xn(n.y,i.minY+5/e,i.maxY-5/e),1/e,T.Angle(i.center,n));const l=As("cursor_hint");return p.jsxs("svg",{ref:o,className:je("tl-overlays__item",t),children:[p.jsx("use",{href:`#${l}`,color:r,strokeWidth:3,stroke:"var(--color-background)"}),p.jsx("use",{href:`#${l}`,color:r,opacity:s})]})}const YR=E.memo(function({className:e,zoom:n,point:r,color:i,name:s,chatMessage:o}){const l=E.useRef(null);wd(l,r==null?void 0:r.x,r==null?void 0:r.y,1/n);const u=As("cursor");return r?p.jsxs("div",{ref:l,className:je("tl-overlays__item",e),children:[p.jsx("svg",{className:"tl-cursor",children:p.jsx("use",{href:`#${u}`,color:i})}),o?p.jsxs(p.Fragment,{children:[s&&p.jsx("div",{className:"tl-nametag-title",style:{color:i},children:s}),p.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:i},children:o})]}):s&&p.jsx("div",{className:"tl-nametag",style:{backgroundColor:i},children:s})]}):null});function JV({x:t,y:e,z:n,size:r}){const i=xd("grid"),s=re(),{gridSteps:o}=s.options;return p.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[p.jsx("defs",{children:o.map(({min:l,mid:u,step:d},f)=>{const g=d*r*n,m=.5+t*n,S=.5+e*n,b=m>0?m%g:g+m%g,v=S>0?S%g:g+S%g,w=n<u?sd(n,[l,u],[0,1]):1;return p.jsx("pattern",{id:u2(i,`${d}`),width:g,height:g,patternUnits:"userSpaceOnUse",children:p.jsx("circle",{className:"tl-grid-dot",cx:b,cy:v,r:1,opacity:w})},f)})}),o.map(({step:l},u)=>p.jsx("rect",{width:"100%",height:"100%",fill:`url(#${i}_${l})`},u))]})}function eW({handle:t,isCoarse:e,className:n,zoom:r}){const i=re(),s=(e?i.options.coarseHandleRadius:i.options.handleRadius)/r;if(t.type==="clone"){const l=3/r,u=`M0,${-l} A${l},${l} 0 0,1 0,${l}`,d=iY.indexOf(t.id);return p.jsxs("g",{className:je(`tl-handle tl-handle__${t.type}`,n),children:[p.jsx("circle",{className:"tl-handle__bg",r:s}),p.jsx("path",{className:"tl-handle__fg",d:u,transform:`rotate(${-90+90*d})`})]})}const o=(t.type==="create"&&e?3:4)/Math.max(r,.25);return p.jsxs("g",{className:je(`tl-handle tl-handle__${t.type}`,n),children:[p.jsx("circle",{className:"tl-handle__bg",r:s}),p.jsx("circle",{className:"tl-handle__fg",r:o})]})}const tW=({children:t})=>p.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}),nW=()=>{const{Spinner:t}=Zt();return p.jsx(R2,{children:t?p.jsx(t,{}):null})};function m2(t,e=!0){const n=t.length;if(n<2)return"";let r=t[0],i=t[1];if(n===2)return`M${mt(r)}L${mt(i)}`;let s="";for(let o=2,l=n-1;o<l;o++)r=t[o],i=t[o+1],s+=Jr(r,i);return e?`M${Jr(t[0],t[1])}Q${mt(t[1])}${Jr(t[1],t[2])}T${s}${Jr(t[n-1],t[0])}${Jr(t[0],t[1])}Z`:`M${mt(t[0])}Q${mt(t[1])}${Jr(t[1],t[2])}${t.length>3?"T":""}${s}L${mt(t[n-1])}`}function VR({scribble:t,zoom:e,color:n,opacity:r,className:i}){return t.points.length?p.jsx("svg",{className:i&&je("tl-overlays__item",i),children:p.jsx("path",{className:"tl-scribble",d:m2(t.points,!1),stroke:n??`var(--color-${t.color})`,fill:"none",strokeWidth:8/e,opacity:r??t.opacity})}):null}function s4({bounds:t,rotation:e}){const n=E.useRef(null);return wd(n,t.x,t.y,1,e),E.useLayoutEffect(()=>{const r=n.current;r&&(r.style.width=ne(Math.max(1,t.width))+"px",r.style.height=ne(Math.max(1,t.height))+"px")},[t.width,t.height]),p.jsx("div",{ref:n,className:"tl-selection__bg",draggable:!1})}function rW({bounds:t,rotation:e}){const n=re(),r=E.useRef(null),i=oe("only selected shape",()=>n.getOnlySelectedShape(),[n]),s=i?n.getShapeUtil(i).expandSelectionOutlinePx(i):0;return wd(r,t==null?void 0:t.x,t==null?void 0:t.y,1,e,{x:-s,y:-s}),t=s instanceof xe?t.clone().expand(s).zeroFix():t.clone().expandBy(s).zeroFix(),p.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:p.jsx("rect",{className:je("tl-selection__fg__outline"),width:ne(t.width),height:ne(t.height)})})}const iW=()=>p.jsx("div",{className:"tl-shape-error-boundary"}),sW=({shape:t,util:e})=>iS("Indicator: "+t.type,()=>e.indicator(e.editor.store.unsafeGetWithoutCapture(t.id))),oW=({editor:t,id:e})=>{const n=oe("shape for indicator",()=>t.store.get(e),[t,e]),{ShapeIndicatorErrorFallback:r}=Zt();return!n||n.isLocked?null:p.jsx(Of,{fallback:r,onError:i=>t.annotateError(i,{origin:"react.shapeIndicator",willCrashApp:!1}),children:p.jsx(sW,{shape:n,util:t.getShapeUtil(n)},n.id)})},WR=E.memo(function({shapeId:e,className:n,color:r,hidden:i,opacity:s}){const o=re(),l=E.useRef(null);return pl("indicator transform",()=>{const u=l.current;if(!u)return;const d=o.getShapePageTransform(e);d&&u.style.setProperty("transform",d.toCssString())},[o,e]),E.useLayoutEffect(()=>{const u=l.current;u&&u.style.setProperty("display",i?"none":"block")},[i]),p.jsx("svg",{ref:l,className:je("tl-overlays__item",n),children:p.jsx("g",{className:"tl-shape-indicator",stroke:r??"var(--color-selected)",opacity:s,children:p.jsx(oW,{editor:o,id:e})})})}),aW=()=>p.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"}),o4=E.memo(function(){const e=re(),n=E.useRef(new Set),r=oe("should display selected ids",()=>{const o=n.current,l=new Set;if(e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.getInstanceState().isChangingStyle){const u=e.getSelectedShapeIds();for(const d of u)l.add(d);if(e.isInAny("select.idle","select.editing_shape")){const d=e.getInstanceState();if(d.isHoveringCanvas&&!d.isCoarsePointer){const f=e.getHoveredShapeId();f&&l.add(f)}}}if(o.size!==l.size)return n.current=l,l;for(const u of l)if(!o.has(u))return n.current=l,l;return o},[e]),i=oe("rendering shapes",()=>e.getRenderingShapes(),[e]),{ShapeIndicator:s}=Zt();return s?i.map(({id:o})=>p.jsx(s,{shapeId:o,hidden:!r.has(o)},o+"_indicator")):null});function lW({points:t,zoom:e}){const n=2.5/e,r=t.reduce((m,S)=>Math.min(m,S.x),1/0),i=t.reduce((m,S)=>Math.max(m,S.x),-1/0),s=t.reduce((m,S)=>Math.min(m,S.y),1/0),o=t.reduce((m,S)=>Math.max(m,S.y),-1/0),l=t.some(m=>m.x===r&&m.y===s);let u,d,f,g;return l?(u=r,d=s,f=i,g=o):(u=r,d=o,f=i,g=s),p.jsxs("g",{className:"tl-snap-indicator",stroke:"lime",children:[p.jsx("line",{x1:u,y1:d,x2:f,y2:g}),t.map((m,S)=>p.jsx("g",{transform:`translate(${m.x},${m.y})`,children:p.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},S))]})}function cW({gaps:t,direction:e,zoom:n}){const r=3.5/n;let i=[-1/0,1/0],s=null;const o=e==="horizontal";for(const u of t){if(s=_s(i[0],i[1],o?u.startEdge[0].y:u.startEdge[0].x,o?u.startEdge[1].y:u.startEdge[1].x),s)i=s;else continue;if(s=_s(i[0],i[1],o?u.endEdge[0].y:u.endEdge[0].x,o?u.endEdge[1].y:u.endEdge[1].x),s)i=s;else continue}if(i===null)return null;const l=(i[0]+i[1])/2;return p.jsx("g",{className:"tl-snap-indicator",stroke:"cyan",children:t.map(({startEdge:u,endEdge:d},f)=>p.jsx(E.Fragment,{children:o?p.jsxs(p.Fragment,{children:[p.jsx("line",{x1:u[0].x,y1:l-2*r,x2:u[1].x,y2:l+2*r}),p.jsx("line",{x1:d[0].x,y1:l-2*r,x2:d[1].x,y2:l+2*r}),p.jsx("line",{x1:u[0].x,y1:l,x2:d[0].x,y2:l}),p.jsx("line",{x1:(u[0].x+d[0].x)/2,y1:l-r,x2:(u[0].x+d[0].x)/2,y2:l+r})]}):p.jsxs(p.Fragment,{children:[p.jsx("line",{x1:l-2*r,y1:u[0].y,x2:l+2*r,y2:u[1].y}),p.jsx("line",{x1:l-2*r,y1:d[0].y,x2:l+2*r,y2:d[1].y}),p.jsx("line",{x1:l,y1:u[0].y,x2:l,y2:d[0].y}),p.jsx("line",{x1:l-r,y1:(u[0].y+d[0].y)/2,x2:l+r,y2:(u[0].y+d[0].y)/2})]})},f))})}function uW({className:t,line:e,zoom:n}){return p.jsx("svg",{className:je("tl-overlays__item",t),children:e.type==="points"?p.jsx(lW,{...e,zoom:n}):e.type==="gaps"?p.jsx(cW,{...e,zoom:n}):null})}function y2(){return p.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:p.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[p.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),p.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:p.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const dW=()=>null;function a4(t,e){const n=E.useRef(t);return e(t,n.current)?n.current:(n.current=t,t)}const hW=(t,e)=>(t??(t=null),e??(e=null),t===e?!0:!t||!e?!1:jD(t,e));function cl(t){return a4(t,hW)}const fW=(t,e)=>(t??(t=null),e??(e=null),t===e?!0:!t||!e?!1:$D(t,e));function Cd(t){return a4(t,fW)}const l4=E.createContext(null);function pW({overrides:t={},children:e}){const n=Cd(t),r=E.useMemo(()=>({Background:rY,SvgDefs:dW,Brush:jw,ZoomBrush:jw,CollaboratorBrush:jw,Cursor:YR,CollaboratorCursor:YR,CollaboratorHint:QV,CollaboratorShapeIndicator:WR,Grid:JV,Scribble:VR,SnapIndicator:uW,Handles:tW,Handle:eW,CollaboratorScribble:VR,ErrorFallback:u4,ShapeErrorFallback:iW,ShapeIndicatorErrorFallback:aW,Spinner:y2,SelectionBackground:s4,SelectionForeground:rW,ShapeIndicators:o4,ShapeIndicator:WR,OnTheCanvas:null,InFrontOfTheCanvas:null,Canvas:kV,LoadingScreen:nW,...n}),[n]);return p.jsx(l4.Provider,{value:r,children:e})}function Zt(){const t=E.useContext(l4);if(!t)throw new Error("useEditorComponents must be used inside of <EditorComponentsProvider />");return t}const hS={openWindow(t,e){window.open(t,e,"noopener noreferrer")},refreshPage(){window.location.reload()},async hardReset(){var t;return await((t=window.__tldraw__hardReset)==null?void 0:t.call(window))}};function c4(){hS.hardReset()}function gW(){hS.refreshPage()}const mW="https://github.com/tldraw/tldraw/issues/new",u4=({error:t,editor:e})=>{const n=E.useRef(null),[r,i]=E.useState(!1),[s,o]=E.useState(!1),[l,u]=E.useState(!1);let d=null;try{d=Zt().Canvas??null}catch{}const f=t instanceof Error?t.message:String(t),g=t instanceof Error?t.stack:null,m=oe("isDarkMode",()=>{try{if(e)return e.user.getIsDarkMode()}catch{}return null},[e]),[S,b]=E.useState(null);E.useLayoutEffect(()=>{var A;m!==null&&b(m);let M=(A=n.current)==null?void 0:A.parentElement,I=!1;for(;M;){if(M.classList.contains("tl-theme__dark")||M.classList.contains("tl-theme__light")){I=!0;break}M=M.parentElement}if(I){b(null);return}typeof window<"u"&&"matchMedia"in window&&b(window.matchMedia("(prefers-color-scheme: dark)").matches)},[m]),E.useEffect(()=>{if(s){const M=e==null?void 0:e.timers.setTimeout(()=>{o(!1)},2e3);return()=>clearTimeout(M)}},[s,e]);const v=()=>{const M=document.createElement("textarea");M.value=g??f,document.body.appendChild(M),M.select(),document.execCommand("copy"),M.remove(),o(!0)},w=()=>{gW()},C=async()=>{c4()},_=new URL(mW);return _.searchParams.set("title",f),_.searchParams.set("labels","bug"),_.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${g??f}
\`\`\`

My browser: ${navigator.userAgent}`),p.jsxs("div",{ref:n,className:je("tl-container tl-error-boundary",S===null?"":S?"tl-theme__dark":"tl-theme__light"),children:[p.jsx("div",{className:"tl-error-boundary__overlay"}),e&&p.jsx(c2,{onError:Tf,fallback:()=>null,children:p.jsx(h2,{editor:e,children:p.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:d?p.jsx(d,{}):null})})}),p.jsx("div",{className:je("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!l}),children:l?p.jsxs(p.Fragment,{children:[p.jsx("h2",{children:"Are you sure?"}),p.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),p.jsxs("div",{className:"tl-error-boundary__content__actions",children:[p.jsx("button",{onClick:()=>u(!1),children:"Cancel"}),p.jsx("button",{className:"tl-error-boundary__reset",onClick:C,children:"Reset data"})]})]}):p.jsxs(p.Fragment,{children:[p.jsx("h2",{children:"Something went wrong"}),p.jsx("p",{children:"Please refresh the page to continue."}),p.jsxs("p",{children:["If you keep seeing this screen, you can create a"," ",p.jsx("a",{href:_.toString(),children:"GitHub issue"})," or ask for help on"," ",p.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"Discord"}),". If you are still stuck, you can reset the tldraw data on your machine. This may erase the project you were working on, so try to get help first."]}),r&&p.jsxs(p.Fragment,{children:["Message:",p.jsx("h4",{children:p.jsx("code",{children:f})}),"Stack trace:",p.jsxs("div",{className:"tl-error-boundary__content__error",children:[p.jsx("pre",{children:p.jsx("code",{children:g??f})}),p.jsx("button",{onClick:v,children:s?"Copied!":"Copy"})]})]}),p.jsxs("div",{className:"tl-error-boundary__content__actions",children:[p.jsx("button",{onClick:()=>i(!r),children:r?"Hide details":"Show details"}),p.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[p.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>u(!0),children:"Reset data"}),p.jsx("button",{className:"tl-error-boundary__refresh",onClick:w,children:"Refresh Page"})]})]})]})})]})},d4="TLDRAW_USER_DATA_v3",h4=st({id:Ye,name:Ye.nullable().optional(),color:Ye.nullable().optional(),locale:Ye.nullable().optional(),animationSpeed:Le.nullable().optional(),edgeScrollSpeed:Le.nullable().optional(),colorScheme:lS("light","dark","system").optional(),isSnapMode:rt.nullable().optional(),isWrapMode:rt.nullable().optional(),isDynamicSizeMode:rt.nullable().optional(),isPasteAtCursorMode:rt.nullable().optional()}),ia={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4,AddExcalidrawSelectMode:5,AddDynamicSizeMode:6,AllowSystemColorScheme:7,AddPasteAtCursor:8},S2=Math.max(...Object.values(ia));function yW(t){t.version<ia.AddAnimationSpeed&&(t.user.animationSpeed=1),t.version<ia.AddIsSnapMode&&(t.user.isSnapMode=!1),t.version<ia.MakeFieldsNullable,t.version<ia.AddEdgeScrollSpeed&&(t.user.edgeScrollSpeed=1),t.version<ia.AddExcalidrawSelectMode&&(t.user.isWrapMode=!1),t.version<ia.AllowSystemColorScheme&&(t.user.isDarkMode===!0?t.user.colorScheme="dark":t.user.isDarkMode===!1&&(t.user.colorScheme="light"),delete t.user.isDarkMode),t.version<ia.AddDynamicSizeMode&&(t.user.isDynamicSizeMode=!1),t.version<ia.AddPasteAtCursor&&(t.user.isPasteAtCursorMode=!1),t.version=S2}const pC=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function f4(){return pC[Math.floor(Math.random()*pC.length)]}function SW(){var t,e;return typeof window<"u"&&"matchMedia"in window?((e=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:e.matches)??!1:!1}const Qs=Object.freeze({name:"New User",locale:Xq(),color:f4(),edgeScrollSpeed:1,animationSpeed:SW()?0:1,isSnapMode:!1,isWrapMode:!1,isDynamicSizeMode:!1,isPasteAtCursorMode:!1,colorScheme:"light"});function $w(){return{id:At(),color:f4()}}function p4(t){if(t===null||typeof t!="object"||!("version"in t)||!("user"in t)||typeof t.version!="number")return $w();const e=Xt(t);yW(e);try{return h4.validate(e.user)}catch{return $w()}}function vW(){const t=JSON.parse(O_(d4)||"null")??null;return p4(t)}const fS=On("globalUserData",null);function bW(){j_(d4,JSON.stringify({version:S2,user:fS.get()}))}function g4(t){h4.validate(t),fS.set(t),bW(),xW()}const Zu=typeof BroadcastChannel<"u"?new BroadcastChannel("tldraw-user-sync"):null;Zu==null||Zu.addEventListener("message",t=>{const e=t.data;(e==null?void 0:e.type)===y4&&(e==null?void 0:e.origin)!==m4()&&fS.set(p4(e.data))});let Bw=null;function m4(){return Bw===null&&(Bw=At()),Bw}const y4="tldraw-user-preferences-change";function xW(){Zu==null||Zu.postMessage({type:y4,origin:m4(),data:{user:S4(),version:S2}})}function S4(){let t=fS.get();return t||(t=vW(),g4(t)),t}const wW=he("defaultLocalStorageUserPrefs",()=>S4());function v4(t={}){return{userPreferences:t.userPreferences??wW,setUserPreferences:t.setUserPreferences??g4}}var Fw={exports:{}},XR;function CW(){return XR||(XR=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function s(u,d,f,g,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var S=new i(f,g||u,m),b=n?n+d:d;return u._events[b]?u._events[b].fn?u._events[b]=[u._events[b],S]:u._events[b].push(S):(u._events[b]=S,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,g;if(this._eventsCount===0)return d;for(g in f=this._events)e.call(f,g)&&d.push(n?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=n?n+d:d,g=this._events[f];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,S=g.length,b=new Array(S);m<S;m++)b[m]=g[m].fn;return b},l.prototype.listenerCount=function(d){var f=n?n+d:d,g=this._events[f];return g?g.fn?1:g.length:0},l.prototype.emit=function(d,f,g,m,S,b){var v=n?n+d:d;if(!this._events[v])return!1;var w=this._events[v],C=arguments.length,_,M;if(w.fn){switch(w.once&&this.removeListener(d,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,f),!0;case 3:return w.fn.call(w.context,f,g),!0;case 4:return w.fn.call(w.context,f,g,m),!0;case 5:return w.fn.call(w.context,f,g,m,S),!0;case 6:return w.fn.call(w.context,f,g,m,S,b),!0}for(M=1,_=new Array(C-1);M<C;M++)_[M-1]=arguments[M];w.fn.apply(w.context,_)}else{var I=w.length,A;for(M=0;M<I;M++)switch(w[M].once&&this.removeListener(d,w[M].fn,void 0,!0),C){case 1:w[M].fn.call(w[M].context);break;case 2:w[M].fn.call(w[M].context,f);break;case 3:w[M].fn.call(w[M].context,f,g);break;case 4:w[M].fn.call(w[M].context,f,g,m);break;default:if(!_)for(A=1,_=new Array(C-1);A<C;A++)_[A-1]=arguments[A];w[M].fn.apply(w[M].context,_)}}return!0},l.prototype.on=function(d,f,g){return s(this,d,f,g,!1)},l.prototype.once=function(d,f,g){return s(this,d,f,g,!0)},l.prototype.removeListener=function(d,f,g,m){var S=n?n+d:d;if(!this._events[S])return this;if(!f)return o(this,S),this;var b=this._events[S];if(b.fn)b.fn===f&&(!m||b.once)&&(!g||b.context===g)&&o(this,S);else{for(var v=0,w=[],C=b.length;v<C;v++)(b[v].fn!==f||m&&!b[v].once||g&&b[v].context!==g)&&w.push(b[v]);w.length?this._events[S]=w.length===1?w[0]:w:o(this,S)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=n?n+d:d,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l}(Fw)),Fw.exports}var _W=CW();const EW=_l(_W),Qu="TLDRAW_TAB_ID_v2",pa=globalThis.window;function PW(){return pa?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(pa.navigator.platform)||Ft.isDarwin&&"ontouchend"in document:!1}const Iy=pa?pa[Qu]??QD(Qu)??"TLDRAW_INSTANCE_STATE_V1_"+At():"<error>";pa&&(pa[Qu]=Iy,PW()?D_(Qu,Iy):JD(Qu));pa==null||pa.addEventListener("beforeunload",()=>{D_(Qu,Iy)});const b4={Initial:0},pS=Math.max(...Object.values(b4));function TW(t){t.version<b4.Initial,t.version=pS}const x4=st({version:Le,currentPageId:kf.optional(),isFocusMode:rt.optional(),exportBackground:rt.optional(),isDebugMode:rt.optional(),isToolLocked:rt.optional(),isGridMode:rt.optional(),pageStates:er(st({pageId:kf,camera:st({x:Le,y:Le,z:Le}).optional(),selectedShapeIds:er(Yi).optional(),focusedGroupId:Yi.nullable().optional()})).optional()});function IW(t){if(!t||typeof t!="object")return console.warn("Invalid instance state"),null;if(!("version"in t)||typeof t.version!="number")return console.warn("No version in instance state"),null;t.version!==pS&&(t=Xt(t),TW(t));try{return x4.validate(t)}catch(e){return console.warn(e),null}}function v2(t){const e=t.query.ids("page");return he("sessionStateSnapshot",()=>{const n=t.get(kr);if(!n)return null;const r=[...e.get()];return{version:pS,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(i=>{const s=t.get(Is.createId(i)),o=t.get(oo.createId(i));return{pageId:i,camera:{x:(o==null?void 0:o.x)??0,y:(o==null?void 0:o.y)??0,z:(o==null?void 0:o.z)??1},selectedShapeIds:(s==null?void 0:s.selectedShapeIds)??[],focusedGroupId:(s==null?void 0:s.focusedGroupId)??null}})}},{isEqual:X5})}function gC(t,e,n){const r=IW(e);if(!r)return;const i=h3(t.get(kr)),s=n!=null&&n.forceOverwrite?r:i,o=n!=null&&n.forceOverwrite?i:r,l=t.schema.types.instance.create({id:kr,...i,currentPageId:r.currentPageId,isDebugMode:(s==null?void 0:s.isDebugMode)??(o==null?void 0:o.isDebugMode),isFocusMode:(s==null?void 0:s.isFocusMode)??(o==null?void 0:o.isFocusMode),isToolLocked:(s==null?void 0:s.isToolLocked)??(o==null?void 0:o.isToolLocked),isGridMode:(s==null?void 0:s.isGridMode)??(o==null?void 0:o.isGridMode),exportBackground:(s==null?void 0:s.exportBackground)??(o==null?void 0:o.exportBackground)});t.atomic(()=>{var u,d,f;for(const g of r.pageStates??[]){if(!t.has(g.pageId))continue;const m=oo.createId(g.pageId),S=Is.createId(g.pageId),b=t.get(m),v=t.get(S);t.put([oo.create({id:m,x:((u=g.camera)==null?void 0:u.x)??(b==null?void 0:b.x),y:((d=g.camera)==null?void 0:d.y)??(b==null?void 0:b.y),z:((f=g.camera)==null?void 0:f.z)??(b==null?void 0:b.z)}),Is.create({id:S,pageId:g.pageId,selectedShapeIds:g.selectedShapeIds??(v==null?void 0:v.selectedShapeIds),focusedGroupId:g.focusedGroupId??(v==null?void 0:v.focusedGroupId)})])}t.put([l]),t.ensureStoreIsUsable()})}function MW(t){var i;const e=[];for(const s of Object.values(t))(i=s.typeName)!=null&&i.match(/^(instance.*|pointer|camera)$/)&&e.push(s);const n=e.filter(s=>s.typeName==="instance"&&s.id!==kr)[0];if(!n)return null;const r={version:pS,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:e.filter(s=>s.typeName==="instance_page_state"&&s.instanceId===n.id).map(s=>{const o=t[s.cameraId]??{x:0,y:0,z:1};return{pageId:s.pageId,camera:{x:o.x,y:o.y,z:o.z},selectedShapeIds:s.selectedShapeIds,focusedGroupId:s.focusedGroupId}})};try{return x4.validate(r),r}catch{return null}}function w4(t,e,n){let r={};if("store"in e){const o=t.schema.migrateStoreSnapshot(e);if(o.type!=="success")throw new Error("Failed to migrate store snapshot: "+o.reason);r.document={schema:t.schema.serialize(),store:gf(o.value,(l,{typeName:u})=>t.scopedTypes.document.has(u))}}else r=e;const i=h3(t.get(kr)),s=C4.get(t,v2).get();t.atomic(()=>{r.document&&t.loadStoreSnapshot(r.document),i&&t.update(kr,o=>({...o,...i})),s&&gC(t,s),r.session&&gC(t,r.session,{forceOverwrite:n==null?void 0:n.forceOverwriteSessionState})})}const C4=new po;function AW(t){const n=C4.get(t,v2).get();if(!n)throw new Error("Session state is not ready yet");return{document:t.getStoreSnapshot(),session:n}}function _4(t){const e=[],n=new Set;for(const r of t){if(n.has(r.type))throw new Error(`Binding type "${r.type}" is defined more than once`);e.push(r),n.add(r.type)}return e}function Sl({children:t,className:e="",...n}){return p.jsx("svg",{...n,className:je("tl-svg-container",e),children:t})}function b2(t,e,n,r){const i=t.x-n.x,s=t.y-n.y,o=r.x-n.x,l=r.y-n.y,u=e.x-t.x,d=e.y-t.y,f=o*s-l*i,g=u*s-d*i,m=l*u-o*d;if(f===0||g===0||m===0)return null;if(m!==0){const S=f/m,b=g/m;if(0<=S&&S<=1&&0<=b&&b<=1)return T.AddXY(t,S*u,S*d)}return null}function op(t,e,n,r){const i=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y),s=2*((e.x-t.x)*(t.x-n.x)+(e.y-t.y)*(t.y-n.y)),o=n.x*n.x+n.y*n.y+t.x*t.x+t.y*t.y-2*(n.x*t.x+n.y*t.y)-r*r,l=s*s-4*i*o;if(l<0||l===0)return null;const u=Math.sqrt(l),d=(-s+u)/(2*i),f=(-s-u)/(2*i);if((d<0||d>1)&&(f<0||f>1))return null;const g=[];return 0<=d&&d<=1&&g.push(T.Lrp(t,e,d)),0<=f&&f<=1&&g.push(T.Lrp(t,e,f)),g.length===0?null:g}function kW(t,e,n){const r=[];let i;for(let s=0,o=n.length-1;s<o;s++)i=b2(t,e,n[s],n[s+1]),i&&r.push(i);return r.length===0?null:r}function x2(t,e,n){const r=[];let i;for(let s=1,o=n.length;s<o+1;s++)i=b2(t,e,n[s-1],n[s%n.length]),i&&r.push(i);return r.length===0?null:r}function RW(t,e,n,r){let i=n.x-t.x,s=n.y-t.y;const o=Math.sqrt(i*i+s*s),l=(o*o-r*r+e*e)/(2*o),u=Math.sqrt(e*e-l*l);return i/=o,s/=o,[new T(t.x+i*l-s*u,t.y+s*l+i*u),new T(t.x+i*l+s*u,t.y+s*l-i*u)]}function mC(t,e,n){const r=[];let i,s,o;for(let l=0,u=n.length;l<u;l++)i=n[l],s=n[(l+1)%n.length],o=op(i,s,t,e),o&&r.push(...o);return r.length===0?null:r}function ZR(t,e,n){const r=[];let i,s,o;for(let l=1,u=n.length;l<u;l++)i=n[l-1],s=n[l],o=op(i,s,t,e),o&&r.push(...o);return r.length===0?null:r}function Hg(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function w2(t,e,n,r){return Hg(t,n,r)!==Hg(e,n,r)&&Hg(t,e,n)!==Hg(t,e,r)}function QR(t,e){const n=new Map;let r,i,s,o;for(let l=0,u=t.length;l<u;l++)if(r=t[l],Ci(r,e)){const d=Uw(r);n.has(d)||n.set(d,r)}for(let l=0,u=e.length;l<u;l++)if(r=e[l],Ci(r,t)){const d=Uw(r);n.has(d)||n.set(d,r)}for(let l=0,u=t.length;l<u;l++){r=t[l],i=t[(l+1)%t.length];for(let d=0,f=e.length;d<f;d++){s=e[d],o=e[(d+1)%e.length];const g=b2(r,i,s,o);if(g!==null){const m=Uw(g);n.has(m)||n.set(m,g)}}}return n.size===0?null:OW([...n.values()])}function Uw(t){return`${t.x},${t.y}`}function OW(t){const e=T.Average(t);return t.sort((n,r)=>T.Angle(e,n)-T.Angle(e,r))}function C2(t,e){let n,r,i,s;for(let o=0,l=t.length;o<l;o++){n=t[o],r=t[(o+1)%l];for(let u=0,d=e.length;u<d;u++)if(i=e[u],s=e[(u+1)%d],w2(n,r,i,s))return!0}return!1}function jW(t,e){let n,r,i,s;for(let o=0,l=t.length;o<l;o++){n=t[o],r=t[(o+1)%l];for(let u=1,d=e.length;u<d;u++)if(i=e[u-1],s=e[u],w2(n,r,i,s))return!0}return!1}class ua extends Al{constructor(n){super({...n,isClosed:!1,isFilled:!1});O(this,"start");O(this,"end");O(this,"d");O(this,"u");O(this,"ul");const{start:r,end:i}=n;this.start=r,this.end=i,this.d=r.clone().sub(i),this.u=this.d.clone().uni(),this.ul=this.u.len()}getLength(){return this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(n){const{start:r,end:i,d:s,u:o,ul:l}=this;if(s.len()===0||l===0)return r;const u=T.Sub(n,r).dpr(o)/l,d=r.x+o.x*u;if(d<Math.min(r.x,i.x))return r.x<i.x?r:i;if(d>Math.max(r.x,i.x))return r.x>i.x?r:i;const f=r.y+o.y*u;return f<Math.min(r.y,i.y)?r.y<i.y?r:i:f>Math.max(r.y,i.y)?r.y>i.y?r:i:new T(d,f)}hitTestLineSegment(n,r,i=0){return w2(n,r,this.start,this.end)||this.distanceToLineSegment(n,r)<=i}getSvgPathData(n=!0){const{start:r,end:i}=this;return`${n?`M${r.toFixed()}`:""} L${i.toFixed()}`}}class _d extends Al{constructor(n){super({isClosed:!1,isFilled:!1,...n});O(this,"points");O(this,"_segments");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:n}=this;for(let r=0,i=n.length-1;r<i;r++){const s=n[r],o=n[r+1];this._segments.push(new ua({start:s,end:o}))}this.isClosed&&this._segments.push(new ua({start:n[n.length-1],end:n[0]}))}return this._segments}getLength(){return this.segments.reduce((n,r)=>n+r.length,0)}getVertices(){return this.points}nearestPoint(n){const{segments:r}=this;let i=this.points[0],s=1/0,o,l;for(let u=0;u<r.length;u++)o=r[u].nearestPoint(n),l=T.Dist2(o,n),l<s&&(i=o,s=l);if(!i)throw Error("nearest point not found");return i}hitTestLineSegment(n,r,i=0){const{segments:s}=this;for(let o=0,l=s.length;o<l;o++)if(s[o].hitTestLineSegment(n,r,i))return!0;return!1}getSvgPathData(){const{vertices:n}=this;return n.length<2?"":n.reduce((r,i,s)=>s===0?`M ${i.x} ${i.y}`:`${r} L ${i.x} ${i.y}`,"")}}class bn extends _d{constructor(e){super({...e}),this.isClosed=!0}}class Rr extends bn{constructor(n){const{x:r=0,y:i=0,width:s,height:o}=n;super({...n,points:[new T(r,i),new T(r+s,i),new T(r+s,i+o),new T(r,i+o)]});O(this,"x");O(this,"y");O(this,"w");O(this,"h");this.x=r,this.y=i,this.w=s,this.h=o}getBounds(){return new xe(this.x,this.y,this.w,this.h)}getSvgPathData(){const{x:n,y:r,w:i,h:s}=this;return`M${n},${r} h${i} v${s} h-${i}z`}}class si{constructor(e){O(this,"options",{});this.editor=e}static configure(e){return class extends this{constructor(){super(...arguments);O(this,"options",{...this.options,...e})}}}canSnap(e){return!0}canScroll(e){return!1}canBind(e){return!0}canEdit(e){return!1}canResize(e){return!0}canEditInReadOnly(e){return!1}canCrop(e){return!1}canBeLaidOut(e){return!0}providesBackgroundForChildren(e){return!1}hideResizeHandles(e){return!1}hideRotateHandle(e){return!1}hideSelectionBoundsBg(e){return!1}hideSelectionBoundsFg(e){return!1}isAspectRatioLocked(e){return!1}canReceiveNewChildrenOfType(e,n){return!1}canDropShapes(e,n){return!1}expandSelectionOutlinePx(e){return 0}getCanvasSvgDefs(){return[]}getBoundsSnapGeometry(e){return{}}getHandleSnapGeometry(e){return{}}getText(e){}}O(si,"props"),O(si,"migrations"),O(si,"type");function Ps(t,e,n={}){const{closed:r=!1,snap:i=1,start:s="outset",end:o="outset",lengthRatio:l=2,style:u="dashed",forceSolid:d=!1}=n;let f=0,g=0,m=1,S=0,b=0;if(d)return{strokeDasharray:"none",strokeDashoffset:"none"};switch(u){case"dashed":{m=1,f=Math.min(e*l,t/4);break}case"dotted":{m=100,f=e/m;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(s==="outset"?(t+=f/2,b+=f/2):s==="skip"&&(t-=f,b-=f),o==="outset"?t+=f/2:o==="skip"&&(t-=f)),g=Math.floor(t/f/(2*m)),g-=g%i,g<3&&u==="dashed"?t/e<4?(f=t,g=1,S=0):(f=t*(1/3),S=t*(1/3)):(f=t/g/(2*m),r?(b=f/2,S=(t-g*f)/g):S=(t-g*f)/Math.max(1,g-1)),{strokeDasharray:[f,S].join(" "),strokeDashoffset:b.toString()}}function JR({bounds:t,className:e}){const n=re(),r=oe("zoom level",()=>n.getZoomLevel(),[n]);return p.jsx("g",{className:e,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((i,s)=>{const{strokeDasharray:o,strokeDashoffset:l}=Ps(i[0].dist(i[1]),1/r,{style:"dashed",lengthRatio:4});return p.jsx("line",{x1:i[0].x,y1:i[0].y,x2:i[1].x,y2:i[1].y,strokeDasharray:o,strokeDashoffset:l},s)})})}class Em extends si{hideSelectionBoundsFg(){return!0}canBind(){return!1}getDefaultProps(){return{}}getGeometry(e){const n=this.editor.getSortedChildIdsForParent(e.id);return n.length===0?new Rr({width:1,height:1,isFilled:!1}):new ns({children:n.map(r=>{const i=this.editor.getShape(r),s=this.editor.getShapeGeometry(r),o=this.editor.getShapeLocalTransform(i).applyToPoints(s.vertices);return s.isClosed?new bn({points:o,isFilled:!0}):new _d({points:o})})})}component(e){const n=this.editor.getErasingShapeIds().includes(e.id),{hintingShapeIds:r}=this.editor.getCurrentPageState(),i=r.length>0&&r.some(l=>l!==e.id&&this.editor.isShapeOfType(this.editor.getShape(l),"group")),s=this.editor.getCurrentPageState().focusedGroupId!==e.id;if(!n&&(s||i))return null;const o=this.editor.getShapeGeometry(e).bounds;return p.jsx(Sl,{children:p.jsx(JR,{className:"tl-group",bounds:o})})}indicator(e){const n=this.editor.getShapeGeometry(e).bounds;return p.jsx(JR,{className:"",bounds:n})}onChildrenChange(e){const n=this.editor.getSortedChildIdsForParent(e.id);if(n.length===0){this.editor.getCurrentPageState().focusedGroupId===e.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([e.id]);return}else if(n.length===1){this.editor.getCurrentPageState().focusedGroupId===e.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(n,e.parentId),this.editor.deleteShapes([e.id]);return}}}O(Em,"type","group"),O(Em,"props",_3),O(Em,"migrations",E3);const E4=[Em],DW=new Set(E4.map(t=>t.type));function P4(t){const e=[...E4],n=new Set;for(const r of t){if(DW.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);e.push(r),n.add(r.type)}return e}var Ed=MD();const LW=_l(Ed);function T4(t,e){const n=new Map;return async function(i){const s=n.get(i);if(s)return s;const o=(async()=>{try{const l=await go(i,e);return xt(l.ok),await t(l)}catch(l){return console.error(l),null}})();return n.set(i,o),o}}const gS=T4(async t=>await Ts.blobToDataUrl(await t.blob())),NW=/@import\s+(?:"([^"]+)"|'([^']+)'|url\s*\(\s*(?:"([^"]+)"|'([^']+)'|([^'")]+))\s*\))([^;]+);/gi,zW=/@font-face\s*{([^}]+)}/gi,I4=/url\s*\(\s*(?:"([^"]+)"|'([^']+)'|([^'")]+))\s*\)/gi,$W=/(?:^|;)\s*font-family\s*:\s*(?:([^'"][^;\n]+)|"([^"]+)"|'([^']+)')\s*(?:;|$)/gi;function BW(t){return Array.from(t.matchAll(NW),e=>({url:e[1]||e[2]||e[3]||e[4]||e[5],extras:e[6]}))}function M4(t,e){return Array.from(t.matchAll(zW),n=>{const r=n[1],i=Array.from(r.matchAll(I4),o=>{var u;const l=o[1]||o[2]||o[3];return{original:l,resolved:((u=Ge(l,e))==null?void 0:u.href)??null}}),s=new Set(Array.from(r.matchAll($W),o=>(o[1]||o[2]||o[3]).toLowerCase()));return{fontFace:r,urls:i,fontFamilies:s}})}function FW(t){const e=/\s*(?:([^'"][^;\n\s,]+)|"([^"]+)"|'([^']+)')\s*/gi,n=/\s*,\s*/gi,r=new Set;for(;;){const i=e.exec(t);if(!i)break;const s=i[1]||i[2]||i[3];if(r.add(s.toLowerCase()),n.lastIndex=e.lastIndex,!n.exec(t))break;e.lastIndex=n.lastIndex}return r}function A4(t){return!(t.startsWith("-")||t.startsWith("animation")||t.startsWith("transition")||t==="cursor"||t==="pointer-events"||t==="user-select"||t==="touch-action")}function UW(t,e){return{imports:BW(t),fontFaces:M4(t,e)}}function HW(t){return Array.from(t.matchAll(I4),e=>({original:e[0],url:e[1]||e[2]||e[3]}))}const KW=new Set(["border-collapse","border-spacing","caption-side","color","cursor","direction","empty-cells","font-family","font-size","font-style","font-variant","font-weight","font-size-adjust","font-stretch","font","letter-spacing","line-height","list-style-image","list-style-position","list-style-type","list-style","orphans","quotes","tab-size","text-align","text-align-last","text-decoration-color","text-indent","text-justify","text-shadow","text-transform","visibility","white-space","widows","word-break","word-spacing","word-wrap"]);function k4(t){return KW.has(t)}var GW=Object.create,R4=Object.defineProperty,qW=Object.getOwnPropertyDescriptor,YW=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),O4=t=>{throw TypeError(t)},j4=(t,e,n)=>e in t?R4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,VW=t=>[,,,GW(null)],D4=["class","method","getter","setter","accessor","field","value","get","set"],L4=t=>t!==void 0&&typeof t!="function"?O4("Function expected"):t,WW=(t,e,n,r,i)=>({kind:D4[t],name:e,metadata:r,addInitializer:s=>n._?O4("Already initialized"):i.push(L4(s||null))}),XW=(t,e)=>j4(e,YW("metadata"),t[3]),ZW=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},QW=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=D4[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,qW(i,n)),C=r.length-1;C>=0;C--)u=WW(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,L4(o)&&(w[b]=o);return w&&R4(i,n,w),i},Kg=(t,e,n)=>j4(t,typeof e!="symbol"?e+"":e,n),N4,mS;N4=[ni];class _2{constructor(){ZW(mS,5,this),Kg(this,"fontFacesPromise",null),Kg(this,"foundFontNames",new Set),Kg(this,"fontFacesToEmbed",new Set),Kg(this,"pendingPromises",[])}startFindingCurrentDocumentFontFaces(){xt(!this.fontFacesPromise,"FontEmbedder already started"),this.fontFacesPromise=JW()}onFontFamilyValue(e){xt(this.fontFacesPromise,"FontEmbedder not started");const n=FW(e);for(const r of n){if(this.foundFontNames.has(r))return;this.foundFontNames.add(r),this.pendingPromises.push(this.fontFacesPromise.then(i=>{const s=i.filter(o=>o.fontFamilies.has(r));for(const o of s)if(!this.fontFacesToEmbed.has(o)){this.fontFacesToEmbed.add(o);for(const l of o.urls)!l.resolved||l.embedded||(l.embedded=gS(l.resolved))}}))}}async createCss(){await Promise.all(this.pendingPromises);let e="";for(const n of this.fontFacesToEmbed){let r=`@font-face {${n.fontFace}}`;for(const i of n.urls){if(!i.embedded)continue;const s=await i.embedded;s&&(r=r.replace(i.original,s))}e+=r}return e}}mS=VW();QW(mS,1,"onFontFamilyValue",N4,_2);XW(mS,_2);async function JW(){var e;const t=[];for(const n of document.styleSheets){let r;try{r=n.cssRules}catch{}if(r){for(const i of n.cssRules)if(i instanceof CSSFontFaceRule)t.push(M4(i.cssText,n.href??document.baseURI));else if(i instanceof CSSImportRule){const s=new URL(i.href,((e=i.parentStyleSheet)==null?void 0:e.href)??document.baseURI);t.push(yC(s.href))}}else n.href&&t.push(yC(n.href))}return We(await Promise.all(t)).flat()}const yC=T4(async t=>{const e=UW(await t.text(),t.url),n=await Promise.all(e.imports.map(({url:r})=>yC(new URL(r,t.url).href)));return[...e.fontFaces,...We(n).flat()]});function z4(t){if(t.shadowRoot)return t.shadowRoot.childNodes;if(rX(t)){const e=t.assignedNodes();if(e!=null&&e.length)return e}return t.childNodes}function*SC(t){for(const e of z4(t))eX(e)&&(yield e)}function yS(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)??globalThis}function eX(t){return t instanceof yS(t).Element}function tX(t){return t instanceof yS(t).ShadowRoot}function nX(t){return"getRootNode"in t&&tX(t.getRootNode())}function rX(t){return nX(t)&&t instanceof yS(t).HTMLSlotElement}function iX(t){return t.style}function E2(t,e){return yS(t).getComputedStyle(t,e)}const vc={};class sX{constructor(e){O(this,"styles",new Map);O(this,"fonts",new _2);this.root=e}readRootElementStyles(e){this.readElementStyles(e,{shouldRespectDefaults:!1,shouldSkipInheritedParentStyles:!1});const n=Array.from(SC(e));for(;n.length;){const r=n.pop();n.push(...SC(r)),this.readElementStyles(r,{shouldRespectDefaults:!0,shouldSkipInheritedParentStyles:!0})}}readElementStyles(e,{shouldRespectDefaults:n=!0,shouldSkipInheritedParentStyles:r=!0}){var l;const i=n?cX(e.tagName.toLowerCase()):vc,s=r?((l=this.styles.get(e.parentElement))==null?void 0:l.self)??vc:vc,o={self:oX(e,{defaultStyles:i,parentStyles:s}),before:eO(e,"::before"),after:eO(e,"::after")};this.styles.set(e,o)}fetchResources(){const e=[];for(const n of this.styles.values())for(const r of ln(n))if(r)for(const[i,s]of Object.entries(r)){if(!s)continue;i==="font-family"&&this.fonts.onFontFamilyValue(s);const o=HW(s);o.length!==0&&e.push(...o.map(async({url:l,original:u})=>{const d=await gS(l)??"data:";r[i]=s.replace(u,`url("${d}")`)}))}return Promise.all(e)}unwrapCustomElements(){const e=new Set,n=(r,i)=>{if(e.has(r))return;e.add(r);const s=r.shadowRoot;if(s){const o=document.createElement("div");this.styles.set(o,this.styles.get(r)),o.setAttribute("data-tl-custom-element",r.tagName),(i??r.parentElement).appendChild(o);for(const l of s.childNodes)l instanceof Element?n(l,o):o.appendChild(l.cloneNode(!0));r.remove()}else if(i){if(r.tagName.toLowerCase()==="style")return;const o=r.cloneNode(!1);this.styles.set(o,this.styles.get(r)),i.appendChild(o);for(const l of z4(r))l instanceof Element?n(l,o):o.appendChild(l.cloneNode(!0))}};for(const r of this.styles.keys())n(r,null)}embedStyles(){let e="";for(const[n,r]of this.styles){if(r.after||r.before){const s=`pseudo-${At()}`;n.classList.add(s),r.before&&(e+=`.${s}::before {${tO(r.before)}}
`),r.after&&(e+=`.${s}::after {${tO(r.after)}}
`)}const i=iX(n);for(const[s,o]of Object.entries(r.self))o&&i.setProperty(s,o);i.fontKerning==="auto"&&(i.fontKerning="normal")}return e}async getFontFaceCss(){return await this.fonts.createCss()}dispose(){lX()}}function oX(t,{defaultStyles:e,parentStyles:n}){return t.computedStyleMap?$4(t.computedStyleMap(),{defaultStyles:e,parentStyles:n}):P2(E2(t),{defaultStyles:e,parentStyles:n})}function eO(t,e){const n=E2(t,e),r=n.getPropertyValue("content");if(!(r===""||r==="none"))return P2(n,{defaultStyles:vc,parentStyles:vc})}function $4(t,{defaultStyles:e,parentStyles:n}){const r={};for(const i of t.keys()){if(!A4(i))continue;const s=t.get(i).toString();e[i]!==s&&(n[i]===s&&k4(i)||(r[i]=s))}return r}function P2(t,{defaultStyles:e,parentStyles:n}){const r={};for(const i of t){if(!A4(i))continue;const s=t.getPropertyValue(i);e[i]!==s&&(n[i]===s&&k4(i)||(r[i]=s))}return r}function tO(t){let e="";for(const[n,r]of Object.entries(t))e+=`${n}: ${r};`;return e}let Ju;const nO={};function aX(){if(!Ju){const t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);const e=Qr(t.contentDocument,"frame must have a document"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");n.appendChild(r),e.body.appendChild(n),Ju={iframe:t,foreignObject:r,document:e}}return Ju}function lX(){Ju&&(document.body.removeChild(Ju.iframe),Ju=void 0)}const rO={defaultStyles:vc,parentStyles:vc};function cX(t){let e=nO[t];if(!e){const{foreignObject:n,document:r}=aX(),i=r.createElement(t);n.appendChild(i),e=i.computedStyleMap?$4(i.computedStyleMap(),rO):P2(E2(i),rO),n.removeChild(i),nO[t]=e}return e}function uX(t,e){Array.from(t.attributes).forEach(r=>{e.setAttribute(r.name,r.value)})}function iO(t,e){return t.replaceWith(e),e}async function Sf(t,e){const n=document.createElement("img");e&&uX(e,n),n.setAttribute("src",t??"data:"),n.setAttribute("decoding","sync"),n.setAttribute("loading","eager");try{await n.decode()}catch{}return n}async function dX(t){try{const e=t.toDataURL();return await Sf(e,t)}catch{return await Sf(null,t)}}async function hX(t){try{const e=await bi.getVideoFrameAsDataUrl(t);return Sf(e,t)}catch(e){console.error("Could not get video frame",e)}if(t.poster){const e=await gS(t.poster);return Sf(e,t)}return Sf(null,t)}async function B4(t){if(t instanceof HTMLCanvasElement)return iO(t,await dX(t));if(t instanceof HTMLVideoElement)return iO(t,await hX(t));if(t instanceof HTMLImageElement){const e=t.currentSrc||t.src,n=await gS(e);t.setAttribute("src",n??"data:"),t.setAttribute("decoding","sync"),t.setAttribute("loading","eager");try{await t.decode()}catch{}return t}else t instanceof HTMLInputElement?t.setAttribute("value",t.value):t instanceof HTMLTextAreaElement&&(t.textContent=t.value);await Promise.all(Array.from(SC(t),e=>B4(e)))}function SS(t){const e=E.useRef();return E.useLayoutEffect(()=>{e.current=t}),E.useDebugValue(t),E.useCallback((...n)=>{const r=e.current;return xt(r,"fn does not exist"),r(...n)},[])}const T2=E.createContext(null);function fX({context:t,editor:e,children:n}){const r=e.options.exportProvider;return p.jsx(h2,{editor:e,children:p.jsx(H3,{container:e.getContainer(),children:p.jsx(T2.Provider,{value:t,children:p.jsx(r,{children:n})})})})}function ap(){return E.useContext(T2)}function pX(){const t=E.useContext(T2),[e]=E.useState(__);return E.useEffect(()=>(t==null||t.waitUntil(e),()=>{e.resolve()}),[e,t]),SS(()=>{e.resolve()})}var gX=Object.create,F4=Object.defineProperty,mX=Object.getOwnPropertyDescriptor,yX=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),U4=t=>{throw TypeError(t)},H4=(t,e,n)=>e in t?F4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,SX=t=>[,,,gX(null)],K4=["class","method","getter","setter","accessor","field","value","get","set"],G4=t=>t!==void 0&&typeof t!="function"?U4("Function expected"):t,vX=(t,e,n,r,i)=>({kind:K4[t],name:e,metadata:r,addInitializer:s=>n._?U4("Already initialized"):i.push(G4(s||null))}),bX=(t,e)=>H4(e,yX("metadata"),t[3]),xX=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},wX=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=K4[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,mX(i,n)),C=r.length-1;C>=0;C--)u=vX(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,G4(o)&&(w[b]=o);return w&&F4(i,n,w),i},sO=(t,e,n)=>H4(t,typeof e!="symbol"?e+"":e,n),q4,vS;q4=[ni];class I2{constructor(e){this.maxDelayTimeMs=e,xX(vS,5,this),sO(this,"isResolved",!1),sO(this,"promisesToWaitFor",[])}waitUntil(e){if(this.isResolved)throw new Error("Cannot `waitUntil` - the export has already been resolved. Make sure to call `waitUntil` as soon as possible during an export - ie within the first react effect after rendering.");this.promisesToWaitFor.push(e.catch(n=>console.error("Error whilst waiting for export:",n)))}async resolvePromises(){let e=null;for(;this.promisesToWaitFor.length!==e;)e=this.promisesToWaitFor.length,await Promise.allSettled(this.promisesToWaitFor),await Z1(0)}async resolve(){const e=Z1(this.maxDelayTimeMs).then(()=>"timeout"),n=this.resolvePromises().then(()=>"resolved");await Promise.race([e,n])==="timeout"&&console.warn("[tldraw] Export delay timed out after ${this.maxDelayTimeMs}ms"),this.isResolved=!0}}vS=SX();wX(vS,1,"waitUntil",q4,I2);bX(vS,I2);function CX(t,e,n={}){var C,_;if(!window.document)throw Error("No document");const{scale:r=1,background:i=t.getInstanceState().exportBackground,padding:s=t.options.defaultSvgPadding,preserveAspectRatio:o}=n,l=n.darkMode??t.user.getIsDarkMode(),u=t.getShapeAndDescendantIds(e),d=t.getUnorderedRenderingShapes(!1).filter(({id:M})=>u.has(M));let f=null;if(n.bounds)f=n.bounds;else for(const{id:M}of d){const I=t.getShapeMaskedPageBounds(M);I&&(f?f.union(I):f=I.clone())}if(!f)return;const g=e.length===1&&t.isShapeOfType(t.getShape(e[0]),"frame")?e[0]:null;g||f.expandBy(s);const m=f.width*r,S=f.height*r;try{(_=(C=document.body).focus)==null||_.call(C)}catch{}const b=new I2(t.options.maxExportDelayMs),v=__();return b.waitUntil(v),{jsx:p.jsx(_X,{editor:t,preserveAspectRatio:o,scale:r,pixelRatio:n.pixelRatio??null,bbox:f,background:i,singleFrameShapeId:g,isDarkMode:l,renderingShapes:d,onMount:v.resolve,waitUntil:b.waitUntil}),width:m,height:S,exportDelay:b}}function _X({editor:t,preserveAspectRatio:e,scale:n,pixelRatio:r,bbox:i,background:s,singleFrameShapeId:o,isDarkMode:l,renderingShapes:u,onMount:d,waitUntil:f}){const g=xd(),m=Ca({isDarkMode:l}),S=V_("export state",{defsById:{},shapeElements:null}),{defsById:b,shapeElements:v}=oe(S),w=SS(M=>{S.update(I=>{if(es(I.defsById,M.key))return I;const A=Promise.resolve(M.getElement());return f(A.then(R=>{S.update(D=>({...D,defsById:{...D.defsById,[M.key]:{pending:!1,element:R}}}))})),{...I,defsById:{...I.defsById,[M.key]:{pending:!0,element:A}}}})}),C=E.useMemo(()=>({isDarkMode:l,waitUntil:f,addExportDef:w,scale:n,pixelRatio:r,async resolveAssetUrl(M,I){const A=t.getAsset(M);return!A||A.type!=="image"&&A.type!=="video"?null:await t.resolveAssetUrl(M,{screenScale:n*(I/A.props.w),shouldResolveToOriginal:r===null,dpr:r??void 0})}}),[l,f,w,n,r,t]),_=E.useRef(!1);return E.useLayoutEffect(()=>{if(_.current)throw new Error("SvgExport should only render once - do not use with react strict mode");_.current=!0,(async()=>{const M={},I=u.map(async({id:R,opacity:D,index:L,backgroundIndex:G})=>{var N,B;if(R===o)return[];const k=t.getShape(R);if(t.isShapeOfType(k,"group"))return[];const $=[],F=t.getShapeUtil(k);if(F.toSvg||F.toBackgroundSvg){const[Y,K]=await Promise.all([(N=F.toSvg)==null?void 0:N.call(F,k,C),(B=F.toBackgroundSvg)==null?void 0:B.call(F,k,C)]),V=t.getShapePageTransform(k);let W=V.toCssString(),ee=1;"scale"in k.props&&k.props.scale!==1&&(ee=k.props.scale,W=`${W} scale(${k.props.scale}, ${k.props.scale})`);const H=t.getShapeMask(k.id),te=H?be.From(be.Inverse(V)).applyToPoints(H):null,ge=u2(g,k.id);te&&(M[ge]={pending:!1,element:p.jsx("clipPath",{id:ge,children:p.jsx("path",{d:`M${te.map(({x:de,y:Se})=>`${de/ee},${Se/ee}`).join("L")}Z`})})}),Y&&$.push({zIndex:L,element:p.jsx("g",{transform:W,opacity:D,clipPath:H?`url(#${ge})`:void 0,children:Y},`fg_${k.id}`)}),K&&$.push({zIndex:G,element:p.jsx("g",{transform:W,opacity:D,clipPath:H?`url(#${ge})`:void 0,children:K},`bg_${k.id}`)})}else $.push({zIndex:L,element:p.jsx(oO,{shape:k,util:F,component:r4,className:"tl-shape",bbox:i,opacity:D},`fg_${k.id}`)}),F.backgroundComponent&&$.push({zIndex:G,element:p.jsx(oO,{shape:k,util:F,component:i4,className:"tl-shape tl-shape-background",bbox:i,opacity:D},`bg_${k.id}`)});return $}),A=(await Promise.all(I)).flat();Ed.flushSync(()=>{S.update(R=>({...R,shapeElements:A.sort((D,L)=>D.zIndex-L.zIndex).map(({element:D})=>D),defsById:{...R.defsById,...M}}))})})()},[i,t,C,g,u,o,S]),E.useEffect(()=>{v!==null&&d()},[d,v]),p.jsx(fX,{editor:t,context:C,children:p.jsxs("svg",{preserveAspectRatio:e,direction:"ltr",width:i.width*n,height:i.height*n,viewBox:`${i.minX} ${i.minY} ${i.width} ${i.height}`,strokeLinecap:"round",strokeLinejoin:"round",style:{backgroundColor:s?o?m.solid:m.background:"transparent"},"data-color-mode":l?"dark":"light",className:`tl-container tl-theme__force-sRGB ${l?"tl-theme__dark":"tl-theme__light"}`,children:[p.jsx("defs",{children:Object.entries(b).map(([M,I])=>I.pending?null:p.jsx(E.Fragment,{children:I.element},M))}),v]})})}function oO({shape:t,util:e,className:n,component:r,bbox:i,opacity:s}){const o=re(),l=be.Translate(-i.minX,-i.minY).multiply(o.getShapePageTransform(t.id)),u=o.getShapeGeometry(t.id).bounds,d=Math.max(u.width,1),f=Math.max(u.height,1);return p.jsx(c2,{fallback:()=>null,children:p.jsx("foreignObject",{x:i.minX,y:i.minY,width:i.w,height:i.h,className:"tl-shape-foreign-object",children:p.jsx("div",{className:n,"data-shape-type":t.type,style:{clipPath:o.getShapeClipPath(t.id),transform:l.toCssString(),width:d,height:f,opacity:s},children:p.jsx(r,{shape:t,util:e})})})})}let EX=1;async function PX(t,e,n={}){const r=CX(t,e,n);if(!r)return;const i=t.getContainer(),s=document.createElement("div");s.className="tldraw-svg-export",s.inert=!0,s.tabIndex=-1,Object.assign(s.style,{position:"absolute",top:"0px",left:"0px",width:r.width+"px",height:r.height+"px",pointerEvents:"none",opacity:0}),i.appendChild(s);const o=AD.createRoot(s,{identifierPrefix:`export_${EX++}_`});try{await Promise.resolve(),Ed.flushSync(()=>{o.render(r.jsx)}),await r.exportDelay.resolve();const l=s.firstElementChild;return xt(l instanceof SVGSVGElement,"Expected an SVG element"),await TX(l),{svg:l,width:r.width,height:r.height}}finally{setTimeout(()=>{o.unmount(),i.removeChild(s)},0)}}async function TX(t){const e=[...t.querySelectorAll("foreignObject.tl-shape-foreign-object > *")];if(!e.length)return;const n=new sX(t);try{n.fonts.startFindingCurrentDocumentFontFaces(),await Promise.all(e.map(s=>B4(s)));for(const s of e)n.readRootElementStyles(s);await n.fetchResources();const r=await n.getFontFaceCss();n.unwrapCustomElements();const i=n.embedStyles();if(r||i){const s=document.createElementNS("http://www.w3.org/2000/svg","style");s.textContent=`${r}
${i}`,t.prepend(s)}}finally{n.dispose()}}/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function vf(t){const e=t.sizes.shift(),n=Math.max(Math.ceil(e[0]),1),r=Math.max(Math.ceil(e[1]),1),i=[n-1,r-1,1,1],s=performance.now(),o=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;let l,u;o?(l=new OffscreenCanvas(1,1),u=new OffscreenCanvas(n,r)):(l=document.createElement("canvas"),l.width=1,l.height=1,u=document.createElement("canvas"),u.width=n,u.height=r);const d=l.getContext("2d"),f=u.getContext("2d");f&&(f.fillRect.apply(f,i),d.drawImage(u,n-1,r-1,1,1,0,0,1,1));const g=d&&d.getImageData(0,0,1,1).data[3]!==0,m=parseInt(performance.now()-s);return[l,u].forEach(S=>{S.height=0,S.width=0}),o?(postMessage({width:n,height:r,testTime:m,isTestPass:g}),!g&&t.sizes.length&&setTimeout(()=>{vf(t)},0)):g?t.onSuccess({width:n,height:r,testTime:m}):(t.onError({width:n,height:r,testTime:m}),t.sizes.length&&setTimeout(()=>{vf(t)},0)),g}const Hw={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},qu={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Gh={};function Kw(t){const e=t.width===t.height,n=t.height===1,r=t.width===1,i=[];if(!t.width||!t.height)t.sizes.forEach(s=>{const o=e||n?s:1,l=e||r?s:1;i.push([o,l])});else{const s=t.min||qu.min,o=t.step||qu.step;let l=Math.max(t.width,t.height);for(;l>=s;){const u=e||n?l:1,d=e||r?l:1;i.push([u,d]),l-=o}}return i}function Gg(t){const e=typeof window<"u",n=e&&"Promise"in window,r=e&&"HTMLCanvasElement"in window,i=e&&"OffscreenCanvas"in window,s=URL.createObjectURL(new Blob([])).slice(-36),o=performance.now(),{onError:l,onSuccess:u,...d}=t,f=()=>parseInt(performance.now()-o);let g=null;if(!r)return!1;if(t.useWorker&&i){const m=`
            var canvasTest = ${vf.toString()};
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `,S=new Blob([m],{type:"application/javascript"}),b=URL.createObjectURL(S);g=new Worker(b),URL.revokeObjectURL(b),g.onmessage=function(v){const{width:w,height:C,testTime:_,isTestPass:M}=v.data,I={width:w,height:C,testTime:_,totalTime:f()};M?(Gh[s].onSuccess(I),delete Gh[s]):Gh[s].onError(I)}}if(n)return new Promise(m=>{const S={...t,onError(b){let{width:v,height:w,testTime:C}=b;const _={width:v,height:w,testTime:C,totalTime:f()};let M;if(t.sizes.length===0)M=!0;else{const[[I,A]]=t.sizes.slice(-1);M=v===I&&w===A}l(_),M&&m({..._,success:!1})},onSuccess(b){let{width:v,height:w,testTime:C}=b;const _={width:v,height:w,testTime:C,totalTime:f()};u(_),m({..._,success:!0})}};if(g){const{onError:b,onSuccess:v}=S;Gh[s]={onError:b,onSuccess:v},g.postMessage(d)}else vf(S)});if(g)Gh[s]={onError:l,onSuccess:u},g.postMessage(d);else return vf(t)}const Gw={maxArea(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Kw({width:t.max,height:t.max,min:t.min,step:t.step,sizes:[...Hw.area]}),n={...qu,...t,sizes:e};return Gg(n)},maxHeight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Kw({width:1,height:t.max,min:t.min,step:t.step,sizes:[...Hw.height]}),n={...qu,...t,sizes:e};return Gg(n)},maxWidth(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=Kw({width:t.max,height:1,min:t.min,step:t.step,sizes:[...Hw.width]}),n={...qu,...t,sizes:e};return Gg(n)},test(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e={...qu,...t};return e.sizes=[...e.sizes],e.width&&e.height&&(e.sizes=[[e.width,e.height]]),Gg(e)}};let qw=null;function IX(){return qw||(qw=MX()),qw}async function MX(){const t=await Gw.maxWidth({usePromise:!0}),e=await Gw.maxHeight({usePromise:!0}),n=await Gw.maxArea({usePromise:!0});return{maxWidth:t.width,maxHeight:e.height,maxArea:n.width*n.height}}const aO=8192,AX=4096*4096;async function kX(t,e){if(t<=aO&&e<=aO&&t*e<=AX)return[t,e];const{maxWidth:n,maxHeight:r,maxArea:i}=await IX(),s=t/e;if(t>n&&(t=n,e=t/s),e>r&&(e=r,t=e*s),t*e>i){const o=Math.sqrt(i/(t*e));t*=o,e*=o}return[t,e]}async function RX(t,e){const{type:n,width:r,height:i,quality:s=1,pixelRatio:o=2}=e;let[l,u]=await kX(r*o,i*o);l=Math.floor(l),u=Math.floor(u);const d=l/r,f=await Ts.blobToDataUrl(new Blob([t],{type:"image/svg+xml"})),g=await new Promise(S=>{const b=If();b.crossOrigin="anonymous",b.onload=async()=>{Ft.isSafari&&await Z1(250);const v=document.createElement("canvas"),w=v.getContext("2d");v.width=l,v.height=u,w.imageSmoothingEnabled=!0,w.imageSmoothingQuality="high",w.drawImage(b,0,0,l,u),URL.revokeObjectURL(f),S(v)},b.onerror=()=>{S(null)},b.src=f});if(!g)return null;const m=await new Promise(S=>g.toBlob(b=>{(!b||xn.throwToBlob.get())&&S(null),S(b)},"image/"+n,s));if(!m)return null;if(n==="png"){const S=new DataView(await m.arrayBuffer());return no.setPhysChunk(S,d,{type:"image/"+n})}else return m}const Es={menus:On("open menus",[]),getOpenMenus(t){return t?this.menus.get().filter(e=>e.endsWith("-"+t)):this.menus.get()},addOpenMenu(t,e=""){const n=e?`${t}-${e}`:t,r=new Set(this.menus.get());r.has(n)||(r.add(n),this.menus.set([...r]))},deleteOpenMenu(t,e=""){const n=e?`${t}-${e}`:t,r=new Set(this.menus.get());r.has(n)&&(r.delete(n),this.menus.set([...r]))},clearOpenMenus(t){this.menus.set(t?this.menus.get().filter(e=>!e.endsWith("-"+t)):[])},_hiddenMenus:[],hideOpenMenus(t){if(this._hiddenMenus=[...this.getOpenMenus(t)],this._hiddenMenus.length!==0)for(const e of this._hiddenMenus)this.deleteOpenMenu(e,t)},showOpenMenus(t){if(this._hiddenMenus.length!==0){for(const e of this._hiddenMenus)this.addOpenMenu(e,t);this._hiddenMenus=[]}},isMenuOpen(t,e){return this.getOpenMenus(e).includes(t)},hasOpenMenus(t){return this.getOpenMenus(t).length>0},hasAnyOpenMenus(){return this.getOpenMenus().length>0},forContext(t){return{getOpenMenus:()=>this.getOpenMenus(t),addOpenMenu:e=>this.addOpenMenu(e,t),deleteOpenMenu:e=>this.deleteOpenMenu(e,t),clearOpenMenus:()=>this.clearOpenMenus(t),isMenuOpen:e=>this.isMenuOpen(e,t),hasOpenMenus:()=>this.hasOpenMenus(t),hasAnyOpenMenus:()=>this.hasAnyOpenMenus()}}},vC=new zH,OX={maxShapesPerPage:4e3,maxFilesAtOnce:100,maxPages:40,animationMediumMs:320,followChaseViewportSnap:2,doubleClickDurationMs:450,multiClickDurationMs:200,coarseDragDistanceSquared:36,dragDistanceSquared:16,defaultSvgPadding:32,cameraSlideFriction:.09,gridSteps:[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],collaboratorInactiveTimeoutMs:6e4,collaboratorIdleTimeoutMs:3e3,collaboratorCheckIntervalMs:1200,cameraMovingTimeoutMs:64,hitTestMargin:8,edgeScrollDelay:200,edgeScrollEaseDuration:200,edgeScrollSpeed:25,edgeScrollDistance:8,coarsePointerWidth:12,coarseHandleRadius:20,handleRadius:12,longPressDurationMs:500,textShadowLod:.35,adjacentShapeMargin:10,flattenImageBoundsExpand:64,flattenImageBoundsPadding:16,laserDelayMs:1200,maxExportDelayMs:5e3,temporaryAssetPreviewLifetimeMs:18e4,actionShortcutsLocation:"swap",createTextOnCanvasDoubleClick:!0,exportProvider:E.Fragment,enableToolbarKeyboardShortcuts:!0};function lO(t,e){if(!e)return!1;switch(t.type){case"mixed":return e.type==="mixed";case"shared":return e.type==="shared"&&t.value===e.value;default:throw An(t)}}class jX{constructor(e){O(this,"map");this.map=new Map(e)}get(e){return this.map.get(e)}getAsKnownValue(e){const n=this.get(e);if(n&&n.type!=="mixed")return n.value}get size(){return this.map.size}equals(e){if(this.size!==e.size)return!1;const n=new Set;for(const[r,i]of this){if(!lO(i,e.get(r)))return!1;n.add(r)}for(const[r,i]of e)if(!n.has(r)&&!lO(i,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class bC extends jX{set(e,n){this.map.set(e,n)}applyValue(e,n){const r=this.get(e);if(!r){this.set(e,{type:"shared",value:n});return}switch(r.type){case"mixed":return;case"shared":r.value!==n&&this.set(e,{type:"mixed"});return;default:An(r,"type")}}}function DX(t,e,n){return go(t).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],e,{type:n})})}const LX="https://cdn.tldraw.com";function hl(){return`${LX}/${z3}`}function NX(t){switch(t.type){case"shapes":return`s${t.shapeIds.map(n=>Yw(n.slice(6))).join(".")}`;case"page":return"p"+Yw(Ai.parseId(t.pageId));case"viewport":{const{bounds:e,pageId:n}=t;let r=`v${Math.round(e.x)}.${Math.round(e.y)}.${Math.round(e.w)}.${Math.round(e.h)}`;return n&&(r+="."+Yw(Ai.parseId(n))),r}default:An(t)}}function zX(t){switch(t[0]){case"s":return{type:"shapes",shapeIds:t.slice(1).split(".").filter(Boolean).map(r=>Lt(decodeURIComponent(r)))};case"p":return{type:"page",pageId:Ai.createId(decodeURIComponent(t.slice(1)))};case"v":{const[n,r,i,s,o]=t.slice(1).split(".");return{type:"viewport",bounds:new xe(Number(n),Number(r),Number(i),Number(s)),pageId:o?Ai.createId(decodeURIComponent(o)):void 0}}default:throw Error("Invalid deep link string")}}function Yw(t){return encodeURIComponent(t).replace(/\./g,"%2E")}function $X(t,e){var i;let n=t;const r=new Set(e);for(;r.has(n);)n=(i=/^.*(\d+)$/.exec(n))!=null&&i[1]?n.replace(/(\d+)(?=\D?)$/,s=>(+s+1).toString()):`${n} 1`;return n}function qg(t,e,n,r){if(n.length===0)return[];const i=new Map;for(const o of We(n.map(l=>t.getShape(l)))){const{parentId:l}=o;i.has(l)||i.set(l,{children:We(t.getSortedChildIdsForParent(l).map(u=>t.getShape(u))),moving:new Set}),i.get(l).moving.add(o)}const s=[];switch(e){case"toBack":{i.forEach(({moving:o,children:l})=>BX(o,l,s));break}case"toFront":{i.forEach(({moving:o,children:l})=>FX(o,l,s));break}case"forward":{i.forEach(({moving:o,children:l})=>UX(t,o,l,s,r));break}case"backward":{i.forEach(({moving:o,children:l})=>HX(t,o,l,s,r));break}}return s}function BX(t,e,n){const r=e.length;if(t.size===r)return;let i,s;for(let o=0;o<r;o++){const l=e[o];if(t.has(l))i=l.index,t.delete(l);else{s=l.index;break}}if(t.size!==0){const o=od(i,s,t.size);n.push(...Array.from(t.values()).sort(vr).map((l,u)=>({...l,index:o[u]})))}}function FX(t,e,n){const r=e.length;if(t.size===r)return;let i,s;for(let o=r-1;o>-1;o--){const l=e[o];if(t.has(l))s=l.index,t.delete(l);else{i=l.index;break}}if(t.size!==0){const o=od(i,s,t.size);n.push(...Array.from(t.values()).sort(vr).map((l,u)=>({...l,index:o[u]})))}}function cO(t,e){const n=t.getShapeGeometry(e),r=t.getShapePageTransform(e);return!n||!r?null:r.applyToPoints(n.vertices)}function Y4(t,e){const n=Array.from(e).map(i=>{const s=cO(t,i);return s?{shape:i,vertices:s}:null}).filter(Boolean);return i=>{const s=cO(t,i);return s?n.some(o=>C2(o.vertices,s)):!1}}function UX(t,e,n,r,i){var u;const s=Y4(t,e),o=n.length;if(e.size===o)return;let l={name:"skipping"};for(let d=0;d<o;d++){const f=e.has(n[d]);switch(l.name){case"skipping":{if(!f)continue;l={name:"selecting",selectIndex:d};break}case"selecting":{if(f||!(i!=null&&i.considerAllShapes)&&!s(n[d]))continue;const{selectIndex:g}=l;od(n[d].index,(u=n[d+1])==null?void 0:u.index,d-g).forEach((m,S)=>{const b=n[g+S];e.has(b)&&r.push({...b,index:m})}),l={name:"skipping"};break}}}}function HX(t,e,n,r,i){var u;const s=Y4(t,e),o=n.length;if(e.size===o)return;let l={name:"skipping"};for(let d=o-1;d>-1;d--){const f=e.has(n[d]);switch(l.name){case"skipping":{if(!f)continue;l={name:"selecting",selectIndex:d};break}case"selecting":{if(f||!(i!=null&&i.considerAllShapes)&&!s(n[d]))continue;od((u=n[d-1])==null?void 0:u.index,n[d].index,l.selectIndex-d).forEach((g,m)=>{const S=n[d+m+1];e.has(S)&&r.push({...S,index:g})}),l={name:"skipping"};break}}}}function V4({editor:t,ids:e}){const n=We(e.map(o=>t.getShape(o))),r=t.getShapesSharedRotation(e),i=t.getShapesRotatedPageBounds(e);if(!i)return null;const s=i.center.clone().rotWith(i.point,r);return{pageCenter:s,initialCursorAngle:s.angle(t.inputs.originPagePoint),initialShapesRotation:r,shapeSnapshots:n.map(o=>({shape:o,initialPagePoint:t.getShapePageTransform(o.id).point()}))}}function Pm({delta:t,editor:e,snapshot:n,stage:r,centerOverride:i}){const{pageCenter:s,shapeSnapshots:o}=n;e.updateShapes(o.map(({shape:u,initialPagePoint:d})=>{const f=Zr(u.parentId)?e.getShapePageTransform(u.parentId):be.Identity(),g=T.RotWith(d,i??s,t),m=be.applyToPoint(be.Inverse(f),g),S=yc(u.rotation+t);return{id:u.id,type:u.type,x:m.x,y:m.y,rotation:S}}));const l=[];o.forEach(({shape:u})=>{var m,S,b;const d=e.getShape(u.id);if(!d)return;const f=e.getShapeUtil(u);if(r==="start"||r==="one-off"){const v=(m=f.onRotateStart)==null?void 0:m.call(f,u);v&&l.push(v)}const g=(S=f.onRotate)==null?void 0:S.call(f,u,d);if(g&&l.push(g),r==="end"||r==="one-off"){const v=(b=f.onRotateEnd)==null?void 0:b.call(f,u,d);v&&l.push(v)}}),l.length>0&&e.updateShapes(l)}const KX=t=>{const{store:e}=t,n=e.query.filterHistory("binding"),r=e.query.records("binding");function i(){const s=r.get(),o=new Map;for(const l of s){const{fromId:u,toId:d}=l,f=o.get(u);f?f.push(l):o.set(u,[l]);const g=o.get(d);g?g.push(l):o.set(d,[l])}return o}return he("arrowBindingsIndex",(s,o)=>{if(mc(s))return i();const l=s,u=n.getDiffSince(o);if(u===wi)return i();let d;function f(S){d??(d=new Map(l));const b=d.get(S.fromId),v=b==null?void 0:b.filter(_=>_.id!==S.id);v!=null&&v.length?d.set(S.fromId,v):d.delete(S.fromId);const w=d.get(S.toId),C=w==null?void 0:w.filter(_=>_.id!==S.id);C!=null&&C.length?d.set(S.toId,C):d.delete(S.toId)}function g(S){d??(d=new Map(l));let b=d.get(S);return b?b===l.get(S)&&(b=b.slice(0),d.set(S,b)):(b=[],d.set(S,b)),b}function m(S){g(S.fromId).push(S),g(S.toId).push(S)}for(const S of u){for(const b of ln(S.added))m(b);for(const[b,v]of ln(S.updated))f(b),m(v);for(const b of ln(S.removed))f(b)}return d??l})};function GX(t,e,n){const r=t.getShapeMaskedPageBounds(e);return r===void 0?!0:!n.includes(r)}const qX=t=>{function e(n){const r=n.getCurrentPageShapeIds(),i=n.getViewportPageBounds(),s=new Set;return r.forEach(o=>{GX(n,o,i)&&s.add(o)}),s}return he("getCulledShapes",n=>{if(mc(n))return e(t);const r=e(t);if(n.size!==r.size)return r;for(const i of n)if(!r.has(i))return r;return n})},YX=t=>{const e=t.query.ids("shape"),n=t.query.filterHistory("shape");function r(){const i={},s=e.get(),o=Array(s.size);return s.forEach(l=>o.push(t.get(l))),o.sort(vr),o.forEach(l=>{i[l.parentId]||(i[l.parentId]=[]),i[l.parentId].push(l.id)}),i}return he("parentsToChildrenWithIndexes",(i,s)=>{if(mc(i))return r();const o=n.getDiffSince(s);if(o===wi)return r();if(o.length===0)return i;let l=null;const u=g=>{l||(l={...i}),l[g]?l[g]===i[g]&&(l[g]=[...l[g]]):l[g]=[]},d=new Set;let f;for(let g=0,m=o.length;g<m;g++){f=o[g];for(const S of Object.values(f.added))Gu(S)&&(u(S.parentId),l[S.parentId].push(S.id),d.add(l[S.parentId]));for(const[S,b]of Object.values(f.updated))if(Gu(b)&&Gu(S)){if(S.parentId!==b.parentId)u(S.parentId),u(b.parentId),l[S.parentId].splice(l[S.parentId].indexOf(b.id),1),l[b.parentId].push(b.id),d.add(l[b.parentId]);else if(S.index!==b.index){u(b.parentId);const v=l[b.parentId].indexOf(b.id);l[b.parentId][v]=b.id,d.add(l[b.parentId])}}for(const S of Object.values(f.removed))Gu(S)&&(u(S.parentId),l[S.parentId].splice(l[S.parentId].indexOf(S.id),1))}for(const g of d){const m=We(g.map(S=>t.get(S)));m.sort(vr),g.splice(0,g.length,...m.map(S=>S.id))}return l??i})},Vw=(t,e,n)=>{for(;!Vr(n.parentId);){const r=t.get(n.parentId);if(!r)return!1;n=r}return n.parentId===e},VX=(t,e)=>{const n=t.query.ids("shape");let r=null;function i(){const s=e();return r=s,new Set([...n.get()].filter(o=>Vw(t,s,t.get(o))))}return he("_shapeIdsInCurrentPage",(s,o)=>{if(mc(s))return i();const l=e();if(l!==r)return i();const u=t.history.getDiffSince(o);if(u===wi)return i();const d=new wm(s);for(const g of u){for(const m of Object.values(g.added))Gu(m)&&Vw(t,l,m)&&d.add(m.id);for(const[m,S]of Object.values(g.updated))Gu(S)&&(Vw(t,l,S)?d.add(S.id):d.remove(S.id));for(const m of Object.keys(g.removed))Zr(m)&&d.remove(m)}const f=d.get();return f?rf(f.value,f.diff):s})};var WX=Object.create,W4=Object.defineProperty,XX=Object.getOwnPropertyDescriptor,ZX=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),X4=t=>{throw TypeError(t)},Z4=(t,e,n)=>e in t?W4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QX=t=>[,,,WX(null)],Q4=["class","method","getter","setter","accessor","field","value","get","set"],J4=t=>t!==void 0&&typeof t!="function"?X4("Function expected"):t,JX=(t,e,n,r,i)=>({kind:Q4[t],name:e,metadata:r,addInitializer:s=>n._?X4("Already initialized"):i.push(J4(s||null))}),eZ=(t,e)=>Z4(e,ZX("metadata"),t[3]),tZ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},eL=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=Q4[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,XX(i,n)),C=r.length-1;C>=0;C--)u=JX(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,J4(o)&&(w[b]=o);return w&&W4(i,n,w),i},Au=(t,e,n)=>Z4(t,typeof e!="symbol"?e+"":e,n),tL,nL,lp;const nZ=40;nL=[ni],tL=[ni];class bS{constructor(e){this.editor=e,tZ(lp,5,this),Au(this,"_clickId",""),Au(this,"_clickTimeout"),Au(this,"_clickScreenPoint"),Au(this,"_previousScreenPoint"),Au(this,"_clickState","idle"),Au(this,"lastPointerInfo",{})}_getClickTimeout(e,n=At()){this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=this.editor.timers.setTimeout(()=>{if(this._clickState===e&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},e==="idle"||e==="pendingDouble"?this.editor.options.doubleClickDurationMs:this.editor.options.multiClickDurationMs)}get clickState(){return this._clickState}handlePointerEvent(e){switch(e.name){case"pointer_down":{if(!this._clickState)return e;switch(this._clickScreenPoint=T.From(e.point),this._previousScreenPoint&&T.Dist2(this._previousScreenPoint,this._clickScreenPoint)>nZ**2&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"idle":{this._clickState="pendingDouble";break}case"pendingOverflow":{this._clickState="overflow";break}}return this._clickTimeout=this._getClickTimeout(this._clickState),e}case"pointer_up":{if(!this._clickState)return e;switch(this._clickScreenPoint=T.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"}}return e}case"pointer_move":return this._clickState!=="idle"&&this._clickScreenPoint&&T.Dist2(this._clickScreenPoint,this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?this.editor.options.coarseDragDistanceSquared:this.editor.options.dragDistanceSquared)&&this.cancelDoubleClickTimeout(),e}return e}cancelDoubleClickTimeout(){this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"}}lp=QX();eL(lp,1,"_getClickTimeout",nL,bS);eL(lp,1,"cancelDoubleClickTimeout",tL,bS);eZ(lp,bS);class rZ{constructor(e){O(this,"_isEdgeScrolling",!1);O(this,"_edgeScrollDuration",-1);this.editor=e}updateEdgeScrolling(e){const{editor:n}=this,r=this.getEdgeScroll();if(r.x===0&&r.y===0)this._isEdgeScrolling&&(this._isEdgeScrolling=!1,this._edgeScrollDuration=0);else if(this._isEdgeScrolling||(this._isEdgeScrolling=!0,this._edgeScrollDuration=0),this._edgeScrollDuration+=e,this._edgeScrollDuration>n.options.edgeScrollDelay){const i=n.options.edgeScrollEaseDuration>0?Kn.easeInCubic(Math.min(1,this._edgeScrollDuration/(n.options.edgeScrollDelay+n.options.edgeScrollEaseDuration))):1;this.moveCameraWhenCloseToEdge({x:r.x*i,y:r.y*i})}}getEdgeProximityFactors(e,n,r,i,s){const{editor:o}=this,l=o.options.edgeScrollDistance,u=r?o.options.coarsePointerWidth:0,d=e-u,f=e+u,g=i?0:l,m=s?n:n-l;return d<g?Math.min(1,(g-d)/l):f>m?-Math.min(1,(f-m)/l):0}getEdgeScroll(){const{editor:e}=this,{inputs:{currentScreenPoint:{x:n,y:r}}}=e,i=e.getViewportScreenBounds(),{isCoarsePointer:s,insets:[o,l,u,d]}=e.getInstanceState(),f=this.getEdgeProximityFactors(n,i.w,s,d,l),g=this.getEdgeProximityFactors(r,i.h,s,o,u);return{x:f,y:g}}moveCameraWhenCloseToEdge(e){const{editor:n}=this;if(!n.inputs.isDragging||n.inputs.isPanning||n.getCameraOptions().isLocked||e.x===0&&e.y===0)return;const r=n.getViewportScreenBounds(),i=r.w<1e3?.612:1,s=r.h<1e3?.612:1,o=n.getZoomLevel(),l=n.user.getEdgeScrollSpeed()*n.options.edgeScrollSpeed,u=l*e.x*i/o,d=l*e.y*s/o,{x:f,y:g,z:m}=n.getCamera();n.setCamera(new T(f+u,g+d,m))}}class iZ{constructor(e,n){O(this,"disposeSideEffectListener");this.editor=e,this.disposeSideEffectListener=e.sideEffects.registerAfterChangeHandler("instance",(i,s)=>{i.isFocused!==s.isFocused&&this.updateContainerClass()});const r=e.getInstanceState().isFocused;n!==r&&e.updateInstanceState({isFocused:!!n}),this.updateContainerClass()}updateContainerClass(){const e=this.editor.getContainer();this.editor.getInstanceState().isFocused?e.classList.add("tl-container__focused"):e.classList.remove("tl-container__focused")}focus(){this.editor.getContainer().focus()}blur(){this.editor.complete(),this.editor.getContainer().blur()}dispose(){var e;(e=this.disposeSideEffectListener)==null||e.call(this)}}function qh(t){return oZ}class sZ{constructor(){O(this,"length",0);O(this,"head",null);O(this,"tail",this)}push(e){return new M2(e,this)}toArray(){return ha}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const oZ=new sZ;class M2{constructor(e,n){O(this,"length");this.head=e,this.tail=n,this.length=n.length+1}push(e){return new M2(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(e.length){const n=e.head;return e=e.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class aZ{constructor(e){O(this,"store");O(this,"dispose");O(this,"state","recording");O(this,"pendingDiff",new cZ);O(this,"stacks",On("HistoryManager.stacks",{undos:qh(),redos:qh()},{isEqual:(e,n)=>e.undos===n.undos&&e.redos===n.redos}));O(this,"annotateError");O(this,"_isInBatch",!1);this.store=e.store,this.annotateError=e.annotateError??Tf,this.dispose=this.store.addHistoryInterceptor((n,r)=>{if(r==="user")switch(this.state){case"recording":this.pendingDiff.apply(n.changes),this.stacks.update(({undos:i})=>({undos:i,redos:qh()}));break;case"recordingPreserveRedoStack":this.pendingDiff.apply(n.changes);break;case"paused":break;default:An(this.state)}})}flushPendingDiff(){if(this.pendingDiff.isEmpty())return;const e=this.pendingDiff.clear();this.stacks.update(({undos:n,redos:r})=>({undos:n.push({type:"diff",diff:e}),redos:r}))}getNumUndos(){return this.stacks.get().undos.length+(this.pendingDiff.isEmpty()?0:1)}getNumRedos(){return this.stacks.get().redos.length}batch(e,n){const r=this.state;r!=="paused"&&(n!=null&&n.history)&&(this.state=lZ[n.history]);try{if(this._isInBatch)return uo(e),this;this._isInBatch=!0;try{uo(e)}catch(i){throw this.annotateError(i),i}finally{this._isInBatch=!1}return this}finally{this.state=r}}_undo({pushToRedoStack:e,toMark:n=void 0}){var i;const r=this.state;this.state="paused";try{let{undos:s,redos:o}=this.stacks.get();const l=this.pendingDiff.clear(),u=W5(l),d=aC(l);e&&!u&&(o=o.push({type:"diff",diff:l}));let f=!1;if(u)for(;((i=s.head)==null?void 0:i.type)==="stop";){const g=s.head;if(s=s.tail,e&&(o=o.push(g)),g.id===n){f=!0;break}}if(!f)e:for(;s.head;){const g=s.head;switch(s=s.tail,e&&(o=o.push(g)),g.type){case"diff":mf(d,[aC(g.diff)]);break;case"stop":if(!n)break e;if(g.id===n){f=!0;break e}break;default:An(g)}}if(!f&&n)return this;this.store.applyDiff(d,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:s,redos:o})}finally{this.state=r}return this}undo(){return this._undo({pushToRedoStack:!0}),this}redo(){var n;const e=this.state;this.state="paused";try{this.flushPendingDiff();let{undos:r,redos:i}=this.stacks.get();if(i.length===0)return this;for(;((n=i.head)==null?void 0:n.type)==="stop";)r=r.push(i.head),i=i.tail;const s=py();for(;i.head;){const o=i.head;if(r=r.push(o),i=i.tail,o.type==="diff")mf(s,[o.diff]);else break}this.store.applyDiff(s,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:r,redos:i})}finally{this.state=e}return this}bail(){return this._undo({pushToRedoStack:!1}),this}bailToMark(e){return this._undo({pushToRedoStack:!1,toMark:e}),this}squashToMark(e){var s;let n=this.stacks.get().undos;const r=[];for(;n.head&&!(n.head.type==="stop"&&n.head.id===e);)n.head.type==="diff"&&r.push(n.head.diff),n=n.tail;if(!n.head||((s=n.head)==null?void 0:s.id)!==e)return console.error("Could not find mark to squash to: ",e),this;if(r.length===0)return this;const i=py();return mf(i,r.reverse()),this.stacks.update(({redos:o})=>({undos:n.push({type:"diff",diff:i}),redos:o})),this}_mark(e){uo(()=>{this.flushPendingDiff(),this.stacks.update(({undos:n,redos:r})=>({undos:n.push({type:"stop",id:e}),redos:r}))})}clear(){this.stacks.set({undos:qh(),redos:qh()}),this.pendingDiff.clear()}getMarkIdMatching(e){let n=this.stacks.get().undos;for(;n.head;){if(n.head.type==="stop"&&n.head.id.includes(e))return n.head.id;n=n.tail}return null}debug(){const{undos:e,redos:n}=this.stacks.get();return{undos:e.toArray(),redos:n.toArray(),pendingDiff:this.pendingDiff.debug(),state:this.state}}}const lZ={record:"recording","record-preserveRedoStack":"recordingPreserveRedoStack",ignore:"paused"};class cZ{constructor(){O(this,"diff",py());O(this,"isEmptyAtom",On("PendingDiff.isEmpty",!0))}clear(){const e=this.diff;return this.diff=py(),this.isEmptyAtom.set(!0),e}isEmpty(){return this.isEmptyAtom.get()}apply(e){mf(this.diff,[e]),this.isEmptyAtom.set(W5(this.diff))}debug(){return{diff:this.diff,isEmpty:this.isEmpty()}}}class uZ{constructor(e){O(this,"scribbleItems",new Map);O(this,"state","paused");this.editor=e}addScribble(e,n=At()){const r={id:n,scribble:{id:n,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...e,state:"starting"},timeoutMs:0,delayRemaining:e.delay??0,prev:null,next:null};return this.scribbleItems.set(n,r),r}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear()}stop(e){const n=this.scribbleItems.get(e);if(!n)throw Error(`Scribble with id ${e} not found`);return n.delayRemaining=Math.min(n.delayRemaining,200),n.scribble.state="stopping",n}addPoint(e,n,r,i=.5){const s=this.scribbleItems.get(e);if(!s)throw Error(`Scribble with id ${e} not found`);const{prev:o}=s,l={x:n,y:r,z:i};return(!o||T.Dist(o,l)>=1)&&(s.next=l),s}tick(e){this.scribbleItems.size!==0&&this.editor.run(()=>{this.scribbleItems.forEach(n=>{if(n.scribble.state==="starting"){const{next:u,prev:d}=n;u&&u!==d&&(n.prev=u,n.scribble.points.push(u)),n.scribble.points.length>8&&(n.scribble.state="active");return}n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-e)),n.timeoutMs+=e,n.timeoutMs>=16&&(n.timeoutMs=0);const{delayRemaining:r,timeoutMs:i,prev:s,next:o,scribble:l}=n;switch(l.state){case"active":{o&&o!==s?(n.prev=o,l.points.push(o),r===0&&l.points.length>8&&l.points.shift()):i===0&&(l.points.length>1?l.points.shift():n.delayRemaining=l.delay);break}case"stopping":{if(n.delayRemaining===0&&i===0){if(l.points.length===1){this.scribbleItems.delete(n.id);return}l.shrink&&(l.size=Math.max(1,l.size*(1-l.shrink))),l.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:n})=>({...n,points:[...n.points]})).slice(-5)})})}}var dZ=Object.create,rL=Object.defineProperty,hZ=Object.getOwnPropertyDescriptor,fZ=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),iL=t=>{throw TypeError(t)},sL=(t,e,n)=>e in t?rL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pZ=t=>[,,,dZ(null)],oL=["class","method","getter","setter","accessor","field","value","get","set"],aL=t=>t!==void 0&&typeof t!="function"?iL("Function expected"):t,gZ=(t,e,n,r,i)=>({kind:oL[t],name:e,metadata:r,addInitializer:s=>n._?iL("Already initialized"):i.push(aL(s||null))}),mZ=(t,e)=>sL(e,fZ("metadata"),t[3]),yZ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},xS=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=oL[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,hZ(i,n)),C=r.length-1;C>=0;C--)u=gZ(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,aL(o)&&(w[b]=o);return w&&rL(i,n,w),i},SZ=(t,e,n)=>sL(t,e+"",n),lL,cL,uL,dL,Lc;const Fe=t=>Math.round(t*10**8)/10**8;function sa(t,e,n,r,i){const s=t.filter(l=>(r==="forward"?l.startNode.id===e:l.endNode.id===e)&&Fe(l.length)===Fe(n)&&_s(l.breadthIntersection[0],l.breadthIntersection[1],i[0],i[1]));if(s.length===0)return[];const o=new Set;return s.forEach(l=>{const u=r==="forward"?l.endNode.id:l.startNode.id;if(!o.has(u)){o.add(u);const d=sa(t,u,n,r,_s(l.breadthIntersection[0],l.breadthIntersection[1],i[0],i[1]));s.push(...d)}}),s}function vZ(t){t.sort((e,n)=>n.gaps.length-e.gaps.length);for(let e=t.length-1;e>0;e--){const n=t[e];for(let r=e-1;r>=0;r--){const i=t[r];if(i.direction===n.direction&&n.gaps.every(s=>i.gaps.some(o=>Fe(s.startEdge[0].x)===Fe(o.startEdge[0].x)&&Fe(s.startEdge[0].y)===Fe(o.startEdge[0].y)&&Fe(s.startEdge[1].x)===Fe(o.startEdge[1].x)&&Fe(s.startEdge[1].y)===Fe(o.startEdge[1].y))&&i.gaps.some(o=>Fe(s.endEdge[0].x)===Fe(o.endEdge[0].x)&&Fe(s.endEdge[0].y)===Fe(o.endEdge[0].y)&&Fe(s.endEdge[1].x)===Fe(o.endEdge[1].x)&&Fe(s.endEdge[1].y)===Fe(o.endEdge[1].y)))){t.splice(e,1);break}}}}dL=[he],uL=[he],cL=[he],lL=[he];class Pd{constructor(e){this.manager=e,yZ(Lc,5,this),SZ(this,"editor"),this.editor=e.editor}getSnapPointsCache(){const{editor:e}=this;return e.store.createComputedCache("snapPoints",n=>{const r=e.getShapePageTransform(n.id);if(!r)return;const s=e.getShapeUtil(n).getBoundsSnapGeometry(n).points??e.getShapeGeometry(n).bounds.cornersAndCenter;if(!(!r||!s))return s.map((o,l)=>{const{x:u,y:d}=be.applyToPoint(r,o);return{x:u,y:d,id:`${n.id}:${l}`}})})}getSnapPoints(e){return this.getSnapPointsCache().get(e)??[]}getSnappablePoints(){const e=this.getSnapPointsCache(),n=this.manager.getSnappableShapes(),r=[];for(const i of n){const s=e.get(i);s&&r.push(...s)}return r}getSnappableGapNodes(){return Array.from(this.manager.getSnappableShapes(),e=>({id:e,pageBounds:Qr(this.editor.getShapePageBounds(e))}))}getVisibleGaps(){const e=[],n=[];let r,i;const s=this.getSnappableGapNodes().sort((l,u)=>l.pageBounds.minX-u.pageBounds.minX);for(let l=0;l<s.length;l++){r=s[l];for(let u=l+1;u<s.length;u++)i=s[u],r.pageBounds.maxX<i.pageBounds.minX&&Bh(r.pageBounds.minY,r.pageBounds.maxY,i.pageBounds.minY,i.pageBounds.maxY)&&e.push({startNode:r,endNode:i,startEdge:[new T(r.pageBounds.maxX,r.pageBounds.minY),new T(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new T(i.pageBounds.minX,i.pageBounds.minY),new T(i.pageBounds.minX,i.pageBounds.maxY)],length:i.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:_s(r.pageBounds.minY,r.pageBounds.maxY,i.pageBounds.minY,i.pageBounds.maxY)})}const o=s.sort((l,u)=>l.pageBounds.minY-u.pageBounds.minY);for(let l=0;l<o.length;l++){r=o[l];for(let u=l+1;u<o.length;u++)i=o[u],r.pageBounds.maxY<i.pageBounds.minY&&Bh(r.pageBounds.minX,r.pageBounds.maxX,i.pageBounds.minX,i.pageBounds.maxX)&&n.push({startNode:r,endNode:i,startEdge:[new T(r.pageBounds.minX,r.pageBounds.maxY),new T(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new T(i.pageBounds.minX,i.pageBounds.minY),new T(i.pageBounds.maxX,i.pageBounds.minY)],length:i.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:_s(r.pageBounds.minX,r.pageBounds.maxX,i.pageBounds.minX,i.pageBounds.maxX)})}return{horizontal:e,vertical:n}}snapTranslateShapes({lockedAxis:e,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:i}){var w,C;const s=this.manager.getSnapThreshold(),o=this.getSnappablePoints(),l=n.clone().translate(i),u=r.map(({x:_,y:M},I)=>({id:"selection:"+I,x:_+i.x,y:M+i.y})),d=o,f=[],g=[],m=new T(s,s);this.collectPointSnaps({minOffset:m,nearestSnapsX:f,nearestSnapsY:g,otherNodeSnapPoints:d,selectionSnapPoints:u}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:g,minOffset:m});const S=new T(e==="x"?0:((w=f[0])==null?void 0:w.nudge)??0,e==="y"?0:((C=g[0])==null?void 0:C.nudge)??0);m.x=0,m.y=0,f.length=0,g.length=0,u.forEach(_=>{_.x+=S.x,_.y+=S.y}),l.translate(S),this.collectPointSnaps({minOffset:m,nearestSnapsX:f,nearestSnapsY:g,otherNodeSnapPoints:d,selectionSnapPoints:u}),this.collectGapSnaps({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:g,minOffset:m});const b=this.getPointSnapLines({nearestSnapsX:f,nearestSnapsY:g}),v=this.getGapSnapLines({selectionPageBounds:l,nearestSnapsX:f,nearestSnapsY:g});return this.manager.setIndicators([...v,...b]),{nudge:S}}snapResizeShapes({initialSelectionPageBounds:e,dragDelta:n,handle:r,isAspectRatioLocked:i,isResizingFromCenter:s}){var D,L;const o=this.manager.getSnapThreshold(),{box:l,scaleX:u,scaleY:d}=xe.Resize(e,r,s?n.x*2:n.x,s?n.y*2:n.y,i);let f=r;u<0&&(f=wV(f)),d<0&&(f=xV(f)),s&&(l.center=e.center);const g=f==="top"||f==="bottom",m=f==="left"||f==="right",S=uO(f,l),b=this.getSnappablePoints(),v=[],w=[],C=new T(o,o);this.collectPointSnaps({minOffset:C,nearestSnapsX:v,nearestSnapsY:w,otherNodeSnapPoints:b,selectionSnapPoints:S});const _=new T(g?0:((D=v[0])==null?void 0:D.nudge)??0,m?0:((L=w[0])==null?void 0:L.nudge)??0);if(i&&CV(f)&&_.len()!==0){const G=v.length&&w.length?Math.abs(_.x)<Math.abs(_.y)?"x":"y":v.length?"x":"y",k=e.aspectRatio;G==="x"?(w.length=0,_.y=_.x/k,(f==="bottom_left"||f==="top_right")&&(_.y=-_.y)):(v.length=0,_.x=_.y*k,(f==="bottom_left"||f==="top_right")&&(_.x=-_.x))}const M=T.Add(n,_),{box:I}=xe.Resize(e,r,s?M.x*2:M.x,s?M.y*2:M.y,i);s&&(I.center=e.center);const A=uO("any",I);v.length=0,w.length=0,C.x=0,C.y=0,this.collectPointSnaps({minOffset:C,nearestSnapsX:v,nearestSnapsY:w,otherNodeSnapPoints:b,selectionSnapPoints:A});const R=this.getPointSnapLines({nearestSnapsX:v,nearestSnapsY:w});return this.manager.setIndicators([...R]),{nudge:_}}collectPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:i,nearestSnapsY:s}){for(const o of e)for(const l of n){const u=T.Sub(o,l),d=Math.abs(u.x),f=Math.abs(u.y);Fe(d)<=Fe(r.x)&&(Fe(d)<Fe(r.x)&&(i.length=0),i.push({type:"points",points:{thisPoint:o,otherPoint:l},nudge:l.x-o.x}),r.x=d),Fe(f)<=Fe(r.y)&&(Fe(f)<Fe(r.y)&&(s.length=0),s.push({type:"points",points:{thisPoint:o,otherPoint:l},nudge:l.y-o.y}),r.y=f)}}collectGapSnaps({selectionPageBounds:e,minOffset:n,nearestSnapsX:r,nearestSnapsY:i}){const{horizontal:s,vertical:o}=this.getVisibleGaps();for(const l of s){if(!Bh(l.breadthIntersection[0],l.breadthIntersection[1],e.minY,e.maxY))continue;const d=l.startEdge[0].x+l.length/2-e.center.x;if(l.length>e.width&&Fe(Math.abs(d))<=Fe(n.x)){Fe(Math.abs(d))<Fe(n.x)&&(r.length=0),n.x=Math.abs(d);const C={type:"gap_center",gap:l,nudge:d},_=r.find(({type:I})=>I==="gap_center"),M=_&&_s(l.breadthIntersection[0],l.breadthIntersection[1],_.gap.breadthIntersection[0],_.gap.breadthIntersection[1]);_&&_.gap.length>l.length&&M?r[r.indexOf(_)]=C:(!_||!M)&&r.push(C)}const g=l.startNode.pageBounds.minX-l.length,m=e.maxX,S=g-m;Fe(Math.abs(S))<=Fe(n.x)&&(Fe(Math.abs(S))<Fe(n.x)&&(r.length=0),n.x=Math.abs(S),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"left",nudge:S}));const b=l.endNode.pageBounds.maxX+l.length,v=e.minX,w=b-v;Fe(Math.abs(w))<=Fe(n.x)&&(Fe(Math.abs(w))<Fe(n.x)&&(r.length=0),n.x=Math.abs(w),r.push({type:"gap_duplicate",gap:l,protrusionDirection:"right",nudge:w}))}for(const l of o){if(!Bh(l.breadthIntersection[0],l.breadthIntersection[1],e.minX,e.maxX))continue;const d=l.startEdge[0].y+l.length/2-e.center.y;if(l.length>e.height&&Fe(Math.abs(d))<=Fe(n.y)){Fe(Math.abs(d))<Fe(n.y)&&(i.length=0),n.y=Math.abs(d);const C={type:"gap_center",gap:l,nudge:d},_=i.find(({type:I})=>I==="gap_center"),M=_&&Bh(_.gap.breadthIntersection[0],_.gap.breadthIntersection[1],l.breadthIntersection[0],l.breadthIntersection[1]);_&&_.gap.length>l.length&&M?i[i.indexOf(_)]=C:(!_||!M)&&i.push(C);continue}const g=l.startNode.pageBounds.minY-l.length,m=e.maxY,S=g-m;Fe(Math.abs(S))<=Fe(n.y)&&(Fe(Math.abs(S))<Fe(n.y)&&(i.length=0),n.y=Math.abs(S),i.push({type:"gap_duplicate",gap:l,protrusionDirection:"top",nudge:S}));const b=l.endNode.pageBounds.maxY+l.length,v=e.minY,w=b-v;Fe(Math.abs(w))<=Fe(n.y)&&(Fe(Math.abs(w))<Fe(n.y)&&(i.length=0),n.y=Math.abs(w),i.push({type:"gap_duplicate",gap:l,protrusionDirection:"bottom",nudge:w}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:n}){const r={},i={};if(e.length>0){for(const s of e)if(s.type==="points"){const o=Fe(s.points.otherPoint.x);r[o]||(r[o]=[]),r[o].push(s.points)}}if(n.length>0){for(const s of n)if(s.type==="points"){const o=Fe(s.points.otherPoint.y);i[o]||(i[o]=[]),i[o].push(s.points)}}return Object.values(r).concat(Object.values(i)).map(s=>({id:At(),type:"points",points:E_(s.map(o=>T.From(o.otherPoint)).concat(s.map(o=>T.From(o.thisPoint))),(o,l)=>o.equals(l))}))}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:n,nearestSnapsY:r}){const{vertical:i,horizontal:s}=this.getVisibleGaps(),o={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},l=[];if(n.length>0)for(const u of n){if(u.type==="points")continue;const{gap:{breadthIntersection:d,startEdge:f,startNode:g,endNode:m,length:S,endEdge:b}}=u;switch(u.type){case"gap_center":{const v=(S-e.width)/2,w=_s(d[0],d[1],e.minY,e.maxY);l.push({type:"gaps",direction:"horizontal",id:At(),gaps:[...sa(s,g.id,v,"backward",w),{startEdge:f,endEdge:o.left},{startEdge:o.right,endEdge:b},...sa(s,m.id,v,"forward",w)]});break}case"gap_duplicate":{const v=_s(d[0],d[1],e.minY,e.maxY);l.push({type:"gaps",direction:"horizontal",id:At(),gaps:u.protrusionDirection==="left"?[{startEdge:o.right,endEdge:f.map(w=>w.clone().addXY(-g.pageBounds.width,0))},{startEdge:f,endEdge:b},...sa(s,m.id,S,"forward",v)]:[...sa(s,g.id,S,"backward",v),{startEdge:f,endEdge:b},{startEdge:b.map(w=>w.clone().addXY(u.gap.endNode.pageBounds.width,0)),endEdge:o.left}]});break}}}if(r.length>0)for(const u of r){if(u.type==="points")continue;const{gap:{breadthIntersection:d,startEdge:f,startNode:g,endNode:m,length:S,endEdge:b}}=u;switch(u.type){case"gap_center":{const v=(S-e.height)/2,w=_s(d[0],d[1],e.minX,e.maxX);l.push({type:"gaps",direction:"vertical",id:At(),gaps:[...sa(i,g.id,v,"backward",w),{startEdge:f,endEdge:o.top},{startEdge:o.bottom,endEdge:b},...sa(i,u.gap.endNode.id,v,"forward",w)]});break}case"gap_duplicate":{const v=_s(d[0],d[1],e.minX,e.maxX);l.push({type:"gaps",direction:"vertical",id:At(),gaps:u.protrusionDirection==="top"?[{startEdge:o.bottom,endEdge:f.map(w=>w.clone().addXY(0,-g.pageBounds.height))},{startEdge:f,endEdge:b},...sa(i,m.id,S,"forward",v)]:[...sa(i,g.id,S,"backward",v),{startEdge:f,endEdge:b},{startEdge:b.map(w=>w.clone().addXY(0,m.pageBounds.height)),endEdge:o.top}]})}break}}return vZ(l),l}}Lc=pZ();xS(Lc,1,"getSnapPointsCache",dL,Pd);xS(Lc,1,"getSnappablePoints",uL,Pd);xS(Lc,1,"getSnappableGapNodes",cL,Pd);xS(Lc,1,"getVisibleGaps",lL,Pd);mZ(Lc,Pd);function uO(t,e){const{minX:n,maxX:r,minY:i,maxY:s}=e,o=[];switch(t){case"top":case"left":case"top_left":case"any":o.push({id:"top_left",handle:"top_left",x:n,y:i})}switch(t){case"top":case"right":case"top_right":case"any":o.push({id:"top_right",handle:"top_right",x:r,y:i})}switch(t){case"bottom":case"right":case"bottom_right":case"any":o.push({id:"bottom_right",handle:"bottom_right",x:r,y:s})}switch(t){case"bottom":case"left":case"bottom_left":case"any":o.push({id:"bottom_left",handle:"bottom_left",x:n,y:s})}return o}var bZ=Object.create,hL=Object.defineProperty,xZ=Object.getOwnPropertyDescriptor,wZ=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),fL=t=>{throw TypeError(t)},pL=(t,e,n)=>e in t?hL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,CZ=t=>[,,,bZ(null)],gL=["class","method","getter","setter","accessor","field","value","get","set"],mL=t=>t!==void 0&&typeof t!="function"?fL("Function expected"):t,_Z=(t,e,n,r,i)=>({kind:gL[t],name:e,metadata:r,addInitializer:s=>n._?fL("Already initialized"):i.push(mL(s||null))}),EZ=(t,e)=>pL(e,wZ("metadata"),t[3]),PZ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},TZ=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=gL[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,xZ(i,n)),C=r.length-1;C>=0;C--)u=_Z(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,mL(o)&&(w[b]=o);return w&&hL(i,n,w),i},IZ=(t,e,n)=>pL(t,e+"",n),yL,wS;const MZ=()=>null,AZ=()=>[];yL=[he];class A2{constructor(e){this.manager=e,PZ(wS,5,this),IZ(this,"editor"),this.editor=e.editor}getSnapGeometryCache(){const{editor:e}=this;return e.store.createComputedCache("handle snap geometry",n=>{const r=e.getShapeUtil(n).getHandleSnapGeometry(n),i=r.getSelfSnapOutline?r.getSelfSnapOutline.bind(r):MZ,s=r.getSelfSnapPoints?r.getSelfSnapPoints.bind(r):AZ;return{outline:r.outline===void 0?e.getShapeGeometry(n):r.outline,points:r.points??[],getSelfSnapOutline:i,getSelfSnapPoints:s}})}*iterateSnapPointsInPageSpace(e,n){var i,s;const r=(i=this.getSnapGeometryCache().get(e))==null?void 0:i.getSelfSnapPoints(n);if(r&&r.length){const o=Qr(this.editor.getShapePageTransform(e));for(const l of r)yield o.applyToPoint(l)}for(const o of this.manager.getSnappableShapes()){if(o===e)continue;const l=(s=this.getSnapGeometryCache().get(o))==null?void 0:s.points;if(!l||!l.length)continue;const u=Qr(this.editor.getShapePageTransform(o));for(const d of l)yield u.applyToPoint(d)}}*iterateSnapOutlines(e,n){var i,s;const r=(i=this.getSnapGeometryCache().get(e))==null?void 0:i.getSelfSnapOutline(n);r&&(yield{shapeId:e,outline:r});for(const o of this.manager.getSnappableShapes()){if(o===e)continue;const l=(s=this.getSnapGeometryCache().get(o))==null?void 0:s.outline;l&&(yield{shapeId:o,outline:l})}}getHandleSnapPosition({currentShapeId:e,handle:n,handleInPageSpace:r}){const i=this.manager.getSnapThreshold();let s=i,o=null;for(const d of this.iterateSnapPointsInPageSpace(e,n))T.DistMin(r,d,s)&&(s=T.Dist(r,d),o=d);if(o)return o;let l=i,u=null;for(const{shapeId:d,outline:f}of this.iterateSnapOutlines(e,n)){const g=Qr(this.editor.getShapePageTransform(d)),m=this.editor.getPointInShapeSpace(d,r),S=f.nearestPoint(m),b=g.applyToPoint(S);T.DistMin(r,b,l)&&(l=T.Dist(r,b),u=b)}return u||null}snapHandle({currentShapeId:e,handle:n}){const i=Qr(this.editor.getShapePageTransform(e)).applyToPoint(n),s=this.getHandleSnapPosition({currentShapeId:e,handle:n,handleInPageSpace:i});return s?(this.manager.setIndicators([{id:At(),type:"points",points:[s]}]),{nudge:T.Sub(s,i)}):null}}wS=CZ();TZ(wS,1,"getSnapGeometryCache",yL,A2);EZ(wS,A2);var kZ=Object.create,SL=Object.defineProperty,RZ=Object.getOwnPropertyDescriptor,OZ=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),vL=t=>{throw TypeError(t)},bL=(t,e,n)=>e in t?SL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jZ=t=>[,,,kZ(null)],xL=["class","method","getter","setter","accessor","field","value","get","set"],wL=t=>t!==void 0&&typeof t!="function"?vL("Function expected"):t,DZ=(t,e,n,r,i)=>({kind:xL[t],name:e,metadata:r,addInitializer:s=>n._?vL("Already initialized"):i.push(wL(s||null))}),LZ=(t,e)=>bL(e,OZ("metadata"),t[3]),NZ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},k2=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=xL[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,RZ(i,n)),C=r.length-1;C>=0;C--)u=DZ(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,wL(o)&&(w[b]=o);return w&&SL(i,n,w),i},Ww=(t,e,n)=>bL(t,typeof e!="symbol"?e+"":e,n),CL,_L,EL,Td;EL=[he],_L=[he],CL=[he];class cp{constructor(e){this.editor=e,NZ(Td,5,this),Ww(this,"shapeBounds"),Ww(this,"handles"),Ww(this,"_snapIndicators",On("snapLines",void 0)),this.shapeBounds=new Pd(this),this.handles=new A2(this)}getIndicators(){return this._snapIndicators.get()??ha}clearIndicators(){this.getIndicators().length&&this._snapIndicators.set(void 0)}setIndicators(e){this._snapIndicators.set(e)}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:e}=this,n=e.getViewportPageBounds(),r=e.getSelectedShapeIds(),i=new Set,s=o=>{if(Zr(o)){const u=e.getShape(o);u&&e.isShapeOfType(u,"frame")&&i.add(o)}const l=e.getSortedChildIdsForParent(o);for(const u of l){if(r.includes(u))continue;const d=e.getShape(u);if(!d||!e.getShapeUtil(d).canSnap(d))continue;const g=e.getShapePageBounds(u);if(g&&n.includes(g)){if(e.isShapeOfType(d,"group")){s(u);continue}i.add(u)}}};return s(this.getCurrentCommonAncestor()??e.getCurrentPageId()),i}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}}Td=jZ();k2(Td,1,"getSnapThreshold",EL,cp);k2(Td,1,"getSnappableShapes",_L,cp);k2(Td,1,"getCurrentCommonAncestor",CL,cp);LZ(Td,cp);const zZ=/\r?\n|\r/g;function dO(t){return t.replace(zZ,`
`).split(`
`).map(e=>e||" ").join(`
`)}const $Z={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},BZ=/\s/;class FZ{constructor(e){O(this,"baseElem");this.editor=e,this.baseElem=document.createElement("div"),this.baseElem.classList.add("tl-text"),this.baseElem.classList.add("tl-text-measure"),this.baseElem.tabIndex=-1}measureText(e,n){const r=this.baseElem.cloneNode();this.editor.getContainer().appendChild(r),r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-style",n.fontStyle),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("font-size",n.fontSize+"px"),r.style.setProperty("line-height",n.lineHeight*n.fontSize+"px"),r.style.setProperty("max-width",n.maxWidth===null?null:n.maxWidth+"px"),r.style.setProperty("min-width",n.minWidth===null?null:n.minWidth+"px"),r.style.setProperty("padding",n.padding),r.style.setProperty("overflow-wrap",n.disableOverflowWrapBreaking?"normal":"break-word"),r.textContent=dO(e);const i=r.scrollWidth,s=r.getBoundingClientRect();return r.remove(),{x:0,y:0,w:s.width,h:s.height,scrollWidth:i}}measureElementTextNodeSpans(e,{shouldTruncateToFirstLine:n=!1}={}){const r=[],i=e.getBoundingClientRect(),s=-i.left,o=-i.top,l=new Range,u=e.childNodes[0];let d=0,f=null,g=null,m=0,S=0,b=!1;for(const v of e.childNodes)if(v.nodeType===Node.TEXT_NODE)for(const w of v.textContent??""){l.setStart(u,d),l.setEnd(u,d+w.length);const C=l.getClientRects(),_=C[C.length-1],M=_.top+o,I=_.left+s,A=_.right+s,R=I<S,D=BZ.test(w);if(D!==g||M!==m||!f){if(f){if(n&&M!==m){b=!0;break}r.push(f)}f={box:{x:I,y:M,w:_.width,h:_.height},text:w},S=I}else R&&(f.box.x=I),f.box.w=R?f.box.w+_.width:A-f.box.x,f.text+=w;w===`
`&&(S=0),g=D,m=M,d+=w.length}return f&&r.push(f),{spans:r,didTruncate:b}}measureTextSpans(e,n){if(e==="")return[];const r=this.baseElem.cloneNode();this.editor.getContainer().appendChild(r);const i=Math.ceil(n.width-n.padding*2);r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("width",`${i}px`),r.style.setProperty("height","min-content"),r.style.setProperty("font-size",`${n.fontSize}px`),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("line-height",`${n.lineHeight*n.fontSize}px`),r.style.setProperty("text-align",$Z[n.textAlign]),r.style.setProperty("font-style",n.fontStyle);const s=n.overflow==="truncate-ellipsis"||n.overflow==="truncate-clip";s&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all"));const o=dO(e);r.textContent=o;const{spans:l,didTruncate:u}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:s});if(n.overflow==="truncate-ellipsis"&&u){r.textContent="";const d=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${i-d}px`),r.textContent=o;const f=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,g=f[f.length-1];return f.push({text:"",box:{x:Math.min(g.box.x+g.box.w,n.width-n.padding-d),y:g.box.y,w:d,h:g.box.h}}),f}return r.remove(),l}}var UZ=Object.create,PL=Object.defineProperty,HZ=Object.getOwnPropertyDescriptor,KZ=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),TL=t=>{throw TypeError(t)},IL=(t,e,n)=>e in t?PL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,GZ=t=>[,,,UZ(null)],ML=["class","method","getter","setter","accessor","field","value","get","set"],AL=t=>t!==void 0&&typeof t!="function"?TL("Function expected"):t,qZ=(t,e,n,r,i)=>({kind:ML[t],name:e,metadata:r,addInitializer:s=>n._?TL("Already initialized"):i.push(AL(s||null))}),YZ=(t,e)=>IL(e,KZ("metadata"),t[3]),VZ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},kL=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=ML[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,HZ(i,n)),C=r.length-1;C>=0;C--)u=qZ(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,AL(o)&&(w[b]=o);return w&&PL(i,n,w),i},Yg=(t,e,n)=>IL(t,typeof e!="symbol"?e+"":e,n),RL,OL,up;const hO=t5;OL=[ni],RL=[ni];class CS{constructor(e){this.editor=e,VZ(up,5,this),Yg(this,"cancelRaf"),Yg(this,"isPaused",!0),Yg(this,"now",0),Yg(this,"prevPoint",new T),this.editor.disposables.add(this.dispose),this.start()}start(){var e;this.isPaused=!1,(e=this.cancelRaf)==null||e.call(this),this.cancelRaf=hO(this.tick),this.now=Date.now()}tick(){if(this.isPaused)return;const e=Date.now(),n=e-this.now;this.now=e,this.updatePointerVelocity(n),this.editor.emit("frame",n),this.editor.emit("tick",n),this.cancelRaf=hO(this.tick)}dispose(){var e;this.isPaused=!0,(e=this.cancelRaf)==null||e.call(this)}updatePointerVelocity(e){const{prevPoint:n,editor:{inputs:{currentScreenPoint:r,pointerVelocity:i}}}=this;if(e===0)return;const s=T.Sub(r,n);this.prevPoint=r.clone();const o=s.len(),l=o?s.div(o):new T(0,0),u=i.clone().lrp(l.mul(o/e),.5);Math.abs(u.x)<.01&&(u.x=0),Math.abs(u.y)<.01&&(u.y=0),i.equals(u)||(this.editor.inputs.pointerVelocity=u)}}up=GZ();kL(up,1,"tick",OL,CS);kL(up,1,"dispose",RL,CS);YZ(up,CS);var WZ=Object.create,jL=Object.defineProperty,XZ=Object.getOwnPropertyDescriptor,ZZ=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),DL=t=>{throw TypeError(t)},LL=(t,e,n)=>e in t?jL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,QZ=t=>[,,,WZ(null)],NL=["class","method","getter","setter","accessor","field","value","get","set"],zL=t=>t!==void 0&&typeof t!="function"?DL("Function expected"):t,JZ=(t,e,n,r,i)=>({kind:NL[t],name:e,metadata:r,addInitializer:s=>n._?DL("Already initialized"):i.push(zL(s||null))}),eQ=(t,e)=>LL(e,ZZ("metadata"),t[3]),tQ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},is=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=NL[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,XZ(i,n)),C=r.length-1;C>=0;C--)u=JZ(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,zL(o)&&(w[b]=o);return w&&jL(i,n,w),i},fO=(t,e,n)=>LL(t,typeof e!="symbol"?e+"":e,n),$L,BL,FL,UL,HL,KL,GL,qL,YL,VL,WL,XL,Nr;XL=[he],WL=[he],VL=[he],YL=[he],qL=[he],GL=[he],KL=[he],HL=[he],UL=[he],FL=[he],BL=[he],$L=[he];class li{constructor(e,n){if(this.user=e,this.inferDarkMode=n,tQ(Nr,5,this),fO(this,"systemColorScheme",On("systemColorScheme","light")),fO(this,"disposables",new Set),typeof window>"u"||!("matchMedia"in window))return;const r=window.matchMedia("(prefers-color-scheme: dark)");r!=null&&r.matches&&this.systemColorScheme.set("dark");const i=s=>{s.matches?this.systemColorScheme.set("dark"):this.systemColorScheme.set("light")};r==null||r.addEventListener("change",i),this.disposables.add(()=>r==null?void 0:r.removeEventListener("change",i))}dispose(){this.disposables.forEach(e=>e())}updateUserPreferences(e){this.user.setUserPreferences({...this.user.userPreferences.get(),...e})}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode(),colorScheme:this.user.userPreferences.get().colorScheme,isDarkMode:this.getIsDarkMode(),isWrapMode:this.getIsWrapMode(),isDynamicResizeMode:this.getIsDynamicResizeMode()}}getIsDarkMode(){switch(this.user.userPreferences.get().colorScheme){case"dark":return!0;case"light":return!1;case"system":return this.systemColorScheme.get()==="dark";default:return this.inferDarkMode?this.systemColorScheme.get()==="dark":!1}}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??Qs.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??Qs.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??Qs.name}getLocale(){return this.user.userPreferences.get().locale??Qs.locale}getColor(){return this.user.userPreferences.get().color??Qs.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??Qs.isSnapMode}getIsWrapMode(){return this.user.userPreferences.get().isWrapMode??Qs.isWrapMode}getIsDynamicResizeMode(){return this.user.userPreferences.get().isDynamicSizeMode??Qs.isDynamicSizeMode}getIsPasteAtCursorMode(){return this.user.userPreferences.get().isPasteAtCursorMode??Qs.isPasteAtCursorMode}}Nr=QZ();is(Nr,1,"getUserPreferences",XL,li);is(Nr,1,"getIsDarkMode",WL,li);is(Nr,1,"getEdgeScrollSpeed",VL,li);is(Nr,1,"getAnimationSpeed",YL,li);is(Nr,1,"getId",qL,li);is(Nr,1,"getName",GL,li);is(Nr,1,"getLocale",KL,li);is(Nr,1,"getColor",HL,li);is(Nr,1,"getIsSnapMode",UL,li);is(Nr,1,"getIsWrapMode",FL,li);is(Nr,1,"getIsDynamicResizeMode",BL,li);is(Nr,1,"getIsPasteAtCursorMode",$L,li);eQ(Nr,li);const nQ={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",long_press:"onLongPress",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick",tick:"onTick"},rQ=["brushing","cropping","dragging","dragging_handle","drawing","erasing","lasering","resizing","rotating","scribble_brushing","translating"];class Ae{constructor(e,n){O(this,"performanceTracker");O(this,"id");O(this,"type");O(this,"shapeType");O(this,"initial");O(this,"children");O(this,"isLockable");O(this,"parent");O(this,"_path");O(this,"_current");O(this,"_isActive");O(this,"_currentToolIdMask",On("curent tool id mask",void 0));this.editor=e;const{id:r,children:i,initial:s,isLockable:o}=this.constructor;this.id=r,this._isActive=On("toolIsActive"+this.id,!1),this._current=On("toolState"+this.id,void 0),this._path=he("toolPath"+this.id,()=>{const l=this.getCurrent();return this.id+(l?`.${l.getPath()}`:"")}),this.parent=n??{},this.parent?i&&s?(this.type="branch",this.initial=s,this.children=Object.fromEntries(i().map(l=>[l.id,new l(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",i&&s&&(this.initial=s,this.children=Object.fromEntries(i().map(l=>[l.id,new l(this.editor,this)])),this._current.set(this.children[this.initial]))),this.isLockable=o,this.performanceTracker=new OD}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}transition(e,n={}){var s;const r=e.split(".");let i=this;for(let o=0;o<r.length;o++){const l=r[o],u=i.getCurrent(),d=(s=i.children)==null?void 0:s[l];if(!d)throw Error(`${i.id} - no child state exists with the id ${l}.`);if((u==null?void 0:u.id)!==d.id&&(u==null||u.exit(n,l),i._current.set(d),d.enter(n,(u==null?void 0:u.id)||"initial"),!d.getIsActive()))break;i=d}return this}handleEvent(e){var i;const n=nQ[e.name],r=this._current.__unsafe__getWithoutCapture();(i=this[n])==null||i.call(this,e),this._isActive.__unsafe__getWithoutCapture()&&r&&r===this._current.__unsafe__getWithoutCapture()&&r.handleEvent(e)}enter(e,n){var r;if(xn.measurePerformance.get()&&rQ.includes(this.id)&&this.performanceTracker.start(this.id),this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,e,n),this.children&&this.initial&&this.getIsActive()){const i=this.children[this.initial];this._current.set(i),i.enter(e,n)}}exit(e,n){var r,i;xn.measurePerformance.get()&&this.performanceTracker.isStarted()&&this.performanceTracker.stop(),this._isActive.set(!1),(r=this.onExit)==null||r.call(this,e,n),this.getIsActive()||(i=this.getCurrent())==null||i.exit(e,n)}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(e){this._currentToolIdMask.set(e)}}O(Ae,"id"),O(Ae,"initial"),O(Ae,"children"),O(Ae,"isLockable",!0);class xC extends Ae{static children(){return[]}onKeyDown(e){var n;switch(e.code){case"KeyZ":{if(!(e.shiftKey||e.ctrlKey)){const r=this.getCurrent();r&&((n=r.getCurrent())==null?void 0:n.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...e,onInteractionEnd:r.id})}break}}}}O(xC,"id","root"),O(xC,"initial","");var iQ=Object.create,ZL=Object.defineProperty,sQ=Object.getOwnPropertyDescriptor,QL=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),JL=t=>{throw TypeError(t)},e6=(t,e,n)=>e in t?ZL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oQ=t=>[,,,iQ((t==null?void 0:t[QL("metadata")])??null)],t6=["class","method","getter","setter","accessor","field","value","get","set"],n6=t=>t!==void 0&&typeof t!="function"?JL("Function expected"):t,aQ=(t,e,n,r,i)=>({kind:t6[t],name:e,metadata:r,addInitializer:s=>n._?JL("Already initialized"):i.push(n6(s||null))}),lQ=(t,e)=>e6(e,QL("metadata"),t[3]),cQ=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},Pe=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=t6[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,sQ(i,n)),C=r.length-1;C>=0;C--)u=aQ(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,n6(o)&&(w[b]=o);return w&&ZL(i,n,w),i},Be=(t,e,n)=>e6(t,typeof e!="symbol"?e+"":e,n),r6,i6,s6,o6,a6,l6,c6,u6,d6,h6,f6,p6,g6,m6,y6,S6,v6,b6,x6,w6,C6,_6,E6,P6,T6,I6,M6,A6,k6,R6,O6,j6,D6,L6,N6,z6,$6,B6,F6,U6,H6,K6,G6,q6,Y6,V6,W6,X6,Z6,Q6,J6,eN,tN,nN,rN,iN,sN,oN,aN,lN,cN,uN,dN,hN,fN,pN,gN,mN,yN,SN,vN,bN,wC,Ee;class _e extends(wC=EW,bN=[he],vN=[he],SN=[he],yN=[he],mN=[he],gN=[he],pN=[he],fN=[he],hN=[he],dN=[he],uN=[he],cN=[he],lN=[he],aN=[he],oN=[he],sN=[he],iN=[he],rN=[he],nN=[he],tN=[he],eN=[he],J6=[he],Q6=[he],Z6=[he],X6=[he],W6=[he],V6=[he],Y6=[he],q6=[he],G6=[he],K6=[he],H6=[he],U6=[he],F6=[he],B6=[he],$6=[he],z6=[he],N6=[he],L6=[he],D6=[he],j6=[he],O6=[he],R6=[he],k6=[he],A6=[he],M6=[he],I6=[he],T6=[he],P6=[he],E6=[he],_6=[he],C6=[he],w6=[he],x6=[he],b6=[he],v6=[he],S6=[he],y6=[he],m6=[he],g6=[he],p6=[he],f6=[he],h6=[he],d6=[he],u6=[he({isEqual:(e,n)=>e.equals(n)})],c6=[he],l6=[he],a6=[he],o6=[ni],s6=[ni],i6=[ni],r6=[ni],wC){constructor({store:e,user:n,shapeUtils:r,bindingUtils:i,tools:s,getContainer:o,cameraOptions:l,initialState:u,autoFocus:d,inferDarkMode:f,options:g,isShapeHidden:m}){var G;super(),cQ(Ee,5,this),Be(this,"_isShapeHiddenPredicate"),Be(this,"options"),Be(this,"contextId",At()),Be(this,"store"),Be(this,"root"),Be(this,"disposables",new Set),Be(this,"isDisposed",!1),Be(this,"_tickManager"),Be(this,"snaps"),Be(this,"timers",vC.forContext(this.contextId)),Be(this,"user"),Be(this,"textMeasure"),Be(this,"environment",Ft),Be(this,"scribbles"),Be(this,"sideEffects"),Be(this,"edgeScrollManager"),Be(this,"focusManager"),Be(this,"getContainer"),Be(this,"shapeUtils"),Be(this,"styleProps"),Be(this,"bindingUtils"),Be(this,"history"),Be(this,"_shouldIgnoreShapeLock",!1),Be(this,"_crashingError",null),Be(this,"_isChangingStyleTimeout",-1),Be(this,"menus",Es.forContext(this.contextId)),Be(this,"_cameraOptions",On("camera options",AR)),Be(this,"_viewportAnimation",null),Be(this,"_willSetInitialBounds",!0),Be(this,"_isLockedOnFollowingUser",On("isLockedOnFollowingUser",!1)),Be(this,"_cameraState",On("camera state","idle")),Be(this,"_cameraStateTimeoutRemaining",0),Be(this,"_currentPageShapeIds"),Be(this,"_parentIdsToChildIds"),Be(this,"animatingShapes",new Map),Be(this,"externalAssetContentHandlers",{file:null,url:null}),Be(this,"temporaryAssetPreview",new Map),Be(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null,tldraw:null,excalidraw:null}),Be(this,"inputs",{originPagePoint:new T,originScreenPoint:new T,previousPagePoint:new T,previousScreenPoint:new T,currentPagePoint:new T,currentScreenPoint:new T,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,isSpacebarPanning:!1,pointerVelocity:new T}),Be(this,"_clickManager",new bS(this)),Be(this,"_prevCursor","default"),Be(this,"_shiftKeyTimeout",-1),Be(this,"_altKeyTimeout",-1),Be(this,"_ctrlKeyTimeout",-1),Be(this,"_metaKeyTimeout",-1),Be(this,"_restoreToolId","select"),Be(this,"_pinchStart",1),Be(this,"_didPinch",!1),Be(this,"_selectedShapeIdsAtPointerDown",[]),Be(this,"_longPressTimeout",-1),Be(this,"capturedPointerId",null),Be(this,"performanceTracker"),Be(this,"performanceTrackerTimeout",-1),Be(this,"_pendingEventsForNextTick",[]),this._isShapeHiddenPredicate=m,this.options={...OX,...g},this.store=e,this.disposables.add(this.store.dispose.bind(this.store)),this.history=new aZ({store:e,annotateError:k=>{this.annotateError(k,{origin:"history.batch",willCrashApp:!0}),this.crash(k)}}),this.snaps=new cp(this),this.disposables.add(this.timers.dispose),this._cameraOptions.set({...AR,...l}),this.user=new li(n??v4(),f??!1),this.disposables.add(()=>this.user.dispose()),this.getContainer=o,this.textMeasure=new FZ(this),this._tickManager=new CS(this);class S extends xC{}O(S,"initial",u??""),this.root=new S(this),this.root.children={};const b=P4(r),v={},w={},C=new Map;for(const k of b){const $=new k(this);v[k.type]=$;const F=t3(k.props??{});w[k.type]=F;for(const N of F.keys())if(!C.has(N.id))C.set(N.id,N);else if(C.get(N.id)!==N)throw Error(`Multiple style props with id "${N.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=v,this.styleProps=w;const _=_4(i),M={};for(const k of _){const $=new k(this);M[k.type]=$}this.bindingUtils=M;for(const k of[...s]){if(es(this.root.children,k.id))throw Error(`Can't override tool with id "${k.id}"`);this.root.children[k.id]=new k(this,this.root)}this.scribbles=new uZ(this);const I=(k,$)=>{let F=null;const N=k.selectedShapeIds.filter(K=>!$.has(K));N.length!==k.selectedShapeIds.length&&(F||(F={...k}),F.selectedShapeIds=N);const B=k.erasingShapeIds.filter(K=>!$.has(K));B.length!==k.erasingShapeIds.length&&(F||(F={...k}),F.erasingShapeIds=B),k.hoveredShapeId&&$.has(k.hoveredShapeId)&&(F||(F={...k}),F.hoveredShapeId=null),k.editingShapeId&&$.has(k.editingShapeId)&&(F||(F={...k}),F.editingShapeId=null);const Y=k.hintingShapeIds.filter(K=>!$.has(K));return Y.length!==k.hintingShapeIds.length&&(F||(F={...k}),F.hintingShapeIds=Y),k.focusedGroupId&&$.has(k.focusedGroupId)&&(F||(F={...k}),F.focusedGroupId=null),F};this.sideEffects=this.store.sideEffects;let A=new Map;const R=new Set,D=new Set;let L=new Set;if(this.disposables.add(this.sideEffects.registerOperationCompleteHandler(()=>{var k,$,F,N;R.clear();for(const B of D){D.delete(B);const Y=this.getShape(B);if(!Y)continue;const K=this.getShapeUtil(Y),V=(k=K.onChildrenChange)==null?void 0:k.call(K,Y);V!=null&&V.length&&this.updateShapes(V)}if(L.size){const B=L;L=new Set;for(const Y of B){const K=this.getBindingUtil(Y);($=K.onOperationComplete)==null||$.call(K)}}if(A.size){const B=A;A=new Map;for(const Y of B.values())(N=(F=this.getBindingUtil(Y.binding)).onAfterDelete)==null||N.call(F,Y)}this.emit("update")})),this.disposables.add(this.sideEffects.register({shape:{afterChange:(k,$)=>{var F,N,B,Y;for(const K of this.getBindingsInvolvingShape($))L.add(K.type),K.fromId===$.id&&((N=(F=this.getBindingUtil(K)).onAfterChangeFromShape)==null||N.call(F,{binding:K,shapeBefore:k,shapeAfter:$})),K.toId===$.id&&((Y=(B=this.getBindingUtil(K)).onAfterChangeToShape)==null||Y.call(B,{binding:K,shapeBefore:k,shapeAfter:$}));if(k.parentId!==$.parentId){const K=V=>{var ee,H,te,ge;const W=this.getShape(V);if(W)for(const de of this.getBindingsInvolvingShape(W))L.add(de.type),de.fromId===W.id&&((H=(ee=this.getBindingUtil(de)).onAfterChangeFromShape)==null||H.call(ee,{binding:de,shapeBefore:W,shapeAfter:W})),de.toId===W.id&&((ge=(te=this.getBindingUtil(de)).onAfterChangeToShape)==null||ge.call(te,{binding:de,shapeBefore:W,shapeAfter:W}))};K($.id),this.visitDescendants($.id,K)}if(k.parentId!==$.parentId&&Vr($.parentId)){const K=new Set([k.id]);this.visitDescendants(k.id,V=>{K.add(V)});for(const V of this.getPageStates()){if(V.pageId===$.parentId)continue;const W=I(V,K);W&&this.store.put([W])}}k.parentId&&Zr(k.parentId)&&D.add(k.parentId),$.parentId!==k.parentId&&Zr($.parentId)&&D.add($.parentId)},beforeDelete:k=>{var B,Y,K,V;if(R.has(k.id))return;k.parentId&&Zr(k.parentId)&&D.add(k.parentId),R.add(k.id);const $=[];for(const W of this.getBindingsInvolvingShape(k)){L.add(W.type),$.push(W.id);const ee=this.getBindingUtil(W);W.fromId===k.id?((B=ee.onBeforeIsolateToShape)==null||B.call(ee,{binding:W,removedShape:k}),(Y=ee.onBeforeDeleteFromShape)==null||Y.call(ee,{binding:W,shape:k})):((K=ee.onBeforeIsolateFromShape)==null||K.call(ee,{binding:W,removedShape:k}),(V=ee.onBeforeDeleteToShape)==null||V.call(ee,{binding:W,shape:k}))}$.length&&this.deleteBindings($);const F=new Set([k.id]),N=We(this.getPageStates().map(W=>I(W,F)));N.length&&this.store.put(N)}},binding:{beforeCreate:k=>{var F,N;const $=(N=(F=this.getBindingUtil(k)).onBeforeCreate)==null?void 0:N.call(F,{binding:k});return $||k},afterCreate:k=>{var $,F;L.add(k.type),(F=($=this.getBindingUtil(k)).onAfterCreate)==null||F.call($,{binding:k})},beforeChange:(k,$)=>{var N,B;const F=(B=(N=this.getBindingUtil($)).onBeforeChange)==null?void 0:B.call(N,{bindingBefore:k,bindingAfter:$});return F||$},afterChange:(k,$)=>{var F,N;L.add($.type),(N=(F=this.getBindingUtil($)).onAfterChange)==null||N.call(F,{bindingBefore:k,bindingAfter:$})},beforeDelete:k=>{var $,F;(F=($=this.getBindingUtil(k)).onBeforeDelete)==null||F.call($,{binding:k})},afterDelete:k=>{var $,F;(F=($=this.getBindingUtil(k)).onAfterDelete)==null||F.call($,{binding:k}),L.add(k.type)}},page:{afterCreate:k=>{const $=oo.createId(k.id),F=Is.createId(k.id);this.store.has($)||this.store.put([oo.create({id:$})]),this.store.has(F)||this.store.put([Is.create({id:F,pageId:k.id})])},afterDelete:(k,$)=>{var B,Y;if(((B=this.getInstanceState())==null?void 0:B.currentPageId)===k.id){const K=(Y=this.getPages().find(V=>V.id!==k.id))==null?void 0:Y.id;K?this.store.put([{...this.getInstanceState(),currentPageId:K}]):$==="user"&&this.store.ensureStoreIsUsable()}const F=oo.createId(k.id),N=Is.createId(k.id);this.store.remove([F,N])}},instance:{afterChange:(k,$,F)=>{var N;if(!this.store.has($.currentPageId)){const B=this.store.has(k.currentPageId)?k.currentPageId:(N=this.getPages()[0])==null?void 0:N.id;B?this.store.update($.id,Y=>({...Y,currentPageId:B})):F==="user"&&this.store.ensureStoreIsUsable()}}},instance_page_state:{afterChange:(k,$)=>{if((k==null?void 0:k.selectedShapeIds)!==($==null?void 0:$.selectedShapeIds)){const F=$.selectedShapeIds.filter(B=>{var K,V;let Y=(K=this.getShape(B))==null?void 0:K.parentId;for(;Zr(Y);){if($.selectedShapeIds.includes(Y))return!1;Y=(V=this.getShape(Y))==null?void 0:V.parentId}return!0});let N=null;if(F.length>0){const B=this.findCommonAncestor(We(F.map(Y=>this.getShape(Y))),Y=>this.isShapeOfType(Y,"group"));B&&(N=B)}else $!=null&&$.focusedGroupId&&(N=$.focusedGroupId);(F.length!==$.selectedShapeIds.length||N!==$.focusedGroupId)&&this.store.put([{...$,selectedShapeIds:F,focusedGroupId:N??null}])}}}})),this._currentPageShapeIds=VX(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=YX(this.store),this.disposables.add(this.store.listen(k=>{this.emit("change",k)})),this.disposables.add(this.history.dispose),this.run(()=>{this.store.ensureStoreIsUsable(),this._updateCurrentPageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]})},{history:"ignore"}),u&&this.root.children[u]===void 0)throw Error(`No state found for initialState "${u}".`);if(this.root.enter(void 0,"initial"),this.edgeScrollManager=new rZ(this),this.focusManager=new iZ(this,d),this.disposables.add(this.focusManager.dispose.bind(this.focusManager)),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.on("tick",this._flushEventsForTick),this.timers.requestAnimationFrame(()=>{this._tickManager.start()}),this.performanceTracker=new OD,(G=this.store.props.collaboration)!=null&&G.mode){const k=this.store.props.collaboration.mode;this.disposables.add(co("update collaboration mode",()=>{this.store.put([{...this.getInstanceState(),isReadonly:k.get()==="readonly"}])}))}}getIsShapeHiddenCache(){return this._isShapeHiddenPredicate?this.store.createComputedCache("isShapeHidden",e=>this.findShapeAncestor(e,r=>this.isShapeHidden(r))?!0:this._isShapeHiddenPredicate(e,this)??!1):null}isShapeHidden(e){return this._isShapeHiddenPredicate?!!this.getIsShapeHiddenCache().get(typeof e=="string"?e:e.id):!1}dispose(){this.disposables.forEach(e=>e()),this.disposables.clear(),this.isDisposed=!0}getShapeUtil(e){const n=typeof e=="string"?e:e.type,r=xr(this.shapeUtils,n);return xt(r,`No shape util found for type "${n}"`),r}hasShapeUtil(e){const n=typeof e=="string"?e:e.type;return es(this.shapeUtils,n)}getBindingUtil(e){const n=typeof e=="string"?e:e.type,r=xr(this.bindingUtils,n);return xt(r,`No binding util found for type "${n}"`),r}undo(){return this._flushEventsForTick(0),this.complete(),this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this._flushEventsForTick(0),this.complete(),this.history.redo(),this}clearHistory(){return this.history.clear(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(e){return console.warn(typeof e=="string"?`[tldraw] \`editor.history.mark("${e}")\` is deprecated. Please use \`const myMarkId = editor.markHistoryStoppingPoint()\` instead.`:"[tldraw] `editor.mark()` is deprecated. Use `editor.markHistoryStoppingPoint()` instead."),this.history._mark(e??At()),this}markHistoryStoppingPoint(e){const n=`[${e??"stop"}]_${At()}`;return this.history._mark(n),n}getMarkIdMatching(e){return this.history.getMarkIdMatching(e)}squashToMark(e){return this.history.squashToMark(e),this}bail(){return this.history.bail(),this}bailToMark(e){return this.history.bailToMark(e),this}run(e,n){const r=this._shouldIgnoreShapeLock;this._shouldIgnoreShapeLock=(n==null?void 0:n.ignoreShapeLock)??r;try{this.history.batch(e,n)}finally{this._shouldIgnoreShapeLock=r}return this}batch(e,n){return this.run(e,n)}annotateError(e,{origin:n,willCrashApp:r,tags:i,extras:s}){const o=this.createErrorAnnotations(n,r);return T_(e,{tags:{...o.tags,...i},extras:{...o.extras,...s}}),r&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(e,n){try{const r=this.getEditingShapeId();return{tags:{origin:e,willCrashApp:n},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes().map(i=>{const{props:s,...o}=i,{text:l,richText:u,...d}=s;return{...o,props:d}}),selectionCount:this.getSelectedShapes().length,editingShape:r?this.getShape(r):void 0,inputs:this.inputs,pageState:this.getCurrentPageState(),instanceState:this.getInstanceState(),collaboratorCount:this.getCollaboratorsOnCurrentPage().length}}}catch{return{tags:{origin:e,willCrashApp:n},extras:{}}}}getCrashingError(){return this._crashingError}crash(e){return this._crashingError=e,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:e}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(e){const n=e.split(".").reverse();let r=this.root;for(;n.length>0;){const i=n.pop();if(!i)return!0;const s=r.getCurrent();if((s==null?void 0:s.id)===i){if(n.length===0)return!0;r=s;continue}else return!1}return!1}isInAny(...e){return e.some(n=>this.isIn(n))}setCurrentTool(e,n={}){return this.root.transition(e,n),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const e=this.getCurrentTool();return e?e.getCurrentToolIdMask()??e.id:""}getStateDescendant(e){var i;const n=e.split(".").reverse();let r=this.root;for(;n.length>0;){const s=n.pop();if(!s)return r;const o=(i=r.children)==null?void 0:i[s];if(!o)return;r=o}return r}getDocumentSettings(){return this.store.get(uC)}updateDocumentSettings(e){return this.run(()=>{this.store.put([{...this.getDocumentSettings(),...e}])},{history:"ignore"}),this}getInstanceState(){return this.store.get(kr)}updateInstanceState(e,n){return this._updateInstanceState(e,{history:"ignore",...n}),e.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),e.isChangingStyle===!0&&(this._isChangingStyleTimeout=this.timers.setTimeout(()=>{this._updateInstanceState({isChangingStyle:!1},{history:"ignore"})},1e3))),this}_updateInstanceState(e,n){this.run(()=>{this.store.put([{...this.getInstanceState(),...e}])},n)}getOpenMenus(){return this.menus.getOpenMenus()}addOpenMenu(e){return this.menus.addOpenMenu(e),this}deleteOpenMenu(e){return this.menus.deleteOpenMenu(e),this}clearOpenMenus(){return this.menus.clearOpenMenus(),this}getIsMenuOpen(){return this.menus.hasAnyOpenMenus()}setCursor(e){return this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...e}}),this}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return Is.createId(this.getCurrentPageId())}updateCurrentPageState(e){return this._updateCurrentPageState(e),this}_updateCurrentPageState(e){this.store.update(e.id??this.getCurrentPageState().id,n=>({...n,...e}))}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:e}=this.getCurrentPageState();return We(e.map(n=>this.store.get(n)))}setSelectedShapes(e){return this.run(()=>{const n=e.map(s=>typeof s=="string"?s:s.id),{selectedShapeIds:r}=this.getCurrentPageState(),i=new Set(r);if(n.length===i.size&&n.every(s=>i.has(s)))return null;this.store.put([{...this.getCurrentPageState(),selectedShapeIds:n}])},{history:"record-preserveRedoStack"})}isAncestorSelected(e){const n=typeof e=="string"?e:(e==null?void 0:e.id)??null,r=this.getShape(n);if(!r)return!1;const i=this.getSelectedShapeIds();return!!this.findShapeAncestor(r,s=>i.includes(s.id))}select(...e){const n=typeof e[0]=="string"?e:e.map(r=>r.id);return this.setSelectedShapes(n),this}deselect(...e){const n=typeof e[0]=="string"?e:e.map(i=>i.id),r=this.getSelectedShapeIds();return r.length>0&&n.length>0&&this.setSelectedShapes(r.filter(i=>!n.includes(i))),this}selectAll(){const e=this.getSortedChildIdsForParent(this.getCurrentPageId());return e.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(e)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShapeId(){var e;return((e=this.getOnlySelectedShape())==null?void 0:e.id)??null}getOnlySelectedShape(){const e=this.getSelectedShapes();return e.length===1?e[0]:null}getShapesPageBounds(e){const n=We(e.map(r=>this.getShapePageBounds(r)));return n.length===0?null:xe.Common(n)}getSelectionPageBounds(){return this.getShapesPageBounds(this.getSelectedShapeIds())}getShapesSharedRotation(e){let n=!1,r=0;for(let i=0,s=e.length;i<s;i++){const o=this.getShapePageTransform(e[i]);if(o)if(n){if(o.rotation()!==r)return 0}else n=!0,r=o.rotation()}return r}getSelectionRotation(){return this.getShapesSharedRotation(this.getSelectedShapeIds())}getShapesRotatedPageBounds(e){if(e.length===0)return;const n=this.getShapesSharedRotation(e);if(n===0)return this.getShapesPageBounds(e)??void 0;if(e.length===1){const i=this.getShapeGeometry(e[0]).bounds.clone(),s=this.getShapePageTransform(e[0]);return i.point=s.applyToPoint(i.point),i}const r=xe.FromPoints(e.flatMap(i=>{const s=this.getShapePageTransform(i);return s?s.applyToPoints(this.getShapeGeometry(i).bounds.corners):[]}).map(i=>i.rot(-n)));return r.point=r.point.rot(n),r}getSelectionRotatedPageBounds(){return this.getShapesRotatedPageBounds(this.getSelectedShapeIds())}getSelectionRotatedScreenBounds(){const e=this.getSelectionRotatedPageBounds();if(!e)return;const{x:n,y:r}=this.pageToScreen(e.point),i=this.getZoomLevel();return new xe(n,r,e.width*i,e.height*i)}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const e=this.getFocusedGroupId();return e?this.getShape(e):void 0}setFocusedGroup(e){const n=typeof e=="string"?e:(e==null?void 0:e.id)??null;if(n!==null){const r=this.getShape(n);if(!r)throw Error(`Editor.setFocusedGroup: Shape with id ${n} does not exist`);if(!this.isShapeOfType(r,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${r.type}`)}return n===this.getFocusedGroupId()?this:this.run(()=>{this.store.update(this.getCurrentPageState().id,r=>({...r,focusedGroupId:n}))},{history:"record-preserveRedoStack"})}popFocusedGroupId(){const e=this.getFocusedGroup();if(e){const n=this.findShapeAncestor(e,r=>this.isShapeOfType(r,"group"));this.setFocusedGroup((n==null?void 0:n.id)??null),this.select(e.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const e=this.getEditingShapeId();return e?this.getShape(e):void 0}setEditingShape(e){const n=typeof e=="string"?e:(e==null?void 0:e.id)??null;if(n!==this.getEditingShapeId()){if(n){const r=this.getShape(n);if(r&&this.getShapeUtil(r).canEdit(r))return this.run(()=>{this._updateCurrentPageState({editingShapeId:n})},{history:"ignore"}),this}this.run(()=>{this._updateCurrentPageState({editingShapeId:null})},{history:"ignore"})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const e=this.getHoveredShapeId();return e?this.getShape(e):void 0}setHoveredShape(e){const n=typeof e=="string"?e:(e==null?void 0:e.id)??null;return n===this.getHoveredShapeId()?this:(this.run(()=>{this.updateCurrentPageState({hoveredShapeId:n})},{history:"ignore"}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const e=this.getHintingShapeIds();return We(e.map(n=>this.getShape(n)))}setHintingShapes(e){const n=typeof e[0]=="string"?e:e.map(r=>r.id);return this.run(()=>{this._updateCurrentPageState({hintingShapeIds:E_(n)})},{history:"ignore"}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const e=this.getErasingShapeIds();return We(e.map(n=>this.getShape(n)))}setErasingShapes(e){const n=typeof e[0]=="string"?e:e.map(i=>i.id);n.sort();const r=this.getErasingShapeIds();return this.run(()=>{if(n.length===r.length){for(let i=0;i<n.length;i++)if(n[i]!==r[i]){this._updateCurrentPageState({erasingShapeIds:n});break}}else this._updateCurrentPageState({erasingShapeIds:n})},{history:"ignore"}),this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(e){const n=typeof e=="string"?e:(e==null?void 0:e.id)??null;return n!==this.getCroppingShapeId()&&this.run(()=>{if(!n)this.updateCurrentPageState({croppingShapeId:null});else{const r=this.getShape(n),i=this.getShapeUtil(r);r&&i.canCrop(r)&&this.updateCurrentPageState({croppingShapeId:n})}},{history:"ignore"}),this}_unsafe_getCameraId(){return oo.createId(this.getCurrentPageId())}getCamera(){const e=this.store.get(this._unsafe_getCameraId());if(this._isLockedOnFollowingUser.get()){const n=this.getCameraForFollowing();if(n)return{...e,...n}}return e}getViewportPageBoundsForFollowing(){const e=this.getInstanceState().followingUserId;if(!e)return null;const n=this.getCollaborators().find(g=>g.userId===e);if(!n||!n.camera||!n.screenBounds)return null;const{w:r,h:i}=n.screenBounds,{x:s,y:o,z:l}=n.camera,u=new xe(-s,-o,r/l,i/l),d=this.getViewportScreenBounds().clone(),f=d.width/d.height;return d.width=u.width,d.height=d.width/f,d.height<u.height&&(d.height=u.height,d.width=d.height*f),d.center=u.center,d}getCameraForFollowing(){const e=this.getViewportPageBoundsForFollowing();return e?{x:-e.x,y:-e.y,z:this.getViewportScreenBounds().w/e.width}:null}getZoomLevel(){return this.getCamera().z}getInitialZoom(){const e=this.getCameraOptions();if(!e.constraints||e.constraints.initialZoom==="default")return 1;const{zx:n,zy:r}=gO(this,e);switch(e.constraints.initialZoom){case"fit-min":return Math.max(n,r);case"fit-max":return Math.min(n,r);case"fit-x":return n;case"fit-y":return r;case"fit-min-100":return Math.min(1,Math.max(n,r));case"fit-max-100":return Math.min(1,Math.min(n,r));case"fit-x-100":return Math.min(1,n);case"fit-y-100":return Math.min(1,r);default:throw An(e.constraints.initialZoom)}}getBaseZoom(){const e=this.getCameraOptions();if(!e.constraints||e.constraints.baseZoom==="default")return 1;const{zx:n,zy:r}=gO(this,e);switch(e.constraints.baseZoom){case"fit-min":return Math.max(n,r);case"fit-max":return Math.min(n,r);case"fit-x":return n;case"fit-y":return r;case"fit-min-100":return Math.min(1,Math.max(n,r));case"fit-max-100":return Math.min(1,Math.min(n,r));case"fit-x-100":return Math.min(1,n);case"fit-y-100":return Math.min(1,r);default:throw An(e.constraints.baseZoom)}}getCameraOptions(){return this._cameraOptions.get()}setCameraOptions(e){var r;const n=Xt({...this._cameraOptions.__unsafe__getWithoutCapture(),...e});return((r=n.zoomSteps)==null?void 0:r.length)<1&&(n.zoomSteps=[1]),this._cameraOptions.set(n),this.setCamera(this.getCamera()),this}getConstrainedCamera(e,n){const r=this.getCamera();let{x:i,y:s,z:o=r.z}=e;if(!(n!=null&&n.force)){const l=this.getCameraOptions(),u=l.zoomSteps[0],d=Qn(l.zoomSteps),f=this.getViewportScreenBounds();if(l.constraints){const{constraints:g}=l,m=Math.min(g.padding.y,f.w/2),S=Math.min(g.padding.x,f.h/2),b=xe.From(l.constraints.bounds),v=(f.w-S*2)/b.w,w=(f.h-m*2)/b.h,C=this.getBaseZoom(),_=d*C,M=u*C;if(n!=null&&n.reset&&(o=this.getInitialZoom()),o<M||o>_){const{x:F,y:N,z:B}=r,Y=-F+f.w/B/2,K=-N+f.h/B/2;o=Xn(o,M,_);const V=-F+f.w/o/2,W=-N+f.h/o/2;i=F+V-Y,s=N+W-K}const I=S/o-b.x,A=m/o-b.y,R=(f.w-S*2)/o-b.w,D=(f.h-m*2)/o-b.h,L=I+R*g.origin.x,G=A+D*g.origin.y,k=typeof g.behavior=="string"?g.behavior:g.behavior.x,$=typeof g.behavior=="string"?g.behavior:g.behavior.y;if(n!=null&&n.reset)i=L,s=G;else{switch(k){case"fixed":{i=L;break}case"contain":{o<v?i=L:i=Xn(i,I+R,I);break}case"inside":{o<v?i=Xn(i,I,(f.w-S)/o-b.w):i=Xn(i,I+R,I);break}case"outside":{i=Xn(i,S/o-b.w,(f.w-S)/o);break}case"free":break;default:throw An(k)}switch($){case"fixed":{s=G;break}case"contain":{o<w?s=G:s=Xn(s,A+D,A);break}case"inside":{o<w?s=Xn(s,A,(f.h-m)/o-b.h):s=Xn(s,A+D,A);break}case"outside":{s=Xn(s,m/o-b.h,(f.h-m)/o);break}case"free":break;default:throw An($)}}}else if(o>d||o<u){const{x:g,y:m,z:S}=r;o=Xn(o,u,d),i=g+(-g+f.w/o/2)-(-g+f.w/S/2),s=m+(-m+f.h/o/2)-(-m+f.h/S/2)}}return{x:i,y:s,z:o}}_setCamera(e,n){const r=this.getCamera(),{x:i,y:s,z:o}=this.getConstrainedCamera(e,n);return r.x===i&&r.y===s&&r.z===o?this:(uo(()=>{const l={...r,x:i,y:s,z:o};this.run(()=>{this.store.put([l])},{history:"ignore"});const{currentScreenPoint:u,currentPagePoint:d}=this.inputs,{screenBounds:f}=this.store.unsafeGetWithoutCapture(kr);if(u.x/o-i!==d.x||u.y/o-s!==d.y){const g={type:"pointer",target:"canvas",name:"pointer_move",point:T.AddXY(u,f.x,f.y),pointerId:kR.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,metaKey:this.inputs.metaKey,accelKey:br(this.inputs),button:0,isPen:this.getInstanceState().isPenMode??!1};n!=null&&n.immediate?this._flushEventForTick(g):this.dispatch(g)}this._tickCameraState()}),this)}setCamera(e,n){const{isLocked:r}=this._cameraOptions.__unsafe__getWithoutCapture();if(r&&!(n!=null&&n.force))return this;this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser();const i=T.Cast(e);Number.isFinite(i.x)||(i.x=0),Number.isFinite(i.y)||(i.y=0),(i.z===void 0||!Number.isFinite(i.z))&&(e.z=this.getZoomLevel());const s=this.getConstrainedCamera(i,n);if(n!=null&&n.animation){const{width:o,height:l}=this.getViewportScreenBounds();this._animateToViewport(new xe(-s.x,-s.y,o/s.z,l/s.z),n)}else this._setCamera(s,{...n,force:!0});return this}centerOnPoint(e,n){const{isLocked:r}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;const{width:i,height:s}=this.getViewportPageBounds();return this.setCamera(new T(-(e.x-i/2),-(e.y-s/2),this.getCamera().z),n),this}zoomToFit(e){const n=[...this.getCurrentPageShapeIds()];if(n.length<=0)return this;const r=xe.Common(We(n.map(i=>this.getShapePageBounds(i))));return this.zoomToBounds(r,e),this}resetZoom(e=this.getViewportScreenCenter(),n){const{isLocked:r,constraints:i}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;const s=this.getCamera(),{x:o,y:l,z:u}=s,{x:d,y:f}=e;let g=1;if(i){const m=this.getInitialZoom();u!==m&&(g=m)}return this.setCamera(new T(o+(d/g-d)-(d/u-d),l+(f/g-f)-(f/u-f),g),n),this}zoomIn(e=this.getViewportScreenCenter(),n){const{isLocked:r}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;const{x:i,y:s,z:o}=this.getCamera(),{zoomSteps:l}=this.getCameraOptions();if(l!==null&&l.length>1){const u=this.getBaseZoom();let d=Qn(l)*u;for(let f=1;f<l.length;f++){const g=l[f-1]*u,m=l[f]*u;if(!(m-o<=(m-g)/2)){d=m;break}}this.setCamera(new T(i+(e.x/d-e.x)-(e.x/o-e.x),s+(e.y/d-e.y)-(e.y/o-e.y),d),n)}return this}zoomOut(e=this.getViewportScreenCenter(),n){const{isLocked:r}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;const{zoomSteps:i}=this.getCameraOptions();if(i!==null&&i.length>1){const s=this.getBaseZoom(),{x:o,y:l,z:u}=this.getCamera();let d=i[0]*s;for(let f=i.length-1;f>0;f--){const g=i[f-1]*s,m=i[f]*s;if(!(m-u>=(m-g)/2)){d=g;break}}this.setCamera(new T(o+(e.x/d-e.x)-(e.x/u-e.x),l+(e.y/d-e.y)-(e.y/u-e.y),d),n)}return this}zoomToSelection(e){const{isLocked:n}=this.getCameraOptions();if(n&&!(e!=null&&e.force))return this;const r=this.getSelectionPageBounds();return r&&this.zoomToBounds(r,{targetZoom:Math.max(1,this.getZoomLevel()),...e}),this}zoomToBounds(e,n){const r=this._cameraOptions.__unsafe__getWithoutCapture();if(r.isLocked&&!(n!=null&&n.force))return this;const i=this.getViewportScreenBounds(),s=(n==null?void 0:n.inset)??Math.min(sY,i.width*.28),o=this.getBaseZoom(),l=r.zoomSteps[0],u=Qn(r.zoomSteps);let d=Xn(Math.min((i.width-s)/e.w,(i.height-s)/e.h),l*o,u*o);return(n==null?void 0:n.targetZoom)!==void 0&&(d=Math.min(n.targetZoom,d)),this.setCamera(new T(-e.x+(i.width-e.w*d)/2/d,-e.y+(i.height-e.h*d)/2/d,d),n),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(e){if(!this._viewportAnimation)return;this._viewportAnimation.elapsed+=e;const{elapsed:n,easing:r,duration:i,start:s,end:o}=this._viewportAnimation;if(n>i){this.off("tick",this._animateViewport),this._viewportAnimation=null,this._setCamera(new T(-o.x,-o.y,this.getViewportScreenBounds().width/o.width));return}const l=i-n,u=r(1-l/i),d=s.minX+(o.minX-s.minX)*u,f=s.minY+(o.minY-s.minY)*u,g=s.maxX+(o.maxX-s.maxX)*u;this._setCamera(new T(-d,-f,this.getViewportScreenBounds().width/(g-d)),{force:!0})}_animateToViewport(e,n={animation:Dw}){const{animation:r,...i}=n;if(!r)return;const{duration:s=0,easing:o=Kn.easeInOutCubic}=r,l=this.user.getAnimationSpeed(),u=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),s===0||l===0?this._setCamera(new T(-e.x,-e.y,this.getViewportScreenBounds().width/e.width),{...i}):(this._viewportAnimation={elapsed:0,duration:s/l,easing:o,start:u.clone(),end:e.clone()},this.once("stop-camera-animation",()=>{this.off("tick",this._animateViewport),this._viewportAnimation=null}),this.on("tick",this._animateViewport),this)}slideCamera(e={}){const{isLocked:n}=this.getCameraOptions();if(n&&!(e!=null&&e.force))return this;if(this.user.getAnimationSpeed()===0)return this;this.stopCameraAnimation();const{speed:i,friction:s=this.options.cameraSlideFriction,direction:o,speedThreshold:l=.01}=e;let u=Math.min(i,1);const d=()=>{this.off("tick",f),this.off("stop-camera-animation",d)};this.once("stop-camera-animation",d);const f=g=>{const{x:m,y:S,z:b}=this.getCamera(),v=T.Mul(o,u*g/b);u*=1-s,u<l?d():this._setCamera(new T(m+v.x,S+v.y,b))};return this.on("tick",f),this}zoomToUser(e,n={animation:{duration:500}}){const r=this.getCollaborators().find(s=>s.userId===e);if(!r)return this;const i=r.cursor;return i?(this.run(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const s=r.currentPageId===this.getCurrentPageId();s||this.setCurrentPage(r.currentPageId),n&&n.animation&&!s&&(n.animation=void 0),this.centerOnPoint(i,n);const{highlightedUserIds:o}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...o,e]}),this.timers.setTimeout(()=>{const l=[...this.getInstanceState().highlightedUserIds],u=l.indexOf(e);u<0||(l.splice(u,1),this.updateInstanceState({highlightedUserIds:l}))},this.options.collaboratorIdleTimeoutMs)}),this):this}updateViewportScreenBounds(e,n=!1){if(e instanceof HTMLElement){const l=e.getBoundingClientRect();e=new xe(l.left||l.x,l.top||l.y,Math.max(l.width,1),Math.max(l.height,1))}else e.width=Math.max(e.width,1),e.height=Math.max(e.height,1);const r=[e.minY!==0,!gl(document.body.scrollWidth,e.maxX,1),!gl(document.body.scrollHeight,e.maxY,1),e.minX!==0],{_willSetInitialBounds:i}=this;this._willSetInitialBounds=!1;const{screenBounds:s,insets:o}=this.getInstanceState();if(e.equals(s)&&r.every((l,u)=>l===o[u]))return this;if(i)this.updateInstanceState({screenBounds:e.toJson(),insets:r}),this.setCamera(this.getCamera());else if(n&&!this.getInstanceState().followingUserId){const l=this.getViewportPageBounds().center;this.updateInstanceState({screenBounds:e.toJson(),insets:r}),this.centerOnPoint(l)}else this.updateInstanceState({screenBounds:e.toJson(),insets:r}),this._setCamera(T.From({...this.getCamera()}));return this._tickCameraState(),this}getViewportScreenBounds(){const{x:e,y:n,w:r,h:i}=this.getInstanceState().screenBounds;return new xe(e,n,r,i)}getViewportScreenCenter(){const e=this.getViewportScreenBounds();return new T(e.midX-e.minX,e.midY-e.minY)}getViewportPageBounds(){const{w:e,h:n}=this.getViewportScreenBounds(),{x:r,y:i,z:s}=this.getCamera();return new xe(-r,-i,e/s,n/s)}screenToPage(e){const{screenBounds:n}=this.store.unsafeGetWithoutCapture(kr),{x:r,y:i,z:s=1}=this.getCamera();return new T((e.x-n.x)/s-r,(e.y-n.y)/s-i,e.z??.5)}pageToScreen(e){const{screenBounds:n}=this.store.unsafeGetWithoutCapture(kr),{x:r,y:i,z:s=1}=this.getCamera();return new T((e.x+r)*s+n.x,(e.y+i)*s+n.y,e.z??.5)}pageToViewport(e){const{x:n,y:r,z:i=1}=this.getCamera();return new T((e.x+n)*i,(e.y+r)*i,e.z??.5)}_getCollaboratorsQuery(){return this.store.query.records("instance_presence",()=>({userId:{neq:this.user.getId()}}))}getCollaborators(){const e=this._getCollaboratorsQuery().get();return e.length?[...new Set(e.map(r=>r.userId))].sort().map(r=>nH(e.filter(s=>s.userId===r),s=>s.lastActivityTimestamp??0)):ha}getCollaboratorsOnCurrentPage(){const e=this.getCurrentPageId();return this.getCollaborators().filter(n=>n.currentPageId===e)}startFollowingUser(e){this.stopFollowingUser();const n=this._getCollaboratorsQuery().get().filter(s=>s.userId===e);if(!n.length)return console.warn("User not found"),this;const r=this.user.getId();if(r||console.warn("You should set the userId for the current instance before following a user"),n.some(s=>s.followingUserId===r))return this;const i=he("latestLeaderPresence",()=>this.getCollaborators().find(s=>s.userId===e));return uo(()=>{this.updateInstanceState({followingUserId:e},{history:"ignore"});const s=co("update current page",()=>{const u=i.get();if(!u){this.stopFollowingUser();return}u.currentPageId!==this.getCurrentPageId()&&this.getPage(u.currentPageId)&&this.run(()=>{this.store.put([{...this.getInstanceState(),currentPageId:u.currentPageId}]),this._isLockedOnFollowingUser.set(!0)},{history:"ignore"})}),o=()=>{s(),this._isLockedOnFollowingUser.set(!1),this.off("frame",l),this.off("stop-following",o)},l=()=>{if(!i.get()){this.stopFollowingUser();return}if(this._isLockedOnFollowingUser.get())return;const d=this.user.getAnimationSpeed();if(d===0){this._isLockedOnFollowingUser.set(!0);return}const f=this.getViewportPageBoundsForFollowing();if(!f){this.stopFollowingUser();return}const g=this.getViewportPageBounds(),m=Math.abs(f.minX-g.minX)+Math.abs(f.maxX-g.maxX),S=Math.abs(f.minY-g.minY)+Math.abs(f.maxY-g.maxY);if(m<this.options.followChaseViewportSnap&&S<this.options.followChaseViewportSnap){this._isLockedOnFollowingUser.set(!0);return}const b=Xn(d*.5,.1,.8),v=new xe(ct(g.minX,f.minX,b),ct(g.minY,f.minY,b),ct(g.width,f.width,b),ct(g.height,f.height,b)),w=new T(-v.x,-v.y,this.getViewportScreenBounds().width/v.width);this.stopCameraAnimation(),this._setCamera(w)};this.once("stop-following",o),this.addListener("frame",l),l()}),this}stopFollowingUser(){return this.run(()=>{this.store.put([this.getCamera()]),this._isLockedOnFollowingUser.set(!1),this.updateInstanceState({followingUserId:null}),this.emit("stop-following")},{history:"ignore"}),this}getUnorderedRenderingShapes(e){const n=[];let r=this.options.maxShapesPerPage*2,i=this.options.maxShapesPerPage;const s=this.getErasingShapeIds(),o=(u,d,f)=>{const g=this.getShape(u);if(!g||this.isShapeHidden(g))return;d*=g.opacity;let m=!1;const S=this.getShapeUtil(g);e&&(m=!f&&s.includes(u),m&&(d*=.32)),n.push({id:u,shape:g,util:S,index:r,backgroundIndex:i,opacity:d}),r+=1,i+=1;const b=this.getSortedChildIdsForParent(u);if(!b.length)return;let v=null;S.providesBackgroundForChildren(g)&&(v=i,i=r,r+=this.options.maxShapesPerPage);for(const w of b)o(w,d,f||m);v!==null&&(i=v)},l=e?[this.getCurrentPage()]:this.getPages();for(const u of l)for(const d of this.getSortedChildIdsForParent(u.id))o(d,1,!1);return n}_decayCameraStateTimeout(e){this._cameraStateTimeoutRemaining-=e,!(this._cameraStateTimeoutRemaining>0)&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"))}_tickCameraState(){this._cameraStateTimeoutRemaining=this.options.cameraMovingTimeoutMs,this._cameraState.__unsafe__getWithoutCapture()==="idle"&&(this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout))}getCameraState(){return this._cameraState.get()}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(OH)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return Array.from(this._getAllPagesQuery().get()).sort(vr)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(e){return this.store.get(typeof e=="string"?e:e.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getCurrentPageShapeIdsSorted(){return Array.from(this.getCurrentPageShapeIds()).sort()}getPageShapeIds(e){const n=typeof e=="string"?e:e.id,r=this.store.query.exec("shape",{parentId:{eq:n}});return this.getShapeAndDescendantIds(r.map(i=>i.id))}setCurrentPage(e){const n=typeof e=="string"?e:e.id;return this.store.has(n)?(this.stopFollowingUser(),this.complete(),this.run(()=>{this.store.put([{...this.getInstanceState(),currentPageId:n}]),this.setCamera(this.getCamera())},{history:"record-preserveRedoStack"})):(console.error("Tried to set the current page id to a page that doesn't exist."),this)}updatePage(e){return this.getIsReadonly()?this:this.getPage(e.id)?this.run(()=>this.store.update(e.id,r=>({...r,...e}))):this}createPage(e){return this.run(()=>{if(this.getIsReadonly()||this.getPages().length>=this.options.maxPages)return;const n=this.getPages(),r=$X(e.name??"Page 1",n.map(o=>o.name));let i=e.index;(!i||n.some(o=>o.index===i))&&(i=so(n[n.length-1].index));const s=Ai.create({meta:{},...e,name:r,index:i});this.store.put([s])}),this}deletePage(e){const n=typeof e=="string"?e:e.id;return this.run(()=>{if(this.getIsReadonly())return;const r=this.getPages();if(r.length===1)return;const i=this.getPage(n);if(i){if(n===this.getCurrentPageId()){const s=r.findIndex(l=>l.id===n),o=r[s-1]??r[s+1];this.setCurrentPage(o.id)}this.store.remove([i.id])}}),this}duplicatePage(e,n=Ai.createId()){if(this.getPages().length>=this.options.maxPages)return this;const r=typeof e=="string"?e:e.id,i=this.getPage(r);if(!i)return this;const s={...this.getCamera()},o=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(i.id));return this.run(()=>{var d;const l=this.getPages(),u=Mf(i.index,(d=l[l.indexOf(i)+1])==null?void 0:d.index);if(this.createPage({name:i.name+" Copy",id:n,index:u}),this.setCurrentPage(n),this.setCamera(s),o)return this.putContentOntoCurrentPage(o)}),this}renamePage(e,n){const r=typeof e=="string"?e:e.id;return this.getIsReadonly()?this:(this.updatePage({id:r,name:n}),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(e){return this.getIsReadonly()?this:e.length<=0?this:(this.run(()=>this.store.put(e),{history:"ignore"}),this)}updateAssets(e){return this.getIsReadonly()?this:e.length<=0?this:(this.run(()=>{this.store.put(e.map(n=>({...this.store.get(n.id),...n})))},{history:"ignore"}),this)}deleteAssets(e){if(this.getIsReadonly())return this;const n=typeof e[0]=="string"?e:e.map(r=>r.id);return n.length<=0?this:(this.run(()=>this.store.remove(n),{history:"ignore"}),this)}getAsset(e){return this.store.get(typeof e=="string"?e:e.id)}async resolveAssetUrl(e,n){if(!e)return null;const r=this.getAsset(e);if(!r)return null;const{screenScale:i=1,shouldResolveToOriginal:s=!1,dpr:o=this.getInstanceState().devicePixelRatio}=n,u=(f=>Math.pow(2,Math.ceil(Math.log2(f))))(i),d="connection"in navigator?navigator.connection.effectiveType:null;return await this.store.props.assets.resolve(r,{screenScale:i||1,steppedScreenScale:u,dpr:o,networkEffectiveType:d,shouldResolveToOriginal:s})}async uploadAsset(e,n,r){return await this.store.props.assets.upload(e,n,r)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",e=>this.getShapeUtil(e).getGeometry(e),(e,n)=>e.props===n.props)}getShapeGeometry(e){return this._getShapeGeometryCache().get(typeof e=="string"?e:e.id)}_getShapeHandlesCache(){return this.store.createComputedCache("handles",e=>{var n,r;return(r=(n=this.getShapeUtil(e)).getHandles)==null?void 0:r.call(n,e)})}getShapeHandles(e){return this._getShapeHandlesCache().get(typeof e=="string"?e:e.id)}getShapeLocalTransform(e){const n=typeof e=="string"?e:e.id,r=this.getShape(n);if(!r)throw Error("Editor.getTransform: shape not found");return be.Identity().translate(r.x,r.y).rotate(r.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",e=>{if(Vr(e.parentId))return this.getShapeLocalTransform(e);const n=this._getShapePageTransformCache().get(e.parentId)??be.Identity();return be.Compose(n,this.getShapeLocalTransform(e))})}getShapeParentTransform(e){const n=typeof e=="string"?e:e.id,r=this.getShape(n);return!r||Vr(r.parentId)?be.Identity():this._getShapePageTransformCache().get(r.parentId)??be.Identity()}getShapePageTransform(e){const n=typeof e=="string"?e:e.id;return this._getShapePageTransformCache().get(n)??be.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",e=>{const n=this._getShapePageTransformCache().get(e.id);return n?xe.FromPoints(be.applyToPoints(n,this.getShapeGeometry(e).vertices)):new xe})}getShapePageBounds(e){return this._getShapePageBoundsCache().get(typeof e=="string"?e:e.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",e=>{const n=this._getShapeMaskCache().get(e.id);if(!n)return;if(n.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const r=this._getShapePageTransformCache().get(e.id);return r?`polygon(${be.applyToPoints(be.Inverse(r),n).map(s=>`${s.x}px ${s.y}px`).join(",")})`:void 0})}getShapeClipPath(e){return this._getShapeClipPathCache().get(typeof e=="string"?e:e.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",e=>{if(Vr(e.parentId))return;const n=this.getShapeAncestors(e.id).filter(i=>this.isShapeOfType(i,"frame"));return n.length===0?void 0:n.map(i=>this._getShapePageTransformCache().get(i.id).applyToPoints(this.getShapeGeometry(i).vertices)).reduce((i,s)=>{if(!(s&&i))return;const o=QR(i,s);return o?o.map(T.Cast):[]})})}getShapeMask(e){return this._getShapeMaskCache().get(typeof e=="string"?e:e.id)}getShapeMaskedPageBounds(e){return typeof e!="string"&&(e=e.id),this._getShapeMaskedPageBoundsCache().get(e)}_getShapeMaskedPageBoundsCache(){return this.store.createComputedCache("shapeMaskedPageBoundsCache",e=>{const n=this._getShapePageBoundsCache().get(e.id);if(!n)return;const r=this._getShapeMaskCache().get(e.id);if(r){if(r.length===0)return;const{corners:i}=n;if(i.every((o,l)=>o&&T.Equals(o,r[l])))return n.clone();const s=QR(r,i);return s?xe.FromPoints(s):void 0}return n})}getShapeAncestors(e,n=[]){const r=typeof e=="string"?e:e.id,i=this.getShape(r);if(!i)return n;const s=i.parentId;if(Vr(s))return n.reverse(),n;const o=this.store.get(s);return o?(n.push(o),this.getShapeAncestors(o,n)):n}findShapeAncestor(e,n){const r=typeof e=="string"?e:e.id,i=this.getShape(r);if(!i)return;const s=i.parentId;if(Vr(s))return;const o=this.getShape(s);if(o)return n(o)?o:this.findShapeAncestor(o,n)}hasAncestor(e,n){const r=typeof e=="string"?e:e==null?void 0:e.id,i=r&&this.getShape(r);return i?i.parentId===n?!0:this.hasAncestor(this.getShapeParent(i),n):!1}findCommonAncestor(e,n){var u;if(e.length===0)return;const r=typeof e[0]=="string"?e:e.map(d=>d.id),i=We(r.map(d=>this.getShape(d)));if(i.length===1){const d=i[0].parentId;return Vr(d)?void 0:n?(u=this.findShapeAncestor(i[0],n))==null?void 0:u.id:d}const[s,...o]=i;let l=this.getShapeParent(s);for(;l;){if(n&&!n(l)){l=this.getShapeParent(l);continue}if(o.every(d=>this.hasAncestor(d,l.id)))return l.id;l=this.getShapeParent(l)}}isShapeOrAncestorLocked(e){const n=typeof e=="string"?this.getShape(e):e;return n===void 0?!1:n.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(n))}_notVisibleShapes(){return qX(this)}getCulledShapes(){const e=this._notVisibleShapes().get(),n=this.getSelectedShapeIds(),r=this.getEditingShapeId(),i=new Set(e);return r&&i.delete(r),n.forEach(s=>{i.delete(s)}),i}getCurrentPageBounds(){let e;return this.getCurrentPageShapeIdsSorted().forEach(n=>{const r=this.getShapeMaskedPageBounds(n);r&&(e?e=e.expand(r):e=r.clone())}),e}getSelectedShapeAtPoint(e){const n=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(r=>r.type!=="group"&&n.includes(r.id)).reverse().find(r=>this.isPointInShape(r,e,{hitInside:!0,margin:0}))}getShapeAtPoint(e,n={}){const r=this.getZoomLevel(),i=this.getViewportPageBounds(),{filter:s,margin:o=0,hitLocked:l=!1,hitLabels:u=!1,hitInside:d=!1,hitFrameInside:f=!1}=n;let g=1/0,m=null,S=1/0,b=null;const v=(n.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(w=>{if(w.isLocked&&!l||this.isShapeHidden(w)||this.isShapeOfType(w,"group"))return!1;const C=this.getShapeMask(w);return C&&!Ci(e,C)?!1:s?s(w):!0});for(let w=v.length-1;w>=0;w--){const C=v[w],_=this.getShapeGeometry(C),M=_ instanceof ns,I=this.getPointInShapeSpace(C,e);if(this.isShapeOfType(C,"frame")||(this.isShapeOfType(C,"arrow")||this.isShapeOfType(C,"geo")&&C.props.fill==="none")&&C.props.text.trim()){for(const R of _.children)if(R.isLabel&&R.isPointInBounds(I))return C}if(this.isShapeOfType(C,"frame")){const R=_.distanceToPoint(I,d);if(Math.abs(R)<=o)return b||C;if(_.hitTestPoint(I,0,!0))return b||m||(f?C:void 0);continue}let A;if(M){let R=1/0;for(const D of _.children){if(D.isLabel&&!u)continue;const L=D.distanceToPoint(I,d);L<R&&(R=L)}A=R}else o===0&&(_.bounds.w<1||_.bounds.h<1)||_.bounds.containsPoint(I,o)?A=_.distanceToPoint(I,d):A=1/0;if(_.isClosed){if(A<=o){if(_.isFilled||M&&_.children[0].isFilled)return b||C;if(this.getShapePageBounds(C).contains(i))continue;if(Math.abs(A)<o)Math.abs(A)<S&&(S=Math.abs(A),b=C);else if(!b){const{area:R}=_;R<g&&(g=R,m=C)}}}else if(A<this.options.hitTestMargin/r)return C}return b||m||void 0}getShapesAtPoint(e,n={}){return this.getCurrentPageShapes().filter(r=>!this.isShapeHidden(r)&&this.isPointInShape(r,e,n))}isPointInShape(e,n,r={}){const{hitInside:i=!1,margin:s=0}=r,o=typeof e=="string"?e:e.id,l=this.getShapeMask(o);return l&&!Ci(n,l)?!1:this.getShapeGeometry(o).hitTestPoint(this.getPointInShapeSpace(e,n),s,i)}getPointInShapeSpace(e,n){const r=typeof e=="string"?e:e.id;return this._getShapePageTransformCache().get(r).clone().invert().applyToPoint(n)}getPointInParentSpace(e,n){const r=typeof e=="string"?e:e.id,i=this.getShape(r);if(!i)return new T(0,0);if(Vr(i.parentId))return T.From(n);const s=this.getShapePageTransform(i.parentId);return s?s.clone().invert().applyToPoint(n):T.From(n)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),e=>this.store.get(e))}getCurrentPageShapesSorted(){const e=[],n=this.getSortedChildIdsForParent(this.getCurrentPageId());for(let r=0,i=n.length;r<i;r++)xN(this,n[r],e);return e}getCurrentPageRenderingShapesSorted(){const e=this.getCulledShapes();return this.getCurrentPageShapesSorted().filter(({id:n})=>!e.has(n)&&!this.isShapeHidden(n))}isShapeOfType(e,n){const r=typeof e=="string"?this.getShape(e):e;return r?r.type===n:!1}getShape(e){const n=typeof e=="string"?e:e.id;if(Zr(n))return this.store.get(n)}getShapeParent(e){const n=typeof e=="string"?e:e==null?void 0:e.id;if(!n)return;const r=this.getShape(n);if(!(r===void 0||!Zr(r.parentId)))return this.store.get(r.parentId)}getShapeNearestSibling(e,n){return n?n.parentId===e.parentId?n:this.findShapeAncestor(n,i=>i.parentId===e.parentId):void 0}isShapeInPage(e,n=this.getCurrentPageId()){const r=typeof e=="string"?e:e.id,i=this.getShape(r);if(!i)return!1;let s=!1;if(i.parentId===n)s=!0;else{let o=this.getShape(i.parentId);e:for(;o;){if(o.parentId===n){s=!0;break e}o=this.getShape(o.parentId)}}return s}getAncestorPageId(e){const n=typeof e=="string"?e:e==null?void 0:e.id,r=n&&this.getShape(n);if(r)return Vr(r.parentId)?r.parentId:this.getAncestorPageId(this.getShape(r.parentId))}reparentShapes(e,n,r){const i=typeof e[0]=="string"?e:e.map(m=>m.id);if(i.length===0)return this;const s=[],o=Vr(n)?be.Identity():this.getShapePageTransform(n),l=o.rotation();let u=[];const d=We(this.getSortedChildIdsForParent(n).map(m=>this.getShape(m)));if(r){const m=d.find(S=>S.index===r);if(m){const S=d[d.indexOf(m)+1];S?u=od(r,S.index,i.length):u=kb(r,i.length)}else{const S=d.sort(vr).find(b=>b.index>r);S?u=od(r,S.index,i.length):u=kb(r,i.length)}}else{const m=d.length&&d[d.length-1];u=m?kb(m.index,i.length):Af(i.length)}const f=o.clone().invert(),g=We(i.map(m=>this.getShape(m)));return this.run(()=>{for(let m=0;m<g.length;m++){const S=g[m],b=this.getShapePageTransform(S);if(!b)continue;const v=b.point();if(!v)continue;const w=f.applyToPoint(v),C=b.rotation()-l;s.push({id:S.id,type:S.type,parentId:n,x:w.x,y:w.y,rotation:C,index:u[m]})}this.updateShapes(s)},{ignoreShapeLock:!0}),this}getHighestIndexForParent(e){const n=typeof e=="string"?e:e.id,r=this._parentIdsToChildIds.get()[n];if(!r||r.length===0)return"a1";const i=this.getShape(r[r.length-1]);return so(i.index)}getSortedChildIdsForParent(e){const n=typeof e=="string"?e:e.id,r=this._parentIdsToChildIds.get()[n];return r||ha}visitDescendants(e,n){const r=typeof e=="string"?e:e.id,i=this.getSortedChildIdsForParent(r);for(const s of i)n(s)!==!1&&this.visitDescendants(s,n);return this}getShapeAndDescendantIds(e){const n=new Set;for(const r of e.map(i=>this.getShape(i)).sort(vr))n.add(r.id),this.visitDescendants(r,i=>{n.add(i)});return n}getDroppingOverShape(e,n=[]){const r=this.getCurrentPageShapesSorted();for(let i=r.length-1;i>=0;i--){const s=r[i];if(this.isShapeHidden(s)||this.getSelectedShapeIds().includes(s.id)||!this.getShapeUtil(s).canDropShapes(s,n)||n.find(l=>l.id===s.id||this.hasAncestor(s,l.id)))continue;const o=this.getShapeMaskedPageBounds(s.id);if(o&&o.containsPoint(e)&&this.getShapeGeometry(s).hitTestPoint(this.getPointInShapeSpace(s,e),0,!0))return s}}getOutermostSelectableShape(e,n){const r=typeof e=="string"?e:e.id,i=this.getShape(r);let s=i,o=i;const l=this.getFocusedGroup();for(;o;){if(this.isShapeOfType(o,"group")&&(l==null?void 0:l.id)!==o.id&&!this.hasAncestor(l,o.id)&&((n==null?void 0:n(o))??!0))s=o;else if((l==null?void 0:l.id)===o.id)break;o=this.getShapeParent(o)}return s}_getBindingsIndexCache(){const e=KX(this);return this.store.createComputedCache("bindingsIndex",n=>e.get().get(n.id))}getBinding(e){return this.store.get(e)}getBindingsFromShape(e,n){const r=typeof e=="string"?e:e.id;return this.getBindingsInvolvingShape(r).filter(i=>i.fromId===r&&i.type===n)}getBindingsToShape(e,n){const r=typeof e=="string"?e:e.id;return this.getBindingsInvolvingShape(r).filter(i=>i.toId===r&&i.type===n)}getBindingsInvolvingShape(e,n){const r=typeof e=="string"?e:e.id,i=this._getBindingsIndexCache().get(r)??ha;return n?i.filter(s=>s.type===n):i}createBindings(e){const n=[];for(const r of e){const i=this.getShape(r.fromId),s=this.getShape(r.toId);if(!i||!s||!this.canBindShapes({fromShape:i,toShape:s,binding:r}))continue;const l=this.getBindingUtil(r.type).getDefaultProps(),u=this.store.schema.types.binding.create({...r,id:r.id??Sc(),props:{...l,...r.props}});n.push(u)}return this.store.put(n),this}createBinding(e){return this.createBindings([e])}updateBindings(e){const n=[];for(const r of e){if(!r)continue;const i=this.getBinding(r.id);if(!i)continue;const s=Ws(i,r);if(s===i)continue;const o=this.getShape(s.fromId),l=this.getShape(s.toId);!o||!l||this.canBindShapes({fromShape:o,toShape:l,binding:s})&&n.push(s)}return this.store.put(n),this}updateBinding(e){return this.updateBindings([e])}deleteBindings(e,{isolateShapes:n=!1}={}){const r=e.map(i=>typeof i=="string"?i:i.id);return n?this.store.atomic(()=>{var i,s;for(const o of r){const l=this.getBinding(o);if(!l)continue;const u=this.getBindingUtil(l);(i=u.onBeforeIsolateFromShape)==null||i.call(u,{binding:l,removedShape:this.getShape(l.toId)}),(s=u.onBeforeIsolateToShape)==null||s.call(u,{binding:l,removedShape:this.getShape(l.fromId)}),this.store.remove([o])}}):this.store.remove(r),this}deleteBinding(e,n){return this.deleteBindings([e],n)}canBindShapes({fromShape:e,toShape:n,binding:r}){const i=typeof e=="string"?e:e.type,s=typeof n=="string"?n:n.type,o=typeof r=="string"?r:r.type,l={fromShapeType:i,toShapeType:s,bindingType:o};return i===s?this.getShapeUtil(i).canBind(l):this.getShapeUtil(i).canBind(l)&&this.getShapeUtil(s).canBind(l)}rotateShapesBy(e,n,r){const i=typeof e[0]=="string"?e:e.map(o=>o.id);if(i.length<=0)return this;const s=V4({editor:this,ids:i});return s?(Pm({delta:n,snapshot:s,editor:this,stage:"one-off",centerOverride:r==null?void 0:r.center}),this):this}getChangesToTranslateShape(e,n){var s,o,l;let r=e;const i=this.getShapeUtil(e);return r=Ws(r,((s=i.onTranslateStart)==null?void 0:s.call(i,r))??void 0),r=Ws(r,{id:e.id,type:e.type,x:n.x,y:n.y}),r=Ws(r,((o=i.onTranslate)==null?void 0:o.call(i,e,r))??void 0),r=Ws(r,((l=i.onTranslateEnd)==null?void 0:l.call(i,e,r))??void 0),r}nudgeShapes(e,n){const r=typeof e[0]=="string"?e:e.map(s=>s.id);if(r.length<=0)return this;const i=[];for(const s of r){const o=this.getShape(s),l=T.From(n),u=this.getShapeParentTransform(o);u&&l.rot(-u.rotation()),i.push(this.getChangesToTranslateShape(o,l.add(o)))}return this.updateShapes(i),this}duplicateShapes(e,n){return this.run(()=>{const r=typeof e[0]=="string"?e:e.map(m=>m.id);if(r.length<=0)return this;const i=new Set(r),s=this.getShapeAndDescendantIds(r),o=[...s].reverse(),l=new Map;for(const m of s)l.set(m,Lt());const{shapesToCreateWithOriginals:u,bindingsToCreate:d}=pO(this,s,m=>{const S=[];for(const v of m){const w=this.getBinding(v);if(!w)continue;const C=Sc();S.push({...w,id:C,fromId:Qr(l.get(w.fromId)),toId:Qr(l.get(w.toId))})}const b=[];for(const v of o){const w=Qr(l.get(v)),C=this.getShape(v);if(!C)continue;let _=0,M=0;if(n&&i.has(v)){const I=this.getShapeParentTransform(C),A=new T(n.x,n.y).rot(-I.rotation());_=A.x,M=A.y}b.push({shape:{...C,id:w,x:C.x+_,y:C.y+M,index:"a1",parentId:l.get(C.parentId)??C.parentId},originalShape:C})}return{shapesToCreateWithOriginals:b,bindingsToCreate:S}});u.forEach(({shape:m,originalShape:S})=>{const b=S.parentId,v=this.getSortedChildIdsForParent(b),w=v.indexOf(S.id),C=v[w+1],_=C?this.getShape(C):void 0,M=Mf(S.index,_==null?void 0:_.index);m.index=M});const f=u.map(({shape:m})=>m);if(f.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage){Vg(this);return}if(this.createShapes(f),this.createBindings(d),this.setSelectedShapes(We(r.map(m=>l.get(m)))),n!==void 0){const m=this.getSelectionPageBounds(),S=this.getViewportPageBounds();m&&!S.contains(m)&&this.centerOnPoint(m.center,{animation:{duration:this.options.animationMediumMs}})}}),this}moveShapesToPage(e,n){const r=typeof e[0]=="string"?e:e.map(l=>l.id);if(r.length===0)return this;if(this.getIsReadonly())return this;const i=this.getCurrentPageId();if(n===i)return this;if(!this.store.has(n))return this;const s=this.getContentFromCurrentPage(r);if(!s)return this;if(this.getPageShapeIds(n).size+s.shapes.length>this.options.maxShapesPerPage)return Vg(this,n),this;const o=this.getCamera().z;return this.run(()=>{this.deleteShapes(r),this.setCurrentPage(n),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(s,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:o}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(e){const n=typeof e[0]=="string"?e:e.map(o=>o.id);if(this.getIsReadonly()||n.length===0)return this;let r=!0,i=!0;const s=[];for(const o of n){const l=this.getShape(o);l&&(s.push(l),l.isLocked?i=!1:r=!1)}return this.run(()=>{i?(this.updateShapes(s.map(o=>({id:o.id,type:o.type,isLocked:!0}))),this.setSelectedShapes([])):r?this.updateShapes(s.map(o=>({id:o.id,type:o.type,isLocked:!1}))):this.updateShapes(s.map(o=>({id:o.id,type:o.type,isLocked:!0})))}),this}sendToBack(e){const n=typeof e[0]=="string"?e:e.map(i=>i.id),r=qg(this,"toBack",n,{considerAllShapes:!0});return r&&this.updateShapes(r),this}sendBackward(e,n={}){const r=typeof e[0]=="string"?e:e.map(s=>s.id),i=qg(this,"backward",r,n);return i&&this.updateShapes(i),this}bringForward(e,n={}){const r=typeof e[0]=="string"?e:e.map(s=>s.id),i=qg(this,"forward",r,n);return i&&this.updateShapes(i),this}bringToFront(e){const n=typeof e[0]=="string"?e:e.map(i=>i.id),r=qg(this,"toFront",n);return r&&this.updateShapes(r),this}flipShapes(e,n){const r=typeof e[0]=="string"?e:e.map(o=>o.id);if(this.getIsReadonly())return this;let i=We(r.map(o=>this.getShape(o)));if(!i.length)return this;i=We(i.map(o=>this.isShapeOfType(o,"group")?this.getSortedChildIdsForParent(o.id).map(l=>this.getShape(l)):o).flat());const s=xe.Common(We(i.map(o=>this.getShapePageBounds(o)))).center;return this.run(()=>{for(const o of i){const l=this.getShapeGeometry(o).bounds,u=this.getShapePageTransform(o.id);u&&this.resizeShape(o.id,{x:n==="horizontal"?-1:1,y:n==="vertical"?-1:1},{initialBounds:l,initialPageTransform:u,initialShape:o,mode:"scale_shape",isAspectRatioLocked:this.getShapeUtil(o).isAspectRatioLocked(o),scaleOrigin:s,scaleAxisRotation:0})}}),this}stackShapes(e,n,r){const i=typeof e[0]=="string"?e:e.map(v=>v.id);if(this.getIsReadonly())return this;const s=i.map(v=>this.getShape(v)).filter(v=>v?this.getShapeUtil(v).canBeLaidOut(v):!1),o=s.length;if(r===0&&o<3||o<2)return this;const l=Object.fromEntries(s.map(v=>[v.id,this.getShapePageBounds(v)]));let u,d,f,g;n==="horizontal"?(u="x",d="minX",f="maxX",g="width"):(u="y",d="minY",f="maxY",g="height");let m;if(r===0){const v=[];s.sort((C,_)=>l[C.id][d]-l[_.id][d]);for(let C=0;C<o-1;C++){const _=s[C],M=s[C+1],I=l[_.id],R=l[M.id][d]-I[f],D=v.find(L=>L.gap===R);D?D.count++:v.push({gap:R,count:1})}let w=0;v.forEach(C=>{C.count>w&&(w=C.count,m=C.gap)}),w===1&&(m=Math.max(0,v.reduce((C,_)=>C+_.gap*_.count,0)/(o-1)))}else m=r;const S=[];let b=l[s[0].id][f];return s.forEach((v,w)=>{var A,R;if(w===0)return;const C={x:0,y:0};C[u]=b+m-l[v.id][u];const _=this.getShapeParent(v),M=_?T.Rot(C,-this.getShapePageTransform(_).decompose().rotation):C,I=(R=(A=this.getShapeUtil(v)).onTranslateStart)==null?void 0:R.call(A,v);S.push(I?{...I,[u]:v[u]+M[u]}:{id:v.id,type:v.type,[u]:v[u]+M[u]}),b+=l[v.id][g]+m}),this.updateShapes(S),this}packShapes(e,n){var R,D;const r=typeof e[0]=="string"?e:e.map(L=>L.id);if(this.getIsReadonly())return this;if(r.length<2)return this;const i=r.map(L=>this.getShape(L)).filter(L=>L?this.getShapeUtil(L).canBeLaidOut(L):!1),s={},o={};let l,u,d=0;for(let L=0;L<i.length;L++)l=i[L],u=this.getShapePageBounds(l),s[l.id]=u,o[l.id]=u.clone(),d+=u.width*u.height;const f=xe.Common(We(Object.values(s))),g=f.width;i.sort((L,G)=>s[G.id].height-s[L.id].height);const m=Math.max(Math.ceil(Math.sqrt(d/.95)),g),S=[new xe(f.x,f.y,m,1/0)];let b=0,v=0,w,C;for(let L=0;L<i.length;L++){l=i[L],u=o[l.id];for(let G=S.length-1;G>=0;G--)if(w=S[G],!(u.width>w.width||u.height>w.height)){u.x=w.x,u.y=w.y,v=Math.max(v,u.maxY),b=Math.max(b,u.maxX),u.width===w.width&&u.height===w.height?(C=S.pop(),G<S.length&&(S[G]=C)):u.height===w.height?(w.x+=u.width+n,w.width-=u.width+n):u.width===w.width?(w.y+=u.height+n,w.height-=u.height+n):(S.push(new xe(w.x+(u.width+n),w.y,w.width-(u.width+n),u.height)),w.y+=u.height+n,w.height-=u.height+n);break}}const _=xe.Common(Object.values(o)),M=T.Sub(f.center,_.center);let I;const A=[];for(let L=0;L<i.length;L++){l=i[L],u=s[l.id],I=o[l.id];const G=T.Sub(I.point,u.point).add(M),k=this.getShapeParentTransform(l);k&&G.rot(-k.rotation());const $={id:l.id,type:l.type,x:l.x+G.x,y:l.y+G.y},F=(D=(R=this.getShapeUtil(l)).onTranslateStart)==null?void 0:D.call(R,{...l,...$});F?A.push({...$,...F}):A.push($)}return A.length&&this.updateShapes(A),this}alignShapes(e,n){const r=typeof e[0]=="string"?e:e.map(u=>u.id);if(this.getIsReadonly())return this;if(r.length<2)return this;const i=We(r.map(u=>this.getShape(u))),s=Object.fromEntries(i.map(u=>[u.id,this.getShapePageBounds(u)])),o=xe.Common(We(Object.values(s))),l=[];return i.forEach(u=>{const d=s[u.id];if(!d)return;const f={x:0,y:0};switch(n){case"top":{f.y=o.minY-d.minY;break}case"center-vertical":{f.y=o.midY-d.minY-d.height/2;break}case"bottom":{f.y=o.maxY-d.minY-d.height;break}case"left":{f.x=o.minX-d.minX;break}case"center-horizontal":{f.x=o.midX-d.minX-d.width/2;break}case"right":{f.x=o.maxX-d.minX-d.width;break}}const g=this.getShapeParent(u),m=g?T.Rot(f,-this.getShapePageTransform(g).decompose().rotation):f;l.push(this.getChangesToTranslateShape(u,T.Add(u,m)))}),this.updateShapes(l),this}distributeShapes(e,n){const r=typeof e[0]=="string"?e:e.map(_=>_.id);if(this.getIsReadonly())return this;if(r.length<3)return this;const i=r.length,s=We(r.map(_=>this.getShape(_))),o=Object.fromEntries(s.map(_=>[_.id,this.getShapePageBounds(_)]));let l,u,d,f,g;n==="horizontal"?(l="x",u="minX",d="maxX",f="midX",g="width"):(l="y",u="minY",d="maxY",f="midY",g="height");const m=[],S=s.sort((_,M)=>o[_.id][u]-o[M.id][u])[0],b=s.sort((_,M)=>o[M.id][d]-o[_.id][d])[0],v=o[S.id][f],w=(o[b.id][f]-v)/(i-1),C=v+w;return s.filter(_=>_!==S&&_!==b).sort((_,M)=>o[_.id][f]-o[M.id][f]).forEach((_,M)=>{const I={x:0,y:0};I[l]=C+w*M-o[_.id][g]/2-o[_.id][l];const A=this.getShapeParent(_),R=A?T.Rot(I,-this.getShapePageTransform(A).rotation()):I;m.push(this.getChangesToTranslateShape(_,T.Add(_,R)))}),this.updateShapes(m),this}stretchShapes(e,n){const r=typeof e[0]=="string"?e:e.map(u=>u.id);if(this.getIsReadonly())return this;if(r.length<2)return this;const i=We(r.map(u=>this.getShape(u))),s=Object.fromEntries(r.map(u=>[u,this.getShapeGeometry(u).bounds])),o=Object.fromEntries(r.map(u=>[u,this.getShapePageBounds(u)])),l=xe.Common(We(Object.values(o)));switch(n){case"vertical":{this.run(()=>{for(const u of i){if(this.getShapePageTransform(u).rotation()%It)continue;const f=s[u.id],g=o[u.id],m=new T(0,l.minY-g.minY),S=this.getShapeParentTransform(u);S&&m.rot(-S.rotation());const{x:b,y:v}=T.Add(m,u);this.updateShapes([{id:u.id,type:u.type,x:b,y:v}]);const w=new T(1,l.height/g.height);this.resizeShape(u.id,w,{initialBounds:f,scaleOrigin:new T(g.center.x,l.minY),isAspectRatioLocked:this.getShapeUtil(u).isAspectRatioLocked(u),scaleAxisRotation:0})}});break}case"horizontal":{this.run(()=>{for(const u of i){const d=s[u.id],f=o[u.id];if(this.getShapePageTransform(u).rotation()%It)continue;const m=new T(l.minX-f.minX,0),S=this.getShapeParentTransform(u);S&&m.rot(-S.rotation());const{x:b,y:v}=T.Add(m,u);this.updateShapes([{id:u.id,type:u.type,x:b,y:v}]);const w=new T(l.width/f.width,1);this.resizeShape(u.id,w,{initialBounds:d,scaleOrigin:new T(l.minX,f.center.y),isAspectRatioLocked:this.getShapeUtil(u).isAspectRatioLocked(u),scaleAxisRotation:0})}});break}}return this}resizeShape(e,n,r={}){var b,v,w;const i=typeof e=="string"?e:e.id;if(this.getIsReadonly())return this;Number.isFinite(n.x)||(n=new T(1,n.y)),Number.isFinite(n.y)||(n=new T(n.x,1));const s=r.initialShape??this.getShape(i);if(!s)return this;const o=r.scaleOrigin??((b=this.getShapePageBounds(i))==null?void 0:b.center);if(!o)return this;const l=r.initialPageTransform?be.Cast(r.initialPageTransform):this.getShapePageTransform(i);if(!l)return this;const u=l.rotation();if(u==null)return this;const d=r.scaleAxisRotation??u,f=r.initialBounds??this.getShapeGeometry(i).bounds;if(!f)return this;const g=r.isAspectRatioLocked??this.getShapeUtil(s).isAspectRatioLocked(s);if(!F5(u,d))return this._resizeUnalignedShape(i,n,{...r,initialBounds:f,scaleOrigin:o,scaleAxisRotation:d,initialPageTransform:l,isAspectRatioLocked:g,initialShape:s});const m=this.getShapeUtil(s);g&&(Math.abs(n.x)>Math.abs(n.y)?n=new T(n.x,Math.sign(n.y)*Math.abs(n.x)):n=new T(Math.sign(n.x)*Math.abs(n.y),n.y));let S=!1;if(m.onResize&&m.canResize(s)){const C=this._scalePagePoint(be.applyToPoint(l,new T(0,0)),o,n,d),_=this.getPointInParentSpace(s.id,C),M=new T(n.x,n.y),I=gl((u-d)%Math.PI,0);M.x=I?n.x:n.y,M.y=I?n.y:n.x;const A=be.applyToPoint(l,new T),{x:R,y:D}=this.getPointInParentSpace(s.id,A);let L=s;r.skipStartAndEndCallbacks||(L=Ws(s,((v=m.onResizeStart)==null?void 0:v.call(m,s))??void 0));const G=m.onResize({...s,x:R,y:D},{newPoint:_,handle:r.dragHandle??"bottom_right",mode:r.mode??"scale_shape",scaleX:M.x,scaleY:M.y,initialBounds:f,initialShape:s});G&&(S=!0),L=Ws(L,{id:i,type:s.type,x:_.x,y:_.y,...G}),r.skipStartAndEndCallbacks||(L=Ws(L,((w=m.onResizeEnd)==null?void 0:w.call(m,s,L))??void 0)),this.updateShapes([L])}if(!S){const C=be.applyToPoint(l,f.center),_=this._scalePagePoint(C,o,n,d),M=this.getPointInParentSpace(s.id,C),I=this.getPointInParentSpace(s.id,_),A=T.Sub(I,M);this.updateShapes([{id:i,type:s.type,x:s.x+A.x,y:s.y+A.y}])}return this}_scalePagePoint(e,n,r,i){const s=T.RotWith(e,n,-i).sub(n),o=T.MulV(s,r);return T.Add(o,n).rotWith(n,i)}_resizeUnalignedShape(e,n,r){const{type:i}=r.initialShape,s=new T(n.x,n.y);if(Math.abs(n.x)>Math.abs(n.y)?s.x=Math.sign(n.x)*Math.abs(n.y):s.y=Math.sign(n.y)*Math.abs(n.x),this.resizeShape(e,s,{initialShape:r.initialShape,initialBounds:r.initialBounds,isAspectRatioLocked:r.isAspectRatioLocked}),Math.sign(n.x)*Math.sign(n.y)<0){let{rotation:w}=be.Decompose(r.initialPageTransform);w-=2*w,this.updateShapes([{id:e,type:i,rotation:w}])}const o=be.applyToPoint(r.initialPageTransform,r.initialBounds.center),l=this._scalePagePoint(o,r.scaleOrigin,n,r.scaleAxisRotation),u=this.getShapePageBounds(e),d=this.getShapePageTransform(e),f=u.center,g=d.point();if(!f||!g)return this;const m=T.Sub(l,f),S=T.Add(g,m),{x:b,y:v}=this.getPointInParentSpace(e,S);return this.updateShapes([{id:e,type:i,x:b,y:v}]),this}getInitialMetaForShape(e){return{}}createShape(e){return this.createShapes([e]),this}createShapes(e){if(!Array.isArray(e))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");if(this.getIsReadonly())return this;if(e.length<=0)return this;const n=this.getCurrentPageShapeIds();if(e.length+n.size>this.options.maxShapesPerPage)return Vg(this),this;const i=this.getFocusedGroupId();return this.run(()=>{var f,g;const s=this.getCurrentPageShapesSorted(),o=e.map(m=>{if(m.id||(m={id:Lt(),...m}),!m.parentId||!(this.store.has(m.parentId)||e.some(S=>S.id===m.parentId))){let S=this.getFocusedGroupId();for(let v=s.length-1;v>=0;v--){const w=s[v];if(!this.isShapeHidden(w)&&this.getShapeUtil(w).canReceiveNewChildrenOfType(w,m.type)&&this.isPointInShape(w,{x:m.x??0,y:m.y??0},{margin:0,hitInside:!0})){S=w.id;break}}const b=m.parentId;if(S===m.id&&(S=i),S!==b&&(m={...m},m.parentId=S,Zr(S))){const v=this.getPointInShapeSpace(this.getShape(S),{x:m.x??0,y:m.y??0});m.x=v.x,m.y=v.y,m.rotation=-this.getShapePageTransform(S).rotation()+(m.rotation??0)}}return m}),l=new Map,u=[],{opacityForNextShape:d}=this.getInstanceState();for(const m of o){const S=this.getShapeUtil(m);let b=m.index;if(!b){const _=m.parentId??i;l.has(_)||l.set(_,this.getHighestIndexForParent(_)),b=l.get(_),l.set(_,so(b))}const v=S.getDefaultProps();for(const[_,M]of this.styleProps[m.type])v[M]=this.getStyleForNextShape(_);let w=this.store.schema.types.shape.create({...m,index:b,opacity:m.opacity??d,parentId:m.parentId??i,props:"props"in m?{...v,...m.props}:v});if(w.index===void 0)throw Error("no index!");const C=(g=(f=this.getShapeUtil(w)).onBeforeCreate)==null?void 0:g.call(f,w);C&&(w=C),u.push(w)}u.forEach(m=>{m.meta={...this.getInitialMetaForShape(m),...m.meta}}),this.store.put(u)}),this}animateShape(e,n={animation:Dw}){return this.animateShapes([e],n)}animateShapes(e,n={animation:Dw}){if(!n.animation)return this;const{duration:r=500,easing:i=Kn.linear}=n.animation,s=At();let o=r,l;const u=[];let d,f;for(let m=0,S=e.length;m<S;m++){if(d=e[m],!d)continue;const b=this.getShape(d.id);b&&(f={start:Xt(b),end:Ws(Xt(b),d)},u.push(f),this.animatingShapes.set(b.id,s))}const g=m=>{var w,C;if(o-=m,o<0){const{animatingShapes:_}=this,M=e.filter(I=>I&&_.get(I.id)===s);M.length&&this.updateShapes(M),this.off("tick",g);return}l=i(1-o/r);const{animatingShapes:S}=this,b=[];let v;for(let _=0,M=u.length;_<M;_++){const{start:I,end:A}=u[_];v=S.get(I.id),v===s&&b.push({...A,x:I.x+(A.x-I.x)*l,y:I.y+(A.y-I.y)*l,opacity:I.opacity+(A.opacity-I.opacity)*l,rotation:I.rotation+(A.rotation-I.rotation)*l,props:((C=(w=this.getShapeUtil(A)).getInterpolatedProps)==null?void 0:C.call(w,I,A,l))??A.props})}this._updateShapes(b)};return this.on("tick",g),this}groupShapes(e,n={}){var b;const{groupId:r=Lt(),select:i=!0}=n;if(!Array.isArray(e))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getIsReadonly())return this;const s=typeof e[0]=="string"?e:e.map(v=>v.id);if(s.length<=1)return this;const o=We((this._shouldIgnoreShapeLock?s:this._getUnlockedShapeIds(s)).map(v=>this.getShape(v))),l=o.sort(vr).map(v=>v.id),u=xe.Common(We(o.map(v=>this.getShapePageBounds(v)))),{x:d,y:f}=u.point,g=this.findCommonAncestor(o)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const m=o.filter(v=>v.parentId===g).sort(vr),S=(b=m[m.length-1])==null?void 0:b.index;return this.run(()=>{this.createShapes([{id:r,type:"group",parentId:g,index:S,x:d,y:f,opacity:1,props:{}}]),this.reparentShapes(l,r),i&&this.select(r)}),this}ungroupShapes(e,n={}){if(this.getIsReadonly())return this;const{select:r=!0}=n,i=typeof e[0]=="string"?e:e.map(u=>u.id),s=We((this._shouldIgnoreShapeLock?i:this._getUnlockedShapeIds(i)).map(u=>this.getShape(u)));if(s.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const o=new Set,l=[];return s.forEach(u=>{this.isShapeOfType(u,"group")?l.push(u):o.add(u.id)}),l.length===0?this:(this.run(()=>{let u;for(let d=0,f=l.length;d<f;d++){u=l[d];const g=this.getSortedChildIdsForParent(u.id);for(let m=0,S=g.length;m<S;m++)o.add(g[m]);this.reparentShapes(g,u.parentId,u.index)}this.deleteShapes(l.map(d=>d.id)),r&&this.select(...o)}),this)}updateShape(e){return this.updateShapes([e]),this}updateShapes(e){const n=Array(e.length);for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s)continue;const o=this.getShape(s.id);if(o){if(!this._shouldIgnoreShapeLock){if(o.isLocked){if(!(Object.hasOwn(s,"isLocked")&&!s.isLocked))continue}else if(this.isShapeOrAncestorLocked(o))continue}this.animatingShapes.delete(s.id),n.push(s)}}return this._updateShapes(n),this}_updateShapes(e){this.getIsReadonly()||this.run(()=>{var s,o;const n=[];let r,i;for(let l=0,u=e.length;l<u;l++){const d=e[l];d&&(r=this.getShape(d.id),r&&(i=Ws(r,d),i!==r&&(i=((o=(s=this.getShapeUtil(r)).onBeforeUpdate)==null?void 0:o.call(s,r,i))??i,n.push(i))))}this.store.put(n)})}_getUnlockedShapeIds(e){return e.filter(n=>{var r;return!((r=this.getShape(n))!=null&&r.isLocked)})}deleteShapes(e){if(this.getIsReadonly())return this;if(!Array.isArray(e))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");const n=typeof e[0]=="string"?e:e.map(s=>s.id),r=this._shouldIgnoreShapeLock?n:this._getUnlockedShapeIds(n);if(r.length===0)return this;const i=new Set(r);for(const s of r)this.visitDescendants(s,o=>{i.add(o)});return this.run(()=>this.store.remove([...i]))}deleteShape(e){return this.deleteShapes([typeof e=="string"?e:e.id]),this}_extractSharedStyles(e,n){if(this.isShapeOfType(e,"group")){const r=this._parentIdsToChildIds.get()[e.id];if(!r)return;for(let i=0,s=r.length;i<s;i++)this._extractSharedStyles(this.getShape(r[i]),n)}else for(const[r,i]of this.styleProps[e.type])n.applyValue(r,xr(e.props,i))}_getSelectionSharedStyles(){const e=this.getSelectedShapes(),n=new bC;for(const r of e)this._extractSharedStyles(r,n);return n}getStyleForNextShape(e){const n=this.getInstanceState().stylesForNextShape[e.id];return n===void 0?e.defaultValue:n}getShapeStyleIfExists(e,n){const r=this.styleProps[e.type].get(n);if(r!==void 0)return xr(e.props,r)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._getSelectionSharedStyles();const e=this.root.getCurrent(),n=new bC;if(!e)return n;if(e.shapeType)for(const r of this.styleProps[e.shapeType].keys())n.applyValue(r,this.getStyleForNextShape(r));return n}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const e=[],n=i=>{const s=this.getShape(i);if(s)if(this.isShapeOfType(s,"group"))for(const o of this.getSortedChildIdsForParent(s.id))n(o);else e.push(s)};for(const i of this.getSelectedShapeIds())n(i);let r=null;for(const i of e)if(r===null)r=i.opacity;else if(r!==i.opacity)return{type:"mixed"};if(r!==null)return{type:"shared",value:r}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(e,n){return this.updateInstanceState({opacityForNextShape:e},n),this}setOpacityForSelectedShapes(e){const n=this.getSelectedShapes();if(n.length>0){const r=[],i=s=>{if(this.isShapeOfType(s,"group")){const o=this.getSortedChildIdsForParent(s);for(const l of o)i(this.getShape(l))}else r.push(s)};for(const s of n)i(s);this.updateShapes(r.map(s=>({id:s.id,type:s.type,opacity:e})))}return this}setStyleForNextShapes(e,n,r){const i=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...i,[e.id]:n}},r),this}setStyleForSelectedShapes(e,n){const r=this.getSelectedShapes();if(r.length>0){const i=[],s=o=>{if(this.isShapeOfType(o,"group")){const l=this.getSortedChildIdsForParent(o.id);for(const u of l)s(this.getShape(u))}else{const l=this.getShapeUtil(o),u=this.styleProps[o.type].get(e);if(u){const d={id:o.id,type:o.type,props:{[u]:n}};i.push({util:l,originalShape:o,updatePartial:d})}}};for(const o of r)s(o);this.updateShapes(i.map(({updatePartial:o})=>o))}return this}registerExternalAssetHandler(e,n){return this.externalAssetContentHandlers[e]=n,this}createTemporaryAssetPreview(e,n){if(this.temporaryAssetPreview.has(e))return this.temporaryAssetPreview.get(e);const r=URL.createObjectURL(n);return this.temporaryAssetPreview.set(e,r),setTimeout(()=>{this.temporaryAssetPreview.delete(e),URL.revokeObjectURL(r)},this.options.temporaryAssetPreviewLifetimeMs),r}getTemporaryAssetPreview(e){return this.temporaryAssetPreview.get(e)}async getAssetForExternalContent(e){var n,r;return await((r=(n=this.externalAssetContentHandlers)[e.type])==null?void 0:r.call(n,e))}hasExternalAssetHandler(e){return!!this.externalAssetContentHandlers[e]}registerExternalContentHandler(e,n){return this.externalContentHandlers[e]=n,this}async putExternalContent(e){var n,r;return(r=(n=this.externalContentHandlers)[e.type])==null?void 0:r.call(n,e)}getContentFromCurrentPage(e){const n=typeof e[0]=="string"?e:e.map(i=>i.id);if(!n||n.length===0)return;const r=this.getShapeAndDescendantIds(n);return pO(this,r,i=>{const s=[];for(const f of i){const g=this.getBinding(f);g&&s.push(g)}const o=[],l=[];for(const f of r){const g=this.getShape(f);if(!g)continue;if(!r.has(g.parentId)){const S=this.getShapePageTransform(g.id),b=S.point();l.push({...g,x:b.x,y:b.y,rotation:S.rotation(),parentId:this.getCurrentPageId()}),o.push(g.id)}else l.push(g)}const u=[],d=new Set;for(const f of l){if(!("assetId"in f.props))continue;const g=f.props.assetId;if(!g||d.has(g))continue;d.add(g);const m=this.getAsset(g);m&&u.push(m)}return{schema:this.store.schema.serialize(),shapes:l,rootShapeIds:o,bindings:s,assets:u}})}async resolveAssetsInContent(e){if(!e)return;const n=[];return await Promise.allSettled(e.assets.map(async r=>{var i,s,o;if((r.type==="image"||r.type==="video")&&!((i=r.props.src)!=null&&i.startsWith("data:image"))&&!((s=r.props.src)!=null&&s.startsWith("data:video"))&&!((o=r.props.src)!=null&&o.startsWith("http"))){const l=Xt(r),u=await this.store.props.assets.resolve(r,{screenScale:1,steppedScreenScale:1,dpr:1,networkEffectiveType:null,shouldResolveToOriginal:!0});l.props.src=await Ts.blobToDataUrl(await go(u).then(d=>d.blob())),n.push(l)}else n.push(r)})),e.assets=n,e}putContentOntoCurrentPage(e,n={}){var k,$,F;if(this.getIsReadonly())return this;if(!e.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:r=!1,preserveIds:i=!1,preservePosition:s=!1}=n;let{point:o=void 0}=n;const l=this.getCurrentPageId(),{rootShapeIds:u}=e,d=[],f=[],g=[],m={store:{...Object.fromEntries(e.assets.map(N=>[N.id,N])),...Object.fromEntries(e.shapes.map(N=>[N.id,N])),...Object.fromEntries(((k=e.bindings)==null?void 0:k.map(N=>[N.id,N]))??[])},schema:e.schema},S=this.store.schema.migrateStoreSnapshot(m);if(S.type==="error")throw Error("Could not put content: could not migrate content");for(const N of Object.values(S.value))switch(N.typeName){case"asset":{d.push(N);break}case"shape":{f.push(N);break}case"binding":{g.push(N);break}}const b=new Map(i?f.map(N=>[N.id,N.id]):f.map(N=>[N.id,Lt()])),v=new Map(i?g.map(N=>[N.id,N.id]):g.map(N=>[N.id,Sc()]));let w=this.getCurrentPageId(),C=1/0,_=[];for(const N of this.getSelectedShapes()){if(C===0)break;const B=this.isShapeOfType(N,"frame"),Y=this.getShapeAncestors(N);B&&Y.push(N);const K=B?Y.length+1:Y.length;if(K<C)C=K,_=Y,w=B?N.id:N.parentId;else if(K===C){if(_.length!==Y.length)throw Error(`Ancestors: ${_.length} !== ${Y.length}`);if(_.length===0){w=l;break}else{w=l;for(let V=0;V<_.length&&Y[V]===_[V];V++)w=Y[V].id}}}let M=!1;if(!Vr(w)){const N=this.getShape(w);if(N){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(N)))w=l;else if(u.length===1){const B=f.find(Y=>Y.id===u[0]);this.isShapeOfType(N,"frame")&&this.isShapeOfType(B,"frame")&&B.props.w===(N==null?void 0:N.props.w)&&B.props.h===(N==null?void 0:N.props.h)&&(M=!0)}}else w=l}M||(M=b.has(w)),M&&(w=this.getShape(w).parentId);let I=this.getHighestIndexForParent(w);const A=[],R=f.map(N=>{const B=b.get(N.id),Y={...N,id:B};return u.includes(N.id)&&(Y.parentId=l,A.push(Y)),b.has(Y.parentId)?Y.parentId=b.get(N.parentId):(u.push(Y.id),Y.index=I,I=so(I)),Y});if(R.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage)return Vg(this),this;const D=g.map(N=>({...N,id:Qr(v.get(N.id)),fromId:Qr(b.get(N.fromId)),toId:Qr(b.get(N.toId))})),L=[],G=[];for(const N of d)this.store.has(N.id)||((N.type==="image"&&(($=N.props.src)!=null&&$.startsWith("data:image"))||N.type==="video"&&((F=N.props.src)!=null&&F.startsWith("data:video")))&&(G.push(Xt(N)),N.props.src=null),L.push(N));return Promise.allSettled(G.map(async N=>{const B=await DX(N.props.src,N.props.name,N.props.mimeType??"image/png"),Y=await this.getAssetForExternalContent({type:"file",file:B,assetId:N.id});if(!Y){this.deleteAssets([N.id]);return}this.updateAssets([{...Y,id:N.id}])})),this.run(()=>{L.length>0&&this.createAssets(L),this.createShapes(R),this.createBindings(D),r&&this.select(...A.map(V=>V.id)),w!==l&&this.reparentShapes(A.map(V=>V.id),w);const N=R.map(V=>this.getShape(V.id)),B=xe.Common(N.map(V=>this.getShapePageBounds(V)));if(o===void 0)if(Vr(w)){const V=this.getViewportPageBounds();s||V.includes(xe.From(B))?o=B.center:o=V.center}else{const V=this.getShape(w);o=be.applyToPoint(this.getShapePageTransform(V),this.getShapeGeometry(V).bounds.center)}if(A.length===1){const V=A[0];if(this.isShapeOfType(V,"frame"))for(;this.getShapesAtPoint(o).some(W=>this.isShapeOfType(W,"frame")&&W.props.w===V.props.w&&W.props.h===V.props.h);)o.x+=B.w+16}const Y=xe.Common(We(A.map(({id:V})=>this.getShapePageBounds(V)))).center,K=T.Sub(o,Y);this.updateShapes(A.map(({id:V})=>{const W=this.getShape(V),ee=this.getShapeParentTransform(V).decompose().rotation,H=T.Rot(K,-ee);return{id:W.id,type:W.type,x:W.x+H.x,y:W.y+H.y}}))}),this}async getSvgElement(e,n={}){const r=e.length===0?this.getCurrentPageShapeIdsSorted():typeof e[0]=="string"?e:e.map(i=>i.id);if(r.length!==0)return PX(this,r,n)}async getSvgString(e,n={}){const r=await this.getSvgElement(e,n);return r?{svg:new XMLSerializer().serializeToString(r.svg),width:r.width,height:r.height}:void 0}async getSvg(e,n={}){const r=await this.getSvgElement(e,n);if(r)return r.svg}async toImage(e,n={}){const r={format:"png",scale:1,pixelRatio:n.format==="svg"?void 0:2,...n},i=await this.getSvgString(e,r);if(!i)throw new Error("Could not create SVG");switch(r.format){case"svg":return{blob:new Blob([i.svg],{type:"image/svg+xml"}),width:i.width,height:i.height};case"jpeg":case"png":case"webp":{const s=await RX(i.svg,{type:r.format,quality:r.quality,pixelRatio:r.pixelRatio,width:i.width,height:i.height});if(!s)throw new Error("Could not construct image.");return{blob:s,width:i.width,height:i.height}}default:An(r.format)}}_updateInputsFromEvent(e){const{pointerVelocity:n,previousScreenPoint:r,previousPagePoint:i,currentScreenPoint:s,currentPagePoint:o}=this.inputs,{screenBounds:l}=this.store.unsafeGetWithoutCapture(kr),{x:u,y:d,z:f}=jg(()=>this.getCamera()),g=e.point.x-l.x,m=e.point.y-l.y,S=e.point.z??.5;r.setTo(s),i.setTo(o),s.set(g,m);const b=g/f-u,v=m/f-d;isFinite(b)&&isFinite(v)&&o.set(b,v,S),this.inputs.isPen=e.type==="pointer"&&e.isPen,(e.name==="pointer_down"||this.inputs.isPinching)&&(n.set(0,0),this.inputs.originScreenPoint.setTo(s),this.inputs.originPagePoint.setTo(o)),this.run(()=>{var w;this.store.put([{id:wy,typeName:"pointer",x:o.x,y:o.y,lastActivityTimestamp:e.type==="pointer"&&e.pointerId===kR.CAMERA_MOVE?((w=this.store.unsafeGetWithoutCapture(wy))==null?void 0:w.lastActivityTimestamp)??this._tickManager.now:this._tickManager.now,meta:{}}])},{history:"ignore"})}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}focus({focusContainer:e=!0}={}){return this.getIsFocused()?this:(e&&this.focusManager.focus(),this.updateInstanceState({isFocused:!0}),this)}blur({blurContainer:e=!0}={}){return this.getIsFocused()?(e?this.focusManager.blur():this.complete(),this.updateInstanceState({isFocused:!1}),this):this}getIsFocused(){return this.getInstanceState().isFocused}getIsReadonly(){return this.getInstanceState().isReadonly}getSnapshot(){return AW(this.store)}loadSnapshot(e,n){return w4(this.store,e,n),this}_zoomToFitPageContentAt100Percent(){const e=this.getCurrentPageBounds();e&&this.zoomToBounds(e,{immediate:!0,targetZoom:this.getBaseZoom()})}_navigateToDeepLink(e){this.run(()=>{switch(e.type){case"page":{const n=this.getPage(e.pageId);n&&this.setCurrentPage(n),this._zoomToFitPageContentAt100Percent();return}case"shapes":{const n=We(e.shapeIds.map(o=>this.getShape(o))),r={};for(const o of n){const l=this.getAncestorPageId(o);l&&(r[l]??(r[l]=[]),r[l].push(o))}const[i,s]=Object.entries(r).sort(([o,l],[u,d])=>d.length-l.length)[0]??["",[]];if(!i||!s.length)this._zoomToFitPageContentAt100Percent();else{this.setCurrentPage(i);const o=xe.Common(s.map(l=>this.getShapePageBounds(l)));this.zoomToBounds(o,{immediate:!0,targetZoom:this.getBaseZoom()})}return}case"viewport":{if(e.pageId){if(!this.getPage(e.pageId)){this._zoomToFitPageContentAt100Percent();return}this.setCurrentPage(e.pageId)}this.zoomToBounds(e.bounds,{immediate:!0,inset:0});return}default:An(e)}})}navigateToDeepLink(e){if(e&&"type"in e)return this._navigateToDeepLink(e),this;const r=new URL((e==null?void 0:e.url)??window.location.href).searchParams.get((e==null?void 0:e.param)??"d");if(!r)return this._zoomToFitPageContentAt100Percent(),this;try{this._navigateToDeepLink(zX(r))}catch(i){console.warn(i),this._zoomToFitPageContentAt100Percent()}return this}createDeepLink(e){const n=new URL((e==null?void 0:e.url)??window.location.href);return n.searchParams.set((e==null?void 0:e.param)??"d",NX((e==null?void 0:e.to)??{type:"viewport",pageId:this.options.maxPages===1?void 0:this.getCurrentPageId(),bounds:this.getViewportPageBounds()})),n}registerDeepLinkListener(e){if(e!=null&&e.getUrl&&!(e!=null&&e.onChange))throw Error("[tldraw:urlStateSync] If you specify getUrl, you must also specify the onChange callback.");const n=he("url with state",()=>{var u,d;const o=((u=e==null?void 0:e.getUrl)==null?void 0:u.call(e,this))??window.location.href;return this.createDeepLink({param:e==null?void 0:e.param,url:o,to:(d=e==null?void 0:e.getTarget)==null?void 0:d.call(e,this)}).toString()}),r=(e==null?void 0:e.onChange)??(()=>{var l;const o=this.createDeepLink({param:e==null?void 0:e.param,to:(l=e==null?void 0:e.getTarget)==null?void 0:l.call(e,this)});window.history.replaceState({},document.title,o.toString())}),i=P_(o=>o(),(e==null?void 0:e.debounceMs)??500),s=co("update url on state change",()=>r(new URL(n.get()),this),{scheduleEffect:i});return()=>{s(),i.cancel()}}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_setShiftKeyTimeout(){this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,metaKey:this.inputs.metaKey,accelKey:br(this.inputs),code:"ShiftLeft"})}_setAltKeyTimeout(){this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,metaKey:this.inputs.metaKey,accelKey:br(this.inputs),code:"AltLeft"})}_setCtrlKeyTimeout(){this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,metaKey:this.inputs.metaKey,accelKey:br(this.inputs),code:"ControlLeft"})}_setMetaKeyTimeout(){this.inputs.metaKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Meta",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,metaKey:this.inputs.metaKey,accelKey:br(this.inputs),code:"MetaLeft"})}dispatch(e){return this._pendingEventsForNextTick.push(e),e.type==="pointer"&&e.name==="pointer_move"||e.type==="wheel"||e.type==="pinch"||this._flushEventsForTick(0),this}_flushEventsForTick(e){this.run(()=>{if(this._pendingEventsForNextTick.length>0){const n=[...this._pendingEventsForNextTick];this._pendingEventsForNextTick.length=0;for(const r of n)this._flushEventForTick(r)}e>0&&this.root.handleEvent({type:"misc",name:"tick",elapsed:e}),this.scribbles.tick(e)})}_flushEventForTick(e){if(this.getCrashingError())return this;this.emit("before-event",e);const{inputs:n}=this,{type:r}=e;if(e.type==="misc"){(e.name==="cancel"||e.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.inputs.isSpacebarPanning=!1,this.setCursor({type:this._prevCursor,rotation:0}))),this.root.handleEvent(e);return}e.shiftKey?(clearTimeout(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,n.shiftKey=!0):!e.shiftKey&&n.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=this.timers.setTimeout(this._setShiftKeyTimeout,150)),e.altKey?(clearTimeout(this._altKeyTimeout),this._altKeyTimeout=-1,n.altKey=!0):!e.altKey&&n.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=this.timers.setTimeout(this._setAltKeyTimeout,150)),e.ctrlKey?(clearTimeout(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,n.ctrlKey=!0):!e.ctrlKey&&n.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=this.timers.setTimeout(this._setCtrlKeyTimeout,150)),e.metaKey?(clearTimeout(this._metaKeyTimeout),this._metaKeyTimeout=-1,n.metaKey=!0):!e.metaKey&&n.metaKey&&this._metaKeyTimeout===-1&&(this._metaKeyTimeout=this.timers.setTimeout(this._setMetaKeyTimeout,150));const{originPagePoint:i,currentPagePoint:s}=n;n.isPointing||(n.isDragging=!1);const o=this.store.unsafeGetWithoutCapture(kr),l=this.store.get(this._getCurrentPageStateId()),u=this._cameraOptions.__unsafe__getWithoutCapture();switch(r){case"pinch":{if(u.isLocked)return;switch(clearTimeout(this._longPressTimeout),this._updateInputsFromEvent(e),e.name){case"pinch_start":{if(n.isPinching)return;n.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=[...l.selectedShapeIds]),this._didPinch=!0,n.isPinching=!0,this.interrupt());return}case"pinch":{if(!n.isPinching)return;const{point:{z:d=1},delta:{x:f,y:g}}=e,{x:m,y:S}=T.SubXY(e.point,o.screenBounds.x,o.screenBounds.y);this.stopCameraAnimation(),o.followingUserId&&this.stopFollowingUser();const{x:b,y:v,z:w}=jg(()=>this.getCamera()),{panSpeed:C,zoomSpeed:_}=u;this._setCamera(new T(b+f*C/w-m/w+m/(d*_),v+g*C/w-S/w+S/(d*_),d*_),{immediate:!0});return}case"pinch_end":{if(!n.isPinching)return this;n.isPinching=!1;const{_selectedShapeIdsAtPointerDown:d}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,d.length>0&&this.once("tick",()=>{this._didPinch||this.setSelectedShapes(d)}));return}}}case"wheel":{if(u.isLocked)return;this._updateInputsFromEvent(e);const{panSpeed:d,zoomSpeed:f,wheelBehavior:g}=u;if(g!=="none"){this.stopCameraAnimation(),o.followingUserId&&this.stopFollowingUser();const{x:m,y:S,z:b}=jg(()=>this.getCamera()),{x:v,y:w,z:C=0}=e.delta;let _=g;switch(n.ctrlKey&&(_=g==="pan"?"zoom":"pan"),_){case"zoom":{const{x:M,y:I}=this.inputs.currentScreenPoint;let A=C;g==="zoom"&&(Math.abs(w)>10?A=10*Math.sign(w)/100:A=w/100);const R=b+(A??0)*f*b;this._setCamera(new T(m+(M/R-M)-(M/b-M),S+(I/R-I)-(I/b-I),R),{immediate:!0}),this.maybeTrackPerformance("Zooming");return}case"pan":{this._setCamera(new T(m+v*d/b,S+w*d/b,b),{immediate:!0}),this.maybeTrackPerformance("Panning");return}}}break}case"pointer":{if(n.isPinching)return;this._updateInputsFromEvent(e);const{isPen:d}=e,{isPenMode:f}=o;switch(e.name){case"pointer_down":{if(f&&!d)return;if(this.inputs.isPanning||(this._longPressTimeout=this.timers.setTimeout(()=>{const g=this.getViewportScreenBounds();this.dispatch({...e,point:this.inputs.originScreenPoint.clone().addXY(g.x,g.y),name:"long_press"})},this.options.longPressDurationMs)),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),e.button===RR&&(this.capturedPointerId=e.pointerId),n.buttons.add(e.button),n.isPointing=!0,n.isDragging=!1,!f&&d&&this.updateInstanceState({isPenMode:!0}),e.button===OR?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):e.button===Fg&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,clearTimeout(this._longPressTimeout)),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing",rotation:0}),this;break}case"pointer_move":{if(!d&&f)return;const{x:g,y:m,z:S}=jg(()=>this.getCamera());if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:b,previousScreenPoint:v}=this.inputs,{panSpeed:w}=u,C=T.Sub(b,v);this.setCamera(new T(g+C.x*w/S,m+C.y*w/S,S),{immediate:!0}),this.maybeTrackPerformance("Panning");return}n.isPointing&&!n.isDragging&&T.Dist2(i,s)*this.getZoomLevel()>(o.isCoarsePointer?this.options.coarseDragDistanceSquared:this.options.dragDistanceSquared)/S&&(n.isDragging=!0,clearTimeout(this._longPressTimeout));break}case"pointer_up":{if(n.isDragging=!1,n.isPointing=!1,clearTimeout(this._longPressTimeout),n.buttons.delete(e.button),o.isPenMode&&!d)return;if(this.capturedPointerId===e.pointerId&&(this.capturedPointerId=null,e.button=0),n.isPanning){n.keys.has("Space")||(n.isPanning=!1,n.isSpacebarPanning=!1);const g=this.inputs.pointerVelocity,m=Math.min(2,g.len());switch(e.button){case RR:{this.setCursor({type:"grab",rotation:0});break}case Fg:this.inputs.keys.has(" ")?this.setCursor({type:"grab",rotation:0}):this.setCursor({type:this._prevCursor,rotation:0})}m>0&&this.slideCamera({speed:m,direction:g})}else e.button===OR&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(e.key==="ShiftRight"&&(e.key="ShiftLeft"),e.key==="AltRight"&&(e.key="AltLeft"),e.code==="ControlRight"&&(e.code="ControlLeft"),e.code==="MetaRight"&&(e.code="MetaLeft"),e.name){case"key_down":{if(n.keys.add(e.code),e.code==="Space"&&!e.ctrlKey&&(this.inputs.isPanning||(this._prevCursor=o.cursor.type),this.inputs.isPanning=!0,this.inputs.isSpacebarPanning=!0,clearTimeout(this._longPressTimeout),this.setCursor({type:this.inputs.isPointing?"grabbing":"grab",rotation:0})),this.inputs.isSpacebarPanning){let d;switch(e.code){case"ArrowUp":{d=new T(0,-1);break}case"ArrowRight":{d=new T(1,0);break}case"ArrowDown":{d=new T(0,1);break}case"ArrowLeft":{d=new T(-1,0);break}}if(d){const f=this.getViewportPageBounds(),g=f.clone().translate(d.mulV({x:f.w,y:f.h}));this._animateToViewport(g,{animation:{duration:320}})}}break}case"key_up":{n.keys.delete(e.code),e.code==="Space"&&(this.inputs.buttons.has(Fg)||(this.inputs.isPanning=!1,this.inputs.isSpacebarPanning=!1,this.setCursor({type:this._prevCursor,rotation:0})));break}}break}}if(e.type==="pointer"){e.button===Fg?e.name="middle_click":e.button===f2&&(e.name="right_click");const{isPenMode:d}=this.store.unsafeGetWithoutCapture(kr);if(e.isPen===d){const f=this._clickManager.handlePointerEvent(e);if(e.name!==f.name){this.root.handleEvent(e),this.emit("event",e),this.root.handleEvent(f),this.emit("event",f);return}}}return this.root.handleEvent(e),this.emit("event",e),e.type==="pointer"&&e.name==="pointer_down"&&this.menus.clearOpenMenus(),this}maybeTrackPerformance(e){xn.measurePerformance.get()&&(this.performanceTracker.isStarted()?clearTimeout(this.performanceTrackerTimeout):this.performanceTracker.start(e),this.performanceTrackerTimeout=this.timers.setTimeout(()=>{this.performanceTracker.stop()},50))}}Ee=oQ(wC);Pe(Ee,1,"getIsShapeHiddenCache",bN,_e);Pe(Ee,1,"getCanUndo",vN,_e);Pe(Ee,1,"getCanRedo",SN,_e);Pe(Ee,1,"getPath",yN,_e);Pe(Ee,1,"getCurrentTool",mN,_e);Pe(Ee,1,"getCurrentToolId",gN,_e);Pe(Ee,1,"getDocumentSettings",pN,_e);Pe(Ee,1,"getInstanceState",fN,_e);Pe(Ee,1,"getOpenMenus",hN,_e);Pe(Ee,1,"getIsMenuOpen",dN,_e);Pe(Ee,1,"getPageStates",uN,_e);Pe(Ee,1,"_getPageStatesQuery",cN,_e);Pe(Ee,1,"getCurrentPageState",lN,_e);Pe(Ee,1,"_getCurrentPageStateId",aN,_e);Pe(Ee,1,"getSelectedShapeIds",oN,_e);Pe(Ee,1,"getSelectedShapes",sN,_e);Pe(Ee,1,"getOnlySelectedShapeId",iN,_e);Pe(Ee,1,"getOnlySelectedShape",rN,_e);Pe(Ee,1,"getSelectionPageBounds",nN,_e);Pe(Ee,1,"getSelectionRotation",tN,_e);Pe(Ee,1,"getSelectionRotatedPageBounds",eN,_e);Pe(Ee,1,"getSelectionRotatedScreenBounds",J6,_e);Pe(Ee,1,"getFocusedGroupId",Q6,_e);Pe(Ee,1,"getFocusedGroup",Z6,_e);Pe(Ee,1,"getEditingShapeId",X6,_e);Pe(Ee,1,"getEditingShape",W6,_e);Pe(Ee,1,"getHoveredShapeId",V6,_e);Pe(Ee,1,"getHoveredShape",Y6,_e);Pe(Ee,1,"getHintingShapeIds",q6,_e);Pe(Ee,1,"getHintingShape",G6,_e);Pe(Ee,1,"getErasingShapeIds",K6,_e);Pe(Ee,1,"getErasingShapes",H6,_e);Pe(Ee,1,"_unsafe_getCameraId",U6,_e);Pe(Ee,1,"getCamera",F6,_e);Pe(Ee,1,"getViewportPageBoundsForFollowing",B6,_e);Pe(Ee,1,"getCameraForFollowing",$6,_e);Pe(Ee,1,"getZoomLevel",z6,_e);Pe(Ee,1,"getViewportScreenBounds",N6,_e);Pe(Ee,1,"getViewportScreenCenter",L6,_e);Pe(Ee,1,"getViewportPageBounds",D6,_e);Pe(Ee,1,"_getCollaboratorsQuery",j6,_e);Pe(Ee,1,"getCollaborators",O6,_e);Pe(Ee,1,"getCollaboratorsOnCurrentPage",R6,_e);Pe(Ee,1,"getRenderingShapes",k6,_e);Pe(Ee,1,"_getAllPagesQuery",A6,_e);Pe(Ee,1,"getPages",M6,_e);Pe(Ee,1,"getCurrentPageId",I6,_e);Pe(Ee,1,"getCurrentPageShapeIdsSorted",T6,_e);Pe(Ee,1,"_getAllAssetsQuery",P6,_e);Pe(Ee,1,"_getShapeGeometryCache",E6,_e);Pe(Ee,1,"_getShapeHandlesCache",_6,_e);Pe(Ee,1,"_getShapePageTransformCache",C6,_e);Pe(Ee,1,"_getShapePageBoundsCache",w6,_e);Pe(Ee,1,"_getShapeClipPathCache",x6,_e);Pe(Ee,1,"_getShapeMaskCache",b6,_e);Pe(Ee,1,"_getShapeMaskedPageBoundsCache",v6,_e);Pe(Ee,1,"_notVisibleShapes",S6,_e);Pe(Ee,1,"getCulledShapes",y6,_e);Pe(Ee,1,"getCurrentPageBounds",m6,_e);Pe(Ee,1,"getCurrentPageShapes",g6,_e);Pe(Ee,1,"getCurrentPageShapesSorted",p6,_e);Pe(Ee,1,"getCurrentPageRenderingShapesSorted",f6,_e);Pe(Ee,1,"_getBindingsIndexCache",h6,_e);Pe(Ee,1,"_getSelectionSharedStyles",d6,_e);Pe(Ee,1,"getSharedStyles",u6,_e);Pe(Ee,1,"getSharedOpacity",c6,_e);Pe(Ee,1,"getIsFocused",l6,_e);Pe(Ee,1,"getIsReadonly",a6,_e);Pe(Ee,1,"_setShiftKeyTimeout",o6,_e);Pe(Ee,1,"_setAltKeyTimeout",s6,_e);Pe(Ee,1,"_setCtrlKeyTimeout",i6,_e);Pe(Ee,1,"_setMetaKeyTimeout",r6,_e);lQ(Ee,_e);function Vg(t,e=t.getCurrentPageId()){const n=t.getPage(e).name;t.emit("max-shapes",{name:n,pageId:e,count:t.options.maxShapesPerPage})}function Ws(t,e){if(!e)return t;let n=null;const r=Object.entries(e);for(let i=0,s=r.length;i<s;i++){const[o,l]=r[i];if(l!==void 0&&!(o==="id"||o==="type"||o==="typeName")&&l!==t[o]){if(n||(n={...t}),o==="props"||o==="meta"){n[o]={...t[o]};for(const[u,d]of Object.entries(l))n[o][u]=d;continue}n[o]=l}}return n||t}function xN(t,e,n){const r=t.getShape(e);if(!r)return;n.push(r);const i=t.getSortedChildIdsForParent(e);for(let s=0,o=i.length;s<o;s++)xN(t,i[s],n)}function pO(t,e,n){let r;if(t.run(()=>{const i=t.store.extractingChanges(()=>{const s=new Set,o=new Set;for(const l of e)if(t.getShape(l))for(const d of t.getBindingsInvolvingShape(l)){const f=e.has(d.fromId),g=e.has(d.toId);if(f&&g){s.add(d.id);continue}(!f||!g)&&o.add(d.id)}t.deleteBindings([...o],{isolateShapes:!0});try{r=fl.ok(n(s))}catch(l){r=fl.err(l)}});t.store.applyDiff(aC(i))},{history:"ignore"}),r.ok)return r.value;throw r.error}function gO(t,e){if(!e.constraints)throw Error("Should have constraints here");const{padding:{x:n,y:r}}=e.constraints,i=t.getViewportScreenBounds(),s=xe.From(e.constraints.bounds),o=(i.w-n*2)/s.w,l=(i.h-r*2)/s.h;return{zx:o,zy:l}}function dp(){const t=re(),e=ap();return oe("isDarkMode",()=>(e==null?void 0:e.isDarkMode)??t.user.getIsDarkMode(),[e,t])}const mO="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",yO="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",Wg='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function nl(t,e,n,r,i,s=16,o=16){const l=(-n-e)*(yt/180),u=Math.sin(l),d=Math.cos(l),f=1*d-1*u,g=1*u+1*d;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${i};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${f}' dy='${g}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${e+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+`</g></svg>") ${s} ${o}, pointer`}const uQ=["default","pointer","cross","move","grab","grabbing","text","zoom-in","zoom-out"],dQ={none:()=>"none","ew-resize":(t,e,n)=>nl(yO,t,0,e,n),"ns-resize":(t,e,n)=>nl(yO,t,90,e,n),"nesw-resize":(t,e,n)=>nl(mO,t,0,e,n),"nwse-resize":(t,e,n)=>nl(mO,t,90,e,n),"nwse-rotate":(t,e,n)=>nl(Wg,t,0,e,n),"nesw-rotate":(t,e,n)=>nl(Wg,t,90,e,n),"senw-rotate":(t,e,n)=>nl(Wg,t,180,e,n),"swne-rotate":(t,e,n)=>nl(Wg,t,270,e,n)};function yi(t,e=0,n="black"){return dQ[t](dG(e),!1,n)}function hQ(){const t=re(),e=zn(),n=dp();pl("useCursor",()=>{const{type:r,rotation:i}=t.getInstanceState().cursor;if(uQ.includes(r)){e.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}e.style.setProperty("--tl-cursor",yi(r,i,n?"white":"black"))},[t,e,n])}function fQ(){const t=re(),e=zn(),n=dp(),r=oe(xn.forceSrgb);et.useEffect(()=>{n?(e.setAttribute("data-color-mode","dark"),e.classList.remove("tl-theme__light"),e.classList.add("tl-theme__dark")):(e.setAttribute("data-color-mode","light"),e.classList.remove("tl-theme__dark"),e.classList.add("tl-theme__light")),r?e.classList.add("tl-theme__force-sRGB"):e.classList.remove("tl-theme__force-sRGB")},[t,e,r,n])}function pQ(){const[t,e]=E.useState(0);E.useEffect(()=>e(n=>n+1),[])}const gQ=t=>t.props.src,mQ={upload:async(t,e)=>({src:await Ts.blobToDataUrl(e)})};function yQ(t){return"schema"in t&&t.schema?t.schema:Wq({shapes:"shapeUtils"in t&&t.shapeUtils?SO(P4(t.shapeUtils)):void 0,bindings:"bindingUtils"in t&&t.bindingUtils?SO(_4(t.bindingUtils)):void 0,migrations:"migrations"in t?t.migrations:void 0})}function My({initialData:t,defaultName:e="",id:n,assets:r=mQ,onMount:i,collaboration:s,...o}={}){const l=yQ(o),u=new J_({id:n,schema:l,initialData:t,props:{defaultName:e,assets:{upload:r.upload,resolve:r.resolve??gQ},onMount:d=>{xt(d instanceof _e),i==null||i(d)},collaboration:s}});if(o.snapshot){if(t)throw new Error("Cannot provide both initialData and snapshot");w4(u,o.snapshot,{forceOverwriteSessionState:!0})}return u}function SO(t){return Object.fromEntries(t.map(e=>[e.type,{props:e.props,migrations:e.migrations}]))}function SQ(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
 If your hard disk is full, try clearing up some space and then reload the page.`)}function vQ(){window.alert(`Oops! We could not access your browser's storageand the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const bQ=350,xQ=1e4,vO=Symbol("UPDATE_INSTANCE_STATE"),wQ=t=>t;class CQ{constructor(e){O(this,"onmessage")}postMessage(e){}close(){}}const _Q=typeof BroadcastChannel>"u"?CQ:BroadcastChannel;class EQ{constructor(e,{persistenceKey:n,sessionId:r=Iy,onLoad:i,onLoadError:s},o=new _Q(`tldraw-tab-sync-${n}`)){O(this,"disposables",new Set);O(this,"diffQueue",[]);O(this,"didDispose",!1);O(this,"shouldDoFullDBWrite",!0);O(this,"isReloading",!1);O(this,"persistenceKey");O(this,"sessionId");O(this,"serializedSchema");O(this,"isDebugging",!1);O(this,"documentTypes");O(this,"$sessionStateSnapshot");O(this,"db");O(this,"initTime",Date.now());O(this,"isPersisting",!1);O(this,"didLastWriteError",!1);O(this,"scheduledPersistTimeout",null);this.store=e,this.channel=o,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=n,this.sessionId=r,this.db=new fy(n),this.disposables.add(()=>this.db.close()),this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=v2(this.store),this.disposables.add(e.listen(({changes:l})=>{this.diffQueue.push(l),this.channel.postMessage(wQ({type:"diff",storeId:this.store.id,changes:l,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(e.listen(()=>{this.diffQueue.push(vO),this.schedulePersist()},{scope:"session"})),this.connect(i,s),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(l=>l.scope==="document").map(l=>l.typeName))}debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,n){this.debug("connecting");let r;try{r=await this.db.load({sessionId:this.sessionId})}catch(i){n(i),vQ();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const i=Object.fromEntries(r.records.map(u=>[u.id,u])),s=r.sessionStateSnapshot??MW(i),o=this.store.schema.migrateStoreSnapshot({store:i,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(o.type==="error"){console.error("failed to migrate store",o),n(new Error(`Failed to migrate store: ${o.reason}`));return}const l=Object.values(o.value).filter(u=>this.documentTypes.has(u.typeName));l.length>0&&this.store.mergeRemoteChanges(()=>{this.store.put(l,"initialize")}),s&&gC(this.store,s,{forceOverwrite:!0})}this.channel.onmessage=({data:i})=>{var l,u;this.debug("got message",i);const s=i,o=this.store.schema.getMigrationsSince(s.schema);if(o.ok){if(o.value.length>0){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}}else{if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(u=(l=window==null?void 0:window.location)==null?void 0:l.reload)==null||u.call(l);return}s.type==="diff"&&(this.debug("applying diff"),uo(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(s.changes)})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),e(this)}catch(i){if(this.debug("error loading data from store",i),this.didDispose)return;n(i);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(e=>e())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?xQ:bQ))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){if(xt(!this.isPersisting,"persist already in progress"),this.didDispose)return;this.isPersisting=!0,this.debug("doPersist start");const e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await this.db.storeSnapshot({schema:this.store.schema,snapshot:this.store.serialize(),sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const n=Q_(e.filter(r=>r!==vO));await this.db.storeChanges({changes:n,schema:this.store.schema,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),SQ(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function wN(t){const e=E.useRef(t),[n,r]=E.useState(t);n!==e.current&&r(e.current);const i=E.useCallback(s=>{typeof s=="function"?e.current=s(e.current):e.current=s,r(e.current)},[]);return[n,i]}function PQ(t){const[e,n]=wN({status:"loading"});return t=Cd(t),E.useEffect(()=>{const{persistenceKey:r,sessionId:i,...s}=t;if(!r){n({status:"not-synced",store:My(s)});return}n({status:"loading"});const o=new po,l={upload:async(g,m)=>(await f.db.storeAsset(g.id,m),{src:g.id}),resolve:async g=>g.props.src?g.props.src.startsWith("asset:")?await o.get(g,async()=>{const m=await f.db.getAsset(g.id);return m?URL.createObjectURL(m):null}):g.props.src:null,...s.assets},u=My({...s,assets:l});let d=!1;const f=new EQ(u,{sessionId:i,persistenceKey:r,onLoad(){d||n({store:u,status:"synced-local"})},onLoadError(g){d||n({status:"error",error:g})}});return()=>{d=!0,f.close()}},[t,n]),e}function TQ(){const t=re(),e=zn();E.useEffect(()=>{const n=s=>e.style.setProperty("--tl-zoom",s.toString()),r=P_(n,100),i=new bd("useZoomCss",()=>{t.getCurrentPageShapeIds().size<300?n(t.getZoomLevel()):r(t.getZoomLevel())});return i.attach(),i.execute(),()=>{i.detach(),r.cancel()}},[t,e])}function CC(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0,i=t.length;r<i;r++)n[r]=t.charCodeAt(r);return e}function IQ(t){const e=atob(t),n=CC(e);return crypto.subtle.importKey("spki",new Uint8Array(n),{name:"ECDSA",namedCurve:"P-256"},!0,["verify"])}const MQ=5,of={ANNUAL_LICENSE:1,PERPETUAL_LICENSE:2,INTERNAL_LICENSE:4,WITH_WATERMARK:8},AQ=Math.max(...Object.values(of)),af={ID:0,HOSTS:1,FLAGS:2,EXPIRY_DATE:3},kQ=Object.keys(af).length,Xw="sales@tldraw.com",RQ=`${hl()}/watermarks/watermark-track.svg`;class _S{constructor(e,n,r){O(this,"publicKey","MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEHJh0uUfxHtCGyerXmmatE368Hd9rI6LH9oPDQihnaCryRFWEVeOvf9U/SPbyxX74LFyJs5tYeAHq5Nc0Ax25LQ");O(this,"isDevelopment");O(this,"isTest");O(this,"isCryptoAvailable");O(this,"state",On("license state","pending"));O(this,"verbose",!0);this.isTest=!1,this.isDevelopment=this.getIsDevelopment(r),this.publicKey=n||this.publicKey,this.isCryptoAvailable=!!crypto.subtle,this.getLicenseFromKey(e).then(i=>{const s=OQ(i);!this.isDevelopment&&s&&go(RQ),s?this.state.set("unlicensed"):i.isLicensedWithWatermark?this.state.set("licensed-with-watermark"):this.state.set("licensed")})}getIsDevelopment(e){return e==="development"?!0:e==="production"?!1:window.location.protocol!=="https:"}async extractLicenseKey(e){const[n,r]=e.split("."),[i,s]=n.split("/");if(!i.startsWith("tldraw-"))throw new Error(`Unsupported prefix '${i}'`);const o=await IQ(this.publicKey);let l;try{l=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,new Uint8Array(CC(atob(r))),new Uint8Array(CC(atob(s))))}catch(d){throw console.error(d),new Error("Could not perform signature validation")}if(!l)throw new Error("Invalid signature");let u;try{u=JSON.parse(atob(s))}catch{throw new Error("Could not parse object")}return u.length>kQ&&this.outputMessages(["License key contains some unknown properties.","You may want to update tldraw packages to a newer version to get access to new functionality."]),{id:u[af.ID],hosts:u[af.HOSTS],flags:u[af.FLAGS],expiryDate:u[af.EXPIRY_DATE]}}async getLicenseFromKey(e){if(!e)return this.isDevelopment||this.outputNoLicenseKeyProvided(),{isLicenseParseable:!1,reason:"no-key-provided"};if(this.isDevelopment&&!this.isCryptoAvailable)return this.verbose&&(console.log("tldraw: you seem to be in a development environment that does not support crypto. License not verified."),console.log("You should check that this works in production separately.")),{isLicenseParseable:!1,reason:"has-key-development-mode"};let n=e.replace(/[\u200B-\u200D\uFEFF]/g,"");n=n.replace(/\r?\n|\r/g,"");try{const r=await this.extractLicenseKey(n),i=new Date(r.expiryDate),s=this.isFlagEnabled(r.flags,of.ANNUAL_LICENSE),o=this.isFlagEnabled(r.flags,of.PERPETUAL_LICENSE),l={license:r,isLicenseParseable:!0,isDevelopment:this.isDevelopment,isDomainValid:this.isDomainValid(r),expiryDate:i,isAnnualLicense:s,isAnnualLicenseExpired:s&&this.isAnnualLicenseExpired(i),isPerpetualLicense:o,isPerpetualLicenseExpired:o&&this.isPerpetualLicenseExpired(i),isInternalLicense:this.isFlagEnabled(r.flags,of.INTERNAL_LICENSE),isLicensedWithWatermark:this.isFlagEnabled(r.flags,of.WITH_WATERMARK)};return this.outputLicenseInfoIfNeeded(l),l}catch(r){return this.outputInvalidLicenseKey(r.message),{isLicenseParseable:!1,reason:"invalid-license-key"}}}isDomainValid(e){const n=window.location.hostname.toLowerCase();return e.hosts.some(r=>{const i=r.toLowerCase().trim();if(i===n||`www.${i}`===n||i===`www.${n}`||r==="*")return!0;if(r.includes("*")){const s=new RegExp(r.replace(/\*/g,".*?"));return s.test(n)||s.test(`www.${n}`)}return!1})}getExpirationDateWithoutGracePeriod(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}getExpirationDateWithGracePeriod(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+MQ+1)}isAnnualLicenseExpired(e){const n=this.getExpirationDateWithGracePeriod(e),r=new Date>=n;return!r&&new Date>=this.getExpirationDateWithoutGracePeriod(e)&&this.outputMessages(["tldraw license is about to expire, you are in a grace period.",`Please reach out to ${Xw} if you would like to renew your license.`]),r}isPerpetualLicenseExpired(e){const n=this.getExpirationDateWithGracePeriod(e),r={major:new Date(MR.major),minor:new Date(MR.minor)};return r.major>=n||r.minor>=n}isFlagEnabled(e,n){return(e&n)===n}outputNoLicenseKeyProvided(){}outputInvalidLicenseKey(e){this.outputMessages(["Invalid tldraw license key",`Reason: ${e}`])}outputLicenseInfoIfNeeded(e){e.isAnnualLicenseExpired&&this.outputMessages(["Your tldraw license has expired!",`Please reach out to ${Xw} to renew.`]),!e.isDomainValid&&!e.isDevelopment&&this.outputMessages(["This tldraw license key is not valid for this domain!",`Please reach out to ${Xw} if you would like to use tldraw on other domains.`]),e.license.flags>=AQ*2&&this.outputMessages(["This tldraw license contains some unknown flags.","You may want to update tldraw packages to a newer version to get access to new functionality."])}outputMessages(e){if(!this.isTest&&this.verbose){this.outputDelimiter();for(const n of e)console.log(`%c${n}`,"color: white; background: crimson; padding: 2px; border-radius: 3px;");this.outputDelimiter()}}outputDelimiter(){console.log("%c-------------------------------------------------------------------","color: white; background: crimson; padding: 2px; border-radius: 3px;")}}O(_S,"className","tl-watermark_SEE-LICENSE");function OQ(t){if(!t.isLicenseParseable||!t.isDomainValid&&!t.isDevelopment)return!0;if(t.isPerpetualLicenseExpired||t.isAnnualLicenseExpired){if(t.isInternalLicense)throw new Error("License: Internal license expired.");return!0}return!1}const CN=E.createContext({}),jQ=()=>E.useContext(CN);function DQ({licenseKey:t,children:e}){const[n]=E.useState(()=>new _S(t));return p.jsx(CN.Provider,{value:n,children:e})}function kl(t){if(!t)throw Error("usePassThroughWheelEvents must be passed a ref");const e=zn();E.useEffect(()=>{function n(i){if(i.isSpecialRedispatchedEvent)return;const s=t.current;if(s&&s.scrollHeight>s.clientHeight)return;Je(i);const o=e.querySelector(".tl-canvas");if(!o)return;const l=new WheelEvent("wheel",i);l.isSpecialRedispatchedEvent=!0,o.dispatchEvent(l)}const r=t.current;if(r)return r.addEventListener("wheel",n,{passive:!1}),()=>{r.removeEventListener("wheel",n)}},[e,t])}const LQ='<svg xmlns="http://www.w3.org/2000/svg" width="3001" height="1000" fill="none"><path fill="#000" d="M590.656 300.449c0 49.706-40.294 90-90 90-49.705 0-90-40.294-90-90 0-49.705 40.295-90 90-90 49.706 0 90 40.295 90 90M569.431 719.011c-15.247 32.821-56.006 91.589-98.338 91.438-32.004-.115-38.642-30.904-17.414-50.856 17.381-16.337 28.246-48.075 31.995-72.719.415-2.728-1.556-5.197-4.272-5.679-39.666-7.04-70.746-40.877-70.746-83.417 0-48.23 38.983-87.329 87.07-87.329 39.936 0 70.172 22.237 83.369 52.397 18.839 43.055 7.117 115.733-11.664 156.165M2613.29 385.681V239.319c0-11.363 9.22-20.569 20.59-20.569h8.26c11.37 0 20.59 9.206 20.59 20.569v36.911c0 8.629 7 15.625 15.63 15.625h35.25c8.63 0 15.63-6.996 15.63-15.625v-36.911c0-11.363 9.22-20.569 20.59-20.569h8.17c11.37 0 20.59 9.206 20.59 20.569v146.362c0 11.363-9.22 20.569-20.59 20.569h-8.17c-11.37 0-20.59-9.206-20.59-20.569v-36.999c0-8.63-7-15.625-15.63-15.625h-35.25c-8.63 0-15.63 6.995-15.63 15.625v36.999c0 11.363-9.22 20.569-20.59 20.569h-8.26c-11.37 0-20.59-9.206-20.59-20.569M2391.97 239.319v146.362c0 11.348-9.16 20.569-20.49 20.569h-8.2c-11.33 0-20.49-9.221-20.49-20.569V239.319c0-11.348 9.16-20.569 20.49-20.569h8.2c11.33 0 20.49 9.221 20.49 20.569M2098.23 391.43l-42.69-146.361c-3.85-13.171 6.06-26.319 19.79-26.319h10.6c9.59 0 17.93 6.611 20.08 15.952l17.01 73.045c1.48 6.348 10.47 6.478 12.14.176l19.47-73.838c2.38-9.04 10.57-15.335 19.93-15.335h12.1c9.37 0 17.56 6.3 19.94 15.346l19.49 74.067c1.66 6.305 10.65 6.178 12.13-.171l17.09-73.294c2.15-9.339 10.49-15.948 20.08-15.948h10.53c13.72 0 23.63 13.141 19.79 26.31l-42.63 146.361c-2.56 8.789-10.63 14.829-19.79 14.829h-15.68c-9.12 0-17.16-5.98-19.76-14.709l-21.17-71.059c-1.77-5.948-10.19-5.957-11.97-.012l-21.33 71.071c-2.6 8.729-10.64 14.709-19.76 14.709h-15.59c-9.17 0-17.23-6.035-19.8-14.82M2443.23 218.75h118.59c11.38 0 20.62 9.195 20.62 20.557s-9.24 20.556-20.62 20.556h-24.79c-5.53 0-10 4.477-10 10v115.818c0 11.368-9.25 20.569-20.63 20.569h-7.65c-11.39 0-20.63-9.201-20.63-20.569V269.863c0-5.523-4.48-10-10-10h-24.89c-11.37 0-20.61-9.195-20.61-20.556s9.24-20.557 20.61-20.557M1174.15 218.75h24.64c8.35 0 15.88 5.042 19.04 12.764l34.61 83.942c2.13 5.161 9.44 5.155 11.56-.01l34.43-83.932a20.58 20.58 0 0 1 19.04-12.764h24.64c11.37 0 20.58 9.208 20.58 20.569v146.362c0 11.361-9.21 20.569-20.58 20.569h-7.09c-11.36 0-20.58-9.208-20.58-20.569l-.12-50.645c-.01-6.888-9.53-8.688-12.06-2.283l-23.46 59.332a20.57 20.57 0 0 1-19.14 13.009h-3.03a20.57 20.57 0 0 1-19.15-13.046l-23.47-59.68c-2.52-6.416-12.05-4.623-12.06 2.271l-.13 51.042c0 11.361-9.21 20.569-20.57 20.569h-7.1c-11.36 0-20.57-9.208-20.57-20.569V239.319c0-11.361 9.21-20.569 20.57-20.569"/><path fill="#000" fill-rule="evenodd" d="m1449.94 391.836 6.12-19.392a6.255 6.255 0 0 1 5.96-4.369l50.22-.061a6.24 6.24 0 0 1 5.96 4.348l6.23 19.486c2.71 8.581 10.71 14.402 19.74 14.402h9.34c14.13 0 24.15-13.791 19.61-27.151l-49.74-146.361c-2.85-8.37-10.74-13.988-19.61-13.988h-33.16c-8.87 0-16.77 5.618-19.61 13.988l-49.74 146.361c-4.54 13.36 5.48 27.151 19.61 27.151h9.32c9.04 0 17.04-5.827 19.75-14.414m31.1-98.858c1.85-5.807 10.08-5.796 11.91.016l8.83 27.916c1.28 4.028-1.73 8.134-5.96 8.134h-17.74c-4.23 0-7.24-4.119-5.95-8.151zM1681.81 406.25c18.91 0 35.39-3.686 49.36-11.168 13.97-7.544 24.73-18.394 32.24-32.489 7.56-14.105 11.29-30.866 11.29-50.182 0-19.256-3.73-35.957-11.29-50.004-7.57-14.094-18.35-24.912-32.32-32.397-13.91-7.545-30.4-11.26-49.37-11.26h-49.5c-11.38 0-20.63 9.201-20.63 20.569v146.362c0 11.368 9.25 20.569 20.63 20.569zm23.13-47.701c-6.62 3.215-14.85 4.886-24.79 4.886-10.49 0-19-8.507-19-19v-64.34c0-10.149 8.23-18.376 18.38-18.376 10.18 0 18.56 1.703 25.23 4.974 6.59 3.149 11.63 8.315 15.08 15.633 3.45 7.269 5.28 17.268 5.28 30.162 0 12.891-1.82 22.951-5.28 30.347-3.39 7.319-8.36 12.509-14.9 15.714" clip-rule="evenodd"/><path fill="#000" d="M1804.21 385.681V239.319c0-11.361 9.21-20.569 20.58-20.569h91.28c11.36 0 20.57 9.202 20.57 20.557s-9.21 20.556-20.57 20.556h-54.64a7.807 7.807 0 0 0-7.81 7.813v16.366a7.806 7.806 0 0 0 7.81 7.812h48.13c11.37 0 20.58 9.246 20.58 20.602s-9.21 20.601-20.58 20.601h-48.13a7.806 7.806 0 0 0-7.81 7.812v16.455a7.807 7.807 0 0 0 7.81 7.813h54.64c11.36 0 20.57 9.202 20.57 20.556s-9.21 20.557-20.57 20.557h-91.28c-11.37 0-20.58-9.208-20.58-20.569"/><path fill="#000" fill-rule="evenodd" d="M2875.5 68.75h-2750c-31.066 0-56.25 25.184-56.25 56.25v750c0 31.066 25.184 56.25 56.25 56.25h2750c31.07 0 56.25-25.184 56.25-56.25V125c0-31.066-25.18-56.25-56.25-56.25M125.5 0C56.464 0 .5 55.964.5 125v750c0 69.036 55.965 125 125 125h2750c69.04 0 125-55.964 125-125V125c0-69.036-55.96-125-125-125z" clip-rule="evenodd"/><path fill="#000" d="M2476.06 804.813c-10.54 0-19.82-6.947-22.81-17.068L2390.79 575.7c-4.49-15.248 6.92-30.534 22.8-30.534h27.75c11.1 0 20.72 7.686 23.18 18.52L2489 671.402c2.07 9.093 14.93 9.321 17.32.308l28.83-108.844c2.76-10.435 12.19-17.7 22.98-17.7h25.17c10.8 0 20.25 7.293 22.99 17.755l28.27 107.739c2.36 9.001 15.18 8.829 17.3-.232l25.01-106.888c2.51-10.763 12.1-18.374 23.14-18.374h27.87c15.88 0 27.29 15.286 22.8 30.534l-62.46 212.045a23.78 23.78 0 0 1-22.81 17.068h-32.12c-10.39 0-19.58-6.763-22.69-16.696l-32.08-102.694c-2.62-8.397-14.51-8.331-17.04.095l-30.74 102.346c-3.02 10.061-12.27 16.949-22.76 16.949zM1742.44 804.813h-75.81c-13.09 0-23.71-10.656-23.71-23.801V568.967c0-13.145 10.62-23.801 23.71-23.801h74.8c26.6 0 49.59 5.198 68.95 15.594 19.45 10.312 34.44 25.187 44.96 44.627 10.61 19.355 15.91 42.556 15.91 69.602q0 40.57-15.78 69.73c-10.53 19.355-25.43 34.231-44.71 44.627-19.28 10.311-42.05 15.467-68.32 15.467m-29.3-83.642c0 13.145 10.61 23.801 23.71 23.801h3.06c12.8 0 23.7-2.07 32.71-6.212 9.09-4.141 16-11.283 20.71-21.426q7.2-15.213 7.2-42.345 0-27.13-7.32-42.344c-4.8-10.143-11.87-17.285-21.22-21.426-9.26-4.142-20.63-6.212-34.1-6.212h-1.04c-13.1 0-23.71 10.656-23.71 23.801zM1460.86 804.813c-13.12 0-23.76-10.656-23.76-23.801V568.967c0-13.145 10.64-23.801 23.76-23.801h22.84c13.13 0 23.76 10.656 23.76 23.801v155.247c0 13.145 10.64 23.801 23.76 23.801h57.27c13.12 0 23.76 10.656 23.76 23.801v9.196c0 13.145-10.64 23.801-23.76 23.801zM1204.45 601.964c-13.13 0-23.77-10.656-23.77-23.801v-9.196c0-13.145 10.64-23.801 23.77-23.801h177.89c13.13 0 23.78 10.656 23.78 23.801v9.196c0 13.145-10.65 23.801-23.78 23.801h-39.38c-8.21 0-14.86 6.66-14.86 14.875v164.173c0 13.145-10.64 23.801-23.78 23.801h-21.85c-13.13 0-23.78-10.656-23.78-23.801V616.839c0-8.215-6.65-14.875-14.86-14.875z"/><path fill="#000" fill-rule="evenodd" d="M2223.05 787.891c-3.02 10.047-12.27 16.922-22.74 16.922h-25.43c-16.19 0-27.64-15.862-22.57-31.261l69.88-212.045c3.21-9.753 12.31-16.341 22.56-16.341h61.84c10.25 0 19.35 6.588 22.56 16.341l69.87 212.045c5.08 15.399-6.37 31.261-22.56 31.261h-25.43c-10.48 0-19.72-6.875-22.74-16.922l-6.7-22.2a14.84 14.84 0 0 0-14.21-10.576h-63.42c-6.55 0-12.32 4.296-14.22 10.576zm76.13-96.945-14.13-48.436c-2.46-8.451-14.36-8.602-17.04-.217l-15.46 48.436c-1.84 5.759 2.45 11.645 8.48 11.645h29.6c5.94 0 10.22-5.715 8.55-11.428" clip-rule="evenodd"/><path fill="#000" d="M1939.6 804.813c-13.13 0-23.77-10.656-23.77-23.801V568.967c0-13.145 10.64-23.801 23.77-23.801h88.13c19.24 0 36.08 3.508 50.51 10.523s25.65 17.115 33.67 30.3q12.03 19.779 12.03 47.416c0 18.595-4.14 34.273-12.41 47.036-7.64 11.913-18.18 21.101-31.63 27.564-16.98 8.159-36 11.104-54.7 11.104h-43.07c-76.56 0 4.08-135.84 4.08-84.706v7.996c0 12.117 9.81 21.941 21.91 21.941 8.12 0 16.3-.345 24.04-3.043 5.91-2.113 10.43-5.451 13.55-10.015 3.2-4.565 4.81-10.523 4.81-17.877 0-7.437-1.61-13.481-4.81-18.129-3.12-4.733-7.64-8.199-13.55-10.396-7.05-2.766-14.67-3.423-22.18-3.423-13.13 0-23.77 10.656-23.77 23.801v47.71c0 11.825 11.14 16.003 19.91 20.752 12.31 6.671 7.58 25.389-6.42 25.389-7.45 0-13.49 6.048-13.49 13.508v48.395c0 13.145-10.63 23.801-23.76 23.801zm134.89-106.758 5.41 9.95 33.51 61.622c8.62 15.86-2.84 35.186-20.87 35.186h-22.27c-8.74 0-16.77-4.798-20.92-12.496l-35.05-65.04a15.52 15.52 0 0 0-13.66-8.168c-42.24 0 40.62-82.154 73.85-21.054M931.652 0h68.748v1000h-68.748z"/></svg>',NQ='<svg xmlns="http://www.w3.org/2000/svg" width="400" height="1601" fill="none"><path fill="#000" d="M72 1319.8c0-10.73 7.071-20.18 17.372-23.22l215.823-63.62c15.519-4.57 31.078 7.05 31.078 23.22v28.26c0 11.31-7.824 21.1-18.85 23.61l-109.636 24.94c-9.254 2.1-9.487 15.2-.313 17.63l110.784 29.37a24.21 24.21 0 0 1 18.015 23.4v25.64c0 11-7.423 20.62-18.071 23.41l-109.659 28.79c-9.162 2.41-8.986 15.47.236 17.63l108.792 25.46c10.955 2.56 18.702 12.33 18.702 23.57v28.39c0 16.17-15.559 27.79-31.078 23.22l-215.823-63.62c-10.3-3.04-17.372-12.49-17.372-23.22v-32.72c0-10.59 6.883-19.95 16.994-23.11l104.523-32.67c8.547-2.67 8.479-14.79-.096-17.36l-104.17-31.3C79.01 1372.42 72 1363 72 1352.31zM72 572.638V495.43c0-13.336 10.846-24.147 24.225-24.147h215.823c13.379 0 24.225 10.811 24.225 24.147v76.179q0 40.645-15.872 70.228-15.743 29.712-45.422 45.79-29.55 16.206-70.843 16.206-41.292 0-70.971-16.078-29.55-16.077-45.422-45.532Q72 612.767 72 572.638m85.132-29.84c-13.379 0-24.225 10.81-24.225 24.146v3.122q0 19.55 6.323 33.313 6.323 13.89 21.807 21.094 15.485 7.332 43.099 7.331t43.1-7.46q15.484-7.33 21.807-21.608 6.323-14.15 6.323-34.728v-1.064c0-13.336-10.846-24.146-24.225-24.146zM72 285.858c0-13.363 10.846-24.197 24.225-24.197h215.823c13.379 0 24.225 10.834 24.225 24.197v23.27c0 13.364-10.846 24.197-24.225 24.197H154.035c-13.379 0-24.225 10.834-24.225 24.197v58.328c0 13.364-10.846 24.197-24.225 24.197h-9.36C82.845 440.047 72 429.214 72 415.85zM278.463 24.72c0-13.374 10.846-24.216 24.225-24.216h9.36c13.379 0 24.225 10.842 24.225 24.216v181.174c0 13.374-10.846 24.216-24.225 24.216h-9.36c-13.379 0-24.225-10.842-24.225-24.216v-40.108c0-8.359-6.779-15.135-15.141-15.135H96.225c-13.38 0-24.225-10.842-24.225-24.216v-22.256c0-13.374 10.846-24.216 24.225-24.216h167.097c8.362 0 15.141-6.776 15.141-15.135z"/><path fill="#000" fill-rule="evenodd" d="M89.224 1062.13C78.997 1059.04 72 1049.63 72 1038.96v-25.9c0-16.486 16.145-28.147 31.818-22.979l215.823 71.169a24.19 24.19 0 0 1 16.632 22.98v62.97c0 10.45-6.706 19.71-16.632 22.98l-215.823 71.17C88.145 1246.51 72 1234.86 72 1218.37v-25.9c0-10.67 6.997-20.08 17.224-23.17l22.595-6.81a15.13 15.13 0 0 0 10.765-14.48v-64.59a15.13 15.13 0 0 0-10.765-14.48zm98.672 77.53 49.299-14.39c8.601-2.51 8.755-14.62.22-17.35l-49.299-15.75c-5.861-1.88-11.852 2.49-11.852 8.64v30.14c0 6.05 5.817 10.41 11.632 8.71" clip-rule="evenodd"/><path fill="#000" d="M72 773.439c0-13.367 10.846-24.203 24.225-24.203h215.823c13.379 0 24.225 10.836 24.225 24.203v89.762q0 29.395-10.711 51.439-10.71 22.046-30.84 34.293t-48.261 12.248q-28.388 0-47.873-12.635-18.187-11.672-28.056-32.218c-8.303-17.289-11.301-36.661-11.301-55.705v-43.867c0-77.976 138.26 4.16 86.215 4.16h-8.138c-12.334 0-22.332 9.989-22.332 22.311 0 8.269.351 16.6 3.097 24.487q3.225 9.024 10.194 13.794 6.968 4.899 18.194 4.899 11.356 0 18.453-4.899 7.226-4.77 10.581-13.794c2.815-7.188 3.484-14.944 3.484-22.596 0-13.366-10.846-24.202-24.225-24.202h-48.56c-12.036 0-16.288 11.345-21.122 20.272-6.79 12.539-25.841 7.72-25.841-6.536 0-7.586-6.156-13.736-13.749-13.736H96.225C82.845 820.916 72 810.08 72 796.714zm108.66 137.378-10.128 5.511-62.72 34.131C91.67 959.243 72 947.569 72 929.205V906.52a24.2 24.2 0 0 1 12.719-21.299l66.199-35.696a15.82 15.82 0 0 0 8.313-13.921c0-43.012 83.618 41.371 21.429 75.213"/></svg>';function zQ(t){return oe("watermarkState",()=>t.state.get(),[t])}const $Q=`data:image/svg+xml;utf8,${encodeURIComponent(LQ)}`,BQ=`data:image/svg+xml;utf8,${encodeURIComponent(NQ)}`,FQ=E.memo(function(){const e=jQ(),n=re(),r=oe("is mobile",()=>n.getViewportScreenBounds().width<700,[n]),i=zQ(e);return["licensed-with-watermark","unlicensed"].includes(i)?p.jsxs(p.Fragment,{children:[p.jsx(HQ,{}),p.jsx(UQ,{src:r?BQ:$Q})]}):null}),UQ=E.memo(function({src:e}){const n=re(),r=oe("debug mode",()=>n.getInstanceState().isDebugMode,[n]),i=oe("is mobile",()=>n.getViewportScreenBounds().width<700,[n]),s=p2(),o=E.useRef(null);kl(o);const l=`url('${e}') center 100% / 100% no-repeat`,u="https://tldraw.dev";return p.jsx("div",{ref:o,className:_S.className,"data-debug":r,"data-mobile":i,draggable:!1,...s,children:Ft.isWebview?p.jsx("a",{draggable:!1,role:"button",onPointerDown:d=>{_n(d),Je(d)},onClick:()=>hS.openWindow(u,"_blank"),style:{mask:l,WebkitMask:l}}):p.jsx("a",{href:u,target:"_blank",rel:"noreferrer",draggable:!1,onPointerDown:d=>{_n(d)},style:{mask:l,WebkitMask:l}})})}),HQ=E.memo(function(){const e=_S.className,n=`/* ------------------- SEE LICENSE -------------------
The tldraw watermark is part of tldraw's license. It is shown for unlicensed
or "licensed-with-watermark" users. By using this library, you agree to
preserve the watermark's behavior, keeping it visible, unobscured, and
available to user-interaction.

To remove the watermark, please purchase a license at tldraw.dev.
*/

	.${e} {
		position: absolute;
		bottom: var(--space-2);
		right: var(--space-2);
		width: 96px;
		height: 32px;
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: var(--layer-watermark) !important;
		background-color: color-mix(in srgb, var(--color-background) 62%, transparent);
		opacity: 1;
		border-radius: 5px;
		pointer-events: all;
		padding: 2px;
		box-sizing: content-box;
	}

	.${e} > a {
		position: absolute;
		width: 96px;
		height: 32px;
		pointer-events: all;
		cursor: inherit;
		color: var(--color-text);
		opacity: .38;
		background-color: currentColor;
	}

	.${e}[data-debug='true'] {
		bottom: 46px;
	}

	.${e}[data-mobile='true'] {
		border-radius: 4px 0px 0px 4px;
		right: -2px;
		width: 8px;
		height: 48px;
	}

	.${e}[data-mobile='true'] > a {
		width: 8px;
		height: 32px;
	}

	@media (hover: hover) {
		.${e} > a {
			pointer-events: none;
		}

		.${e}:hover {
			background-color: var(--color-background);
			transition: background-color 0.2s ease-in-out;
			transition-delay: 0.32s;
		}

		.${e}:hover > a {
			animation: delayed_link 0.2s forwards ease-in-out;
			animation-delay: 0.32s;
		}
	}

	@keyframes delayed_link {
		0% {
			cursor: inherit;
			opacity: .38;
			pointer-events: none;
		}
		100% {
			cursor: pointer;
			opacity: 1;
			pointer-events: all;
		}
	}`;return p.jsx("style",{children:n})}),KQ=[],GQ=[],qQ=[],YQ="tl-container",VQ=E.memo(function({store:e,components:n,className:r,user:i,options:s,...o}){const[l,u]=E.useState(null),d=E.useMemo(()=>i??v4(),[i]),f=(n==null?void 0:n.ErrorFallback)===void 0?u4:n==null?void 0:n.ErrorFallback,g={...o,shapeUtils:o.shapeUtils??KQ,bindingUtils:o.bindingUtils??GQ,tools:o.tools??qQ,components:n,options:Cd(s)};return p.jsx("div",{ref:u,"data-tldraw":z3,draggable:!1,className:je(`${YQ} tl-theme__light`,r),onPointerDown:_n,tabIndex:-1,children:p.jsx(Of,{fallback:f,onError:m=>T_(m,{tags:{origin:"react.tldraw-before-app"}}),children:l&&p.jsx(DQ,{licenseKey:o.licenseKey,children:p.jsx(H3,{container:l,children:p.jsx(pW,{overrides:n,children:e?e instanceof J_?p.jsx(EN,{...g,store:e,user:d}):p.jsx(_N,{...g,store:e,user:d}):p.jsx(WQ,{...g,store:e,user:d})})})})})})});function WQ(t){const{defaultName:e,snapshot:n,initialData:r,shapeUtils:i,bindingUtils:s,persistenceKey:o,sessionId:l,user:u,assets:d,migrations:f}=t,g=PQ({shapeUtils:i,bindingUtils:s,initialData:r,persistenceKey:o,sessionId:l,defaultName:e,snapshot:n,assets:d,migrations:f});return p.jsx(_N,{...t,store:g,user:u})}const _N=E.memo(function({store:e,user:n,...r}){const i=zn();E.useLayoutEffect(()=>{n.userPreferences.get().colorScheme==="dark"&&(i.classList.remove("tl-theme__light"),i.classList.add("tl-theme__dark"))},[i,n]);const{LoadingScreen:s}=Zt();switch(e.status){case"error":throw e.error;case"loading":return s?p.jsx(s,{}):null}return p.jsx(EN,{...r,store:e.store,user:n})}),Zw=()=>document.location.search.includes("tldraw_preserve_focus");function EN({onMount:t,children:e,store:n,tools:r,shapeUtils:i,bindingUtils:s,user:o,initialState:l,autoFocus:u=!0,inferDarkMode:d,cameraOptions:f,options:g,licenseKey:m,deepLinks:S,isShapeHidden:b}){const{ErrorFallback:v}=Zt(),w=zn(),[C,_]=wN(null),M=E.useRef(null),I=Cd(S===!0?{}:S),A=E.useRef({autoFocus:u&&!Zw(),inferDarkMode:d,initialState:l,cameraOptions:f,deepLinks:I});E.useLayoutEffect(()=>{A.current={autoFocus:u&&!Zw(),inferDarkMode:d,initialState:l,cameraOptions:f,deepLinks:I}},[u,d,l,f,I]),E.useLayoutEffect(()=>{const{autoFocus:L,inferDarkMode:G,initialState:k,cameraOptions:$,deepLinks:F}=A.current,N=new _e({store:n,shapeUtils:i,bindingUtils:s,tools:r,getContainer:()=>w,user:o,initialState:k,autoFocus:L,inferDarkMode:G,cameraOptions:$,options:g,licenseKey:m,isShapeHidden:b});return N.updateViewportScreenBounds(M.current??w),F&&(F!=null&&F.getUrl?N.navigateToDeepLink({...F,url:F.getUrl(N)}):N.navigateToDeepLink(F)),_(N),()=>{N.dispose()}},[s,w,g,i,n,r,o,_,m,b]),E.useLayoutEffect(()=>{if(C&&I)return C.registerDeepLinkListener(I)},[C,I]),E.useLayoutEffect(()=>{C&&f&&C.setCameraOptions(f)},[C,f]);const R=E.useSyncExternalStore(E.useCallback(L=>C?(C.on("crash",L),()=>C.off("crash",L)):()=>{},[C]),()=>(C==null?void 0:C.getCrashingError())??null);E.useEffect(function(){if(!C)return;function G(){C&&C.focus()}function k(){C&&C.blur()}if(u&&Zw())return C.getContainer().addEventListener("pointerdown",G),document.body.addEventListener("pointerdown",k),()=>{var $;($=C.getContainer())==null||$.removeEventListener("pointerdown",G),document.body.removeEventListener("pointerdown",k)}},[C,u]);const{Canvas:D}=Zt();return C?p.jsx(Of,{fallback:v,onError:L=>C.annotateError(L,{origin:"react.tldraw",willCrashApp:!0}),children:R?p.jsx(ZQ,{crashingError:R}):p.jsx(h2,{editor:C,children:p.jsxs(XQ,{onMount:t,children:[e??(D?p.jsx(D,{},C.contextId):null),p.jsx(FQ,{})]})})}):p.jsx("div",{className:"tl-canvas",ref:M})}function XQ({children:t,onMount:e}){return TQ(),hQ(),fQ(),pQ(),TN(n=>{const r=n.store.props.onMount(n),i=e==null?void 0:e(n);return()=>{r==null||r(),i==null||i()}}),t}function ZQ({crashingError:t}){throw t}function R2({children:t}){return p.jsx("div",{className:"tl-loading",children:t})}function PN({children:t}){return p.jsx("div",{className:"tl-loading",children:t})}function TN(t){const e=re(),n=SS(r=>{let i;return r.run(()=>{i=t==null?void 0:t(r),r.emit("mount")},{history:"ignore"}),window.tldrawReady=!0,i});et.useLayoutEffect(()=>{if(e)return n==null?void 0:n(e)},[e,n])}function ks({children:t,className:e="",...n}){return p.jsx("div",{...n,className:je("tl-html-container",e),children:t})}class Tm{constructor(e){this.editor=e}}O(Tm,"props"),O(Tm,"migrations"),O(Tm,"type");function Nc(t,e,n={}){const{newPoint:r,handle:i,scaleX:s,scaleY:o}=e,{minWidth:l=1,maxWidth:u=1/0,minHeight:d=1,maxHeight:f=1/0}=n;let g=t.props.w*s,m=t.props.h*o;const S=new T(0,0);if(g>0){if(g<l){switch(i){case"top_left":case"left":case"bottom_left":{S.x=g-l;break}case"top":case"bottom":{S.x=(g-l)/2;break}default:S.x=0}g=l}}else if(S.x=g,g=-g,g<l){switch(i){case"top_left":case"left":case"bottom_left":{S.x=-g;break}default:S.x=-l}g=l}if(m>0){if(m<d){switch(i){case"top_left":case"top":case"top_right":{S.y=m-d;break}case"right":case"left":{S.y=(m-d)/2;break}default:S.y=0}m=d}}else if(S.y=m,m=-m,m<d){switch(i){case"top_left":case"top":case"top_right":{S.y=-m;break}default:S.y=-d}m=d}const{x:b,y:v}=S.rot(t.rotation).add(r);return{...t,x:b,y:v,props:{w:Math.min(u,g),h:Math.min(f,m)}}}class Id extends si{getGeometry(e){return new Rr({width:e.props.w,height:e.props.h,isFilled:!0})}onResize(e,n){return Nc(e,n)}getHandleSnapGeometry(e){return{points:this.getGeometry(e).bounds.cornersAndCenter}}getInterpolatedProps(e,n,r){return{...n.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r)}}}var k1;let QQ=(k1=class extends Ae{onPointerDown(e){this.parent.transition("pointing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onCancel(){this.editor.setCurrentTool("select")}},O(k1,"id","idle"),k1);var R1;let JQ=(R1=class extends Ae{onPointerMove(e){if(this.editor.inputs.isDragging){const{originPagePoint:n}=this.editor.inputs,r=this.parent.shapeType,i=Lt(),s=this.editor.markHistoryStoppingPoint(`creating_box:${i}`),o=Rs(n,this.editor);this.editor.createShapes([{id:i,type:r,x:o.x,y:o.y,props:{w:1,h:1}}]).select(i);const l=this.parent;this.editor.setCurrentTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creatingMarkId:s,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:l.onCreate?u=>{var d;return(d=l.onCreate)==null?void 0:d.call(l,u)}:void 0})}}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.complete()}onInterrupt(){this.cancel()}complete(){const{originPagePoint:e}=this.editor.inputs,n=this.parent.shapeType,r=Lt();this.editor.markHistoryStoppingPoint(`creating_box:${r}`),this.editor.createShapes([{id:r,type:n,x:e.x,y:e.y}]);const i=this.editor.getShape(r);if(!i){this.cancel();return}let{w:s,h:o}=i.props;const l=new T(s/2,o/2),u=this.editor.getShapeParentTransform(i);u&&l.rot(-u.rotation());let d=1;this.editor.user.getIsDynamicResizeMode()&&(d=1/this.editor.getZoomLevel(),s*=d,o*=d,l.mul(d));const f=Xt(i),g=Rs(new T(i.x-l.x,i.y-l.y),this.editor);f.x=g.x,f.y=g.y,f.props.w=s,f.props.h=o,"scale"in i.props&&(f.props.scale=d),this.editor.updateShape(f),this.editor.setSelectedShapes([r]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},O(R1,"id","pointing"),R1);function Rs(t,e){const n=e.getInstanceState().isGridMode,r=e.getDocumentSettings().gridSize;return n?t.clone().snapToGrid(r):t.clone()}class _C extends Ae{static children(){return[QQ,JQ]}}O(_C,"id","box"),O(_C,"initial","idle");function eJ(t,e,n){const r=E.useRef(!1),i=E.useCallback(o=>{r.current=o,o?Es.addOpenMenu(t):Es.deleteOpenMenu(t),e==null||e(o)},[t,e]),s=oe("is menu open",()=>Es.getOpenMenus().includes(t),[t]);return E.useEffect(()=>(r.current&&(n==null||n("open-menu"),Es.addOpenMenu(t)),()=>{r.current&&(Es.deleteOpenMenu(t),Es.getOpenMenus().forEach(o=>{o.startsWith(t)&&(n==null||n("close-menu"),Es.deleteOpenMenu(o))}),r.current=!1)}),[t,n]),[s,i]}function ES(t){const e=re();return oe("isEditing",()=>e.getEditingShapeId()===t,[e,t])}function Js(t){const e=re();return E.useMemo(function(){const i=d=>{if(d.isKilled)return;if(d.button===f2){e.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...xi(d)});return}if(d.button!==0)return;const f=Py(d.currentTarget);function g(){f.removeEventListener("pointerup",g),rp(f,d)}np(f,d),f.addEventListener("pointerup",g),e.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...xi(d)}),_n(d)};let s,o;function l(d){d.isKilled||d.button===0&&(d.clientX===s&&d.clientY===o||(s=d.clientX,o=d.clientY,e.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...xi(d)})))}return{onPointerDown:i,onPointerMove:l,onPointerUp:d=>{d.isKilled||d.button===0&&e.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...xi(d)})}}},[e,t])}function tJ(t){const[e,n]=E.useState(()=>({store:My(t),opts:t}));if(!$D(e.opts,t)){const r={store:My(t),opts:t};return n(r),r.store}return e.store}const nJ=20,rJ=8;function O2(t,e=nJ){return Math.max(rJ,Math.ceil(t/e))}class Yu extends Al{constructor(n){super({...n,isFilled:!1,isClosed:!1});O(this,"_center");O(this,"radius");O(this,"start");O(this,"end");O(this,"largeArcFlag");O(this,"sweepFlag");O(this,"measure");O(this,"angleStart");O(this,"angleEnd");const{center:r,sweepFlag:i,largeArcFlag:s,start:o,end:l}=n;if(o.equals(l))throw Error("Arc must have different start and end points.");this.angleStart=T.Angle(r,o),this.angleEnd=T.Angle(r,l),this.radius=T.Dist(r,o),this.measure=hG(this.angleStart,this.angleEnd,i,s),this.start=o,this.end=l,this.sweepFlag=i,this.largeArcFlag=s,this._center=r}nearestPoint(n){const{_center:r,measure:i,radius:s,angleEnd:o,angleStart:l,start:u,end:d}=this,f=iC(i,l,o,r.angle(n));if(f<=0)return u;if(f>=1)return d;const g=r.clone().add(n.clone().sub(r).uni().mul(s));let m,S=1/0,b;for(const v of[u,d,g])b=T.Dist2(n,v),b<S&&(m=v,S=b);if(!m)throw Error("nearest point not found");return m}hitTestLineSegment(n,r){const{_center:i,radius:s,measure:o,angleStart:l,angleEnd:u}=this,d=op(n,r,i,s);return d===null?!1:d.some(f=>{const g=iC(o,l,u,i.angle(f));return g>=0&&g<=1})}getVertices(){const{_center:n,measure:r,length:i,radius:s,angleStart:o}=this,l=[];for(let u=0,d=O2(Math.abs(i));u<d+1;u++){const f=u/d*r,g=o+f;l.push(bc(n,s,g))}return l}getSvgPathData(n=!0){const{start:r,end:i,radius:s,largeArcFlag:o,sweepFlag:l}=this;return`${n?`M${r.toFixed()}`:""} A${s} ${s} 0 ${o} ${l} ${i.toFixed()}`}getLength(){return this.measure*this.radius}}class j2 extends Al{constructor(n){super({isClosed:!0,...n});O(this,"_center");O(this,"radius");O(this,"x");O(this,"y");this.config=n;const{x:r=0,y:i=0,radius:s}=n;this.x=r,this.y=i,this._center=new T(s+r,s+i),this.radius=s}getBounds(){return new xe(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:n,radius:r}=this,i=It*r,s=[];for(let o=0,l=O2(i);o<l;o++){const u=o/l*It;s.push(bc(n,r,u))}return s}nearestPoint(n){const{_center:r,radius:i}=this;return r.equals(n)?T.AddXY(r,i,0):r.clone().add(n.clone().sub(r).uni().mul(i))}hitTestLineSegment(n,r,i=0){const{_center:s,radius:o}=this;return op(n,r,s,o+i)!==null}getSvgPathData(){const{_center:n,radius:r}=this;return`M${n.x+r},${n.y} a${r},${r} 0 1,0 ${r*2},0a${r},${r} 0 1,0 -${r*2},0`}}class Sr extends _d{constructor(n){const{start:r,cp1:i,cp2:s,end:o}=n;super({...n,points:[r,o]});O(this,"a");O(this,"b");O(this,"c");O(this,"d");this.a=r,this.b=i,this.c=s,this.d=o}getVertices(){const n=[],{a:r,b:i,c:s,d:o}=this;for(let l=0,u=10;l<=u;l++){const d=l/u;n.push(new T((1-d)*(1-d)*(1-d)*r.x+3*((1-d)*(1-d))*d*i.x+3*(1-d)*(d*d)*s.x+d*d*d*o.x,(1-d)*(1-d)*(1-d)*r.y+3*((1-d)*(1-d))*d*i.y+3*(1-d)*(d*d)*s.y+d*d*d*o.y))}return n}midPoint(){return Sr.GetAtT(this,.5)}nearestPoint(n){let r,i=1/0,s,o;for(const l of this.segments)o=l.nearestPoint(n),s=T.Dist2(o,n),s<i&&(r=o,i=s);if(!r)throw Error("nearest point not found");return r}getSvgPathData(n=!0){const{a:r,b:i,c:s,d:o}=this;return`${n?`M ${r.toFixed()} `:""} C${i.toFixed()} ${s.toFixed()} ${o.toFixed()}`}static GetAtT(n,r){const{a:i,b:s,c:o,d:l}=n;return new T((1-r)*(1-r)*(1-r)*i.x+3*((1-r)*(1-r))*r*s.x+3*(1-r)*(r*r)*o.x+r*r*r*l.x,(1-r)*(1-r)*(1-r)*i.y+3*((1-r)*(1-r))*r*s.y+3*(1-r)*(r*r)*o.y+r*r*r*l.y)}getLength(n=32){let r,i=this.a,s=0;for(let o=1;o<=n;o++)r=Sr.GetAtT(this,o/n),s+=T.Dist(i,r),i=r;return s}}class iJ extends Al{constructor(n){super({...n,isClosed:!1,isFilled:!1});O(this,"points");O(this,"_segments");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:n}=this,r=n.length,i=r-2,s=1.25;for(let o=0;o<r-1;o++){const l=o===0?n[0]:n[o-1],u=n[o],d=n[o+1],f=o===i?d:n[o+2],g=u,m=o===0?l:new T(u.x+(d.x-l.x)/6*s,u.y+(d.y-l.y)/6*s),S=o===i?d:new T(d.x-(f.x-u.x)/6*s,d.y-(f.y-u.y)/6*s),b=d;this._segments.push(new Sr({start:g,cp1:m,cp2:S,end:b}))}}return this._segments}getLength(){return this.segments.reduce((n,r)=>n+r.length,0)}getVertices(){const n=this.segments.reduce((r,i)=>r.concat(i.vertices),[]);return n.push(this.points[this.points.length-1]),n}nearestPoint(n){let r,i=1/0,s,o;for(const l of this.segments)o=l.nearestPoint(n),s=T.Dist2(o,n),s<i&&(r=o,i=s);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.segments.some(i=>i.hitTestLineSegment(n,r))}getSvgPathData(){let n=this.segments.reduce((r,i,s)=>r+i.getSvgPathData(s===0),"");return this.isClosed&&(n+="Z"),n}}class sJ extends Al{constructor(n){super({...n,isClosed:!0});O(this,"w");O(this,"h");O(this,"_edges");this.config=n;const{width:r,height:i}=n;this.w=r,this.h=i}get edges(){if(!this._edges){const{vertices:n}=this;this._edges=[];for(let r=0,i=n.length;r<i;r++){const s=n[r],o=n[(r+1)%i];this._edges.push(new ua({start:s,end:o}))}}return this._edges}getVertices(){const n=Math.max(1,this.w),r=Math.max(1,this.h),i=n/2,s=r/2,o=Math.pow(i-s,2)/Math.pow(i+s,2),l=yt*(i+s)*(1+3*o/(10+Math.sqrt(4-3*o))),u=O2(l),d=It/u,f=Math.cos(d),g=Math.sin(d);let m=0,S=1,b=0,v=1;const w=Array(u);for(let C=0;C<u;C++)w[C]=new T(i+i*S,s+s*m),b=g*S+f*m,v=f*S-g*m,m=b,S=v;return w}nearestPoint(n){let r,i=1/0,s,o;for(const l of this.edges)o=l.nearestPoint(n),s=T.Dist2(o,n),s<i&&(r=o,i=s);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.edges.some(i=>i.hitTestLineSegment(n,r))}getBounds(){return new xe(0,0,this.w,this.h)}getLength(){const{w:n,h:r}=this,i=n/2,s=r/2,o=Math.max(0,i),l=Math.max(0,s);return $5(o,l)}getSvgPathData(n=!1){const{w:r,h:i}=this,s=r/2,o=i/2,l=Math.max(0,s),u=Math.max(0,o);return`${n?`M${s-l},${o}`:""} a${l},${u},0,1,1,${l*2},0a${l},${u},0,1,1,-${l*2},0`}}class oJ extends Al{constructor(n){super({...n,isClosed:!0});O(this,"w");O(this,"h");O(this,"a");O(this,"b");O(this,"c");O(this,"d");this.config=n;const{width:r,height:i}=n;if(this.w=r,this.h=i,i>r){const s=r/2;this.a=new Yu({start:new T(0,s),end:new T(r,s),center:new T(r/2,s),sweepFlag:1,largeArcFlag:1}),this.b=new ua({start:new T(r,s),end:new T(r,i-s)}),this.c=new Yu({start:new T(r,i-s),end:new T(0,i-s),center:new T(r/2,i-s),sweepFlag:1,largeArcFlag:1}),this.d=new ua({start:new T(0,i-s),end:new T(0,s)})}else{const s=i/2;this.a=new Yu({start:new T(s,i),end:new T(s,0),center:new T(s,s),sweepFlag:1,largeArcFlag:1}),this.b=new ua({start:new T(s,0),end:new T(r-s,0)}),this.c=new Yu({start:new T(r-s,0),end:new T(r-s,i),center:new T(r-s,s),sweepFlag:1,largeArcFlag:1}),this.d=new ua({start:new T(r-s,i),end:new T(s,i)})}}nearestPoint(n){let r,i=1/0,s,o;const{a:l,b:u,c:d,d:f}=this;for(const g of[l,u,d,f])o=g.nearestPoint(n),s=T.Dist2(o,n),s<i&&(r=o,i=s);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){const{a:i,b:s,c:o,d:l}=this;return[i,s,o,l].some(u=>u.hitTestLineSegment(n,r))}getVertices(){const{a:n,b:r,c:i,d:s}=this;return[n,r,i,s].reduce((o,l)=>(o.push(...l.vertices),o),[])}getBounds(){return new xe(0,0,this.w,this.h)}getLength(){const{h:n,w:r}=this;return n>r?(yt*(r/2)+(n-r))*2:(yt*(n/2)+(r-n))*2}getSvgPathData(){const{a:n,b:r,c:i,d:s}=this;return[n,r,i,s].map((o,l)=>o.getSvgPathData(l===0)).join(" ")+" Z"}}async function aJ({shouldReload:t=!0}={}){DH();for(const e of fy.connectedInstances)await e.close();await Promise.all(Z_().map(e=>q5(e))),jH(),t&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=aJ);function lJ(t,e="_blank"){hS.openWindow(t,e)}El("@tldraw/editor","3.8.1","esm");function IN(){const[t,e]=E.useState(!1);return E.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{e(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),t}const MN=()=>{},AN=E.createContext(null);function cJ({onEvent:t,children:e}){return p.jsx(AN.Provider,{value:t??MN,children:e})}function or(){return E.useContext(AN)??MN}function Re(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function uJ(t,e){const n=E.createContext(e),r=s=>{const{children:o,...l}=s,u=E.useMemo(()=>l,Object.values(l));return p.jsx(n.Provider,{value:u,children:o})};r.displayName=t+"Provider";function i(s){const o=E.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[r,i]}function _o(t,e=[]){let n=[];function r(s,o){const l=E.createContext(o),u=n.length;n=[...n,o];const d=g=>{var C;const{scope:m,children:S,...b}=g,v=((C=m==null?void 0:m[t])==null?void 0:C[u])||l,w=E.useMemo(()=>b,Object.values(b));return p.jsx(v.Provider,{value:w,children:S})};d.displayName=s+"Provider";function f(g,m){var v;const S=((v=m==null?void 0:m[t])==null?void 0:v[u])||l,b=E.useContext(S);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${g}\` must be used within \`${s}\``)}return[d,f]}const i=()=>{const s=n.map(o=>E.createContext(o));return function(l){const u=(l==null?void 0:l[t])||s;return E.useMemo(()=>({[`__scope${t}`]:{...l,[t]:u}}),[l,u])}};return i.scopeName=t,[r,dJ(i,...e)]}function dJ(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((l,{useScope:u,scopeName:d})=>{const g=u(s)[`__scope${d}`];return{...l,...g}},{});return E.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function bO(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function PS(...t){return e=>{let n=!1;const r=t.map(i=>{const s=bO(i,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():bO(t[i],null)}}}}function Vt(...t){return E.useCallback(PS(...t),t)}var Ec=E.forwardRef((t,e)=>{const{children:n,...r}=t,i=E.Children.toArray(n),s=i.find(fJ);if(s){const o=s.props.children,l=i.map(u=>u===s?E.Children.count(o)>1?E.Children.only(null):E.isValidElement(o)?o.props.children:null:u);return p.jsx(EC,{...r,ref:e,children:E.isValidElement(o)?E.cloneElement(o,void 0,l):null})}return p.jsx(EC,{...r,ref:e,children:n})});Ec.displayName="Slot";var EC=E.forwardRef((t,e)=>{const{children:n,...r}=t;if(E.isValidElement(n)){const i=gJ(n),s=pJ(r,n.props);return n.type!==E.Fragment&&(s.ref=e?PS(e,i):i),E.cloneElement(n,s)}return E.Children.count(n)>1?E.Children.only(null):null});EC.displayName="SlotClone";var hJ=({children:t})=>p.jsx(p.Fragment,{children:t});function fJ(t){return E.isValidElement(t)&&t.type===hJ}function pJ(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...l)=>{s(...l),i(...l)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function gJ(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var mJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],gt=mJ.reduce((t,e)=>{const n=E.forwardRef((r,i)=>{const{asChild:s,...o}=r,l=s?Ec:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),p.jsx(l,{...o,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function D2(t,e){t&&Ed.flushSync(()=>t.dispatchEvent(e))}function TS(t){const e=t+"CollectionProvider",[n,r]=_o(e),[i,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=S=>{const{scope:b,children:v}=S,w=et.useRef(null),C=et.useRef(new Map).current;return p.jsx(i,{scope:b,itemMap:C,collectionRef:w,children:v})};o.displayName=e;const l=t+"CollectionSlot",u=et.forwardRef((S,b)=>{const{scope:v,children:w}=S,C=s(l,v),_=Vt(b,C.collectionRef);return p.jsx(Ec,{ref:_,children:w})});u.displayName=l;const d=t+"CollectionItemSlot",f="data-radix-collection-item",g=et.forwardRef((S,b)=>{const{scope:v,children:w,...C}=S,_=et.useRef(null),M=Vt(b,_),I=s(d,v);return et.useEffect(()=>(I.itemMap.set(_,{ref:_,...C}),()=>void I.itemMap.delete(_))),p.jsx(Ec,{[f]:"",ref:M,children:w})});g.displayName=d;function m(S){const b=s(t+"CollectionConsumer",S);return et.useCallback(()=>{const w=b.collectionRef.current;if(!w)return[];const C=Array.from(w.querySelectorAll(`[${f}]`));return Array.from(b.itemMap.values()).sort((I,A)=>C.indexOf(I.ref.current)-C.indexOf(A.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:o,Slot:u,ItemSlot:g},m,r]}var yJ=E.createContext(void 0);function L2(t){const e=E.useContext(yJ);return t||e||"ltr"}function rr(t){const e=E.useRef(t);return E.useEffect(()=>{e.current=t}),E.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function SJ(t,e=globalThis==null?void 0:globalThis.document){const n=rr(t);E.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var vJ="DismissableLayer",PC="dismissableLayer.update",bJ="dismissableLayer.pointerDownOutside",xJ="dismissableLayer.focusOutside",xO,kN=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),hp=E.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:o,onDismiss:l,...u}=t,d=E.useContext(kN),[f,g]=E.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=E.useState({}),b=Vt(e,D=>g(D)),v=Array.from(d.layers),[w]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),C=v.indexOf(w),_=f?v.indexOf(f):-1,M=d.layersWithOutsidePointerEventsDisabled.size>0,I=_>=C,A=CJ(D=>{const L=D.target,G=[...d.branches].some(k=>k.contains(L));!I||G||(i==null||i(D),o==null||o(D),D.defaultPrevented||l==null||l())},m),R=_J(D=>{const L=D.target;[...d.branches].some(k=>k.contains(L))||(s==null||s(D),o==null||o(D),D.defaultPrevented||l==null||l())},m);return SJ(D=>{_===d.layers.size-1&&(r==null||r(D),!D.defaultPrevented&&l&&(D.preventDefault(),l()))},m),E.useEffect(()=>{if(f)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(xO=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),wO(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=xO)}},[f,m,n,d]),E.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),wO())},[f,d]),E.useEffect(()=>{const D=()=>S({});return document.addEventListener(PC,D),()=>document.removeEventListener(PC,D)},[]),p.jsx(gt.div,{...u,ref:b,style:{pointerEvents:M?I?"auto":"none":void 0,...t.style},onFocusCapture:Re(t.onFocusCapture,R.onFocusCapture),onBlurCapture:Re(t.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Re(t.onPointerDownCapture,A.onPointerDownCapture)})});hp.displayName=vJ;var wJ="DismissableLayerBranch",RN=E.forwardRef((t,e)=>{const n=E.useContext(kN),r=E.useRef(null),i=Vt(e,r);return E.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),p.jsx(gt.div,{...t,ref:i})});RN.displayName=wJ;function CJ(t,e=globalThis==null?void 0:globalThis.document){const n=rr(t),r=E.useRef(!1),i=E.useRef(()=>{});return E.useEffect(()=>{const s=l=>{if(l.target&&!r.current){let u=function(){ON(bJ,n,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=u,e.addEventListener("click",i.current,{once:!0})):u()}else e.removeEventListener("click",i.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function _J(t,e=globalThis==null?void 0:globalThis.document){const n=rr(t),r=E.useRef(!1);return E.useEffect(()=>{const i=s=>{s.target&&!r.current&&ON(xJ,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function wO(){const t=new CustomEvent(PC);document.dispatchEvent(t)}function ON(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?D2(i,s):i.dispatchEvent(s)}var EJ=hp,PJ=RN,Qw=0;function N2(){E.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??CO()),document.body.insertAdjacentElement("beforeend",t[1]??CO()),Qw++,()=>{Qw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Qw--}},[])}function CO(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Jw="focusScope.autoFocusOnMount",e1="focusScope.autoFocusOnUnmount",_O={bubbles:!1,cancelable:!0},TJ="FocusScope",IS=E.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=t,[l,u]=E.useState(null),d=rr(i),f=rr(s),g=E.useRef(null),m=Vt(e,v=>u(v)),S=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let v=function(M){if(S.paused||!l)return;const I=M.target;l.contains(I)?g.current=I:ol(g.current,{select:!0})},w=function(M){if(S.paused||!l)return;const I=M.relatedTarget;I!==null&&(l.contains(I)||ol(g.current,{select:!0}))},C=function(M){if(document.activeElement===document.body)for(const A of M)A.removedNodes.length>0&&ol(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",w);const _=new MutationObserver(C);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",w),_.disconnect()}}},[r,l,S.paused]),E.useEffect(()=>{if(l){PO.add(S);const v=document.activeElement;if(!l.contains(v)){const C=new CustomEvent(Jw,_O);l.addEventListener(Jw,d),l.dispatchEvent(C),C.defaultPrevented||(IJ(OJ(jN(l)),{select:!0}),document.activeElement===v&&ol(l))}return()=>{l.removeEventListener(Jw,d),setTimeout(()=>{const C=new CustomEvent(e1,_O);l.addEventListener(e1,f),l.dispatchEvent(C),C.defaultPrevented||ol(v??document.body,{select:!0}),l.removeEventListener(e1,f),PO.remove(S)},0)}}},[l,d,f,S]);const b=E.useCallback(v=>{if(!n&&!r||S.paused)return;const w=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,C=document.activeElement;if(w&&C){const _=v.currentTarget,[M,I]=MJ(_);M&&I?!v.shiftKey&&C===I?(v.preventDefault(),n&&ol(M,{select:!0})):v.shiftKey&&C===M&&(v.preventDefault(),n&&ol(I,{select:!0})):C===_&&v.preventDefault()}},[n,r,S.paused]);return p.jsx(gt.div,{tabIndex:-1,...o,ref:m,onKeyDown:b})});IS.displayName=TJ;function IJ(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(ol(r,{select:e}),document.activeElement!==n)return}function MJ(t){const e=jN(t),n=EO(e,t),r=EO(e.reverse(),t);return[n,r]}function jN(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function EO(t,e){for(const n of t)if(!AJ(n,{upTo:e}))return n}function AJ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function kJ(t){return t instanceof HTMLInputElement&&"select"in t}function ol(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&kJ(t)&&e&&t.select()}}var PO=RJ();function RJ(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=TO(t,e),t.unshift(e)},remove(e){var n;t=TO(t,e),(n=t[0])==null||n.resume()}}}function TO(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function OJ(t){return t.filter(e=>e.tagName!=="A")}var vl=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},jJ=oy.useId||(()=>{}),DJ=0;function ga(t){const[e,n]=E.useState(jJ());return vl(()=>{n(r=>r??String(DJ++))},[t]),t||(e?`radix-${e}`:"")}const LJ=["top","right","bottom","left"],bl=Math.min,Si=Math.max,Ay=Math.round,Xg=Math.floor,ho=t=>({x:t,y:t}),NJ={left:"right",right:"left",bottom:"top",top:"bottom"},zJ={start:"end",end:"start"};function TC(t,e,n){return Si(t,bl(e,n))}function ya(t,e){return typeof t=="function"?t(e):t}function Sa(t){return t.split("-")[0]}function Md(t){return t.split("-")[1]}function z2(t){return t==="x"?"y":"x"}function $2(t){return t==="y"?"height":"width"}function xl(t){return["top","bottom"].includes(Sa(t))?"y":"x"}function B2(t){return z2(xl(t))}function $J(t,e,n){n===void 0&&(n=!1);const r=Md(t),i=B2(t),s=$2(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=ky(o)),[o,ky(o)]}function BJ(t){const e=ky(t);return[IC(t),e,IC(e)]}function IC(t){return t.replace(/start|end/g,e=>zJ[e])}function FJ(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function UJ(t,e,n,r){const i=Md(t);let s=FJ(Sa(t),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(IC)))),s}function ky(t){return t.replace(/left|right|bottom|top/g,e=>NJ[e])}function HJ(t){return{top:0,right:0,bottom:0,left:0,...t}}function DN(t){return typeof t!="number"?HJ(t):{top:t,right:t,bottom:t,left:t}}function Ry(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function IO(t,e,n){let{reference:r,floating:i}=t;const s=xl(e),o=B2(e),l=$2(o),u=Sa(e),d=s==="y",f=r.x+r.width/2-i.width/2,g=r.y+r.height/2-i.height/2,m=r[l]/2-i[l]/2;let S;switch(u){case"top":S={x:f,y:r.y-i.height};break;case"bottom":S={x:f,y:r.y+r.height};break;case"right":S={x:r.x+r.width,y:g};break;case"left":S={x:r.x-i.width,y:g};break;default:S={x:r.x,y:r.y}}switch(Md(e)){case"start":S[o]-=m*(n&&d?-1:1);break;case"end":S[o]+=m*(n&&d?-1:1);break}return S}const KJ=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,l=s.filter(Boolean),u=await(o.isRTL==null?void 0:o.isRTL(e));let d=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:f,y:g}=IO(d,r,u),m=r,S={},b=0;for(let v=0;v<l.length;v++){const{name:w,fn:C}=l[v],{x:_,y:M,data:I,reset:A}=await C({x:f,y:g,initialPlacement:r,placement:m,strategy:i,middlewareData:S,rects:d,platform:o,elements:{reference:t,floating:e}});f=_??f,g=M??g,S={...S,[w]:{...S[w],...I}},A&&b<=50&&(b++,typeof A=="object"&&(A.placement&&(m=A.placement),A.rects&&(d=A.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):A.rects),{x:f,y:g}=IO(d,m,u)),v=-1)}return{x:f,y:g,placement:m,strategy:i,middlewareData:S}};async function jf(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:l,strategy:u}=t,{boundary:d="clippingAncestors",rootBoundary:f="viewport",elementContext:g="floating",altBoundary:m=!1,padding:S=0}=ya(e,t),b=DN(S),w=l[m?g==="floating"?"reference":"floating":g],C=Ry(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:d,rootBoundary:f,strategy:u})),_=g==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,M=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),I=await(s.isElement==null?void 0:s.isElement(M))?await(s.getScale==null?void 0:s.getScale(M))||{x:1,y:1}:{x:1,y:1},A=Ry(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:M,strategy:u}):_);return{top:(C.top-A.top+b.top)/I.y,bottom:(A.bottom-C.bottom+b.bottom)/I.y,left:(C.left-A.left+b.left)/I.x,right:(A.right-C.right+b.right)/I.x}}const GJ=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:o,elements:l,middlewareData:u}=e,{element:d,padding:f=0}=ya(t,e)||{};if(d==null)return{};const g=DN(f),m={x:n,y:r},S=B2(i),b=$2(S),v=await o.getDimensions(d),w=S==="y",C=w?"top":"left",_=w?"bottom":"right",M=w?"clientHeight":"clientWidth",I=s.reference[b]+s.reference[S]-m[S]-s.floating[b],A=m[S]-s.reference[S],R=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let D=R?R[M]:0;(!D||!await(o.isElement==null?void 0:o.isElement(R)))&&(D=l.floating[M]||s.floating[b]);const L=I/2-A/2,G=D/2-v[b]/2-1,k=bl(g[C],G),$=bl(g[_],G),F=k,N=D-v[b]-$,B=D/2-v[b]/2+L,Y=TC(F,B,N),K=!u.arrow&&Md(i)!=null&&B!==Y&&s.reference[b]/2-(B<F?k:$)-v[b]/2<0,V=K?B<F?B-F:B-N:0;return{[S]:m[S]+V,data:{[S]:Y,centerOffset:B-Y-V,...K&&{alignmentOffset:V}},reset:K}}}),qJ=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:l,platform:u,elements:d}=e,{mainAxis:f=!0,crossAxis:g=!0,fallbackPlacements:m,fallbackStrategy:S="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:v=!0,...w}=ya(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const C=Sa(i),_=xl(l),M=Sa(l)===l,I=await(u.isRTL==null?void 0:u.isRTL(d.floating)),A=m||(M||!v?[ky(l)]:BJ(l)),R=b!=="none";!m&&R&&A.push(...UJ(l,v,b,I));const D=[l,...A],L=await jf(e,w),G=[];let k=((r=s.flip)==null?void 0:r.overflows)||[];if(f&&G.push(L[C]),g){const B=$J(i,o,I);G.push(L[B[0]],L[B[1]])}if(k=[...k,{placement:i,overflows:G}],!G.every(B=>B<=0)){var $,F;const B=((($=s.flip)==null?void 0:$.index)||0)+1,Y=D[B];if(Y)return{data:{index:B,overflows:k},reset:{placement:Y}};let K=(F=k.filter(V=>V.overflows[0]<=0).sort((V,W)=>V.overflows[1]-W.overflows[1])[0])==null?void 0:F.placement;if(!K)switch(S){case"bestFit":{var N;const V=(N=k.filter(W=>{if(R){const ee=xl(W.placement);return ee===_||ee==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(ee=>ee>0).reduce((ee,H)=>ee+H,0)]).sort((W,ee)=>W[1]-ee[1])[0])==null?void 0:N[0];V&&(K=V);break}case"initialPlacement":K=l;break}if(i!==K)return{reset:{placement:K}}}return{}}}};function MO(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function AO(t){return LJ.some(e=>t[e]>=0)}const YJ=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=ya(t,e);switch(r){case"referenceHidden":{const s=await jf(e,{...i,elementContext:"reference"}),o=MO(s,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:AO(o)}}}case"escaped":{const s=await jf(e,{...i,altBoundary:!0}),o=MO(s,n.floating);return{data:{escapedOffsets:o,escaped:AO(o)}}}default:return{}}}}};async function VJ(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Sa(n),l=Md(n),u=xl(n)==="y",d=["left","top"].includes(o)?-1:1,f=s&&u?-1:1,g=ya(e,t);let{mainAxis:m,crossAxis:S,alignmentAxis:b}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return l&&typeof b=="number"&&(S=l==="end"?b*-1:b),u?{x:S*f,y:m*d}:{x:m*d,y:S*f}}const WJ=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:o,middlewareData:l}=e,u=await VJ(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:i+u.x,y:s+u.y,data:{...u,placement:o}}}}},XJ=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:w=>{let{x:C,y:_}=w;return{x:C,y:_}}},...u}=ya(t,e),d={x:n,y:r},f=await jf(e,u),g=xl(Sa(i)),m=z2(g);let S=d[m],b=d[g];if(s){const w=m==="y"?"top":"left",C=m==="y"?"bottom":"right",_=S+f[w],M=S-f[C];S=TC(_,S,M)}if(o){const w=g==="y"?"top":"left",C=g==="y"?"bottom":"right",_=b+f[w],M=b-f[C];b=TC(_,b,M)}const v=l.fn({...e,[m]:S,[g]:b});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[m]:s,[g]:o}}}}}},ZJ=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:l=0,mainAxis:u=!0,crossAxis:d=!0}=ya(t,e),f={x:n,y:r},g=xl(i),m=z2(g);let S=f[m],b=f[g];const v=ya(l,e),w=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(u){const M=m==="y"?"height":"width",I=s.reference[m]-s.floating[M]+w.mainAxis,A=s.reference[m]+s.reference[M]-w.mainAxis;S<I?S=I:S>A&&(S=A)}if(d){var C,_;const M=m==="y"?"width":"height",I=["top","left"].includes(Sa(i)),A=s.reference[g]-s.floating[M]+(I&&((C=o.offset)==null?void 0:C[g])||0)+(I?0:w.crossAxis),R=s.reference[g]+s.reference[M]+(I?0:((_=o.offset)==null?void 0:_[g])||0)-(I?w.crossAxis:0);b<A?b=A:b>R&&(b=R)}return{[m]:S,[g]:b}}}},QJ=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:s,platform:o,elements:l}=e,{apply:u=()=>{},...d}=ya(t,e),f=await jf(e,d),g=Sa(i),m=Md(i),S=xl(i)==="y",{width:b,height:v}=s.floating;let w,C;g==="top"||g==="bottom"?(w=g,C=m===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(C=g,w=m==="end"?"top":"bottom");const _=v-f.top-f.bottom,M=b-f.left-f.right,I=bl(v-f[w],_),A=bl(b-f[C],M),R=!e.middlewareData.shift;let D=I,L=A;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(L=M),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(D=_),R&&!m){const k=Si(f.left,0),$=Si(f.right,0),F=Si(f.top,0),N=Si(f.bottom,0);S?L=b-2*(k!==0||$!==0?k+$:Si(f.left,f.right)):D=v-2*(F!==0||N!==0?F+N:Si(f.top,f.bottom))}await u({...e,availableWidth:L,availableHeight:D});const G=await o.getDimensions(l.floating);return b!==G.width||v!==G.height?{reset:{rects:!0}}:{}}}};function MS(){return typeof window<"u"}function Ad(t){return LN(t)?(t.nodeName||"").toLowerCase():"#document"}function Ei(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Eo(t){var e;return(e=(LN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function LN(t){return MS()?t instanceof Node||t instanceof Ei(t).Node:!1}function Os(t){return MS()?t instanceof Element||t instanceof Ei(t).Element:!1}function So(t){return MS()?t instanceof HTMLElement||t instanceof Ei(t).HTMLElement:!1}function kO(t){return!MS()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ei(t).ShadowRoot}function fp(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=js(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function JJ(t){return["table","td","th"].includes(Ad(t))}function AS(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function F2(t){const e=U2(),n=Os(t)?js(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function eee(t){let e=wl(t);for(;So(e)&&!ad(e);){if(F2(e))return e;if(AS(e))return null;e=wl(e)}return null}function U2(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ad(t){return["html","body","#document"].includes(Ad(t))}function js(t){return Ei(t).getComputedStyle(t)}function kS(t){return Os(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function wl(t){if(Ad(t)==="html")return t;const e=t.assignedSlot||t.parentNode||kO(t)&&t.host||Eo(t);return kO(e)?e.host:e}function NN(t){const e=wl(t);return ad(e)?t.ownerDocument?t.ownerDocument.body:t.body:So(e)&&fp(e)?e:NN(e)}function Df(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=NN(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),o=Ei(i);if(s){const l=MC(o);return e.concat(o,o.visualViewport||[],fp(i)?i:[],l&&n?Df(l):[])}return e.concat(i,Df(i,[],n))}function MC(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function zN(t){const e=js(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=So(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,l=Ay(n)!==s||Ay(r)!==o;return l&&(n=s,r=o),{width:n,height:r,$:l}}function H2(t){return Os(t)?t:t.contextElement}function ed(t){const e=H2(t);if(!So(e))return ho(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=zN(e);let o=(s?Ay(n.width):n.width)/r,l=(s?Ay(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const tee=ho(0);function $N(t){const e=Ei(t);return!U2()||!e.visualViewport?tee:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function nee(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ei(t)?!1:e}function Pc(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=H2(t);let o=ho(1);e&&(r?Os(r)&&(o=ed(r)):o=ed(t));const l=nee(s,n,r)?$N(s):ho(0);let u=(i.left+l.x)/o.x,d=(i.top+l.y)/o.y,f=i.width/o.x,g=i.height/o.y;if(s){const m=Ei(s),S=r&&Os(r)?Ei(r):r;let b=m,v=MC(b);for(;v&&r&&S!==b;){const w=ed(v),C=v.getBoundingClientRect(),_=js(v),M=C.left+(v.clientLeft+parseFloat(_.paddingLeft))*w.x,I=C.top+(v.clientTop+parseFloat(_.paddingTop))*w.y;u*=w.x,d*=w.y,f*=w.x,g*=w.y,u+=M,d+=I,b=Ei(v),v=MC(b)}}return Ry({width:f,height:g,x:u,y:d})}function K2(t,e){const n=kS(t).scrollLeft;return e?e.left+n:Pc(Eo(t)).left+n}function BN(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:K2(t,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function ree(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s=i==="fixed",o=Eo(r),l=e?AS(e.floating):!1;if(r===o||l&&s)return n;let u={scrollLeft:0,scrollTop:0},d=ho(1);const f=ho(0),g=So(r);if((g||!g&&!s)&&((Ad(r)!=="body"||fp(o))&&(u=kS(r)),So(r))){const S=Pc(r);d=ed(r),f.x=S.x+r.clientLeft,f.y=S.y+r.clientTop}const m=o&&!g&&!s?BN(o,u,!0):ho(0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-u.scrollLeft*d.x+f.x+m.x,y:n.y*d.y-u.scrollTop*d.y+f.y+m.y}}function iee(t){return Array.from(t.getClientRects())}function see(t){const e=Eo(t),n=kS(t),r=t.ownerDocument.body,i=Si(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Si(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+K2(t);const l=-n.scrollTop;return js(r).direction==="rtl"&&(o+=Si(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:l}}function oee(t,e){const n=Ei(t),r=Eo(t),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,l=0,u=0;if(i){s=i.width,o=i.height;const d=U2();(!d||d&&e==="fixed")&&(l=i.offsetLeft,u=i.offsetTop)}return{width:s,height:o,x:l,y:u}}function aee(t,e){const n=Pc(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=So(t)?ed(t):ho(1),o=t.clientWidth*s.x,l=t.clientHeight*s.y,u=i*s.x,d=r*s.y;return{width:o,height:l,x:u,y:d}}function RO(t,e,n){let r;if(e==="viewport")r=oee(t,n);else if(e==="document")r=see(Eo(t));else if(Os(e))r=aee(e,n);else{const i=$N(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Ry(r)}function FN(t,e){const n=wl(t);return n===e||!Os(n)||ad(n)?!1:js(n).position==="fixed"||FN(n,e)}function lee(t,e){const n=e.get(t);if(n)return n;let r=Df(t,[],!1).filter(l=>Os(l)&&Ad(l)!=="body"),i=null;const s=js(t).position==="fixed";let o=s?wl(t):t;for(;Os(o)&&!ad(o);){const l=js(o),u=F2(o);!u&&l.position==="fixed"&&(i=null),(s?!u&&!i:!u&&l.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||fp(o)&&!u&&FN(t,o))?r=r.filter(f=>f!==o):i=l,o=wl(o)}return e.set(t,r),r}function cee(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const o=[...n==="clippingAncestors"?AS(e)?[]:lee(e,this._c):[].concat(n),r],l=o[0],u=o.reduce((d,f)=>{const g=RO(e,f,i);return d.top=Si(g.top,d.top),d.right=bl(g.right,d.right),d.bottom=bl(g.bottom,d.bottom),d.left=Si(g.left,d.left),d},RO(e,l,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function uee(t){const{width:e,height:n}=zN(t);return{width:e,height:n}}function dee(t,e,n){const r=So(e),i=Eo(e),s=n==="fixed",o=Pc(t,!0,s,e);let l={scrollLeft:0,scrollTop:0};const u=ho(0);if(r||!r&&!s)if((Ad(e)!=="body"||fp(i))&&(l=kS(e)),r){const m=Pc(e,!0,s,e);u.x=m.x+e.clientLeft,u.y=m.y+e.clientTop}else i&&(u.x=K2(i));const d=i&&!r&&!s?BN(i,l):ho(0),f=o.left+l.scrollLeft-u.x-d.x,g=o.top+l.scrollTop-u.y-d.y;return{x:f,y:g,width:o.width,height:o.height}}function t1(t){return js(t).position==="static"}function OO(t,e){if(!So(t)||js(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Eo(t)===n&&(n=n.ownerDocument.body),n}function UN(t,e){const n=Ei(t);if(AS(t))return n;if(!So(t)){let i=wl(t);for(;i&&!ad(i);){if(Os(i)&&!t1(i))return i;i=wl(i)}return n}let r=OO(t,e);for(;r&&JJ(r)&&t1(r);)r=OO(r,e);return r&&ad(r)&&t1(r)&&!F2(r)?n:r||eee(t)||n}const hee=async function(t){const e=this.getOffsetParent||UN,n=this.getDimensions,r=await n(t.floating);return{reference:dee(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function fee(t){return js(t).direction==="rtl"}const pee={convertOffsetParentRelativeRectToViewportRelativeRect:ree,getDocumentElement:Eo,getClippingRect:cee,getOffsetParent:UN,getElementRects:hee,getClientRects:iee,getDimensions:uee,getScale:ed,isElement:Os,isRTL:fee};function HN(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function gee(t,e){let n=null,r;const i=Eo(t);function s(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,u){l===void 0&&(l=!1),u===void 0&&(u=1),s();const d=t.getBoundingClientRect(),{left:f,top:g,width:m,height:S}=d;if(l||e(),!m||!S)return;const b=Xg(g),v=Xg(i.clientWidth-(f+m)),w=Xg(i.clientHeight-(g+S)),C=Xg(f),M={rootMargin:-b+"px "+-v+"px "+-w+"px "+-C+"px",threshold:Si(0,bl(1,u))||1};let I=!0;function A(R){const D=R[0].intersectionRatio;if(D!==u){if(!I)return o();D?o(!1,D):r=setTimeout(()=>{o(!1,1e-7)},1e3)}D===1&&!HN(d,t.getBoundingClientRect())&&o(),I=!1}try{n=new IntersectionObserver(A,{...M,root:i.ownerDocument})}catch{n=new IntersectionObserver(A,M)}n.observe(t)}return o(!0),s}function mee(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=H2(t),f=i||s?[...d?Df(d):[],...Df(e)]:[];f.forEach(C=>{i&&C.addEventListener("scroll",n,{passive:!0}),s&&C.addEventListener("resize",n)});const g=d&&l?gee(d,n):null;let m=-1,S=null;o&&(S=new ResizeObserver(C=>{let[_]=C;_&&_.target===d&&S&&(S.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var M;(M=S)==null||M.observe(e)})),n()}),d&&!u&&S.observe(d),S.observe(e));let b,v=u?Pc(t):null;u&&w();function w(){const C=Pc(t);v&&!HN(v,C)&&n(),v=C,b=requestAnimationFrame(w)}return n(),()=>{var C;f.forEach(_=>{i&&_.removeEventListener("scroll",n),s&&_.removeEventListener("resize",n)}),g==null||g(),(C=S)==null||C.disconnect(),S=null,u&&cancelAnimationFrame(b)}}const yee=WJ,See=XJ,vee=qJ,bee=QJ,xee=YJ,jO=GJ,wee=ZJ,Cee=(t,e,n)=>{const r=new Map,i={platform:pee,...n},s={...i.platform,_c:r};return KJ(t,e,{...i,platform:s})};var Im=typeof document<"u"?E.useLayoutEffect:E.useEffect;function Oy(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Oy(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!Oy(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function KN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function DO(t,e){const n=KN(t);return Math.round(e*n)/n}function n1(t){const e=E.useRef(t);return Im(()=>{e.current=t}),e}function _ee(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:l=!0,whileElementsMounted:u,open:d}=t,[f,g]=E.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[m,S]=E.useState(r);Oy(m,r)||S(r);const[b,v]=E.useState(null),[w,C]=E.useState(null),_=E.useCallback(W=>{W!==R.current&&(R.current=W,v(W))},[]),M=E.useCallback(W=>{W!==D.current&&(D.current=W,C(W))},[]),I=s||b,A=o||w,R=E.useRef(null),D=E.useRef(null),L=E.useRef(f),G=u!=null,k=n1(u),$=n1(i),F=n1(d),N=E.useCallback(()=>{if(!R.current||!D.current)return;const W={placement:e,strategy:n,middleware:m};$.current&&(W.platform=$.current),Cee(R.current,D.current,W).then(ee=>{const H={...ee,isPositioned:F.current!==!1};B.current&&!Oy(L.current,H)&&(L.current=H,Ed.flushSync(()=>{g(H)}))})},[m,e,n,$,F]);Im(()=>{d===!1&&L.current.isPositioned&&(L.current.isPositioned=!1,g(W=>({...W,isPositioned:!1})))},[d]);const B=E.useRef(!1);Im(()=>(B.current=!0,()=>{B.current=!1}),[]),Im(()=>{if(I&&(R.current=I),A&&(D.current=A),I&&A){if(k.current)return k.current(I,A,N);N()}},[I,A,N,k,G]);const Y=E.useMemo(()=>({reference:R,floating:D,setReference:_,setFloating:M}),[_,M]),K=E.useMemo(()=>({reference:I,floating:A}),[I,A]),V=E.useMemo(()=>{const W={position:n,left:0,top:0};if(!K.floating)return W;const ee=DO(K.floating,f.x),H=DO(K.floating,f.y);return l?{...W,transform:"translate("+ee+"px, "+H+"px)",...KN(K.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ee,top:H}},[n,l,K.floating,f.x,f.y]);return E.useMemo(()=>({...f,update:N,refs:Y,elements:K,floatingStyles:V}),[f,N,Y,K,V])}const Eee=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?jO({element:r.current,padding:i}).fn(n):{}:r?jO({element:r,padding:i}).fn(n):{}}}},Pee=(t,e)=>({...yee(t),options:[t,e]}),Tee=(t,e)=>({...See(t),options:[t,e]}),Iee=(t,e)=>({...wee(t),options:[t,e]}),Mee=(t,e)=>({...vee(t),options:[t,e]}),Aee=(t,e)=>({...bee(t),options:[t,e]}),kee=(t,e)=>({...xee(t),options:[t,e]}),Ree=(t,e)=>({...Eee(t),options:[t,e]});var Oee="Arrow",GN=E.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...s}=t;return p.jsx(gt.svg,{...s,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:p.jsx("polygon",{points:"0,0 30,0 15,10"})})});GN.displayName=Oee;var jee=GN;function qN(t){const[e,n]=E.useState(void 0);return vl(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,l;if("borderBoxSize"in s){const u=s.borderBoxSize,d=Array.isArray(u)?u[0]:u;o=d.inlineSize,l=d.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var G2="Popper",[YN,RS]=_o(G2),[Dee,VN]=YN(G2),WN=t=>{const{__scopePopper:e,children:n}=t,[r,i]=E.useState(null);return p.jsx(Dee,{scope:e,anchor:r,onAnchorChange:i,children:n})};WN.displayName=G2;var XN="PopperAnchor",ZN=E.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=VN(XN,n),o=E.useRef(null),l=Vt(e,o);return E.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.jsx(gt.div,{...i,ref:l})});ZN.displayName=XN;var q2="PopperContent",[Lee,Nee]=YN(q2),QN=E.forwardRef((t,e)=>{var Ne,we,Ie,ke,Ue,Nt;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:f=0,sticky:g="partial",hideWhenDetached:m=!1,updatePositionStrategy:S="optimized",onPlaced:b,...v}=t,w=VN(q2,n),[C,_]=E.useState(null),M=Vt(e,ot=>_(ot)),[I,A]=E.useState(null),R=qN(I),D=(R==null?void 0:R.width)??0,L=(R==null?void 0:R.height)??0,G=r+(s!=="center"?"-"+s:""),k=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},$=Array.isArray(d)?d:[d],F=$.length>0,N={padding:k,boundary:$.filter($ee),altBoundary:F},{refs:B,floatingStyles:Y,placement:K,isPositioned:V,middlewareData:W}=_ee({strategy:"fixed",placement:G,whileElementsMounted:(...ot)=>mee(...ot,{animationFrame:S==="always"}),elements:{reference:w.anchor},middleware:[Pee({mainAxis:i+L,alignmentAxis:o}),u&&Tee({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?Iee():void 0,...N}),u&&Mee({...N}),Aee({...N,apply:({elements:ot,rects:Mt,availableWidth:wt,availableHeight:ft})=>{const{width:jn,height:dn}=Mt.reference,lr=ot.floating.style;lr.setProperty("--radix-popper-available-width",`${wt}px`),lr.setProperty("--radix-popper-available-height",`${ft}px`),lr.setProperty("--radix-popper-anchor-width",`${jn}px`),lr.setProperty("--radix-popper-anchor-height",`${dn}px`)}}),I&&Ree({element:I,padding:l}),Bee({arrowWidth:D,arrowHeight:L}),m&&kee({strategy:"referenceHidden",...N})]}),[ee,H]=tz(K),te=rr(b);vl(()=>{V&&(te==null||te())},[V,te]);const ge=(Ne=W.arrow)==null?void 0:Ne.x,de=(we=W.arrow)==null?void 0:we.y,Se=((Ie=W.arrow)==null?void 0:Ie.centerOffset)!==0,[me,Me]=E.useState();return vl(()=>{C&&Me(window.getComputedStyle(C).zIndex)},[C]),p.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:V?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[(ke=W.transformOrigin)==null?void 0:ke.x,(Ue=W.transformOrigin)==null?void 0:Ue.y].join(" "),...((Nt=W.hide)==null?void 0:Nt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:p.jsx(Lee,{scope:n,placedSide:ee,onArrowChange:A,arrowX:ge,arrowY:de,shouldHideArrow:Se,children:p.jsx(gt.div,{"data-side":ee,"data-align":H,...v,ref:M,style:{...v.style,animation:V?void 0:"none"}})})})});QN.displayName=q2;var JN="PopperArrow",zee={top:"bottom",right:"left",bottom:"top",left:"right"},ez=E.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,s=Nee(JN,r),o=zee[s.placedSide];return p.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:p.jsx(jee,{...i,ref:n,style:{...i.style,display:"block"}})})});ez.displayName=JN;function $ee(t){return t!==null}var Bee=t=>({name:"transformOrigin",options:t,fn(e){var w,C,_;const{placement:n,rects:r,middlewareData:i}=e,o=((w=i.arrow)==null?void 0:w.centerOffset)!==0,l=o?0:t.arrowWidth,u=o?0:t.arrowHeight,[d,f]=tz(n),g={start:"0%",center:"50%",end:"100%"}[f],m=(((C=i.arrow)==null?void 0:C.x)??0)+l/2,S=(((_=i.arrow)==null?void 0:_.y)??0)+u/2;let b="",v="";return d==="bottom"?(b=o?g:`${m}px`,v=`${-u}px`):d==="top"?(b=o?g:`${m}px`,v=`${r.floating.height+u}px`):d==="right"?(b=`${-u}px`,v=o?g:`${S}px`):d==="left"&&(b=`${r.floating.width+u}px`,v=o?g:`${S}px`),{data:{x:b,y:v}}}});function tz(t){const[e,n="center"]=t.split("-");return[e,n]}var Y2=WN,V2=ZN,nz=QN,rz=ez,Fee="Portal",pp=E.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[i,s]=E.useState(!1);vl(()=>s(!0),[]);const o=n||i&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?LW.createPortal(p.jsx(gt.div,{...r,ref:e}),o):null});pp.displayName=Fee;function Uee(t,e){return E.useReducer((n,r)=>e[n][r]??n,t)}var Ns=t=>{const{present:e,children:n}=t,r=Hee(e),i=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),s=Vt(r.ref,Kee(i));return typeof n=="function"||r.isPresent?E.cloneElement(i,{ref:s}):null};Ns.displayName="Presence";function Hee(t){const[e,n]=E.useState(),r=E.useRef({}),i=E.useRef(t),s=E.useRef("none"),o=t?"mounted":"unmounted",[l,u]=Uee(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const d=Zg(r.current);s.current=l==="mounted"?d:"none"},[l]),vl(()=>{const d=r.current,f=i.current;if(f!==t){const m=s.current,S=Zg(d);t?u("MOUNT"):S==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(f&&m!==S?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,u]),vl(()=>{if(e){let d;const f=e.ownerDocument.defaultView??window,g=S=>{const v=Zg(r.current).includes(S.animationName);if(S.target===e&&v&&(u("ANIMATION_END"),!i.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",d=f.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},m=S=>{S.target===e&&(s.current=Zg(r.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{f.clearTimeout(d),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else u("ANIMATION_END")},[e,u]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:E.useCallback(d=>{d&&(r.current=getComputedStyle(d)),n(d)},[])}}function Zg(t){return(t==null?void 0:t.animationName)||"none"}function Kee(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Rl({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=Gee({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,l=rr(n),u=E.useCallback(d=>{if(s){const g=typeof d=="function"?d(t):d;g!==t&&l(g)}else i(d)},[s,t,i,l]);return[o,u]}function Gee({defaultProp:t,onChange:e}){const n=E.useState(t),[r]=n,i=E.useRef(r),s=rr(e);return E.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}var r1="rovingFocusGroup.onEntryFocus",qee={bubbles:!1,cancelable:!0},OS="RovingFocusGroup",[AC,iz,Yee]=TS(OS),[Vee,sz]=_o(OS,[Yee]),[Wee,Xee]=Vee(OS),oz=E.forwardRef((t,e)=>p.jsx(AC.Provider,{scope:t.__scopeRovingFocusGroup,children:p.jsx(AC.Slot,{scope:t.__scopeRovingFocusGroup,children:p.jsx(Zee,{...t,ref:e})})}));oz.displayName=OS;var Zee=E.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:u,onEntryFocus:d,preventScrollOnEntryFocus:f=!1,...g}=t,m=E.useRef(null),S=Vt(e,m),b=L2(s),[v=null,w]=Rl({prop:o,defaultProp:l,onChange:u}),[C,_]=E.useState(!1),M=rr(d),I=iz(n),A=E.useRef(!1),[R,D]=E.useState(0);return E.useEffect(()=>{const L=m.current;if(L)return L.addEventListener(r1,M),()=>L.removeEventListener(r1,M)},[M]),p.jsx(Wee,{scope:n,orientation:r,dir:b,loop:i,currentTabStopId:v,onItemFocus:E.useCallback(L=>w(L),[w]),onItemShiftTab:E.useCallback(()=>_(!0),[]),onFocusableItemAdd:E.useCallback(()=>D(L=>L+1),[]),onFocusableItemRemove:E.useCallback(()=>D(L=>L-1),[]),children:p.jsx(gt.div,{tabIndex:C||R===0?-1:0,"data-orientation":r,...g,ref:S,style:{outline:"none",...t.style},onMouseDown:Re(t.onMouseDown,()=>{A.current=!0}),onFocus:Re(t.onFocus,L=>{const G=!A.current;if(L.target===L.currentTarget&&G&&!C){const k=new CustomEvent(r1,qee);if(L.currentTarget.dispatchEvent(k),!k.defaultPrevented){const $=I().filter(K=>K.focusable),F=$.find(K=>K.active),N=$.find(K=>K.id===v),Y=[F,N,...$].filter(Boolean).map(K=>K.ref.current);cz(Y,f)}}A.current=!1}),onBlur:Re(t.onBlur,()=>_(!1))})})}),az="RovingFocusGroupItem",lz=E.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,...o}=t,l=ga(),u=s||l,d=Xee(az,n),f=d.currentTabStopId===u,g=iz(n),{onFocusableItemAdd:m,onFocusableItemRemove:S}=d;return E.useEffect(()=>{if(r)return m(),()=>S()},[r,m,S]),p.jsx(AC.ItemSlot,{scope:n,id:u,focusable:r,active:i,children:p.jsx(gt.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...o,ref:e,onMouseDown:Re(t.onMouseDown,b=>{r?d.onItemFocus(u):b.preventDefault()}),onFocus:Re(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:Re(t.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){d.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const v=ete(b,d.orientation,d.dir);if(v!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let C=g().filter(_=>_.focusable).map(_=>_.ref.current);if(v==="last")C.reverse();else if(v==="prev"||v==="next"){v==="prev"&&C.reverse();const _=C.indexOf(b.currentTarget);C=d.loop?tte(C,_+1):C.slice(_+1)}setTimeout(()=>cz(C))}})})})});lz.displayName=az;var Qee={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Jee(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function ete(t,e,n){const r=Jee(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Qee[r]}function cz(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function tte(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var nte=oz,rte=lz,ite=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},ku=new WeakMap,Qg=new WeakMap,Jg={},i1=0,uz=function(t){return t&&(t.host||uz(t.parentNode))},ste=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=uz(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},ote=function(t,e,n,r){var i=ste(e,Array.isArray(t)?t:[t]);Jg[n]||(Jg[n]=new WeakMap);var s=Jg[n],o=[],l=new Set,u=new Set(i),d=function(g){!g||l.has(g)||(l.add(g),d(g.parentNode))};i.forEach(d);var f=function(g){!g||u.has(g)||Array.prototype.forEach.call(g.children,function(m){if(l.has(m))f(m);else try{var S=m.getAttribute(r),b=S!==null&&S!=="false",v=(ku.get(m)||0)+1,w=(s.get(m)||0)+1;ku.set(m,v),s.set(m,w),o.push(m),v===1&&b&&Qg.set(m,!0),w===1&&m.setAttribute(n,"true"),b||m.setAttribute(r,"true")}catch(C){console.error("aria-hidden: cannot operate on ",m,C)}})};return f(e),l.clear(),i1++,function(){o.forEach(function(g){var m=ku.get(g)-1,S=s.get(g)-1;ku.set(g,m),s.set(g,S),m||(Qg.has(g)||g.removeAttribute(r),Qg.delete(g)),S||g.removeAttribute(n)}),i1--,i1||(ku=new WeakMap,ku=new WeakMap,Qg=new WeakMap,Jg={})}},W2=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=ite(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),ote(r,i,n,"aria-hidden")):function(){return null}},ro=function(){return ro=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ro.apply(this,arguments)};function dz(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function ate(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var Mm="right-scroll-bar-position",Am="width-before-scroll-bar",lte="with-scroll-bars-hidden",cte="--removed-body-scroll-bar-size";function s1(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function ute(t,e){var n=E.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var dte=typeof window<"u"?E.useLayoutEffect:E.useEffect,LO=new WeakMap;function hte(t,e){var n=ute(null,function(r){return t.forEach(function(i){return s1(i,r)})});return dte(function(){var r=LO.get(n);if(r){var i=new Set(r),s=new Set(t),o=n.current;i.forEach(function(l){s.has(l)||s1(l,null)}),s.forEach(function(l){i.has(l)||s1(l,o)})}LO.set(n,t)},[t]),n}function fte(t){return t}function pte(t,e){e===void 0&&(e=fte);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(l){return s(l)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(s),o=n}var u=function(){var f=o;o=[],f.forEach(s)},d=function(){return Promise.resolve().then(u)};d(),n={push:function(f){o.push(f),d()},filter:function(f){return o=o.filter(f),n}}}};return i}function gte(t){t===void 0&&(t={});var e=pte(null);return e.options=ro({async:!0,ssr:!1},t),e}var hz=function(t){var e=t.sideCar,n=dz(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,ro({},n))};hz.isSideCarExport=!0;function mte(t,e){return t.useMedium(e),hz}var fz=gte(),o1=function(){},jS=E.forwardRef(function(t,e){var n=E.useRef(null),r=E.useState({onScrollCapture:o1,onWheelCapture:o1,onTouchMoveCapture:o1}),i=r[0],s=r[1],o=t.forwardProps,l=t.children,u=t.className,d=t.removeScrollBar,f=t.enabled,g=t.shards,m=t.sideCar,S=t.noIsolation,b=t.inert,v=t.allowPinchZoom,w=t.as,C=w===void 0?"div":w,_=t.gapMode,M=dz(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),I=m,A=hte([n,e]),R=ro(ro({},M),i);return E.createElement(E.Fragment,null,f&&E.createElement(I,{sideCar:fz,removeScrollBar:d,shards:g,noIsolation:S,inert:b,setCallbacks:s,allowPinchZoom:!!v,lockRef:n,gapMode:_}),o?E.cloneElement(E.Children.only(l),ro(ro({},R),{ref:A})):E.createElement(C,ro({},R,{className:u,ref:A}),l))});jS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};jS.classNames={fullWidth:Am,zeroRight:Mm};var yte=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Ste(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=yte();return e&&t.setAttribute("nonce",e),t}function vte(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function bte(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var xte=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Ste())&&(vte(e,n),bte(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},wte=function(){var t=xte();return function(e,n){E.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},pz=function(){var t=wte(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},Cte={left:0,top:0,right:0,gap:0},a1=function(t){return parseInt(t||"",10)||0},_te=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[a1(n),a1(r),a1(i)]},Ete=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Cte;var e=_te(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Pte=pz(),td="data-scroll-locked",Tte=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(lte,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(td,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Mm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Am,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Mm," .").concat(Mm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Am," .").concat(Am,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(td,`] {
    `).concat(cte,": ").concat(l,`px;
  }
`)},NO=function(){var t=parseInt(document.body.getAttribute(td)||"0",10);return isFinite(t)?t:0},Ite=function(){E.useEffect(function(){return document.body.setAttribute(td,(NO()+1).toString()),function(){var t=NO()-1;t<=0?document.body.removeAttribute(td):document.body.setAttribute(td,t.toString())}},[])},Mte=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;Ite();var s=E.useMemo(function(){return Ete(i)},[i]);return E.createElement(Pte,{styles:Tte(s,!e,i,n?"":"!important")})},kC=!1;if(typeof window<"u")try{var em=Object.defineProperty({},"passive",{get:function(){return kC=!0,!0}});window.addEventListener("test",em,em),window.removeEventListener("test",em,em)}catch{kC=!1}var Ru=kC?{passive:!1}:!1,Ate=function(t){return t.tagName==="TEXTAREA"},gz=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Ate(t)&&n[e]==="visible")},kte=function(t){return gz(t,"overflowY")},Rte=function(t){return gz(t,"overflowX")},zO=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=mz(t,r);if(i){var s=yz(t,r),o=s[1],l=s[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Ote=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},jte=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},mz=function(t,e){return t==="v"?kte(e):Rte(e)},yz=function(t,e){return t==="v"?Ote(e):jte(e)},Dte=function(t,e){return t==="h"&&e==="rtl"?-1:1},Lte=function(t,e,n,r,i){var s=Dte(t,window.getComputedStyle(e).direction),o=s*r,l=n.target,u=e.contains(l),d=!1,f=o>0,g=0,m=0;do{var S=yz(t,l),b=S[0],v=S[1],w=S[2],C=v-w-s*b;(b||C)&&mz(t,l)&&(g+=C,m+=b),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!u&&l!==document.body||u&&(e.contains(l)||e===l));return(f&&Math.abs(g)<1||!f&&Math.abs(m)<1)&&(d=!0),d},tm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},$O=function(t){return[t.deltaX,t.deltaY]},BO=function(t){return t&&"current"in t?t.current:t},Nte=function(t,e){return t[0]===e[0]&&t[1]===e[1]},zte=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},$te=0,Ou=[];function Bte(t){var e=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),i=E.useState($te++)[0],s=E.useState(pz)[0],o=E.useRef(t);E.useEffect(function(){o.current=t},[t]),E.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var v=ate([t.lockRef.current],(t.shards||[]).map(BO),!0).filter(Boolean);return v.forEach(function(w){return w.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),v.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var l=E.useCallback(function(v,w){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var C=tm(v),_=n.current,M="deltaX"in v?v.deltaX:_[0]-C[0],I="deltaY"in v?v.deltaY:_[1]-C[1],A,R=v.target,D=Math.abs(M)>Math.abs(I)?"h":"v";if("touches"in v&&D==="h"&&R.type==="range")return!1;var L=zO(D,R);if(!L)return!0;if(L?A=D:(A=D==="v"?"h":"v",L=zO(D,R)),!L)return!1;if(!r.current&&"changedTouches"in v&&(M||I)&&(r.current=A),!A)return!0;var G=r.current||A;return Lte(G,w,v,G==="h"?M:I)},[]),u=E.useCallback(function(v){var w=v;if(!(!Ou.length||Ou[Ou.length-1]!==s)){var C="deltaY"in w?$O(w):tm(w),_=e.current.filter(function(A){return A.name===w.type&&(A.target===w.target||w.target===A.shadowParent)&&Nte(A.delta,C)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var M=(o.current.shards||[]).map(BO).filter(Boolean).filter(function(A){return A.contains(w.target)}),I=M.length>0?l(w,M[0]):!o.current.noIsolation;I&&w.cancelable&&w.preventDefault()}}},[]),d=E.useCallback(function(v,w,C,_){var M={name:v,delta:w,target:C,should:_,shadowParent:Fte(C)};e.current.push(M),setTimeout(function(){e.current=e.current.filter(function(I){return I!==M})},1)},[]),f=E.useCallback(function(v){n.current=tm(v),r.current=void 0},[]),g=E.useCallback(function(v){d(v.type,$O(v),v.target,l(v,t.lockRef.current))},[]),m=E.useCallback(function(v){d(v.type,tm(v),v.target,l(v,t.lockRef.current))},[]);E.useEffect(function(){return Ou.push(s),t.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:m}),document.addEventListener("wheel",u,Ru),document.addEventListener("touchmove",u,Ru),document.addEventListener("touchstart",f,Ru),function(){Ou=Ou.filter(function(v){return v!==s}),document.removeEventListener("wheel",u,Ru),document.removeEventListener("touchmove",u,Ru),document.removeEventListener("touchstart",f,Ru)}},[]);var S=t.removeScrollBar,b=t.inert;return E.createElement(E.Fragment,null,b?E.createElement(s,{styles:zte(i)}):null,S?E.createElement(Mte,{gapMode:t.gapMode}):null)}function Fte(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Ute=mte(fz,Bte);var DS=E.forwardRef(function(t,e){return E.createElement(jS,ro({},t,{ref:e,sideCar:Ute}))});DS.classNames=jS.classNames;var RC=["Enter"," "],Hte=["ArrowDown","PageUp","Home"],Sz=["ArrowUp","PageDown","End"],Kte=[...Hte,...Sz],Gte={ltr:[...RC,"ArrowRight"],rtl:[...RC,"ArrowLeft"]},qte={ltr:["ArrowLeft"],rtl:["ArrowRight"]},gp="Menu",[Lf,Yte,Vte]=TS(gp),[zc,LS]=_o(gp,[Vte,RS,sz]),mp=RS(),vz=sz(),[bz,Ol]=zc(gp),[Wte,yp]=zc(gp),xz=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:i,onOpenChange:s,modal:o=!0}=t,l=mp(e),[u,d]=E.useState(null),f=E.useRef(!1),g=rr(s),m=L2(i);return E.useEffect(()=>{const S=()=>{f.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>f.current=!1;return document.addEventListener("keydown",S,{capture:!0}),()=>{document.removeEventListener("keydown",S,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),p.jsx(Y2,{...l,children:p.jsx(bz,{scope:e,open:n,onOpenChange:g,content:u,onContentChange:d,children:p.jsx(Wte,{scope:e,onClose:E.useCallback(()=>g(!1),[g]),isUsingKeyboardRef:f,dir:m,modal:o,children:r})})})};xz.displayName=gp;var Xte="MenuAnchor",X2=E.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=mp(n);return p.jsx(V2,{...i,...r,ref:e})});X2.displayName=Xte;var Z2="MenuPortal",[Zte,wz]=zc(Z2,{forceMount:void 0}),Cz=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:i}=t,s=Ol(Z2,e);return p.jsx(Zte,{scope:e,forceMount:n,children:p.jsx(Ns,{present:n||s.open,children:p.jsx(pp,{asChild:!0,container:i,children:r})})})};Cz.displayName=Z2;var ts="MenuContent",[Qte,Q2]=zc(ts),_z=E.forwardRef((t,e)=>{const n=wz(ts,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,s=Ol(ts,t.__scopeMenu),o=yp(ts,t.__scopeMenu);return p.jsx(Lf.Provider,{scope:t.__scopeMenu,children:p.jsx(Ns,{present:r||s.open,children:p.jsx(Lf.Slot,{scope:t.__scopeMenu,children:o.modal?p.jsx(Jte,{...i,ref:e}):p.jsx(ene,{...i,ref:e})})})})}),Jte=E.forwardRef((t,e)=>{const n=Ol(ts,t.__scopeMenu),r=E.useRef(null),i=Vt(e,r);return E.useEffect(()=>{const s=r.current;if(s)return W2(s)},[]),p.jsx(J2,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Re(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),ene=E.forwardRef((t,e)=>{const n=Ol(ts,t.__scopeMenu);return p.jsx(J2,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),J2=E.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:u,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:g,onInteractOutside:m,onDismiss:S,disableOutsideScroll:b,...v}=t,w=Ol(ts,n),C=yp(ts,n),_=mp(n),M=vz(n),I=Yte(n),[A,R]=E.useState(null),D=E.useRef(null),L=Vt(e,D,w.onContentChange),G=E.useRef(0),k=E.useRef(""),$=E.useRef(0),F=E.useRef(null),N=E.useRef("right"),B=E.useRef(0),Y=b?DS:E.Fragment,K=b?{as:Ec,allowPinchZoom:!0}:void 0,V=ee=>{var Ne,we;const H=k.current+ee,te=I().filter(Ie=>!Ie.disabled),ge=document.activeElement,de=(Ne=te.find(Ie=>Ie.ref.current===ge))==null?void 0:Ne.textValue,Se=te.map(Ie=>Ie.textValue),me=hne(Se,H,de),Me=(we=te.find(Ie=>Ie.textValue===me))==null?void 0:we.ref.current;(function Ie(ke){k.current=ke,window.clearTimeout(G.current),ke!==""&&(G.current=window.setTimeout(()=>Ie(""),1e3))})(H),Me&&setTimeout(()=>Me.focus())};E.useEffect(()=>()=>window.clearTimeout(G.current),[]),N2();const W=E.useCallback(ee=>{var te,ge;return N.current===((te=F.current)==null?void 0:te.side)&&pne(ee,(ge=F.current)==null?void 0:ge.area)},[]);return p.jsx(Qte,{scope:n,searchRef:k,onItemEnter:E.useCallback(ee=>{W(ee)&&ee.preventDefault()},[W]),onItemLeave:E.useCallback(ee=>{var H;W(ee)||((H=D.current)==null||H.focus(),R(null))},[W]),onTriggerLeave:E.useCallback(ee=>{W(ee)&&ee.preventDefault()},[W]),pointerGraceTimerRef:$,onPointerGraceIntentChange:E.useCallback(ee=>{F.current=ee},[]),children:p.jsx(Y,{...K,children:p.jsx(IS,{asChild:!0,trapped:i,onMountAutoFocus:Re(s,ee=>{var H;ee.preventDefault(),(H=D.current)==null||H.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:p.jsx(hp,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:f,onFocusOutside:g,onInteractOutside:m,onDismiss:S,children:p.jsx(nte,{asChild:!0,...M,dir:C.dir,orientation:"vertical",loop:r,currentTabStopId:A,onCurrentTabStopIdChange:R,onEntryFocus:Re(u,ee=>{C.isUsingKeyboardRef.current||ee.preventDefault()}),preventScrollOnEntryFocus:!0,children:p.jsx(nz,{role:"menu","aria-orientation":"vertical","data-state":Fz(w.open),"data-radix-menu-content":"",dir:C.dir,..._,...v,ref:L,style:{outline:"none",...v.style},onKeyDown:Re(v.onKeyDown,ee=>{const te=ee.target.closest("[data-radix-menu-content]")===ee.currentTarget,ge=ee.ctrlKey||ee.altKey||ee.metaKey,de=ee.key.length===1;te&&(ee.key==="Tab"&&ee.preventDefault(),!ge&&de&&V(ee.key));const Se=D.current;if(ee.target!==Se||!Kte.includes(ee.key))return;ee.preventDefault();const Me=I().filter(Ne=>!Ne.disabled).map(Ne=>Ne.ref.current);Sz.includes(ee.key)&&Me.reverse(),une(Me)}),onBlur:Re(t.onBlur,ee=>{ee.currentTarget.contains(ee.target)||(window.clearTimeout(G.current),k.current="")}),onPointerMove:Re(t.onPointerMove,Nf(ee=>{const H=ee.target,te=B.current!==ee.clientX;if(ee.currentTarget.contains(H)&&te){const ge=ee.clientX>B.current?"right":"left";N.current=ge,B.current=ee.clientX}}))})})})})})})});_z.displayName=ts;var tne="MenuGroup",eE=E.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return p.jsx(gt.div,{role:"group",...r,ref:e})});eE.displayName=tne;var nne="MenuLabel",Ez=E.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return p.jsx(gt.div,{...r,ref:e})});Ez.displayName=nne;var jy="MenuItem",FO="menu.itemSelect",NS=E.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...i}=t,s=E.useRef(null),o=yp(jy,t.__scopeMenu),l=Q2(jy,t.__scopeMenu),u=Vt(e,s),d=E.useRef(!1),f=()=>{const g=s.current;if(!n&&g){const m=new CustomEvent(FO,{bubbles:!0,cancelable:!0});g.addEventListener(FO,S=>r==null?void 0:r(S),{once:!0}),D2(g,m),m.defaultPrevented?d.current=!1:o.onClose()}};return p.jsx(Pz,{...i,ref:u,disabled:n,onClick:Re(t.onClick,f),onPointerDown:g=>{var m;(m=t.onPointerDown)==null||m.call(t,g),d.current=!0},onPointerUp:Re(t.onPointerUp,g=>{var m;d.current||(m=g.currentTarget)==null||m.click()}),onKeyDown:Re(t.onKeyDown,g=>{const m=l.searchRef.current!=="";n||m&&g.key===" "||RC.includes(g.key)&&(g.currentTarget.click(),g.preventDefault())})})});NS.displayName=jy;var Pz=E.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...s}=t,o=Q2(jy,n),l=vz(n),u=E.useRef(null),d=Vt(e,u),[f,g]=E.useState(!1),[m,S]=E.useState("");return E.useEffect(()=>{const b=u.current;b&&S((b.textContent??"").trim())},[s.children]),p.jsx(Lf.ItemSlot,{scope:n,disabled:r,textValue:i??m,children:p.jsx(rte,{asChild:!0,...l,focusable:!r,children:p.jsx(gt.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:d,onPointerMove:Re(t.onPointerMove,Nf(b=>{r?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Re(t.onPointerLeave,Nf(b=>o.onItemLeave(b))),onFocus:Re(t.onFocus,()=>g(!0)),onBlur:Re(t.onBlur,()=>g(!1))})})})}),rne="MenuCheckboxItem",Tz=E.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return p.jsx(Rz,{scope:t.__scopeMenu,checked:n,children:p.jsx(NS,{role:"menuitemcheckbox","aria-checked":Dy(n)?"mixed":n,...i,ref:e,"data-state":rE(n),onSelect:Re(i.onSelect,()=>r==null?void 0:r(Dy(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Tz.displayName=rne;var Iz="MenuRadioGroup",[ine,sne]=zc(Iz,{value:void 0,onValueChange:()=>{}}),Mz=E.forwardRef((t,e)=>{const{value:n,onValueChange:r,...i}=t,s=rr(r);return p.jsx(ine,{scope:t.__scopeMenu,value:n,onValueChange:s,children:p.jsx(eE,{...i,ref:e})})});Mz.displayName=Iz;var Az="MenuRadioItem",kz=E.forwardRef((t,e)=>{const{value:n,...r}=t,i=sne(Az,t.__scopeMenu),s=n===i.value;return p.jsx(Rz,{scope:t.__scopeMenu,checked:s,children:p.jsx(NS,{role:"menuitemradio","aria-checked":s,...r,ref:e,"data-state":rE(s),onSelect:Re(r.onSelect,()=>{var o;return(o=i.onValueChange)==null?void 0:o.call(i,n)},{checkForDefaultPrevented:!1})})})});kz.displayName=Az;var tE="MenuItemIndicator",[Rz,one]=zc(tE,{checked:!1}),Oz=E.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...i}=t,s=one(tE,n);return p.jsx(Ns,{present:r||Dy(s.checked)||s.checked===!0,children:p.jsx(gt.span,{...i,ref:e,"data-state":rE(s.checked)})})});Oz.displayName=tE;var ane="MenuSeparator",jz=E.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return p.jsx(gt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});jz.displayName=ane;var lne="MenuArrow",Dz=E.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=mp(n);return p.jsx(rz,{...i,...r,ref:e})});Dz.displayName=lne;var nE="MenuSub",[cne,Lz]=zc(nE),Nz=t=>{const{__scopeMenu:e,children:n,open:r=!1,onOpenChange:i}=t,s=Ol(nE,e),o=mp(e),[l,u]=E.useState(null),[d,f]=E.useState(null),g=rr(i);return E.useEffect(()=>(s.open===!1&&g(!1),()=>g(!1)),[s.open,g]),p.jsx(Y2,{...o,children:p.jsx(bz,{scope:e,open:r,onOpenChange:g,content:d,onContentChange:f,children:p.jsx(cne,{scope:e,contentId:ga(),triggerId:ga(),trigger:l,onTriggerChange:u,children:n})})})};Nz.displayName=nE;var lf="MenuSubTrigger",zz=E.forwardRef((t,e)=>{const n=Ol(lf,t.__scopeMenu),r=yp(lf,t.__scopeMenu),i=Lz(lf,t.__scopeMenu),s=Q2(lf,t.__scopeMenu),o=E.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:u}=s,d={__scopeMenu:t.__scopeMenu},f=E.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return E.useEffect(()=>f,[f]),E.useEffect(()=>{const g=l.current;return()=>{window.clearTimeout(g),u(null)}},[l,u]),p.jsx(X2,{asChild:!0,...d,children:p.jsx(Pz,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":Fz(n.open),...t,ref:PS(e,i.onTriggerChange),onClick:g=>{var m;(m=t.onClick)==null||m.call(t,g),!(t.disabled||g.defaultPrevented)&&(g.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Re(t.onPointerMove,Nf(g=>{s.onItemEnter(g),!g.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),f()},100))})),onPointerLeave:Re(t.onPointerLeave,Nf(g=>{var S,b;f();const m=(S=n.content)==null?void 0:S.getBoundingClientRect();if(m){const v=(b=n.content)==null?void 0:b.dataset.side,w=v==="right",C=w?-5:5,_=m[w?"left":"right"],M=m[w?"right":"left"];s.onPointerGraceIntentChange({area:[{x:g.clientX+C,y:g.clientY},{x:_,y:m.top},{x:M,y:m.top},{x:M,y:m.bottom},{x:_,y:m.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(g),g.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:Re(t.onKeyDown,g=>{var S;const m=s.searchRef.current!=="";t.disabled||m&&g.key===" "||Gte[r.dir].includes(g.key)&&(n.onOpenChange(!0),(S=n.content)==null||S.focus(),g.preventDefault())})})})});zz.displayName=lf;var $z="MenuSubContent",Bz=E.forwardRef((t,e)=>{const n=wz(ts,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,s=Ol(ts,t.__scopeMenu),o=yp(ts,t.__scopeMenu),l=Lz($z,t.__scopeMenu),u=E.useRef(null),d=Vt(e,u);return p.jsx(Lf.Provider,{scope:t.__scopeMenu,children:p.jsx(Ns,{present:r||s.open,children:p.jsx(Lf.Slot,{scope:t.__scopeMenu,children:p.jsx(J2,{id:l.contentId,"aria-labelledby":l.triggerId,...i,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var g;o.isUsingKeyboardRef.current&&((g=u.current)==null||g.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:Re(t.onFocusOutside,f=>{f.target!==l.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:Re(t.onEscapeKeyDown,f=>{o.onClose(),f.preventDefault()}),onKeyDown:Re(t.onKeyDown,f=>{var S;const g=f.currentTarget.contains(f.target),m=qte[o.dir].includes(f.key);g&&m&&(s.onOpenChange(!1),(S=l.trigger)==null||S.focus(),f.preventDefault())})})})})})});Bz.displayName=$z;function Fz(t){return t?"open":"closed"}function Dy(t){return t==="indeterminate"}function rE(t){return Dy(t)?"indeterminate":t?"checked":"unchecked"}function une(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function dne(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function hne(t,e,n){const i=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=dne(t,Math.max(s,0));i.length===1&&(o=o.filter(d=>d!==n));const u=o.find(d=>d.toLowerCase().startsWith(i.toLowerCase()));return u!==n?u:void 0}function fne(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const l=e[s].x,u=e[s].y,d=e[o].x,f=e[o].y;u>r!=f>r&&n<(d-l)*(r-u)/(f-u)+l&&(i=!i)}return i}function pne(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return fne(n,e)}function Nf(t){return e=>e.pointerType==="mouse"?t(e):void 0}var Uz=xz,Hz=X2,Kz=Cz,Gz=_z,qz=eE,Yz=Ez,Vz=NS,Wz=Tz,Xz=Mz,Zz=kz,Qz=Oz,Jz=jz,e8=Dz,t8=Nz,n8=zz,r8=Bz,iE="ContextMenu",[gne,Cye]=_o(iE,[LS]),Er=LS(),[mne,i8]=gne(iE),s8=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,dir:i,modal:s=!0}=t,[o,l]=E.useState(!1),u=Er(e),d=rr(r),f=E.useCallback(g=>{l(g),d(g)},[d]);return p.jsx(mne,{scope:e,open:o,onOpenChange:f,modal:s,children:p.jsx(Uz,{...u,dir:i,open:o,onOpenChange:f,modal:s,children:n})})};s8.displayName=iE;var o8="ContextMenuTrigger",a8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,disabled:r=!1,...i}=t,s=i8(o8,n),o=Er(n),l=E.useRef({x:0,y:0}),u=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...l.current})}),d=E.useRef(0),f=E.useCallback(()=>window.clearTimeout(d.current),[]),g=m=>{l.current={x:m.clientX,y:m.clientY},s.onOpenChange(!0)};return E.useEffect(()=>f,[f]),E.useEffect(()=>void(r&&f()),[r,f]),p.jsxs(p.Fragment,{children:[p.jsx(Hz,{...o,virtualRef:u}),p.jsx(gt.span,{"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,...i,ref:e,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:r?t.onContextMenu:Re(t.onContextMenu,m=>{f(),g(m),m.preventDefault()}),onPointerDown:r?t.onPointerDown:Re(t.onPointerDown,nm(m=>{f(),d.current=window.setTimeout(()=>g(m),700)})),onPointerMove:r?t.onPointerMove:Re(t.onPointerMove,nm(f)),onPointerCancel:r?t.onPointerCancel:Re(t.onPointerCancel,nm(f)),onPointerUp:r?t.onPointerUp:Re(t.onPointerUp,nm(f))})]})});a8.displayName=o8;var yne="ContextMenuPortal",sE=t=>{const{__scopeContextMenu:e,...n}=t,r=Er(e);return p.jsx(Kz,{...r,...n})};sE.displayName=yne;var l8="ContextMenuContent",c8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=i8(l8,n),s=Er(n),o=E.useRef(!1);return p.jsx(Gz,{...s,...r,ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:l=>{var u;(u=t.onCloseAutoFocus)==null||u.call(t,l),!l.defaultPrevented&&o.current&&l.preventDefault(),o.current=!1},onInteractOutside:l=>{var u;(u=t.onInteractOutside)==null||u.call(t,l),!l.defaultPrevented&&!i.modal&&(o.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});c8.displayName=l8;var Sne="ContextMenuGroup",u8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(qz,{...i,...r,ref:e})});u8.displayName=Sne;var vne="ContextMenuLabel",bne=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Yz,{...i,...r,ref:e})});bne.displayName=vne;var xne="ContextMenuItem",d8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Vz,{...i,...r,ref:e})});d8.displayName=xne;var wne="ContextMenuCheckboxItem",h8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Wz,{...i,...r,ref:e})});h8.displayName=wne;var Cne="ContextMenuRadioGroup",_ne=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Xz,{...i,...r,ref:e})});_ne.displayName=Cne;var Ene="ContextMenuRadioItem",Pne=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Zz,{...i,...r,ref:e})});Pne.displayName=Ene;var Tne="ContextMenuItemIndicator",Ine=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Qz,{...i,...r,ref:e})});Ine.displayName=Tne;var Mne="ContextMenuSeparator",Ane=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(Jz,{...i,...r,ref:e})});Ane.displayName=Mne;var kne="ContextMenuArrow",Rne=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(e8,{...i,...r,ref:e})});Rne.displayName=kne;var One="ContextMenuSub",f8=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,open:i,defaultOpen:s}=t,o=Er(e),[l,u]=Rl({prop:i,defaultProp:s,onChange:r});return p.jsx(t8,{...o,open:l,onOpenChange:u,children:n})};f8.displayName=One;var jne="ContextMenuSubTrigger",p8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(n8,{...i,...r,ref:e})});p8.displayName=jne;var Dne="ContextMenuSubContent",g8=E.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,i=Er(n);return p.jsx(r8,{...i,...r,ref:e,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});g8.displayName=Dne;function nm(t){return e=>e.pointerType!=="mouse"?t(e):void 0}var Lne=s8,Nne=a8,zne=sE,$ne=c8,Bne=h8,oE="DropdownMenu",[Fne,_ye]=_o(oE,[LS]),Pr=LS(),[Une,m8]=Fne(oE),y8=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:i,defaultOpen:s,onOpenChange:o,modal:l=!0}=t,u=Pr(e),d=E.useRef(null),[f=!1,g]=Rl({prop:i,defaultProp:s,onChange:o});return p.jsx(Une,{scope:e,triggerId:ga(),triggerRef:d,contentId:ga(),open:f,onOpenChange:g,onOpenToggle:E.useCallback(()=>g(m=>!m),[g]),modal:l,children:p.jsx(Uz,{...u,open:f,onOpenChange:g,dir:r,modal:l,children:n})})};y8.displayName=oE;var S8="DropdownMenuTrigger",v8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,s=m8(S8,n),o=Pr(n);return p.jsx(Hz,{asChild:!0,...o,children:p.jsx(gt.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:PS(e,s.triggerRef),onPointerDown:Re(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(s.onOpenToggle(),s.open||l.preventDefault())}),onKeyDown:Re(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&s.onOpenToggle(),l.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});v8.displayName=S8;var Hne="DropdownMenuPortal",b8=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Pr(e);return p.jsx(Kz,{...r,...n})};b8.displayName=Hne;var x8="DropdownMenuContent",w8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=m8(x8,n),s=Pr(n),o=E.useRef(!1);return p.jsx(Gz,{id:i.contentId,"aria-labelledby":i.triggerId,...s,...r,ref:e,onCloseAutoFocus:Re(t.onCloseAutoFocus,l=>{var u;o.current||(u=i.triggerRef.current)==null||u.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Re(t.onInteractOutside,l=>{const u=l.detail.originalEvent,d=u.button===0&&u.ctrlKey===!0,f=u.button===2||d;(!i.modal||f)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});w8.displayName=x8;var Kne="DropdownMenuGroup",C8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(qz,{...i,...r,ref:e})});C8.displayName=Kne;var Gne="DropdownMenuLabel",qne=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Yz,{...i,...r,ref:e})});qne.displayName=Gne;var Yne="DropdownMenuItem",_8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Vz,{...i,...r,ref:e})});_8.displayName=Yne;var Vne="DropdownMenuCheckboxItem",E8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Wz,{...i,...r,ref:e})});E8.displayName=Vne;var Wne="DropdownMenuRadioGroup",Xne=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Xz,{...i,...r,ref:e})});Xne.displayName=Wne;var Zne="DropdownMenuRadioItem",Qne=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Zz,{...i,...r,ref:e})});Qne.displayName=Zne;var Jne="DropdownMenuItemIndicator",ere=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Qz,{...i,...r,ref:e})});ere.displayName=Jne;var tre="DropdownMenuSeparator",nre=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(Jz,{...i,...r,ref:e})});nre.displayName=tre;var rre="DropdownMenuArrow",ire=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(e8,{...i,...r,ref:e})});ire.displayName=rre;var sre=t=>{const{__scopeDropdownMenu:e,children:n,open:r,onOpenChange:i,defaultOpen:s}=t,o=Pr(e),[l=!1,u]=Rl({prop:r,defaultProp:s,onChange:i});return p.jsx(t8,{...o,open:l,onOpenChange:u,children:n})},ore="DropdownMenuSubTrigger",P8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(n8,{...i,...r,ref:e})});P8.displayName=ore;var are="DropdownMenuSubContent",T8=E.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Pr(n);return p.jsx(r8,{...i,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});T8.displayName=are;var aE=y8,lE=v8,zS=b8,cE=w8,lre=C8,cre=_8,ure=E8,dre=sre,hre=P8,fre=T8;function qt(t,e){var i;const n=new Set;for(const s of e){const o=t.getShape(s);if(!o)continue;t.getShapeUtil(o).onDragShapesOut&&n.add(o);const l=t.getShape(o.parentId);l&&t.getShapeUtil(l).onDragShapesOut&&n.add(l)}const r=new Map;for(const s of n){const o=I8(t,s);o.length&&r.set(s,o)}for(const[s,o]of r){const l=t.getShapeUtil(s),u=We(o.map(d=>t.getShape(d)));(i=l.onDragShapesOut)==null||i.call(l,s,u)}}function I8(t,e){const n=t.getSortedChildIdsForParent(e.id);if(n.length===0)return[];const r=t.getShapePageBounds(e);if(!r)return[];let i,s,o;const l=[];for(const u of n){const d=t.getShapePageBounds(u);if(!d)continue;if(!r.includes(d)){l.push(u);continue}i??(i=t.getShapeGeometry(e)),s??(s=t.getShapePageTransform(e)),o??(o=s.applyToPoints(i.vertices));const f=t.getShapePageTransform(u).clone().invert().applyToPoints(o),{vertices:g,isClosed:m}=t.getShapeGeometry(u);if(!g.some(S=>Ci(S,f))){if(m){if(C2(f,g))continue}else if(jW(f,g))continue;l.push(u)}}return l}function Ly(t,e,n=!1){t.select(e),t.setEditingShape(e),t.setCurrentTool("select.editing_shape",{target:"shape",shape:e}),n&&t.emit("select-all-text",{shapeId:e.id})}function pre(t,e){const n=We(e.map(i=>t.getShape(i)).filter(i=>i&&t.isShapeOfType(i,"frame")));if(!n.length)return;const r=[];t.run(()=>{n.map(i=>{const s=t.getSortedChildIdsForParent(i.id);s.length&&(t.reparentShapes(s,i.parentId,i.index),r.push(...s))}),t.setSelectedShapes(r),t.deleteShapes(e)})}const gre=50;function mre(t,e,n={}){const r=t.getShape(e);if(!r)return;const i=t.getSortedChildIdsForParent(r.id),s=We(i.map(S=>t.getShape(S)));if(!s.length)return;const o=xe.FromPoints(s.flatMap(S=>{const b=t.getShapeGeometry(S.id);return t.getShapeLocalTransform(S).applyToPoints(b.vertices)})),{padding:l=gre}=n,u=o.w+2*l,d=o.h+2*l,f=l-o.minX,g=l-o.minY;if(f===0&&g===0&&r.props.w===u&&r.props.h===d)return;const m=new T(f,g).rot(r.rotation);t.run(()=>{const S=i.map(b=>{const v=t.getShape(b);return{id:v.id,type:v.type,x:v.x+f,y:v.y+g}});S.push({id:r.id,type:r.type,x:r.x-m.x,y:r.y-m.y,props:{w:u,h:d}}),t.updateShapes(S)})}const M8=E.createContext(null);function yre({assetUrls:t,children:e}){return E.useEffect(()=>{for(const n of Object.values(t.icons)){const r=If();r.src=n,r.decode()}for(const n of Object.values(t.embedIcons)){const r=If();r.src=n,r.decode()}},[t]),p.jsx(M8.Provider,{value:t,children:e})}function uE(){const t=E.useContext(M8);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const OC={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.export-all-as-png.short":"PNG","action.export-all-as-png":"Export as PNG","action.export-all-as-svg.short":"SVG","action.export-all-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.fork-project-on-tldraw":"Fork project on tldraw","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.paste-error-title":"Pasting failed","action.paste-error-description":"Could not paste due to missing clipboard permissions. Please enable the permissions and try again.","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rename":"Rename","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-paste-at-cursor.menu":"Paste at cursor","action.toggle-paste-at-cursor":"Toggle paste at cursor","action.toggle-wrap-mode.menu":"Select on wrap","action.toggle-wrap-mode":"Toggle Select on wrap","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-dynamic-size-mode.menu":"Dynamic size","action.toggle-dynamic-size-mode":"Toggle dynamic size","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.flatten-to-image":"Flatten","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","assets.files.size-too-big":"File size is too big","assets.files.type-not-allowed":"File type is not allowed","assets.files.upload-failed":"Upload failed","assets.files.amount-too-many":"Too many files","assets.url.failed":"Couldnt load URL preview","theme.dark":"Dark","theme.light":"Light","theme.system":"System","color-style.white":"White","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","document.default-name":"Untitled","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","fill-style.fill":"Fill","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","verticalAlign-style.start":"Top","verticalAlign-style.middle":"Middle","verticalAlign-style.end":"Bottom","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","tool.pointer-down":"Pointer down","menu.title":"Menu","menu.theme":"Theme","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.edit":"Edit","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.export-all-as":"Export","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.copy-link":"Copy editor link","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy viewer link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to access this project.","share-menu.project-too-large":"Sorry, this project cant be shared because its too large. Were working on it!","share-menu.upload-failed":"Sorry, we couldnt upload your project at the moment. Please try again or let us know if the problem persists.","share-menu.creating-project":"Creating the new project","share-menu.copied":"Copied link","document-name-menu.copy-link":"Copy link","status.offline":"Offline","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.import-tldr-file":"Import file","help-menu.title":"Help and resources","help-menu.about":"About tldraw","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","help-menu.terms":"Terms of service","help-menu.privacy":"Privacy policy","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the sites URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","style-panel.title":"Styles","style-panel.align":"Align","style-panel.label-align":"Label align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesnt look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Dont ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Dont ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Dont ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"Weve updated this document to work with the current version of tldraw. If youd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Dont ask again","cursor-chat.type-to-chat":"Type to chat"},Sre=new Set(["ar","fa","he","ur","ku"]),ju={locale:"en",label:"English",messages:OC,dir:"ltr"};async function vre(t,e){if(!(await go(e.translations.en)).ok)return console.warn("No main translations found."),ju;if(t==="en")return ju;const r=Rf.find(o=>o.locale===t);if(!r)return console.warn(`No translation found for locale ${t}`),ju;const s=await(await go(e.translations[r.locale])).json();if(!s)return console.warn(`No messages found for locale ${t}`),ju;for(const o in ju.messages)s[o];return{locale:t,label:r.label,dir:Sre.has(r.locale)?"rtl":"ltr",messages:{...ju.messages,...s}}}const A8=E.createContext(null);function k8(){const t=E.useContext(A8);if(!t)throw new Error("useCurrentTranslation must be used inside of <TldrawUiContextProvider />");return t}function bre({overrides:t,locale:e,children:n}){const r=uE(),[i,s]=E.useState(()=>t&&t.en?{locale:"en",label:"English",dir:"ltr",messages:{...OC,...t.en}}:{locale:"en",label:"English",dir:"ltr",messages:OC});return E.useEffect(()=>{let o=!1;async function l(){const u=await vre(e,r);u&&!o&&(t&&t[e]?s({...u,messages:{...u.messages,...t[e]}}):s(u))}return l(),()=>{o=!0}},[r,e,t]),p.jsx(A8.Provider,{value:i,children:n})}function ut(){const t=k8();return E.useCallback(function(n){return t.messages[n]??n},[t])}const $e=E.forwardRef(function({children:e,type:n,...r},i){return p.jsx("button",{ref:i,type:"button",draggable:!1,...r,className:je("tlui-button",`tlui-button__${n}`,r.className),children:e})});function wn({children:t}){return p.jsx("span",{className:"tlui-button__label",children:t})}var dE="Dialog",[R8,Eye]=_o(dE),[xre,zs]=R8(dE),O8=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:o=!0}=t,l=E.useRef(null),u=E.useRef(null),[d=!1,f]=Rl({prop:r,defaultProp:i,onChange:s});return p.jsx(xre,{scope:e,triggerRef:l,contentRef:u,contentId:ga(),titleId:ga(),descriptionId:ga(),open:d,onOpenChange:f,onOpenToggle:E.useCallback(()=>f(g=>!g),[f]),modal:o,children:n})};O8.displayName=dE;var j8="DialogTrigger",wre=E.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=zs(j8,n),s=Vt(e,i.triggerRef);return p.jsx(gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":pE(i.open),...r,ref:s,onClick:Re(t.onClick,i.onOpenToggle)})});wre.displayName=j8;var hE="DialogPortal",[Cre,D8]=R8(hE,{forceMount:void 0}),L8=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,s=zs(hE,e);return p.jsx(Cre,{scope:e,forceMount:n,children:E.Children.map(r,o=>p.jsx(Ns,{present:n||s.open,children:p.jsx(pp,{asChild:!0,container:i,children:o})}))})};L8.displayName=hE;var Ny="DialogOverlay",N8=E.forwardRef((t,e)=>{const n=D8(Ny,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,s=zs(Ny,t.__scopeDialog);return s.modal?p.jsx(Ns,{present:r||s.open,children:p.jsx(_re,{...i,ref:e})}):null});N8.displayName=Ny;var _re=E.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=zs(Ny,n);return p.jsx(DS,{as:Ec,allowPinchZoom:!0,shards:[i.contentRef],children:p.jsx(gt.div,{"data-state":pE(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Tc="DialogContent",z8=E.forwardRef((t,e)=>{const n=D8(Tc,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,s=zs(Tc,t.__scopeDialog);return p.jsx(Ns,{present:r||s.open,children:s.modal?p.jsx(Ere,{...i,ref:e}):p.jsx(Pre,{...i,ref:e})})});z8.displayName=Tc;var Ere=E.forwardRef((t,e)=>{const n=zs(Tc,t.__scopeDialog),r=E.useRef(null),i=Vt(e,n.contentRef,r);return E.useEffect(()=>{const s=r.current;if(s)return W2(s)},[]),p.jsx($8,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,s=>{var o;s.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,s=>{const o=s.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&s.preventDefault()}),onFocusOutside:Re(t.onFocusOutside,s=>s.preventDefault())})}),Pre=E.forwardRef((t,e)=>{const n=zs(Tc,t.__scopeDialog),r=E.useRef(!1),i=E.useRef(!1);return p.jsx($8,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var u,d;(u=t.onInteractOutside)==null||u.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=s.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),$8=E.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...o}=t,l=zs(Tc,n),u=E.useRef(null),d=Vt(e,u);return N2(),p.jsxs(p.Fragment,{children:[p.jsx(IS,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:p.jsx(hp,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":pE(l.open),...o,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),p.jsxs(p.Fragment,{children:[p.jsx(Ire,{titleId:l.titleId}),p.jsx(Are,{contentRef:u,descriptionId:l.descriptionId})]})]})}),fE="DialogTitle",B8=E.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=zs(fE,n);return p.jsx(gt.h2,{id:i.titleId,...r,ref:e})});B8.displayName=fE;var F8="DialogDescription",Tre=E.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=zs(F8,n);return p.jsx(gt.p,{id:i.descriptionId,...r,ref:e})});Tre.displayName=F8;var U8="DialogClose",H8=E.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=zs(U8,n);return p.jsx(gt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,()=>i.onOpenChange(!1))})});H8.displayName=U8;function pE(t){return t?"open":"closed"}var K8="DialogTitleWarning",[Pye,G8]=uJ(K8,{contentName:Tc,titleName:fE,docsSlug:"dialog"}),Ire=({titleId:t})=>{const e=G8(K8),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return E.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Mre="DialogDescriptionWarning",Are=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${G8(Mre).contentName}}.`;return E.useEffect(()=>{var s;const i=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},kre=O8,Rre=L8,Ore=N8,jre=z8,Dre=B8;const vo=E.memo(function({small:e,invertIcon:n,icon:r,color:i,className:s,...o}){const l=uE(),u=l.icons[r]??l.icons["question-mark-circle"],d=E.useRef(null);return E.useLayoutEffect(()=>{u||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),d!=null&&d.current&&(d.current.style.webkitMask=`url(${u}) center 100% / 100% no-repeat`)},[d,u,r]),r==="none"?p.jsx("div",{className:je("tlui-icon tlui-icon__placeholder",{"tlui-icon__small":e},s)}):p.jsx("div",{...o,ref:d,className:je("tlui-icon",{"tlui-icon__small":e},s),style:{color:i,mask:`url(${u}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})});function it({icon:t,small:e,invertIcon:n}){return p.jsx(vo,{className:"tlui-button__icon",icon:t,small:e,invertIcon:n})}function $S({className:t,children:e}){return p.jsx("div",{className:je("tlui-dialog__header",t),children:e})}function BS({className:t,children:e,style:n}){return p.jsx(Dre,{dir:"ltr",className:je("tlui-dialog__header__title",t),style:n,children:e})}function FS(){return p.jsx("div",{className:"tlui-dialog__header__close",children:p.jsx(H8,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:p.jsx($e,{type:"icon","aria-label":"Close",onTouchEnd:t=>t.target.click(),children:p.jsx(it,{small:!0,icon:"cross-2"})})})})}function zf({className:t,children:e,style:n}){return p.jsx("div",{className:je("tlui-dialog__body",t),style:n,children:e})}function gE({className:t,children:e}){return p.jsx("div",{className:je("tlui-dialog__footer",t),children:e})}const US=E.forwardRef(function({className:e,label:n,icon:r,iconLeft:i,autoSelect:s=!1,autoFocus:o=!1,defaultValue:l,placeholder:u,onComplete:d,onValueChange:f,onCancel:g,onFocus:m,onBlur:S,shouldManuallyMaintainScrollPositionWhenFocused:b=!1,children:v,value:w,"data-testid":C},_){const M=Ml(),I=E.useRef(null);E.useImperativeHandle(_,()=>I.current);const A=ut(),R=E.useRef(l??""),D=E.useRef(l??""),[L,G]=E.useState(!1),k=E.useCallback(B=>{G(!0);const Y=B.currentTarget;D.current=Y.value,M?M.timers.requestAnimationFrame(()=>{s&&Y.select()}):vC.requestAnimationFrame("anon",()=>{s&&Y.select()}),m==null||m()},[s,M,m]),$=E.useCallback(B=>{const Y=B.currentTarget.value;D.current=Y,f==null||f(Y)},[f]),F=E.useCallback(B=>{switch(B.key){case"Enter":{B.currentTarget.blur(),_n(B),d==null||d(B.currentTarget.value);break}case"Escape":{B.currentTarget.value=R.current,g==null||g(B.currentTarget.value),B.currentTarget.blur(),_n(B);break}}},[d,g]),N=E.useCallback(B=>{G(!1);const Y=B.currentTarget.value;S==null||S(Y)},[S]);return E.useEffect(()=>{if(!Ft.isIos)return;const B=window.visualViewport;if(L&&b&&B){const Y=()=>{var K;(K=I.current)==null||K.scrollIntoView({block:"center"})};return B.addEventListener("resize",Y),B.addEventListener("scroll",Y),M?M.timers.requestAnimationFrame(()=>{var K;(K=I.current)==null||K.scrollIntoView({block:"center"})}):vC.requestAnimationFrame("anon",()=>{var K;(K=I.current)==null||K.scrollIntoView({block:"center"})}),()=>{B.removeEventListener("resize",Y),B.removeEventListener("scroll",Y)}}},[L,M,b]),p.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[v,n&&p.jsx("label",{children:A(n)}),i&&p.jsx(vo,{icon:i,className:"tlui-icon-left",small:!0}),p.jsx("input",{ref:I,className:je("tlui-input",e),type:"text",defaultValue:l,onKeyDownCapture:F,onChange:$,onFocus:k,onBlur:N,autoFocus:o,placeholder:u,value:w,"data-testid":C}),r&&p.jsx(vo,{icon:r,small:!!n})]})});function UO(t){return Ii.isValid(t)?{isValid:!0,hasProtocol:!0}:Ii.isValid("https://"+t)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const Lre=ir(function({onClose:e}){const r=re().getOnlySelectedShape();return r&&"url"in r.props&&typeof r.props.url=="string"?p.jsx(Nre,{onClose:e,selectedShape:r}):null}),Nre=ir(function({onClose:e,selectedShape:n}){const r=re(),i=ut(),s=E.useRef(null);E.useEffect(()=>{r.timers.requestAnimationFrame(()=>{var b;return(b=s.current)==null?void 0:b.focus()})},[r]);const o=E.useRef(n.props.url),[l,u]=E.useState(()=>{const b=UO(n.props.url),v=b.isValid===!0?b.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:v,safe:v,valid:!0}}),d=E.useCallback(b=>{const v=b.replace(/https?:\/\/(https?:\/\/)/,(_,M)=>M),w=UO(v),C=w.isValid===!0?w.hasProtocol?v:"https://"+v:"https://";u({actual:v,safe:C,valid:w.isValid})},[]),f=E.useCallback(()=>{const b=r.getOnlySelectedShape();b&&(r.updateShapes([{id:b.id,type:b.type,props:{url:""}}]),e())},[r,e]),g=E.useCallback(()=>{const b=r.getOnlySelectedShape();b&&(b&&"url"in b.props&&b.props.url!==l.safe&&r.updateShapes([{id:b.id,type:b.type,props:{url:l.safe}}]),e())},[r,e,l]),m=E.useCallback(()=>{e()},[e]);if(!n)return e(),null;const S=o.current&&!l.valid;return p.jsxs(p.Fragment,{children:[p.jsxs($S,{children:[p.jsx(BS,{children:i("edit-link-dialog.title")}),p.jsx(FS,{})]}),p.jsx(zf,{children:p.jsxs("div",{className:"tlui-edit-link-dialog",children:[p.jsx(US,{ref:s,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autoFocus:!0,value:l.actual,onValueChange:d,onComplete:g,onCancel:m}),p.jsx("div",{children:l.valid?i("edit-link-dialog.detail"):i("edit-link-dialog.invalid-url")})]})}),p.jsxs(gE,{className:"tlui-dialog__footer__actions",children:[p.jsx($e,{type:"normal",onClick:m,onTouchEnd:m,children:p.jsx(wn,{children:i("edit-link-dialog.cancel")})}),S?p.jsx($e,{type:"danger",onTouchEnd:f,onClick:f,children:p.jsx(wn,{children:i("edit-link-dialog.clear")})}):p.jsx($e,{type:"primary",disabled:!l.valid,onTouchEnd:g,onClick:g,children:p.jsx(wn,{children:i("edit-link-dialog.save")})})]})]})});var zre={};const HO=/(^\/r\/[^/]+\/?$)/,mE=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(HO))return t},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(HO))return t}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/?$/)){const n=e.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,overridePermissions:{"allow-presentation":!0},toEmbedUrl:t=>{if(t.includes("/maps/embed?"))return t;if(t.includes("/maps/")){const e=t.match(/@(.*?),(.*?),(.*?)z/);let n;if(e){const[,r,i,s]=e;n=`https://${new URL(t).host.replace("www.","")}/maps/embed/v1/view?key=${zre.NEXT_PUBLIC_GC_API_KEY}&center=${r},${i}&zoom=${s}`}else n="";return n}},fromEmbedUrl:t=>{const e=Ge(t);if(!e)return;if(e.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&e.searchParams.has("center")&&e.searchParams.get("zoom")){const r=e.searchParams.get("zoom"),[i,s]=e.searchParams.get("center").split(",");return`https://www.google.com/maps/@${i},${s},${r}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/v\/(.+)\/?/);if(n)return`https://www.val.town/embed/${n[1]}`},fromEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/embed\/(.+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:t=>{const e=Ge(t),n=e&&e.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=t.match(e);if(n){const[r,i,s]=n;return`https://codepen.io/${i}/embed/${s}`}},fromEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,i,s]=n;return`https://codepen.io/${i}/pen/${s}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:t=>{const e=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=t.match(e);if(n){const[r,i]=n;return`https://scratch.mit.edu/projects/embed/${i}`}},fromEmbedUrl:t=>{const e=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,i]=n;return`https://scratch.mit.edu/projects/${i}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=Ge(t);if(!e)return;const n=e.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${e.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&e.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${e.searchParams.get("v")}`},fromEmbedUrl:t=>{const e=Ge(t);if(!e)return;if(e.hostname.replace(/^www./,"")==="youtube.com"){const r=e.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:t=>{const e=Ge(t),n=e==null?void 0:e.searchParams.get("cid");if(e!=null&&e.pathname.match(/\/calendar\/u\/0/)&&n){e.pathname="/calendar/embed";const r=Array.from(e.searchParams.keys());for(const i of r)e.searchParams.delete(i);return e.searchParams.set("src",n),e.href}},fromEmbedUrl:t=>{const e=Ge(t),n=e==null?void 0:e.searchParams.get("src");if(e!=null&&e.pathname.match(/\/calendar\/embed/)&&n){e.pathname="/calendar/u/0";const r=Array.from(e.searchParams.keys());for(const i of r)e.searchParams.delete(i);return e.searchParams.set("cid",n),e.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:t=>{const e=Ge(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/pub\/?$/))){e.pathname=e.pathname.replace(/\/pub$/,"/embed");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}},fromEmbedUrl:t=>{const e=Ge(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/embed\/?$/))){e.pathname=e.pathname.replace(/\/embed$/,"/pub");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/([^/]+)\/([0-9a-f]+)$/))return t.split("/").pop()?t:void 0},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/([^/]+)\/([0-9a-f]+)$/))return t.split("/").pop()?t:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/)&&e.searchParams.has("embed"))return e.searchParams.delete("embed"),e.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/map\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/map\//))return e.pathname=e.pathname.replace(/^\/embed/,""),e.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/(artist|album)\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/(artist|album)\//))return e.origin+e.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="vimeo.com"&&e.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+e.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="player.vimeo.com"){const n=e.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.hash.match(/#room=/))return t},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}/embed${e.pathname}?cell=*`;if(e&&e.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=e.pathname.replace(/^\/d/,"");return`${e.origin}/embed${n}?cell=*`}},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","")}#cell-*`;if(e&&e.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","/d")}#cell-*`}},{type:"desmos",title:"Desmos",hostnames:["desmos.com"],width:700,height:450,doesResize:!0,toEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search===""&&e.hash==="")return`${t}?embed`},fromEmbedUrl:t=>{const e=Ge(t);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search==="?embed"&&e.hash==="")return t.replace("?embed","")}}],$re={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},Bre=mE.map(t=>t.type);function Fre(t){return Bre.includes(t)}function Ure(t){return"icon"in t}function q8(){const t=re();if(t.hasShapeUtil("embed"))return t.getShapeUtil("embed")}function yE(){const t=q8();return e=>t?t.getEmbedDefinition(e):void 0}function Hre(){const t=q8();return t?t.getEmbedDefinitions():[]}const Y8=ir(function({onClose:e}){const n=re(),r=ut(),i=uE(),[s,o]=E.useState(null),[l,u]=E.useState(""),[d,f]=E.useState(null),[g,m]=E.useState(!1),S=E.useRef(-1),b=Hre(),v=yE();return p.jsxs(p.Fragment,{children:[p.jsxs($S,{children:[p.jsx(BS,{children:s?`${r("embed-dialog.title")}  ${s.title}`:r("embed-dialog.title")}),p.jsx(FS,{})]}),s?p.jsxs(p.Fragment,{children:[p.jsxs(zf,{className:"tlui-embed-dialog__enter",children:[p.jsx(US,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"https://example.com",autoFocus:!0,onValueChange:w=>{u(w);const C=v(w);f(C&&C.definition.type===s.type?C:null),m(!1),clearTimeout(S.current),S.current=n.timers.setTimeout(()=>m(!C),320)}}),l===""?p.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[p.jsx("span",{children:r("embed-dialog.instruction")})," ",s.instructionLink&&p.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:s.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",p.jsx(vo,{icon:"external-link",small:!0})]})]}):p.jsx("div",{className:"tlui-embed-dialog__warning",children:g?r("embed-dialog.invalid-url"):""})]}),p.jsxs(gE,{className:"tlui-dialog__footer__actions",children:[p.jsx($e,{type:"normal",onClick:()=>{o(null),f(null),u("")},children:p.jsx(wn,{children:r("embed-dialog.back")})}),p.jsx("div",{className:"tlui-embed__spacer"}),p.jsx($e,{type:"normal",onClick:e,children:p.jsx(wn,{children:r("embed-dialog.cancel")})}),p.jsx($e,{type:"primary",disabled:!d,onClick:()=>{d&&(n.putExternalContent({type:"embed",url:l,point:n.getViewportPageBounds().center,embed:d.definition}),e())},children:p.jsx(wn,{children:r("embed-dialog.create")})})]})]}):p.jsx(p.Fragment,{children:p.jsx(zf,{className:"tlui-embed-dialog__list",children:b.map(w=>{const C=Fre(w.type)?i.embedIcons[w.type]:Ure(w)?w.icon:void 0;return p.jsxs($e,{type:"menu",onClick:()=>o(w),children:[p.jsx(wn,{children:w.title}),C&&p.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${C})`}})]},w.type)})})})]})});async function Kre(t,e,n){const r=We(e.map(l=>{const u=t.getShape(l);if(!(!u||t.getShapeUtil(u.type).toSvg===void 0))return u}));if(r.length===0)return;if(r.length===1){const l=r[0];if(!l||t.isShapeOfType(l,"image"))return}const i=[];if(n!==void 0){const l=r.map(u=>({shape:u,bounds:t.getShapeMaskedPageBounds(u).clone().expandBy(n)}));for(let u=0;u<l.length;u++){const d=l[u];if(u===0){i[0]={shapes:[d.shape],bounds:d.bounds};continue}let f=!1;for(const g of i)if(g.bounds.includes(d.bounds)){g.shapes.push(d.shape),g.bounds.expand(d.bounds),f=!0;break}f||i.push({shapes:[d.shape],bounds:d.bounds})}}else{const l=xe.Common(r.map(u=>t.getShapeMaskedPageBounds(u)));i.push({shapes:r,bounds:l})}const s=t.options.flattenImageBoundsPadding;for(const l of i){n!==void 0&&l.bounds.expandBy(-n);const u=await t.getSvgString(l.shapes,{padding:s});if(!(u!=null&&u.svg))continue;const d=await t.getAssetForExternalContent({type:"file",file:new File([u.svg],"asset.svg",{type:"image/svg+xml"})});d&&(l.asset=d)}const o=[];return uo(()=>{for(const l of i){const{asset:u,bounds:d,shapes:f}=l;if(!u)continue;const g=t.findCommonAncestor(f)??t.getCurrentPageId();if(!g)continue;let m="a1";for(const C of f)if(C.parentId===g){C.index>m&&(m=C.index);break}let S,b,v;if(Zr(g)){const C=t.getShape(g);if(!C)continue;const _=t.getPointInShapeSpace(C,{x:d.x,y:d.y});v=t.getShapePageTransform(g).rotation(),_.sub(new T(s,s).rot(-v)),S=_.x,b=_.y}else S=d.x-s,b=d.y-s,v=0;t.deleteShapes(f),t.createAssets([{...u,id:u.id}]);const w=Lt();t.createShape({id:w,type:"image",index:m,parentId:g,x:S,y:b,rotation:-v,props:{assetId:u.id,w:d.w+s*2,h:d.h+s*2}}),o.push(w)}}),o}function HS(){const t=Ml();return(t==null?void 0:t.store.props.collaboration)!==void 0}function Gre(){const t=Ml();return oe("sync status",()=>{var e;return(e=t==null?void 0:t.store.props.collaboration)!=null&&e.status?t.store.props.collaboration.status.get():null},[t])}const l1=[0,389,436,476,580,640,840,1023];var Sn=(t=>(t[t.ZERO=0]="ZERO",t[t.MOBILE_XXS=1]="MOBILE_XXS",t[t.MOBILE_XS=2]="MOBILE_XS",t[t.MOBILE_SM=3]="MOBILE_SM",t[t.MOBILE=4]="MOBILE",t[t.TABLET_SM=5]="TABLET_SM",t[t.TABLET=6]="TABLET",t[t.DESKTOP=7]="DESKTOP",t))(Sn||{});const V8=et.createContext(null);function qre({forceMobile:t=!1,children:e}){const n=Ml(),r=oe("breakpoint",()=>{const{width:i}=(n==null?void 0:n.getViewportScreenBounds())??{width:window.innerWidth},s=t?Sn.MOBILE_SM:l1.length-1;for(let o=0;o<s;o++)if(i>l1[o]&&i<=l1[o+1])return o;return s},[n]);return p.jsx(V8.Provider,{value:r,children:e})}function zr(){const t=E.useContext(V8);if(t===null)throw new Error("useBreakpoint must be used inside of the <BreakpointProvider /> component");return t}const jC=E.createContext(null);function Yre({context:t,children:e}){const n=E.useContext(jC),r=or(),i=V_("dialogs",[]),s=E.useMemo(()=>({dialogs:i,addDialog(o){const l=o.id??At();return i.update(u=>[...u.filter(d=>d.id!==o.id),{...o,id:l}]),r("open-menu",{source:"dialog",id:l}),Es.addOpenMenu(l,t),l},removeDialog(o){var u;const l=i.get().find(d=>d.id===o);return l&&((u=l.onClose)==null||u.call(l),r("close-menu",{source:"dialog",id:o}),Es.deleteOpenMenu(o,t),i.update(d=>d.filter(f=>f!==l))),o},clearDialogs(){const o=i.get();o.length!==0&&(o.forEach(l=>{var u;(u=l.onClose)==null||u.call(l),r("close-menu",{source:"dialog",id:l.id}),Es.deleteOpenMenu(l.id,t)}),i.set([]))}}),[r,i,t]);return n?p.jsx(p.Fragment,{children:e}):p.jsx(jC.Provider,{value:s,children:e})}function Sp(){const t=E.useContext(jC);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}var Vre="VisuallyHidden",SE=E.forwardRef((t,e)=>p.jsx(gt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));SE.displayName=Vre;var vE="ToastProvider",[bE,Wre,Xre]=TS("Toast"),[W8,Tye]=_o("Toast",[Xre]),[Zre,KS]=W8(vE),X8=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:o}=t,[l,u]=E.useState(null),[d,f]=E.useState(0),g=E.useRef(!1),m=E.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${vE}\`. Expected non-empty \`string\`.`),p.jsx(bE.Provider,{scope:e,children:p.jsx(Zre,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:s,toastCount:d,viewport:l,onViewportChange:u,onToastAdd:E.useCallback(()=>f(S=>S+1),[]),onToastRemove:E.useCallback(()=>f(S=>S-1),[]),isFocusedToastEscapeKeyDownRef:g,isClosePausedRef:m,children:o})})};X8.displayName=vE;var Z8="ToastViewport",Qre=["F8"],DC="toast.viewportPause",LC="toast.viewportResume",Q8=E.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=Qre,label:i="Notifications ({hotkey})",...s}=t,o=KS(Z8,n),l=Wre(n),u=E.useRef(null),d=E.useRef(null),f=E.useRef(null),g=E.useRef(null),m=Vt(e,g,o.onViewportChange),S=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=o.toastCount>0;E.useEffect(()=>{const w=C=>{var M;r.length!==0&&r.every(I=>C[I]||C.code===I)&&((M=g.current)==null||M.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[r]),E.useEffect(()=>{const w=u.current,C=g.current;if(b&&w&&C){const _=()=>{if(!o.isClosePausedRef.current){const R=new CustomEvent(DC);C.dispatchEvent(R),o.isClosePausedRef.current=!0}},M=()=>{if(o.isClosePausedRef.current){const R=new CustomEvent(LC);C.dispatchEvent(R),o.isClosePausedRef.current=!1}},I=R=>{!w.contains(R.relatedTarget)&&M()},A=()=>{w.contains(document.activeElement)||M()};return w.addEventListener("focusin",_),w.addEventListener("focusout",I),w.addEventListener("pointermove",_),w.addEventListener("pointerleave",A),window.addEventListener("blur",_),window.addEventListener("focus",M),()=>{w.removeEventListener("focusin",_),w.removeEventListener("focusout",I),w.removeEventListener("pointermove",_),w.removeEventListener("pointerleave",A),window.removeEventListener("blur",_),window.removeEventListener("focus",M)}}},[b,o.isClosePausedRef]);const v=E.useCallback(({tabbingDirection:w})=>{const _=l().map(M=>{const I=M.ref.current,A=[I,...die(I)];return w==="forwards"?A:A.reverse()});return(w==="forwards"?_.reverse():_).flat()},[l]);return E.useEffect(()=>{const w=g.current;if(w){const C=_=>{var A,R,D;const M=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!M){const L=document.activeElement,G=_.shiftKey;if(_.target===w&&G){(A=d.current)==null||A.focus();return}const F=v({tabbingDirection:G?"backwards":"forwards"}),N=F.findIndex(B=>B===L);c1(F.slice(N+1))?_.preventDefault():G?(R=d.current)==null||R.focus():(D=f.current)==null||D.focus()}};return w.addEventListener("keydown",C),()=>w.removeEventListener("keydown",C)}},[l,v]),p.jsxs(PJ,{ref:u,role:"region","aria-label":i.replace("{hotkey}",S),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&p.jsx(NC,{ref:d,onFocusFromOutsideViewport:()=>{const w=v({tabbingDirection:"forwards"});c1(w)}}),p.jsx(bE.Slot,{scope:n,children:p.jsx(gt.ol,{tabIndex:-1,...s,ref:m})}),b&&p.jsx(NC,{ref:f,onFocusFromOutsideViewport:()=>{const w=v({tabbingDirection:"backwards"});c1(w)}})]})});Q8.displayName=Z8;var J8="ToastFocusProxy",NC=E.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,s=KS(J8,n);return p.jsx(SE,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:o=>{var d;const l=o.relatedTarget;!((d=s.viewport)!=null&&d.contains(l))&&r()}})});NC.displayName=J8;var GS="Toast",Jre="toast.swipeStart",eie="toast.swipeMove",tie="toast.swipeCancel",nie="toast.swipeEnd",e$=E.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:s,...o}=t,[l=!0,u]=Rl({prop:r,defaultProp:i,onChange:s});return p.jsx(Ns,{present:n||l,children:p.jsx(sie,{open:l,...o,ref:e,onClose:()=>u(!1),onPause:rr(t.onPause),onResume:rr(t.onResume),onSwipeStart:Re(t.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Re(t.onSwipeMove,d=>{const{x:f,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${g}px`)}),onSwipeCancel:Re(t.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Re(t.onSwipeEnd,d=>{const{x:f,y:g}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${g}px`),u(!1)})})})});e$.displayName=GS;var[rie,iie]=W8(GS,{onClose(){}}),sie=E.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:s,onClose:o,onEscapeKeyDown:l,onPause:u,onResume:d,onSwipeStart:f,onSwipeMove:g,onSwipeCancel:m,onSwipeEnd:S,...b}=t,v=KS(GS,n),[w,C]=E.useState(null),_=Vt(e,B=>C(B)),M=E.useRef(null),I=E.useRef(null),A=i||v.duration,R=E.useRef(0),D=E.useRef(A),L=E.useRef(0),{onToastAdd:G,onToastRemove:k}=v,$=rr(()=>{var Y;(w==null?void 0:w.contains(document.activeElement))&&((Y=v.viewport)==null||Y.focus()),o()}),F=E.useCallback(B=>{!B||B===1/0||(window.clearTimeout(L.current),R.current=new Date().getTime(),L.current=window.setTimeout($,B))},[$]);E.useEffect(()=>{const B=v.viewport;if(B){const Y=()=>{F(D.current),d==null||d()},K=()=>{const V=new Date().getTime()-R.current;D.current=D.current-V,window.clearTimeout(L.current),u==null||u()};return B.addEventListener(DC,K),B.addEventListener(LC,Y),()=>{B.removeEventListener(DC,K),B.removeEventListener(LC,Y)}}},[v.viewport,A,u,d,F]),E.useEffect(()=>{s&&!v.isClosePausedRef.current&&F(A)},[s,A,v.isClosePausedRef,F]),E.useEffect(()=>(G(),()=>k()),[G,k]);const N=E.useMemo(()=>w?a$(w):null,[w]);return v.viewport?p.jsxs(p.Fragment,{children:[N&&p.jsx(oie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:N}),p.jsx(rie,{scope:n,onClose:$,children:Ed.createPortal(p.jsx(bE.ItemSlot,{scope:n,children:p.jsx(EJ,{asChild:!0,onEscapeKeyDown:Re(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||$(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:p.jsx(gt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":v.swipeDirection,...b,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Re(t.onKeyDown,B=>{B.key==="Escape"&&(l==null||l(B.nativeEvent),B.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,$()))}),onPointerDown:Re(t.onPointerDown,B=>{B.button===0&&(M.current={x:B.clientX,y:B.clientY})}),onPointerMove:Re(t.onPointerMove,B=>{if(!M.current)return;const Y=B.clientX-M.current.x,K=B.clientY-M.current.y,V=!!I.current,W=["left","right"].includes(v.swipeDirection),ee=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,H=W?ee(0,Y):0,te=W?0:ee(0,K),ge=B.pointerType==="touch"?10:2,de={x:H,y:te},Se={originalEvent:B,delta:de};V?(I.current=de,rm(eie,g,Se,{discrete:!1})):KO(de,v.swipeDirection,ge)?(I.current=de,rm(Jre,f,Se,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs(Y)>ge||Math.abs(K)>ge)&&(M.current=null)}),onPointerUp:Re(t.onPointerUp,B=>{const Y=I.current,K=B.target;if(K.hasPointerCapture(B.pointerId)&&K.releasePointerCapture(B.pointerId),I.current=null,M.current=null,Y){const V=B.currentTarget,W={originalEvent:B,delta:Y};KO(Y,v.swipeDirection,v.swipeThreshold)?rm(nie,S,W,{discrete:!0}):rm(tie,m,W,{discrete:!0}),V.addEventListener("click",ee=>ee.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),oie=t=>{const{__scopeToast:e,children:n,...r}=t,i=KS(GS,e),[s,o]=E.useState(!1),[l,u]=E.useState(!1);return cie(()=>o(!0)),E.useEffect(()=>{const d=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:p.jsx(pp,{asChild:!0,children:p.jsx(SE,{...r,children:s&&p.jsxs(p.Fragment,{children:[i.label," ",n]})})})},aie="ToastTitle",t$=E.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return p.jsx(gt.div,{...r,ref:e})});t$.displayName=aie;var lie="ToastDescription",n$=E.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return p.jsx(gt.div,{...r,ref:e})});n$.displayName=lie;var r$="ToastAction",i$=E.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?p.jsx(o$,{altText:n,asChild:!0,children:p.jsx(xE,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${r$}\`. Expected non-empty \`string\`.`),null)});i$.displayName=r$;var s$="ToastClose",xE=E.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=iie(s$,n);return p.jsx(o$,{asChild:!0,children:p.jsx(gt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,i.onClose)})})});xE.displayName=s$;var o$=E.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return p.jsx(gt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function a$(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),uie(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...a$(r))}}),e}function rm(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?D2(i,s):i.dispatchEvent(s)}var KO=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),s=r>i;return e==="left"||e==="right"?s&&r>n:!s&&i>n};function cie(t=()=>{}){const e=rr(t);vl(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function uie(t){return t.nodeType===t.ELEMENT_NODE}function die(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function c1(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var hie=e$,fie=t$,pie=n$,gie=i$,GO=xE;const zC=E.createContext(null);function mie({children:t}){const e=V_("toasts",[]),n=E.useContext(zC),r=E.useMemo(()=>({toasts:e,addToast(i){const s=i.id??At();return e.update(o=>[...o.filter(l=>l.id!==i.id),{...i,id:s}]),s},removeToast(i){return e.update(s=>s.filter(o=>o.id!==i)),i},clearToasts(){e.set([])}}),[e]);return n?p.jsx(p.Fragment,{children:t}):p.jsx(X8,{children:p.jsx(zC.Provider,{value:r,children:t})})}function _a(){const t=E.useContext(zC);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}var u1={exports:{}},qO;function yie(){return qO||(qO=1,function(t){var e=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function o(u,d){if(!s[u]){s[u]={};for(var f=0;f<u.length;f++)s[u][u.charAt(f)]=f}return s[u][d]}var l={compressToBase64:function(u){if(u==null)return"";var d=l._compress(u,6,function(f){return r.charAt(f)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(u){return u==null?"":u==""?null:l._decompress(u.length,32,function(d){return o(r,u.charAt(d))})},compressToUTF16:function(u){return u==null?"":l._compress(u,15,function(d){return n(d+32)})+" "},decompressFromUTF16:function(u){return u==null?"":u==""?null:l._decompress(u.length,16384,function(d){return u.charCodeAt(d)-32})},compressToUint8Array:function(u){for(var d=l.compress(u),f=new Uint8Array(d.length*2),g=0,m=d.length;g<m;g++){var S=d.charCodeAt(g);f[g*2]=S>>>8,f[g*2+1]=S%256}return f},decompressFromUint8Array:function(u){if(u==null)return l.decompress(u);for(var d=new Array(u.length/2),f=0,g=d.length;f<g;f++)d[f]=u[f*2]*256+u[f*2+1];var m=[];return d.forEach(function(S){m.push(n(S))}),l.decompress(m.join(""))},compressToEncodedURIComponent:function(u){return u==null?"":l._compress(u,6,function(d){return i.charAt(d)})},decompressFromEncodedURIComponent:function(u){return u==null?"":u==""?null:(u=u.replace(/ /g,"+"),l._decompress(u.length,32,function(d){return o(i,u.charAt(d))}))},compress:function(u){return l._compress(u,16,function(d){return n(d)})},_compress:function(u,d,f){if(u==null)return"";var g,m,S={},b={},v="",w="",C="",_=2,M=3,I=2,A=[],R=0,D=0,L;for(L=0;L<u.length;L+=1)if(v=u.charAt(L),Object.prototype.hasOwnProperty.call(S,v)||(S[v]=M++,b[v]=!0),w=C+v,Object.prototype.hasOwnProperty.call(S,w))C=w;else{if(Object.prototype.hasOwnProperty.call(b,C)){if(C.charCodeAt(0)<256){for(g=0;g<I;g++)R=R<<1,D==d-1?(D=0,A.push(f(R)),R=0):D++;for(m=C.charCodeAt(0),g=0;g<8;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1}else{for(m=1,g=0;g<I;g++)R=R<<1|m,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=0;for(m=C.charCodeAt(0),g=0;g<16;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1}_--,_==0&&(_=Math.pow(2,I),I++),delete b[C]}else for(m=S[C],g=0;g<I;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1;_--,_==0&&(_=Math.pow(2,I),I++),S[w]=M++,C=String(v)}if(C!==""){if(Object.prototype.hasOwnProperty.call(b,C)){if(C.charCodeAt(0)<256){for(g=0;g<I;g++)R=R<<1,D==d-1?(D=0,A.push(f(R)),R=0):D++;for(m=C.charCodeAt(0),g=0;g<8;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1}else{for(m=1,g=0;g<I;g++)R=R<<1|m,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=0;for(m=C.charCodeAt(0),g=0;g<16;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1}_--,_==0&&(_=Math.pow(2,I),I++),delete b[C]}else for(m=S[C],g=0;g<I;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1;_--,_==0&&(_=Math.pow(2,I),I++)}for(m=2,g=0;g<I;g++)R=R<<1|m&1,D==d-1?(D=0,A.push(f(R)),R=0):D++,m=m>>1;for(;;)if(R=R<<1,D==d-1){A.push(f(R));break}else D++;return A.join("")},decompress:function(u){return u==null?"":u==""?null:l._decompress(u.length,32768,function(d){return u.charCodeAt(d)})},_decompress:function(u,d,f){var g=[],m=4,S=4,b=3,v="",w=[],C,_,M,I,A,R,D,L={val:f(0),position:d,index:1};for(C=0;C<3;C+=1)g[C]=C;for(M=0,A=Math.pow(2,2),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;switch(M){case 0:for(M=0,A=Math.pow(2,8),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;D=n(M);break;case 1:for(M=0,A=Math.pow(2,16),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;D=n(M);break;case 2:return""}for(g[3]=D,_=D,w.push(D);;){if(L.index>u)return"";for(M=0,A=Math.pow(2,b),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;switch(D=M){case 0:for(M=0,A=Math.pow(2,8),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;g[S++]=n(M),D=S-1,m--;break;case 1:for(M=0,A=Math.pow(2,16),R=1;R!=A;)I=L.val&L.position,L.position>>=1,L.position==0&&(L.position=d,L.val=f(L.index++)),M|=(I>0?1:0)*R,R<<=1;g[S++]=n(M),D=S-1,m--;break;case 2:return w.join("")}if(m==0&&(m=Math.pow(2,b),b++),g[D])v=g[D];else if(D===S)v=_+_.charAt(0);else return null;w.push(v),g[S++]=_+v.charAt(0),m--,_=v,m==0&&(m=Math.pow(2,b),b++)}}};return l}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})}(u1)),u1.exports}var Sie=yie();const l$=_l(Sie),wE="web image/vnd.tldraw+png",vie={"image/png":wE},bie={[wE]:"image/png"};function xie(t){return xr(vie,t)??null}function wie(t){return xr(bie,t)??t}function Cie(t){return typeof ClipboardItem<"u"&&"supports"in ClipboardItem&&ClipboardItem.supports(t)}function _ie(t){const e=Object.entries(t);for(const[n,r]of e)r.catch(i=>console.error(i));return navigator.clipboard.write([new ClipboardItem(t)]).catch(n=>(console.error(n),Promise.all(e.map(async([r,i])=>[r,await i])).then(r=>{const i=M_(r);return navigator.clipboard.write([new ClipboardItem(i)])})))}async function Eie(t,e,n,r){const i=e.map(s=>s instanceof File?s:new File([s],"tldrawFile",{type:s.type}));t.markHistoryStoppingPoint("paste"),await t.putExternalContent({type:"files",files:i,point:n,ignoreParent:!1,sources:r})}async function $C(t,e,n,r){return t.markHistoryStoppingPoint("paste"),await t.putExternalContent({type:"url",point:n,url:e,sources:r})}const Pie=[wE,"image/png","image/jpeg","image/webp","image/svg+xml"];function Tie(t){const e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=t.trim(),e.body.textContent||e.body.innerText||""}const Iie=t=>{try{const e=new URL(t);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}},Mie=t=>{const e=t.split(/[\n\s]/);for(const n of e)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return e4(e)},Aie=t=>/^<svg/.test(t),kie=["input","select","textarea"];function d1(t){const{activeElement:e}=document;return t.menus.hasAnyOpenMenus()||e&&(e.getAttribute("contenteditable")||kie.indexOf(e.tagName.toLowerCase())>-1)}const im=(t,e,n,r)=>{const i=Mie(e);if(i)for(const s of i)$C(t,s,n);else Iie(e)?$C(t,e,n):Aie(e)?(t.markHistoryStoppingPoint("paste"),t.putExternalContent({type:"svg-text",text:e,point:n,sources:r})):(t.markHistoryStoppingPoint("paste"),t.putExternalContent({type:"text",text:e,point:n,sources:r}))},Rie=async(t,e,n)=>{if(t.getEditingShapeId()!==null)return;if(!e)throw Error("No clipboard data");const r=[];for(const i of Object.values(e.items))switch(i.kind){case"file":{r.push({type:"file",source:new Promise(s=>s(i.getAsFile()))});break}case"string":{i.type==="text/html"?r.push({type:"html",source:new Promise(s=>i.getAsString(s))}):i.type==="text/plain"?r.push({type:"text",source:new Promise(s=>i.getAsString(s))}):r.push({type:i.type,source:new Promise(s=>i.getAsString(s))});break}}u$(t,r,n)},c$=async({editor:t,clipboardItems:e,point:n,fallbackFiles:r})=>{const i=[];for(const s of e){for(const o of Pie)if(s.types.includes(o)){const l=s.getType(o).then(u=>Ts.rewriteMimeType(u,wie(o)));i.push({type:"blob",source:l});break}s.types.includes("text/html")&&i.push({type:"html",source:(async()=>{const o=await s.getType("text/html");return await Ts.blobToText(o)})()}),s.types.includes("text/uri-list")&&i.push({type:"url",source:(async()=>{const o=await s.getType("text/uri-list");return await Ts.blobToText(o)})()}),s.types.includes("text/plain")&&i.push({type:"text",source:(async()=>{const o=await s.getType("text/plain");return await Ts.blobToText(o)})()})}return r!=null&&r.length&&i.length===1&&i[0].type==="text"&&(i.pop(),i.push(...r.map(s=>({type:"file",source:Promise.resolve(s)})))),await u$(t,i,n)};async function u$(t,e,n){const r=e.filter(s=>(s.type==="file"||s.type==="blob")&&s.source!==null);if(r.length){if(r.length>t.options.maxFilesAtOnce)throw Error("Too many files");const s=We(await Promise.all(r.map(o=>o.source)));return await Eie(t,s,n)}const i=await Promise.all(e.filter(s=>s.type!=="file").map(s=>new Promise(o=>{const l=s;if(l.type==="file"){o({type:"error",data:null,reason:"unexpected file"});return}l.source.then(u=>{var f;const d=(f=u.match(/<div data-tldraw[^>]*>(.*)<\/div>/))==null?void 0:f[1];if(d)try{const g=l$.decompressFromBase64(d);if(g===null){o({type:"error",data:g,reason:"found tldraw data comment but could not parse base64"});return}else{const m=JSON.parse(g);if(m.type!=="application/tldraw"&&o({type:"error",data:m,reason:`found tldraw data comment but JSON was of a different type: ${m.type}`}),typeof m.data=="string"){o({type:"error",data:m,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}o({type:"tldraw",data:m.data});return}}catch{o({type:"error",data:d,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(l.type==="html"){o({type:"text",data:u,subtype:"html"});return}if(l.type==="url"){o({type:"text",data:u,subtype:"url"});return}try{const g=JSON.parse(u);if(g.type==="excalidraw/clipboard"){o({type:"excalidraw",data:g});return}else{o({type:"text",data:u,subtype:"json"});return}}catch{o({type:"text",data:u,subtype:"text"});return}}o({type:"error",data:u,reason:"unhandled case"})})})));for(const s of i)if(s.type==="tldraw"){t.markHistoryStoppingPoint("paste"),t.putExternalContent({type:"tldraw",content:s.data,point:n});return}for(const s of i)if(s.type==="excalidraw"){t.markHistoryStoppingPoint("paste"),t.putExternalContent({type:"excalidraw",content:s.data,point:n});return}for(const s of i){if(s.type==="text"&&s.subtype==="html"){const l=new DOMParser().parseFromString(s.data,"text/html").querySelector("body");if(l&&Array.from(l.children).filter(d=>d.nodeType===1).length===1&&l.firstElementChild&&l.firstElementChild.tagName==="A"&&l.firstElementChild.hasAttribute("href")&&l.firstElementChild.getAttribute("href")!==""){const d=l.firstElementChild.getAttribute("href");im(t,d,n,i);return}if(!i.some(d=>d.type==="text"&&d.subtype!=="html")&&s.data.trim()){im(t,Tie(s.data),n,i);return}}if(s.type==="text"&&s.subtype==="text"&&s.data.startsWith("<iframe ")){const l=new DOMParser().parseFromString(s.data,"text/html").querySelector("body");if(l&&Array.from(l.children).filter(d=>d.nodeType===1).length===1&&l.firstElementChild&&l.firstElementChild.tagName==="IFRAME"&&l.firstElementChild.hasAttribute("src")&&l.firstElementChild.getAttribute("src")!==""){const d=l.firstElementChild.getAttribute("src");im(t,d,n,i);return}}}for(const s of i)if(s.type==="text"&&s.subtype==="url"){$C(t,s.data,n,i);return}for(const s of i)if(s.type==="text"&&s.subtype==="text"&&s.data.trim()){im(t,s.data,n,i);return}}const zy=async t=>{var r;const e=await t.resolveAssetsInContent(t.getContentFromCurrentPage(t.getSelectedShapeIds()));if(!e){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const n=l$.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:e}));if(!(typeof navigator>"u")){const i=e.shapes.map(s=>t.getShapeUtil(s).getText(s)).filter($H);if((r=navigator.clipboard)!=null&&r.write){const s=new Blob([`<div data-tldraw>${n}</div>`],{type:"text/html"});let o=i.join(" ");o===""&&(o=" "),navigator.clipboard.write([new ClipboardItem({"text/html":s,"text/plain":new Blob([o],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<div data-tldraw>${n}</div>`)}};function Oie(){const t=re(),e=or(),n=E.useCallback(async function(o){t.getSelectedShapeIds().length!==0&&(await zy(t),e("copy",{source:o}))},[t,e]),r=E.useCallback(async function(o){t.getSelectedShapeIds().length!==0&&(await zy(t),t.deleteShapes(t.getSelectedShapeIds()),e("cut",{source:o}))},[t,e]),i=E.useCallback(async function(o,l,u){t.getEditingShapeId()===null&&(Array.isArray(o)&&o[0]instanceof ClipboardItem?(c$({editor:t,clipboardItems:o,point:u}),e("paste",{source:"menu"})):navigator.clipboard.read().then(d=>{i(d,l,u)}))},[t,e]);return{copy:n,cut:r,paste:i}}function jie(){const t=re(),e=or(),n=oe("editor.isFocused",()=>t.getInstanceState().isFocused,[t]);E.useEffect(()=>{if(!n)return;const r=async u=>{t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||d1(t)||(Je(u),await zy(t),e("copy",{source:"kbd"}))};async function i(u){t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||d1(t)||(Je(u),await zy(t),t.deleteShapes(t.getSelectedShapeIds()),e("cut",{source:"kbd"}))}let s=!1;const o=u=>{u.button===1&&(s=!0,t.timers.requestAnimationFrame(()=>{s=!1}))},l=u=>{var m,S;if(s){_n(u);return}if(t.getEditingShapeId()!==null||d1(t))return;let d,f=!1;t.inputs.shiftKey&&(f=!0),t.user.getIsPasteAtCursorMode()&&(f=!f),f&&(d=t.inputs.currentPagePoint);const g=()=>{u.clipboardData&&Rie(t,u.clipboardData,d)};if((m=navigator.clipboard)!=null&&m.read){const b=Array.from(((S=u.clipboardData)==null?void 0:S.files)||[]);navigator.clipboard.read().then(v=>{Array.isArray(v)&&v[0]instanceof ClipboardItem&&c$({editor:t,clipboardItems:v,point:d,fallbackFiles:b})},()=>{g()})}else g();Je(u),e("paste",{source:"kbd"})};return document.addEventListener("copy",r),document.addEventListener("cut",i),document.addEventListener("paste",l),document.addEventListener("pointerup",o),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",i),document.removeEventListener("paste",l),document.removeEventListener("pointerup",o)}},[t,e,n])}const Die={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",svg:"text/plain"};function Lie(t,e,n={}){const r=e!=null&&e.length?e:[...t.getCurrentPageShapeIds()],i=n.format??"png";return{blobPromise:t.toImage(r,n).then(s=>s.blob),mimeType:Die[i]}}function Nie(...t){const[e,n,r]=typeof t[2]=="string"?[t[0],t[1],{...t[3],format:t[2]}]:t;if(!navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(navigator.clipboard.write){const{blobPromise:i,mimeType:s}=Lie(e,n,r),o={[s]:i},l=xie(s);return l&&Cie(l)&&(o[l]=i.then(u=>Ts.rewriteMimeType(u,l))),_ie(o)}switch(r.format){case"svg":return zie(async()=>{const i=await e.getSvgString(n,r);if(!i)throw new Error("Failed to copy");return i.svg});case"png":throw new Error("Copy not supported");default:An(r.format)}}async function zie(t){var e,n;await((n=(e=navigator.clipboard)==null?void 0:e.writeText)==null?void 0:n.call(e,await t()))}function $ie(){const t=re(),{addToast:e}=_a(),n=ut();return E.useCallback((r,i="svg")=>{Nie(t,r,{format:i}).catch(()=>{e({id:"copy-fail",severity:"warning",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")})})},[t,e,n])}async function Bie(...t){const[e,n,r]=typeof t[2]=="object"?t:[t[0],t[1],{...t[4],format:t[2]??"png",name:t[3]}];let i=r.name;if(!i&&(i=`shapes at ${YO()}`,n.length===1)){const l=e.getShape(n[0]);e.isShapeOfType(l,"frame")?i=l.props.name||"frame":i=`${uS(l.id)} at ${YO()}`}i+=`.${r.format}`;const{blob:s}=await e.toImage(n,r),o=new File([s],i,{type:s.type});Fie(o)}function YO(){const t=new Date,e=String(t.getFullYear()).slice(2),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return`${e}-${n}-${r} ${i}.${s}.${o}`}function Fie(t){const e=document.createElement("a"),n=URL.createObjectURL(t);e.href=n,e.download=t.name,e.click(),URL.revokeObjectURL(n)}function Uie(){const t=re(),{addToast:e}=_a(),n=ut();return E.useCallback((r,i="png",s)=>{Bie(t,r,{format:i,name:s,scale:1}).catch(o=>{console.error(o.message),e({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc"),severity:"error"})})},[t,e,n])}const d$=et.createContext([]);function Hie(){const t=re(),e=E.useRef(),n=cl(et.useContext(d$));return E.useEffect(()=>{const r=window.document.createElement("input");r.type="file",r.accept=(n==null?void 0:n.join(","))??gH,r.multiple=!0,e.current=r;async function i(s){const o=s.target.files;!o||o.length===0||(t.markHistoryStoppingPoint("insert media"),await t.putExternalContent({type:"files",files:Array.from(o),point:t.getViewportPageBounds().center,ignoreParent:!1}),r.value="")}return r.addEventListener("change",i),()=>{e.current=void 0,r.removeEventListener("change",i)}},[t,n]),E.useCallback(()=>{var r;(r=e.current)==null||r.click()},[e])}function Kie(){const t=re(),e=E.useRef(null),n=E.useRef(null);return E.useCallback(async function(){const i=document.createElement("div"),s=document.createElement("style"),o=(C,_)=>{C&&(C.innerHTML=""),_&&document.head.contains(_)&&document.head.removeChild(_),C&&document.body.contains(C)&&document.body.removeChild(C)};o(e.current,n.current),e.current=i,n.current=s;const l=`tl-print-surface-${At()}`;i.className=l,s.innerHTML=`
			.${l} {
				display: none;
			}

			.${l} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${l} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${l}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${l}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${l}__item__header {
					display: none;
				}

				.${l}__item__footer {
					display: none;
					text-align: right;
				}

				.${l}__item__footer__hide {
					display: none;
				}

				
			}

		`;const u=()=>{document.head.appendChild(s),document.body.appendChild(i)},d=()=>{t.once("tick",()=>{o(i,s)})};window.addEventListener("beforeprint",u),window.addEventListener("afterprint",d);function f(C,_,M){try{i.innerHTML+=`<div class="${l}__item">
        <div class="${l}__item__header">
          ${C.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${l}__item__main">
          ${M}
        </div>
        <div class="${l}__item__footer ${l}__item__footer__${_?"":"hide"}">
          ${_??""}
        </div>
      </div>`}catch(I){console.error(I)}}function g(){Ft.isChromeForIos?(u(),window.print()):Ft.isSafari?(u(),document.execCommand("print",!1)):window.print()}const m=t.getSelectedShapeIds(),S=t.getCurrentPageId(),b=t.getPages(),w={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.getSelectedShapeIds().length>0){const C=await t.getSvgString(m,w);if(C){const _=b.find(M=>M.id===S);f(`tldraw  ${_==null?void 0:_.name}`,null,C.svg),g()}}else{const C=t.getCurrentPage(),_=await t.getSvgString(t.getSortedChildIdsForParent(C.id),w);_&&(f(`tldraw  ${C.name}`,null,_.svg),g())}window.removeEventListener("beforeprint",u),window.removeEventListener("afterprint",d)},[t])}function CE(){const{addToast:t,removeToast:e,clearToasts:n}=_a(),{addDialog:r,clearDialogs:i,removeDialog:s}=Sp(),o=ut(),l=Hie(),u=Kie(),{cut:d,copy:f,paste:g}=Oie(),m=$ie(),S=Uie(),b=yE(),w=zr()<Sn.TABLET_SM;return E.useMemo(()=>({addToast:t,removeToast:e,clearToasts:n,addDialog:r,removeDialog:s,clearDialogs:i,msg:o,isMobile:w,insertMedia:l,printSelectionOrPages:u,cut:d,copy:f,paste:g,copyAs:m,exportAs:S,getEmbedDefinition:b}),[t,e,n,r,s,i,o,w,l,u,d,f,g,m,S,b])}function Gie(t,e){const n={};for(const r of t)if(r.translations)for(const[i,s]of ri(r.translations)){let o=n[i];o||(o=n[i]={}),Object.assign(o,s)}return{actions:(r,i,s)=>{for(const o of t)o.actions&&(i=o.actions(r,i,s));return i},tools:(r,i,s)=>{for(const o of t)o.tools&&(i=o.tools(r,i,{...e,...s}));return i},translations:n}}function h$(t){return E.useMemo(()=>t,t)}function qie(t){const e=h$(t==null?[]:Array.isArray(t)?t:[t]);return E.useMemo(()=>{const n={};for(const r of e)if(r.translations)for(const[i,s]of ri(r.translations)){let o=n[i];o||(o=n[i]={}),Object.assign(o,s)}return n},[e])}function Yie(t){const e=CE(),n=h$(t==null?[]:Array.isArray(t)?t:[t]);return E.useMemo(()=>Gie(n,e),[n,e])}const f$=E.createContext(null);function Vie(t){return Object.fromEntries(t.map(e=>[e.id,e]))}function sm(t,e){if(t.getSelectedShapes().length===0)return t.getDocumentSettings().name||e}function Wie({overrides:t,children:e}){const n=re(),r=HS(),i=CE(),s=or(),o=i.msg("document.default-name"),l=E.useMemo(()=>{function u(){return n.isIn("select")||(n.complete(),n.setCurrentTool("select")),!1}function d(){return n.isIn("select")&&n.getSelectedShapeIds().length>0}const f=[{id:"edit-link",label:"action.edit-link",icon:"link",onSelect(m){d()&&(u()||(s("edit-link",{source:m}),n.markHistoryStoppingPoint("edit-link"),i.addDialog({component:Lre})))}},{id:"insert-embed",label:"action.insert-embed",kbd:"$i",onSelect(m){s("insert-embed",{source:m}),i.addDialog({component:Y8})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",onSelect(m){s("insert-media",{source:m}),i.insertMedia()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",onSelect(m){s("undo",{source:m}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",onSelect(m){s("redo",{source:m}),n.redo()}},{id:"export-as-svg",label:{default:"action.export-as-svg",menu:"action.export-as-svg.short","context-menu":"action.export-as-svg.short"},readonlyOk:!0,onSelect(m){let S=n.getSelectedShapeIds();S.length===0&&(S=Array.from(n.getCurrentPageShapeIds().values())),S.length!==0&&(s("export-as",{format:"svg",source:m}),i.exportAs(S,"svg",sm(n,o)))}},{id:"export-as-png",label:{default:"action.export-as-png",menu:"action.export-as-png.short","context-menu":"action.export-as-png.short"},readonlyOk:!0,onSelect(m){let S=n.getSelectedShapeIds();S.length===0&&(S=Array.from(n.getCurrentPageShapeIds().values())),S.length!==0&&(s("export-as",{format:"png",source:m}),i.exportAs(S,"png",sm(n,o)))}},{id:"export-all-as-svg",label:{default:"action.export-all-as-svg",menu:"action.export-all-as-svg.short","context-menu":"action.export-all-as-svg.short"},readonlyOk:!0,onSelect(m){let S=n.getSelectedShapeIds();S.length===0&&(S=Array.from(n.getCurrentPageShapeIds().values())),S.length!==0&&(s("export-all-as",{format:"svg",source:m}),i.exportAs(Array.from(n.getCurrentPageShapeIds()),"svg",sm(n,o)))}},{id:"export-all-as-png",label:{default:"action.export-all-as-png",menu:"action.export-all-as-png.short","context-menu":"action.export-all-as-png.short"},readonlyOk:!0,onSelect(m){const S=Array.from(n.getCurrentPageShapeIds().values());S.length!==0&&(s("export-all-as",{format:"png",source:m}),i.exportAs(S,"png",sm(n,o)))}},{id:"copy-as-svg",label:{default:"action.copy-as-svg",menu:"action.copy-as-svg.short","context-menu":"action.copy-as-svg.short"},kbd:"$!c",readonlyOk:!0,onSelect(m){let S=n.getSelectedShapeIds();S.length===0&&(S=Array.from(n.getCurrentPageShapeIds().values())),S.length!==0&&(s("copy-as",{format:"svg",source:m}),i.copyAs(S,"svg"))}},{id:"copy-as-png",label:{default:"action.copy-as-png",menu:"action.copy-as-png.short","context-menu":"action.copy-as-png.short"},readonlyOk:!0,onSelect(m){let S=n.getSelectedShapeIds();S.length===0&&(S=Array.from(n.getCurrentPageShapeIds().values())),S.length!==0&&(s("copy-as",{format:"png",source:m}),i.copyAs(S,"png"))}},{id:"toggle-auto-size",label:"action.toggle-auto-size",onSelect(m){if(!d()||u())return;s("toggle-auto-size",{source:m}),n.markHistoryStoppingPoint("toggling auto size");const S=n.getSelectedShapes().filter(b=>n.isShapeOfType(b,"text")&&b.props.autoSize===!1);n.updateShapes(S.map(b=>({id:b.id,type:b.type,props:{...b.props,w:8,autoSize:!0}}))),qt(n,S.map(b=>b.id))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(m){s("open-embed-link",{source:m});const S=n.getSelectedShapeIds(),b="No embed shapes selected";if(S.length!==1){console.error(b);return}const v=n.getShape(S[0]);if(!v||!n.isShapeOfType(v,"embed")){console.error(b);return}lJ(v.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(m){var S,b;if(((S=n.root.getCurrent())==null?void 0:S.id)!=="zoom"&&(s("zoom-tool",{source:m}),!(n.inputs.shiftKey||n.inputs.ctrlKey))){const v=n.root.getCurrent();v&&((b=v.getCurrent())==null?void 0:b.id)==="idle"&&n.setCurrentTool("zoom",{onInteractionEnd:v.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",onSelect(m){d()&&(u()||n.run(()=>{s("convert-to-bookmark",{source:m});const S=n.getSelectedShapes(),b=[],v=[];for(const w of S){if(!w||!n.isShapeOfType(w,"embed")||!w.props.url)continue;const C=new T(w.x,w.y);C.rot(-w.rotation),C.add(new T(w.props.w/2-300/2,w.props.h/2-320/2)),C.rot(w.rotation);const _={id:Lt(),type:"bookmark",rotation:w.rotation,x:C.x,y:C.y,opacity:1,props:{url:w.props.url}};b.push(_),v.push(w.id)}n.markHistoryStoppingPoint("convert shapes to bookmark"),n.deleteShapes(v),n.createShapes(b)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",onSelect(m){d()&&(u()||(s("convert-to-embed",{source:m}),n.run(()=>{const S=n.getSelectedShapeIds(),b=We(S.map(C=>n.getShape(C))),v=[],w=[];for(const C of b){if(!n.isShapeOfType(C,"bookmark"))continue;const{url:_}=C.props,M=i.getEmbedDefinition(_);if(!M||!M.definition)continue;const{width:I,height:A}=M.definition,R=new T(C.x,C.y);R.rot(-C.rotation),R.add(new T(C.props.w/2-I/2,C.props.h/2-A/2)),R.rot(C.rotation);const D={id:Lt(),type:"embed",x:R.x,y:R.y,rotation:C.rotation,props:{url:_,w:I,h:A}};v.push(D),w.push(C.id)}n.markHistoryStoppingPoint("convert shapes to embed"),n.deleteShapes(w),n.createShapes(v)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",onSelect(m){if(!d()||u())return;s("duplicate-shapes",{source:m});const S=n.getInstanceState();let b,v;if(S.duplicateProps)b=S.duplicateProps.shapeIds,v=S.duplicateProps.offset;else{b=n.getSelectedShapeIds();const w=xe.Common(We(b.map(C=>n.getShapePageBounds(C))));v=n.getCameraOptions().isLocked?{x:n.options.adjacentShapeMargin,y:n.options.adjacentShapeMargin}:{x:w.width+n.options.adjacentShapeMargin,y:0}}n.markHistoryStoppingPoint("duplicate shapes"),n.duplicateShapes(b,v),S.duplicateProps&&n.updateInstanceState({duplicateProps:{...S.duplicateProps,shapeIds:n.getSelectedShapeIds()}})}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",onSelect(m){d()&&(u()||(s("ungroup-shapes",{source:m}),n.markHistoryStoppingPoint("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",onSelect(m){if(!d()||u())return;s("group-shapes",{source:m});const S=n.getOnlySelectedShape();S&&n.isShapeOfType(S,"group")?(n.markHistoryStoppingPoint("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())):(n.markHistoryStoppingPoint("group"),n.groupShapes(n.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",onSelect(m){if(!d())return;s("remove-frame",{source:m});const S=n.getSelectedShapes();S.length>0&&S.every(b=>n.isShapeOfType(b,"frame"))&&(n.markHistoryStoppingPoint("remove-frame"),pre(n,S.map(b=>b.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",onSelect(m){if(!d())return;s("fit-frame-to-content",{source:m});const S=n.getOnlySelectedShape();S&&n.isShapeOfType(S,"frame")&&(n.markHistoryStoppingPoint("fit-frame-to-content"),mre(n,S.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"left",source:m}),n.markHistoryStoppingPoint("align left");const S=n.getSelectedShapeIds();n.alignShapes(S,"left"),qt(n,S)}},{id:"align-center-horizontal",label:{default:"action.align-center-horizontal","context-menu":"action.align-center-horizontal.short"},kbd:"?H",icon:"align-center-horizontal",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"center-horizontal",source:m}),n.markHistoryStoppingPoint("align center horizontal");const S=n.getSelectedShapeIds();n.alignShapes(S,"center-horizontal"),qt(n,S)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"right",source:m}),n.markHistoryStoppingPoint("align right");const S=n.getSelectedShapeIds();n.alignShapes(S,"right"),qt(n,S)}},{id:"align-center-vertical",label:{default:"action.align-center-vertical","context-menu":"action.align-center-vertical.short"},kbd:"?V",icon:"align-center-vertical",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"center-vertical",source:m}),n.markHistoryStoppingPoint("align center vertical");const S=n.getSelectedShapeIds();n.alignShapes(S,"center-vertical"),qt(n,S)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"top",source:m}),n.markHistoryStoppingPoint("align top");const S=n.getSelectedShapeIds();n.alignShapes(S,"top"),qt(n,S)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",onSelect(m){if(!d()||u())return;s("align-shapes",{operation:"bottom",source:m}),n.markHistoryStoppingPoint("align bottom");const S=n.getSelectedShapeIds();n.alignShapes(S,"bottom"),qt(n,S)}},{id:"distribute-horizontal",label:{default:"action.distribute-horizontal","context-menu":"action.distribute-horizontal.short"},icon:"distribute-horizontal",kbd:"?!h",onSelect(m){if(!d()||u())return;s("distribute-shapes",{operation:"horizontal",source:m}),n.markHistoryStoppingPoint("distribute horizontal");const S=n.getSelectedShapeIds();n.distributeShapes(S,"horizontal"),qt(n,S)}},{id:"distribute-vertical",label:{default:"action.distribute-vertical","context-menu":"action.distribute-vertical.short"},icon:"distribute-vertical",kbd:"?!V",onSelect(m){if(!d()||u())return;s("distribute-shapes",{operation:"vertical",source:m}),n.markHistoryStoppingPoint("distribute vertical");const S=n.getSelectedShapeIds();n.distributeShapes(S,"vertical"),qt(n,S)}},{id:"stretch-horizontal",label:{default:"action.stretch-horizontal","context-menu":"action.stretch-horizontal.short"},icon:"stretch-horizontal",onSelect(m){if(!d()||u())return;s("stretch-shapes",{operation:"horizontal",source:m}),n.markHistoryStoppingPoint("stretch horizontal");const S=n.getSelectedShapeIds();n.stretchShapes(S,"horizontal"),qt(n,S)}},{id:"stretch-vertical",label:{default:"action.stretch-vertical","context-menu":"action.stretch-vertical.short"},icon:"stretch-vertical",onSelect(m){if(!d()||u())return;s("stretch-shapes",{operation:"vertical",source:m}),n.markHistoryStoppingPoint("stretch vertical");const S=n.getSelectedShapeIds();n.stretchShapes(S,"vertical"),qt(n,S)}},{id:"flip-horizontal",label:{default:"action.flip-horizontal","context-menu":"action.flip-horizontal.short"},kbd:"!h",onSelect(m){if(!d()||u())return;s("flip-shapes",{operation:"horizontal",source:m}),n.markHistoryStoppingPoint("flip horizontal");const S=n.getSelectedShapeIds();n.flipShapes(S,"horizontal"),qt(n,S)}},{id:"flip-vertical",label:{default:"action.flip-vertical","context-menu":"action.flip-vertical.short"},kbd:"!v",onSelect(m){if(!d()||u())return;s("flip-shapes",{operation:"vertical",source:m}),n.markHistoryStoppingPoint("flip vertical");const S=n.getSelectedShapeIds();n.flipShapes(S,"vertical"),qt(n,S)}},{id:"pack",label:"action.pack",icon:"pack",onSelect(m){if(!d()||u())return;s("pack-shapes",{source:m}),n.markHistoryStoppingPoint("pack");const S=n.getSelectedShapeIds();n.packShapes(S,n.options.adjacentShapeMargin),qt(n,S)}},{id:"stack-vertical",label:{default:"action.stack-vertical","context-menu":"action.stack-vertical.short"},icon:"stack-vertical",onSelect(m){if(!d()||u())return;s("stack-shapes",{operation:"vertical",source:m}),n.markHistoryStoppingPoint("stack-vertical");const S=n.getSelectedShapeIds();n.stackShapes(S,"vertical",16),qt(n,S)}},{id:"stack-horizontal",label:{default:"action.stack-horizontal","context-menu":"action.stack-horizontal.short"},icon:"stack-horizontal",onSelect(m){if(!d()||u())return;s("stack-shapes",{operation:"horizontal",source:m}),n.markHistoryStoppingPoint("stack-horizontal");const S=n.getSelectedShapeIds();n.stackShapes(S,"horizontal",16),qt(n,S)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",onSelect(m){d()&&(u()||(s("reorder-shapes",{operation:"toFront",source:m}),n.markHistoryStoppingPoint("bring to front"),n.bringToFront(n.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",onSelect(m){d()&&(u()||(s("reorder-shapes",{operation:"forward",source:m}),n.markHistoryStoppingPoint("bring forward"),n.bringForward(n.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",onSelect(m){d()&&(u()||(s("reorder-shapes",{operation:"backward",source:m}),n.markHistoryStoppingPoint("send backward"),n.sendBackward(n.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",onSelect(m){d()&&(u()||(s("reorder-shapes",{operation:"toBack",source:m}),n.markHistoryStoppingPoint("send to back"),n.sendToBack(n.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",onSelect(m){d()&&(u()||(n.markHistoryStoppingPoint("cut"),i.cut(m)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(m){d()&&(u()||i.copy(m))}},{id:"paste",label:"action.paste",kbd:"$v",onSelect(m){var S;(S=navigator.clipboard)==null||S.read().then(b=>{i.paste(b,m,m==="context-menu"?n.inputs.currentPagePoint:void 0)}).catch(()=>{i.addToast({title:i.msg("action.paste-error-title"),description:i.msg("action.paste-error-description"),severity:"error"})})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(m){n.run(()=>{u()||(s("select-all-shapes",{source:m}),n.markHistoryStoppingPoint("select all kbd"),n.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(m){d()&&(u()||(s("select-none-shapes",{source:m}),n.markHistoryStoppingPoint("select none"),n.selectNone()))}},{id:"delete",label:"action.delete",kbd:",del,backspace",icon:"trash",onSelect(m){d()&&(u()||(s("delete-shapes",{source:m}),n.markHistoryStoppingPoint("delete"),n.deleteShapes(n.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",onSelect(m){if(!d()||u())return;s("rotate-cw",{source:m}),n.markHistoryStoppingPoint("rotate-cw");const S=n.getSelectionRotation()%(Yt/2),b=gl(S,0)||gl(S,Yt/2),v=n.getSelectedShapeIds();n.rotateShapesBy(v,Yt/2-(b?0:S)),qt(n,v)}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",onSelect(m){if(!d()||u())return;s("rotate-ccw",{source:m}),n.markHistoryStoppingPoint("rotate-ccw");const S=n.getSelectionRotation()%(Yt/2),b=gl(S,0),v=n.getSelectedShapeIds();n.rotateShapesBy(v,b?-(Yt/2):-S),qt(n,v)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(m){s("zoom-in",{source:m}),n.zoomIn(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(m){s("zoom-out",{source:m}),n.zoomOut(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(m){s("reset-zoom",{source:m}),n.resetZoom(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(m){s("zoom-to-fit",{source:m}),n.zoomToFit({animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(m){d()&&(u()||(s("zoom-to-selection",{source:m}),n.zoomToSelection({animation:{duration:n.options.animationMediumMs}})))}},{id:"toggle-snap-mode",label:{default:"action.toggle-snap-mode",menu:"action.toggle-snap-mode.menu"},onSelect(m){s("toggle-snap-mode",{source:m}),n.user.updateUserPreferences({isSnapMode:!n.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:{default:"action.toggle-dark-mode",menu:"action.toggle-dark-mode.menu"},kbd:"$/",readonlyOk:!0,onSelect(m){const S=n.user.getIsDarkMode()?"light":"dark";s("color-scheme",{source:m,value:S}),n.user.updateUserPreferences({colorScheme:S})},checkbox:!0},{id:"toggle-wrap-mode",label:{default:"action.toggle-wrap-mode",menu:"action.toggle-wrap-mode.menu"},readonlyOk:!0,onSelect(m){s("toggle-wrap-mode",{source:m}),n.user.updateUserPreferences({isWrapMode:!n.user.getIsWrapMode()})},checkbox:!0},{id:"toggle-dynamic-size-mode",label:{default:"action.toggle-dynamic-size-mode",menu:"action.toggle-dynamic-size-mode.menu"},readonlyOk:!1,onSelect(m){s("toggle-dynamic-size-mode",{source:m}),n.user.updateUserPreferences({isDynamicSizeMode:!n.user.getIsDynamicResizeMode()})},checkbox:!0},{id:"toggle-paste-at-cursor",label:{default:"action.toggle-paste-at-cursor",menu:"action.toggle-paste-at-cursor.menu"},readonlyOk:!1,onSelect(m){s("toggle-paste-at-cursor",{source:m}),n.user.updateUserPreferences({isPasteAtCursorMode:!n.user.getIsPasteAtCursorMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:{default:"action.toggle-reduce-motion",menu:"action.toggle-reduce-motion.menu"},readonlyOk:!0,onSelect(m){s("toggle-reduce-motion",{source:m}),n.user.updateUserPreferences({animationSpeed:n.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:{default:"action.toggle-edge-scrolling",menu:"action.toggle-edge-scrolling.menu"},readonlyOk:!0,onSelect(m){s("toggle-edge-scrolling",{source:m}),n.user.updateUserPreferences({edgeScrollSpeed:n.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:{default:"action.toggle-transparent",menu:"action.toggle-transparent.menu","context-menu":"action.toggle-transparent.context-menu"},readonlyOk:!0,onSelect(m){s("toggle-transparent",{source:m}),n.updateInstanceState({exportBackground:!n.getInstanceState().exportBackground})},checkbox:!0},{id:"toggle-tool-lock",label:{default:"action.toggle-tool-lock",menu:"action.toggle-tool-lock.menu"},kbd:"q",onSelect(m){s("toggle-tool-lock",{source:m}),n.updateInstanceState({isToolLocked:!n.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",onSelect(m){s("unlock-all",{source:m});const S=[];for(const b of n.getCurrentPageShapes())b.isLocked&&S.push({id:b.id,type:b.type,isLocked:!1});S.length>0&&n.updateShapes(S)}},{id:"toggle-focus-mode",label:{default:"action.toggle-focus-mode",menu:"action.toggle-focus-mode.menu"},readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(m){n.timers.requestAnimationFrame(()=>{n.run(()=>{s("toggle-focus-mode",{source:m}),i.clearDialogs(),i.clearToasts(),n.updateInstanceState({isFocusMode:!n.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:{default:"action.toggle-grid",menu:"action.toggle-grid.menu"},readonlyOk:!0,kbd:"$'",onSelect(m){s("toggle-grid-mode",{source:m}),n.updateInstanceState({isGridMode:!n.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:{default:"action.toggle-debug-mode",menu:"action.toggle-debug-mode.menu"},readonlyOk:!0,onSelect(m){s("toggle-debug-mode",{source:m}),n.updateInstanceState({isDebugMode:!n.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(m){s("print",{source:m}),i.printSelectionOrPages()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(m){s("exit-pen-mode",{source:m}),n.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(m){s("stop-following",{source:m}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(m){s("zoom-to-content",{source:m});const S=n.getSelectionPageBounds()??n.getCurrentPageBounds();S&&n.zoomToBounds(S,{targetZoom:Math.min(1,n.getZoomLevel()),animation:{duration:220}})}},{id:"toggle-lock",label:"action.toggle-lock",kbd:"!l",onSelect(m){n.markHistoryStoppingPoint("locking"),s("toggle-lock",{source:m}),n.toggleLock(n.getSelectedShapeIds())}},{id:"move-to-new-page",label:"context.pages.new-page",onSelect(m){const S=Ai.createId(),b=n.getSelectedShapeIds();n.run(()=>{n.markHistoryStoppingPoint("move_shapes_to_page"),n.createPage({name:i.msg("page-menu.new-page-initial-name"),id:S}),n.moveShapesToPage(b,S)}),s("move-to-new-page",{source:m})}},{id:"select-white-color",label:"color-style.white",kbd:"?t",onSelect(m){const S=Mi;n.run(()=>{n.markHistoryStoppingPoint("change-color"),n.isIn("select")&&n.setStyleForSelectedShapes(S,"white"),n.setStyleForNextShapes(S,"white")}),s("set-style",{source:m,id:S.id,value:"white"})}},{id:"select-fill-fill",label:"fill-style.fill",kbd:"?f",onSelect(m){const S=_c;n.run(()=>{n.markHistoryStoppingPoint("change-fill"),n.isIn("select")&&n.setStyleForSelectedShapes(S,"fill"),n.setStyleForNextShapes(S,"fill")}),s("set-style",{source:m,id:S.id,value:"fill"})}},{id:"flatten-to-image",label:"action.flatten-to-image",kbd:"!f",onSelect:async m=>{const S=n.getSelectedShapeIds();if(S.length===0)return;n.markHistoryStoppingPoint("flattening to image"),s("flatten-to-image",{source:m});const b=await Kre(n,S,n.options.flattenImageBoundsExpand);b!=null&&b.length&&n.setSelectedShapes(b)}},{id:"select-geo-tool",kbd:"g",onSelect:async m=>{s("select-tool",{source:m,id:"geo-previous"}),n.setCurrentTool("geo")}}];r&&f.push({id:"open-cursor-chat",label:"action.open-cursor-chat",readonlyOk:!0,kbd:"/",onSelect(m){s("open-cursor-chat",{source:m}),!n.getInstanceState().isCoarsePointer&&n.timers.requestAnimationFrame(()=>{n.updateInstanceState({isChatting:!0})})}});const g=Vie(f);return t?t(n,g,i):g},[i,n,s,t,o,r]);return p.jsx(f$.Provider,{value:l,children:e})}function $c(){const t=E.useContext(f$);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function $f(t,e){return t?typeof t=="string"?t:e?t[e]??t.default:void 0:void 0}function Ri(){const t=Ml();return oe("isReadonlyMode",()=>!!(t!=null&&t.getIsReadonly()),[t])}const Xie=Ft.isDarwin?"":"Ctrl",Zie=Ft.isDarwin?"":"Alt";function p$(t){return t===","?[","]:t.split(",")[0].split("").map(e=>{const n=e.replace(/\$/g,Xie).replace(/\?/g,Zie).replace(/!/g,"");return n[0].toUpperCase()+n.slice(1)})}function BC(t){return" "+p$(t).join("")}function bf({children:t,visibleOnMobileLayout:e=!1}){const n=zr();return!e&&n<Sn.MOBILE?null:p.jsx("kbd",{className:"tlui-kbd",children:p$(t).map((r,i)=>p.jsx("span",{children:r},i))})}const g$=E.createContext(null);function qS(){const t=E.useContext(g$);if(!t)throw new Error("useTldrawUiMenuContext must be used within a TldrawUiMenuContextProvider");return t}function rs({type:t,sourceId:e,children:n}){return p.jsx(g$.Provider,{value:{type:t,sourceId:e},children:n})}function YS({id:t,kbd:e,label:n,readonlyOk:r,onSelect:i,toggle:s=!1,disabled:o=!1,checked:l=!1}){const{type:u,sourceId:d}=qS(),f=Ri(),g=ut();if(f&&!r)return null;const m=$f(n,u),S=m?g(m):void 0;switch(u){case"menu":return p.jsxs(ure,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",title:S,onSelect:b=>{i==null||i(d),Je(b)},disabled:o,checked:l,children:[p.jsx(vo,{small:!0,icon:s?l?"toggle-on":"toggle-off":l?"check":"none"}),S&&p.jsx("span",{className:"tlui-button__label",draggable:!1,children:S}),e&&p.jsx(bf,{children:e})]});case"context-menu":return p.jsxs(Bne,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",title:S,onSelect:b=>{i(d),Je(b)},disabled:o,checked:l,children:[p.jsx(vo,{small:!0,icon:s?l?"toggle-on":"toggle-off":l?"check":"none"}),S&&p.jsx("span",{className:"tlui-button__label",draggable:!1,children:S}),e&&p.jsx(bf,{children:e})]},t);default:return null}}function Ea(t,e){const n=Ml(),r=E.useCallback(o=>{o&&(n==null||n.complete()),e==null||e(o)},[n,e]),i=or(),s=E.useCallback(o=>{i(o,{source:"unknown",id:t})},[t,i]);return eJ(n?`${t}-${n.contextId}`:t,r,s)}function Ic({id:t,children:e,modal:n=!1,debugOpen:r=!1}){const[i,s]=Ea(t);return p.jsx(aE,{open:r||i,dir:"ltr",modal:n,onOpenChange:s,children:e})}function Mc({children:t,...e}){return p.jsx(lE,{dir:"ltr",asChild:!0,onTouchEnd:n=>Je(n),...e,children:t})}function Ac({className:t,side:e="bottom",align:n="start",sideOffset:r=8,alignOffset:i=8,children:s}){const o=zn();return p.jsx(zS,{container:o,children:p.jsx(cE,{className:je("tlui-menu",t),side:e,sideOffset:r,align:n,alignOffset:i,collisionPadding:4,children:s})})}function Qie({id:t,children:e}){const[n,r]=Ea(t);return p.jsx(dre,{open:n,onOpenChange:r,children:e})}function Jie({id:t,label:e,title:n,disabled:r}){return p.jsx(hre,{dir:"ltr",asChild:!0,disabled:r,children:p.jsxs($e,{"data-testid":t,type:"menu",className:"tlui-menu__submenu__trigger",disabled:r,title:n,children:[p.jsx(wn,{children:e}),p.jsx(it,{icon:"chevron-right",small:!0})]})})}function ese({id:t,alignOffset:e=-1,sideOffset:n=-6,size:r="small",children:i}){const s=zn();return p.jsx(zS,{container:s,children:p.jsx(fre,{"data-testid":t,className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:n,collisionPadding:4,"data-size":r,children:i})})}function tse({children:t}){return p.jsx(lre,{dir:"ltr",className:"tlui-menu__group",children:t})}function Bf({noClose:t,children:e}){return p.jsx(cre,{dir:"ltr",asChild:!0,onClick:t?Je:void 0,children:e})}function Qe({id:t,label:e,children:n}){const{type:r,sourceId:i}=qS(),s=ut(),o=$f(e,r),l=o?s(o):void 0;switch(r){case"panel":return p.jsx("div",{className:"tlui-menu__group","data-testid":`${i}-group.${t}`,children:n});case"menu":return p.jsx(tse,{"data-testid":`${i}-group.${t}`,children:n});case"context-menu":return p.jsx(u8,{dir:"ltr",className:"tlui-menu__group","data-testid":`${i}-group.${t}`,children:n});case"keyboard-shortcuts":return p.jsxs("div",{className:"tlui-shortcuts-dialog__group","data-testid":`${i}-group.${t}`,children:[p.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:l}),p.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:n})]});default:return n}}function ci({id:t,disabled:e=!1,label:n,size:r="small",children:i}){const{type:s,sourceId:o}=qS(),l=zn(),u=ut(),d=n?typeof n=="string"?n:n[s]??n.default:void 0,f=d?u(d):void 0;switch(s){case"menu":return p.jsxs(Qie,{id:`${o}-sub.${t}`,children:[p.jsx(Jie,{id:`${o}-sub.${t}-button`,disabled:e,label:f,title:f}),p.jsx(ese,{id:`${o}-sub.${t}-content`,size:r,children:i})]});case"context-menu":return e?null:p.jsxs(nse,{id:`${o}-sub.${t}`,children:[p.jsx(p8,{dir:"ltr",disabled:e,asChild:!0,children:p.jsxs($e,{"data-testid":`${o}-sub.${t}-button`,type:"menu",className:"tlui-menu__submenu__trigger",children:[p.jsx(wn,{children:f}),p.jsx(it,{icon:"chevron-right",small:!0})]})}),p.jsx(sE,{container:l,children:p.jsx(g8,{"data-testid":`${o}-sub.${t}-content`,className:"tlui-menu tlui-menu__submenu__content",alignOffset:-1,sideOffset:-4,collisionPadding:4,"data-size":r,children:i})})]});default:return i}}function nse({id:t,children:e}){const[n,r]=Ea(t);return p.jsx(f8,{open:n,onOpenChange:r,children:e})}const rse=[{colorScheme:"light",label:"theme.light"},{colorScheme:"dark",label:"theme.dark"},{colorScheme:"system",label:"theme.system"}];function ise(){const t=re(),e=or(),n=oe("colorScheme",()=>t.user.getUserPreferences().colorScheme??(t.user.getIsDarkMode()?"dark":"light"),[t]);return p.jsx(ci,{id:"help menu color-scheme",label:"menu.theme",children:p.jsx(Qe,{id:"theme",children:rse.map(({colorScheme:r,label:i})=>p.jsx(YS,{id:`color-scheme-${r}`,label:i,checked:r===n,readonlyOk:!0,onSelect:()=>{t.user.updateUserPreferences({colorScheme:r}),e("color-scheme",{source:"menu",value:r})}},r))})})}const sse=({id:t,component:e,onClose:n,preventBackgroundClose:r})=>{const{removeDialog:i}=Sp(),s=E.useRef(!1),o=zn(),l=E.useCallback(u=>{if(!u){if(n)try{n()}catch(d){console.warn(d)}i(t)}},[t,n,i]);return p.jsx(kre,{onOpenChange:l,defaultOpen:!0,children:p.jsx(Rre,{container:o,children:p.jsx(Ore,{dir:"ltr",className:"tlui-dialog__overlay",onClick:u=>{s.current||!r&&u.target===u.currentTarget&&l(!1)},children:p.jsx(jre,{dir:"ltr",className:"tlui-dialog__content","aria-describedby":void 0,onMouseDown:()=>s.current=!0,onMouseUp:()=>s.current=!1,onInteractOutside:u=>{s.current=!1,r&&u.preventDefault()},children:p.jsx(e,{onClose:()=>{s.current=!1,l(!1)}})})})})})},ose=E.memo(function(){const{dialogs:e}=Sp();return oe("dialogs",()=>e.get(),[e]).map(r=>p.jsx(sse,{...r},r.id))}),ase=4e3,lse={success:"check-circle",warning:"warning-triangle",error:"cross-circle",info:"info-circle"};function cse({toast:t}){const{removeToast:e}=_a(),n=ut(),r=o=>{o||e(t.id)},i=t.actions&&t.actions.length>0,s=t.icon||t.severity&&lse[t.severity];return p.jsxs(hie,{onOpenChange:r,className:"tlui-toast__container",duration:t.keepOpen?1/0:ase,"data-severity":t.severity,children:[s&&p.jsx("div",{className:"tlui-toast__icon",children:p.jsx(vo,{icon:s})}),p.jsxs("div",{className:"tlui-toast__main","data-title":!!t.title,"data-description":!!t.description,"data-actions":!!t.actions,children:[p.jsxs("div",{className:"tlui-toast__content",children:[t.title&&p.jsx(fie,{className:"tlui-toast__title",children:t.title}),t.description&&p.jsx(pie,{className:"tlui-toast__description",children:t.description})]}),t.actions&&p.jsxs("div",{className:"tlui-toast__actions",children:[t.actions.map((o,l)=>p.jsx(gie,{altText:o.label,asChild:!0,onClick:o.onClick,children:p.jsx($e,{type:o.type,children:p.jsx(wn,{children:o.label})})},l)),p.jsx(GO,{asChild:!0,children:p.jsx($e,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:p.jsx(wn,{children:t.closeLabel??n("toast.close")})})})]})]}),!i&&p.jsx(GO,{asChild:!0,children:p.jsx($e,{type:"normal",className:"tlui-toast__close",children:p.jsx(wn,{children:t.closeLabel??n("toast.close")})})})]})}const use=E.memo(function(){const{toasts:e}=_a(),n=oe("toasts",()=>e.get(),[]);return p.jsxs(p.Fragment,{children:[n.map(r=>p.jsx(cse,{toast:r},r.id)),p.jsx(Q8,{className:"tlui-toast__viewport"})]})});function $s({actionId:t="",...e}){const r=$c()[t];return r?p.jsx(YS,{...r,...e}):null}function VO(t){return p.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:p.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[p.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),p.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:p.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}function kn({disabled:t=!1,spinner:e=!1,readonlyOk:n=!1,id:r,kbd:i,label:s,icon:o,onSelect:l,noClose:u,isSelected:d}){const{type:f,sourceId:g}=qS(),m=ut(),[S,b]=E.useState(!1);if(Ri()&&!n)return null;const w=$f(s,f),C=i?BC(i):void 0,_=w?m(w):void 0,M=_&&C?`${_} ${C}`:_;switch(f){case"menu":return p.jsx(Bf,{children:p.jsxs($e,{type:"menu","data-testid":`${g}.${r}`,disabled:t,title:M,onClick:I=>{u&&Je(I),S?b(!1):l(g)},children:[p.jsx(wn,{children:_}),i&&p.jsx(bf,{children:i})]})});case"context-menu":return t?null:p.jsxs(d8,{dir:"ltr",title:M,draggable:!1,className:"tlui-button tlui-button__menu","data-testid":`${g}.${r}`,onSelect:I=>{u&&Je(I),S?b(!1):l(g)},children:[p.jsx("span",{className:"tlui-button__label",draggable:!1,children:_}),i&&p.jsx(bf,{children:i}),e&&p.jsx(VO,{})]});case"panel":return p.jsxs($e,{"data-testid":`${g}.${r}`,type:"menu",title:M,disabled:t,onClick:()=>l(g),children:[p.jsx(wn,{children:_}),e?p.jsx(VO,{}):o&&p.jsx(it,{icon:o})]});case"small-icons":case"icons":return p.jsx($e,{"data-testid":`${g}.${r}`,type:"icon",title:M,disabled:t,onClick:()=>l(g),children:p.jsx(it,{icon:o,small:f==="small-icons"})});case"keyboard-shortcuts":return i?p.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair","data-testid":`${g}.${r}`,children:[p.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:_}),p.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:p.jsx(bf,{visibleOnMobileLayout:!0,children:i})})]}):(console.warn(`Menu item '${s}' isn't shown in the keyboard shortcuts dialog because it doesn't have a keyboard shortcut.`),null);case"helper-buttons":return p.jsxs($e,{type:"low",onClick:()=>l(g),children:[p.jsx(it,{icon:o}),p.jsx(wn,{children:_})]});case"toolbar":return p.jsx($e,{type:"tool","data-testid":`tools.${r}`,"aria-label":w,"data-value":r,onClick:()=>l("toolbar"),title:M,disabled:t,onTouchStart:I=>{Je(I),l("toolbar")},role:"radio","aria-checked":d?"true":"false",children:p.jsx(it,{icon:o})});case"toolbar-overflow":return p.jsx(Bf,{"aria-label":s,children:p.jsx($e,{type:"icon",className:"tlui-button-grid__button",onClick:()=>{l("toolbar")},"data-testid":`tools.more.${r}`,title:M,disabled:t,role:"radio","aria-checked":d?"true":"false","data-value":r,children:p.jsx(it,{icon:o})})});default:throw An(f)}}function fe({actionId:t="",...e}){const r=$c()[t];return r?p.jsx(kn,{...r,...e}):null}const m$=E.createContext(null);function dse({overrides:t,children:e}){const n=re(),r=or(),i=CE(),s=E.useMemo(()=>{const o=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(u){if(n.isIn("select")){const d=n.root.getCurrent();d.exit({},d.id),d.enter({},d.id)}n.setCurrentTool("select"),r("select-tool",{source:u,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(u){n.setCurrentTool("hand"),r("select-tool",{source:u,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",onSelect(u){n.setCurrentTool("eraser"),r("select-tool",{source:u,id:"eraser"})}},{id:"draw",label:"tool.draw",icon:"tool-pencil",kbd:"d,b,x",onSelect(u){n.setCurrentTool("draw"),r("select-tool",{source:u,id:"draw"})}},...[...Ms.values].map(u=>({id:u,label:`tool.${u}`,meta:{geo:u},kbd:u==="rectangle"?"r":u==="ellipse"?"o":void 0,icon:"geo-"+u,onSelect(d){n.run(()=>{n.setStyleForNextShapes(Ms,u),n.setCurrentTool("geo"),r("select-tool",{source:d,id:`geo-${u}`})})}})),{id:"arrow",label:"tool.arrow",icon:"tool-arrow",kbd:"a",onSelect(u){n.setCurrentTool("arrow"),r("select-tool",{source:u,id:"arrow"})}},{id:"line",label:"tool.line",icon:"tool-line",kbd:"l",onSelect(u){n.setCurrentTool("line"),r("select-tool",{source:u,id:"line"})}},{id:"frame",label:"tool.frame",icon:"tool-frame",kbd:"f",onSelect(u){n.setCurrentTool("frame"),r("select-tool",{source:u,id:"frame"})}},{id:"text",label:"tool.text",icon:"tool-text",kbd:"t",onSelect(u){n.setCurrentTool("text"),r("select-tool",{source:u,id:"text"})}},{id:"asset",label:"tool.asset",icon:"tool-media",kbd:"$u",onSelect(u){i.insertMedia(),r("select-tool",{source:u,id:"media"})}},{id:"note",label:"tool.note",icon:"tool-note",kbd:"n",onSelect(u){n.setCurrentTool("note"),r("select-tool",{source:u,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(u){n.setCurrentTool("laser"),r("select-tool",{source:u,id:"laser"})}},{id:"embed",label:"tool.embed",icon:"dot",onSelect(u){i.addDialog({component:Y8}),r("select-tool",{source:u,id:"embed"})}},{id:"highlight",label:"tool.highlight",icon:"tool-highlight",kbd:"!d",onSelect(u){n.setCurrentTool("highlight"),r("select-tool",{source:u,id:"highlight"})}}];o.push();const l=Object.fromEntries(o.map(u=>[u.id,u]));return t?t(n,l,i):l},[t,n,r,i]);return p.jsx(m$.Provider,{value:s,children:e})}function VS(){const t=E.useContext(m$);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function Wr({toolId:t="",...e}){const r=VS()[t];return r?p.jsx(kn,{...r,...e}):null}function hse({children:t}){const e=re();return oe("shouldDisplayHandles",()=>{if(e.isInAny("select.idle","select.pointing_handle","select.pointing_shape"))return!0;if(e.isInAny("select.editing_shape")){const r=e.getOnlySelectedShape();return r&&e.isShapeOfType(r,"note")}return!1},[e])?p.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}):null}const{PI:fse}=Math,nd=fse+1e-4;function y$(t,e={}){const{size:n=16,smoothing:r=.5}=e;if(t.length===0||n<=0)return{left:[],right:[]};const i=t[0],s=t[t.length-1],o=s.runningLength,l=Math.pow(n*r,2),u=[],d=[];let f=t[0].vector,g=t[0].point,m=g,S=g,b=m,v=!1,w;for(let C=0;C<t.length;C++){w=t[C];const{point:_,vector:M}=t[C],I=w.vector.dpr(f),A=(C<t.length-1?t[C+1]:t[C]).vector,R=C<t.length-1?A.dpr(w.vector):1,D=I<0&&!v,L=R!==null&&R<.2;if(D||L){if(R>-.62&&o-w.runningLength>w.radius){const k=f.clone().mul(w.radius);f.clone().cpr(A)<0?(S=T.Add(_,k),b=T.Sub(_,k)):(S=T.Sub(_,k),b=T.Add(_,k)),u.push(S),d.push(b)}else{const k=f.clone().mul(w.radius).per(),$=T.Sub(w.input,k);for(let F=1/13,N=0;N<1;N+=F)S=T.RotWith($,w.input,nd*N),u.push(S),b=T.RotWith($,w.input,nd+nd*-N),d.push(b)}g=S,m=b,L&&(v=!0);continue}if(v=!1,w===i||w===s){const k=T.Per(M).mul(w.radius);u.push(T.Sub(_,k)),d.push(T.Add(_,k));continue}const G=T.Lrp(A,M,R).per().mul(w.radius);S=T.Sub(_,G),(C<=1||T.Dist2(g,S)>l)&&(u.push(S),g=S),b=T.Add(_,G),(C<=1||T.Dist2(m,b)>l)&&(d.push(b),m=b),f=M}return{left:u,right:d}}function _E(t,e={}){const{size:n=16,start:r={},end:i={},last:s=!1}=e,{cap:o=!0}=r,{cap:l=!0}=i;if(t.length===0||n<=0)return[];const u=t[0],d=t[t.length-1],f=d.runningLength,g=r.taper===!1?0:r.taper===!0?Math.max(n,f):r.taper,m=i.taper===!1?0:i.taper===!0?Math.max(n,f):i.taper,{left:S,right:b}=y$(t,e),v=u.point,w=t.length>1?t[t.length-1].point:T.AddXY(u.point,1,1);if(t.length===1&&(!(g||m)||s)){const I=T.Add(v,T.Sub(v,w).uni().per().mul(-u.radius)),A=[];for(let R=1/13,D=R;D<=1;D+=R)A.push(T.RotWith(I,v,nd*2*D));return A}const C=[];if(!(g||m&&t.length===1))if(o)for(let I=1/8,A=I;A<=1;A+=I){const R=T.RotWith(b[0],v,nd*A);C.push(R)}else{const I=T.Sub(S[0],b[0]),A=T.Mul(I,.5),R=T.Mul(I,.51);C.push(T.Sub(v,A),T.Sub(v,R),T.Add(v,R),T.Add(v,A))}const _=[],M=d.vector.clone().per().neg();if(m||g&&t.length===1)_.push(w);else if(l){const I=T.Add(w,T.Mul(M,d.radius));for(let A=1/29,R=A;R<1;R+=A)_.push(T.RotWith(I,w,nd*3*R))}else _.push(T.Add(w,T.Mul(M,d.radius)),T.Add(w,T.Mul(M,d.radius*.99)),T.Sub(w,T.Mul(M,d.radius*.99)),T.Sub(w,T.Mul(M,d.radius)));return S.concat(_,b.reverse(),C)}const pse=.025,gse=.01;function bo(t,e={}){var w;const{streamline:n=.5,size:r=16,simulatePressure:i=!1}=e;if(t.length===0)return[];const s=.15+(1-n)*.85;let o=t.map(T.From),l=0;if(!i){let C=o[0];for(;C&&!(C.z>=pse);)o.shift(),C=o[0]}if(!i){let C=o[o.length-1];for(;C&&!(C.z>=gse);)o.pop(),C=o[o.length-1]}if(o.length===0)return[{point:T.From(t[0]),input:T.From(t[0]),pressure:i?.5:.15,vector:new T(1,1),distance:0,runningLength:0,radius:1}];let u=o[1];for(;u&&!(T.Dist2(u,o[0])>(r/3)**2);)o[0].z=Math.max(o[0].z,u.z),o.splice(1,1),u=o[1];const d=o.pop();for(u=o[o.length-1];u&&!(T.Dist2(u,d)>(r/3)**2);)o.pop(),u=o[o.length-1],l++;o.push(d);const f=e.last||!e.simulatePressure||o.length>1&&T.Dist2(o[o.length-1],o[o.length-2])<r**2||l>0;if(o.length===2&&e.simulatePressure){const C=o[1];o=o.slice(0,-1);for(let _=1;_<5;_++){const M=T.Lrp(o[0],C,_/4);M.z=(o[0].z+(C.z-o[0].z))*_/4,o.push(M)}}const g=[{point:o[0],input:o[0],pressure:i?.5:o[0].z,vector:new T(1,1),distance:0,runningLength:0,radius:1}];let m=0,S=g[0],b,v;f&&n>0&&o.push(o[o.length-1].clone());for(let C=1,_=o.length;C<_;C++)b=!s||e.last&&C===_-1?o[C].clone():o[C].clone().lrp(S.point,1-s),!S.point.equals(b)&&(v=T.Dist(b,S.point),m+=v,!(C<4&&m<r)&&(S={input:o[C],point:b,pressure:i?.5:o[C].z,vector:T.Sub(S.point,b).uni(),distance:v,runningLength:m,radius:1},g.push(S)));if((w=g[1])!=null&&w.vector&&(g[0].vector=g[1].vector.clone()),m<1){const C=Math.max(.5,...g.map(_=>_.pressure));g.forEach(_=>_.pressure=C)}return g}const{min:rl}=Math,h1=.275;function WS(t,e){const{size:n=16,thinning:r=.5,simulatePressure:i=!0,easing:s=w=>w,start:o={},end:l={}}=e,{easing:u=Kn.easeOutQuad}=o,{easing:d=Kn.easeOutCubic}=l,f=t[t.length-1].runningLength;let g,m=t[0].pressure,S;if(!i&&f<n){const w=t.reduce((C,_)=>Math.max(C,_.pressure),.5);return t.forEach(C=>{C.pressure=w,C.radius=n*s(.5-r*(.5-C.pressure))}),t}else{let w;for(let C=0,_=t.length;C<_&&(S=t[C],!(S.runningLength>n*5));C++){const M=rl(1,S.distance/n);if(i){const I=rl(1,1-M);w=rl(1,m+(I-m)*(M*h1))}else w=rl(1,m+(S.pressure-m)*.5);m=m+(w-m)*.5}for(let C=0;C<t.length;C++){if(S=t[C],r){let{pressure:_}=S;const M=rl(1,S.distance/n);if(i){const I=rl(1,1-M);_=rl(1,m+(I-m)*(M*h1))}else _=rl(1,m+(_-m)*(M*h1));S.radius=n*s(.5-r*(.5-_)),m=_}else S.radius=n/2;g===void 0&&(g=S.radius)}}const b=o.taper===!1?0:o.taper===!0?Math.max(n,f):o.taper,v=l.taper===!1?0:l.taper===!0?Math.max(n,f):l.taper;if(b||v)for(let w=0;w<t.length;w++){S=t[w];const{runningLength:C}=S,_=C<b?u(C/b):1,M=f-C<v?d((f-C)/v):1;S.radius=Math.max(.01,S.radius*Math.min(_,M))}return t}function mse(t,e={}){return _E(WS(bo(t,e),e),e)}function WO({scribble:t,zoom:e,color:n,opacity:r,className:i}){if(!t.points.length)return null;const s=mse(t.points,{size:t.size/e,start:{taper:t.taper,easing:Kn.linear},last:t.state==="stopping",simulatePressure:!1,streamline:.32});let o;if(s.length<4){const l=t.size/e/2,{x:u,y:d}=t.points[t.points.length-1];o=`M ${u-l},${d} a ${l},${l} 0 1,0 ${l*2},0 a ${l},${l} 0 1,0 ${-l*2},0`}else o=m2(s);return p.jsx("svg",{className:i&&je("tl-overlays__item",i),children:p.jsx("path",{className:"tl-scribble",d:o,fill:n??`var(--color-${t.color})`,opacity:r??t.opacity})})}const yse=({bounds:t,rotation:e})=>{const n=re();return oe("should display",()=>n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[n])?p.jsx(s4,{bounds:t,rotation:e}):null};function Sse({size:t,width:e,height:n,hideAlternateHandles:r}){const i=ne(t/3),s=i/2;return p.jsxs("svg",{className:"tl-overlays__item",children:[p.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${ne(0-s)},${ne(t)} 
						${ne(0-s)},${ne(0-s)} 
						${ne(t)},${ne(0-s)}`,strokeWidth:i,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),p.jsx("line",{className:je("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ne(e/2-t),y1:ne(0-s),x2:ne(e/2+t),y2:ne(0-s),strokeWidth:i,"data-testid":"selection.crop.top","aria-label":"top handle"}),p.jsx("polyline",{className:je("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${ne(e-t)},${ne(0-s)} 
						${ne(e+s)},${ne(0-s)} 
						${ne(e+s)},${ne(t)}`,strokeWidth:i,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),p.jsx("line",{className:je("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ne(e+s),y1:ne(n/2-t),x2:ne(e+s),y2:ne(n/2+t),strokeWidth:i,"data-testid":"selection.crop.right","aria-label":"right handle"}),p.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${ne(e+s)},${ne(n-t)} 
						${ne(e+s)},${ne(n+s)}
						${ne(e-t)},${ne(n+s)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),p.jsx("line",{className:je("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ne(e/2-t),y1:ne(n+s),x2:ne(e/2+t),y2:ne(n+s),strokeWidth:i,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),p.jsx("polyline",{className:je("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${ne(0+t)},${ne(n+s)} 
						${ne(0-s)},${ne(n+s)}
						${ne(0-s)},${ne(n-t)}`,strokeWidth:i,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),p.jsx("line",{className:je("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:ne(0-s),y1:ne(n/2-t),x2:ne(0-s),y2:ne(n/2+t),strokeWidth:i,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const vse=ir(function({bounds:e,rotation:n}){const r=re(),i=E.useRef(null),s=Ri(),o=Js("top"),l=Js("right"),u=Js("bottom"),d=Js("left"),f=Js("top_left"),g=Js("top_right"),m=Js("bottom_right"),S=Js("bottom_left"),b=r.getInstanceState().cursor.type==="default",v=r.getInstanceState().isCoarsePointer,w=r.getOnlySelectedShape(),C=w&&r.isShapeOrAncestorLocked(w),_=w?r.getShapeUtil(w).expandSelectionOutlinePx(w):0,M=_ instanceof xe?e.clone().expand(_).zeroFix():e.clone().expandBy(_).zeroFix();if(wd(i,e==null?void 0:e.x,e==null?void 0:e.y,1,r.getSelectionRotation(),{x:M.x-e.x,y:M.y-e.y}),w&&r.isShapeHidden(w))return null;const I=r.getZoomLevel(),A=r.getInstanceState().isChangingStyle,R=M.width,D=M.height,L=8/I,G=R<L*2,k=D<L*2,$=R<L*4,F=D<L*4,N=R<L*5,B=D<L*5,Y=v?1.75:1,K=6/I*Y,V=($?K/2:K)*(Y*.75),W=(F?K/2:K)*(Y*.75),ee=(w?!r.getShapeUtil(w).hideSelectionBoundsFg(w):!0)&&!A;let H=ee&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle","select.pointing_resize_handle")||ee&&r.isIn("select.resizing")&&w&&r.isShapeOfType(w,"text");w&&H&&Ft.isFirefox&&r.isShapeOfType(w,"embed")&&(H=!1);const te=r.isInAny("select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle")&&!A&&!s,ge=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!A&&!s,de=!v&&!(G||k)&&(ge||te)&&(w?!r.getShapeUtil(w).hideRotateHandle(w):!0)&&!C,Se=v&&(!$||!F)&&(ge||te)&&(w?!r.getShapeUtil(w).hideRotateHandle(w):!0)&&!C,me=ge&&(w?r.getShapeUtil(w).canResize(w)&&!r.getShapeUtil(w).hideResizeHandles(w):!0)&&!te&&!C,Me=G||k,Ne=G&&k,we=N||B,Ie=me||te,ke=!de,Ue=!ge||!Se,Nt=!ge||!Ie,ot=!ge||!Ie||Me,Mt=!ge||!Ie||Me,wt=!ge||!Ie||Ne&&!te;let ft=!0,jn=!0;if(te)ft=we,jn=we;else if(me){ft=Me||Ne||v;const Tr=v&&w&&w.type==="text";jn=ft&&!Tr}const dn=Math.min(24/I,D-W*3),lr=ge&&v&&w&&r.isShapeOfType(w,"text")&&dn*I>=4;return p.jsx("svg",{className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:p.jsxs("g",{ref:i,children:[H&&p.jsx("rect",{className:"tl-selection__fg__outline",width:ne(R),height:ne(D)}),p.jsx(om,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:K,corner:"top_left_rotate",cursor:b?yi("nwse-rotate",n):void 0,isHidden:ke}),p.jsx(om,{"data-testid":"selection.rotate.top-right",cx:R+K*3,cy:0,targetSize:K,corner:"top_right_rotate",cursor:b?yi("nesw-rotate",n):void 0,isHidden:ke}),p.jsx(om,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:D+K*3,targetSize:K,corner:"bottom_left_rotate",cursor:b?yi("swne-rotate",n):void 0,isHidden:ke}),p.jsx(om,{"data-testid":"selection.rotate.bottom-right",cx:R+K*3,cy:D+K*3,targetSize:K,corner:"bottom_right_rotate",cursor:b?yi("senw-rotate",n):void 0,isHidden:ke}),p.jsx(xse,{"data-testid":"selection.rotate.mobile",cx:$?-K*1.5:R/2,cy:$?D/2:-K*1.5,size:L,isHidden:Ue}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":ft}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:ne(0-(F?W*2:W)),width:ne(R),height:ne(Math.max(1,W*2)),style:b?{cursor:yi("ns-resize",n)}:void 0,...o}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":jn}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:ne(R-($?0:V)),y:0,height:ne(D),width:ne(Math.max(1,V*2)),style:b?{cursor:yi("ew-resize",n)}:void 0,...l}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":ft}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:ne(D-(F?0:W)),width:ne(R),height:ne(Math.max(1,W*2)),style:b?{cursor:yi("ns-resize",n)}:void 0,...u}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":jn}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:ne(0-($?V*2:V)),y:0,height:ne(D),width:ne(Math.max(1,V*2)),style:b?{cursor:yi("ew-resize",n)}:void 0,...d}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":Nt}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:ne(0-($?V*2:V*1.5)),y:ne(0-(F?W*2:W*1.5)),width:ne(V*3),height:ne(W*3),style:b?{cursor:yi("nwse-resize",n)}:void 0,...f}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":ot}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:ne(R-($?0:V*1.5)),y:ne(0-(F?W*2:W*1.5)),width:ne(V*3),height:ne(W*3),style:b?{cursor:yi("nesw-resize",n)}:void 0,...g}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":wt}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:ne(R-($?V:V*1.5)),y:ne(D-(F?W:W*1.5)),width:ne(V*3),height:ne(W*3),style:b?{cursor:yi("nwse-resize",n)}:void 0,...m}),p.jsx("rect",{className:je("tl-transparent",{"tl-hidden":Mt}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:ne(0-($?V*3:V*1.5)),y:ne(D-(F?0:W*1.5)),width:ne(V*3),height:ne(W*3),style:b?{cursor:yi("nesw-resize",n)}:void 0,...S}),me&&p.jsxs(p.Fragment,{children:[p.jsx("rect",{"data-testid":"selection.resize.top-left",className:je("tl-corner-handle",{"tl-hidden":Nt}),"aria-label":"top_left handle",x:ne(0-L/2),y:ne(0-L/2),width:ne(L),height:ne(L)}),p.jsx("rect",{"data-testid":"selection.resize.top-right",className:je("tl-corner-handle",{"tl-hidden":ot}),"aria-label":"top_right handle",x:ne(R-L/2),y:ne(0-L/2),width:ne(L),height:ne(L)}),p.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:je("tl-corner-handle",{"tl-hidden":wt}),"aria-label":"bottom_right handle",x:ne(R-L/2),y:ne(D-L/2),width:ne(L),height:ne(L)}),p.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:je("tl-corner-handle",{"tl-hidden":Mt}),"aria-label":"bottom_left handle",x:ne(0-L/2),y:ne(D-L/2),width:ne(L),height:ne(L)})]}),lr&&p.jsxs(p.Fragment,{children:[p.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:ne(0-L/4),y:ne(D/2-dn/2),rx:L/4,width:ne(L/2),height:ne(dn)}),p.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:L/4,x:ne(R-L/4),y:ne(D/2-dn/2),width:ne(L/2),height:ne(dn)})]}),te&&p.jsx(Sse,{size:L,width:R,height:D,hideAlternateHandles:we})]})})}),om=function({cx:e,cy:n,targetSize:r,corner:i,cursor:s,isHidden:o,"data-testid":l}){const u=Js(i);return p.jsx("rect",{className:je("tl-transparent","tl-rotate-corner",{"tl-hidden":o}),"data-testid":l,"aria-label":`${i} target`,pointerEvents:"all",x:ne(e-r*3),y:ne(n-r*3),width:ne(Math.max(1,r*3)),height:ne(Math.max(1,r*3)),cursor:s,...u})},bse=Math.sqrt(Math.PI),xse=function({cx:e,cy:n,size:r,isHidden:i,"data-testid":s}){const o=Js("mobile_rotate"),l=re(),u=oe("zoom level",()=>l.getZoomLevel(),[l]),d=Math.max(14*(1/u),20/Math.max(1,u));return p.jsxs("g",{children:[p.jsx("circle",{"data-testid":s,pointerEvents:"all",className:je("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":i}),cx:e,cy:n,r:d,...o}),p.jsx("circle",{className:je("tl-mobile-rotate__fg",{"tl-hidden":i}),cx:e,cy:n,r:r/bse})]})};function wse(){const t=re();return oe("is in a valid select state",()=>t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle"),[t])?p.jsx(o4,{}):null}function FC(t,e,n){const{arrowheadStart:r,arrowheadEnd:i}=e.props,s=Vu(t,e,n),o=s.start.clone(),l=s.end.clone(),u=T.Med(o,l);if(T.Equals(o,l))return{bindings:n,isStraight:!0,start:{handle:o,point:o,arrowhead:e.props.arrowheadStart},end:{handle:l,point:l,arrowhead:e.props.arrowheadEnd},middle:u,isValid:!1,length:0};const d=T.Sub(l,o).uni(),f=$y(t,e,"start"),g=$y(t,e,"end"),m=t.getShapePageTransform(e);XO(l,s.start,m,g),XO(o,s.end,m,f);let S=0,b=0,v=0,w=0,C=xf*e.props.scale;const _=f&&g&&f.shape===g.shape,M=f&&g?EE(t,f.shape.id,g.shape.id):"safe";M==="safe"&&f&&g&&!_&&!f.isExact&&!g.isExact&&(g.didIntersect&&!f.didIntersect?f.isClosed&&o.setTo(l.clone().add(d.clone().mul(xf*e.props.scale))):g.didIntersect||g.isClosed&&l.setTo(o.clone().sub(d.clone().mul(xf*e.props.scale))));const I=T.Sub(l,o),A=T.Len(I)?I.uni():T.From(I),R=!T.Equals(A,d);_||(M!=="start-contains-end"&&f&&r!=="none"&&!f.isExact&&(v=lo[e.props.size]/2+("size"in f.shape.props?lo[f.shape.props.size]/2:0),S=(By+v)*e.props.scale,C+=v*e.props.scale),M!=="end-contains-start"&&g&&i!=="none"&&!g.isExact&&(w=lo[e.props.size]/2+("size"in g.shape.props?lo[g.shape.props.size]/2:0),b=(By+w)*e.props.scale,C+=w*e.props.scale));const D=o.clone().add(A.clone().mul(S*(R?-1:1))),L=l.clone().sub(A.clone().mul(b*(R?-1:1)));T.DistMin(D,L,C)&&(S!==0&&b!==0?(S*=-1.5,b*=-1.5):S!==0?S*=-1:b!==0&&(b*=-1)),o.add(A.clone().mul(S*(R?-1:1))),l.sub(A.clone().mul(b*(R?-1:1))),R?(f&&g&&l.setTo(T.Add(o,A.clone().mul(-10*e.props.scale))),u.setTo(T.Med(s.start,s.end))):u.setTo(T.Med(o,l));const G=T.Dist(o,l);return{bindings:n,isStraight:!0,start:{handle:s.start,point:o,arrowhead:e.props.arrowheadStart},end:{handle:s.end,point:l,arrowhead:e.props.arrowheadEnd},middle:u,isValid:G>0,length:G}}function XO(t,e,n,r){if(r===void 0||r.isExact)return;const i=be.applyToPoint(n,e),s=be.applyToPoint(n,t),o=be.applyToPoint(be.Inverse(r.transform),i),l=be.applyToPoint(be.Inverse(r.transform),s),u=r.isClosed,f=(u?x2:kW)(o,l,r.outline);let g;if(f!==null&&(g=f.sort((b,v)=>T.Dist2(b,o)-T.Dist2(v,o))[0]??(u?void 0:l)),g===void 0)return;const m=be.applyToPoint(r.transform,g),S=be.applyToPoint(be.Inverse(n),m);t.setTo(S),r.didIntersect=!0}function Cse(t,e,n){const{arrowheadEnd:r,arrowheadStart:i}=e.props,s=e.props.bend;if(Math.abs(s)>Math.abs(e.props.bend*(Ise*e.props.scale)))return FC(t,e,n);const o=Vu(t,e,n),l=T.Med(o.start,o.end),u=T.Sub(o.end,o.start),d=T.Len(u)?u.uni():T.From(u),f=T.Add(l,d.per().mul(-s)),g=$y(t,e,"start"),m=$y(t,e,"end"),S=o.start.clone(),b=o.end.clone(),v=f.clone();if(T.Equals(S,b))return{bindings:n,isStraight:!0,start:{handle:S,point:S,arrowhead:e.props.arrowheadStart},end:{handle:b,point:b,arrowhead:e.props.arrowheadEnd},middle:v,isValid:!1,length:0};const w=e.props.bend<0,C=w?tp:B5,_=ZO(S,b,v),M=T.Angle(_.center,S),I=T.Angle(_.center,b),A=C(M,I);if(_.length===0||_.size===0||!uR(_.length)||!uR(_.size))return FC(t,e,n);const R=S.clone(),D=b.clone(),L=v.clone(),G=t.getShapePageTransform(e);let k=0,$=0,F=xf*e.props.scale;if(g&&!g.isExact){const H=be.applyToPoint(G,R),te=be.applyToPoint(G,_.center),ge=be.applyToPoint(G,D),de=be.Inverse(g.transform),Se=be.applyToPoint(de,H),me=be.applyToPoint(de,te),Me=be.applyToPoint(de,ge),{isClosed:Ne}=g,we=Ne?mC:ZR;let Ie,ke=we(me,_.radius,g.outline);if(ke){const Ue=me.angle(Se),Nt=me.angle(Me),ot=C(Ue,Nt);ke=ke.filter(wt=>C(Ue,me.angle(wt))<=ot);const Mt=ot*.25;ke.sort(Ne?(wt,ft)=>Math.abs(C(Ue,me.angle(wt))-Mt)<Math.abs(C(Ue,me.angle(ft))-Mt)?-1:1:(wt,ft)=>C(Ue,me.angle(wt))<C(Ue,me.angle(ft))?-1:1),Ie=ke[0]??(Ne?void 0:Se)}else Ie=Ne?void 0:Se;if(Ie&&(R.setTo(t.getPointInShapeSpace(e,be.applyToPoint(g.transform,Ie))),g.didIntersect=!0,i!=="none")){const Ue=lo[e.props.size]/2+("size"in g.shape.props?lo[g.shape.props.size]/2:0);k=(By+Ue)*e.props.scale,F+=Ue*e.props.scale}}if(m&&!m.isExact){const H=be.applyToPoint(G,R),te=be.applyToPoint(G,D),ge=be.applyToPoint(G,_.center),de=be.Inverse(m.transform),Se=be.applyToPoint(de,H),me=be.applyToPoint(de,ge),Me=be.applyToPoint(de,te),Ne=m.isClosed,we=Ne?mC:ZR;let Ie,ke=we(me,_.radius,m.outline);if(ke){const Ue=me.angle(Se),Nt=me.angle(Me),ot=C(Ue,Nt),Mt=ot*.75;ke=ke.filter(wt=>C(Ue,me.angle(wt))<=ot),ke.sort(Ne?(wt,ft)=>Math.abs(C(Ue,me.angle(wt))-Mt)<Math.abs(C(Ue,me.angle(ft))-Mt)?-1:1:(wt,ft)=>C(Ue,me.angle(wt))<C(Ue,me.angle(ft))?-1:1),ke[0]?Ie=ke[0]:Ie=Ne?void 0:Me}else Ie=Ne?void 0:Me;if(Ie&&(D.setTo(t.getPointInShapeSpace(e,be.applyToPoint(m.transform,Ie))),m.didIntersect=!0,r!=="none")){const Ue=lo[e.props.size]/2+("size"in m.shape.props?lo[m.shape.props.size]/2:0);$=(By+Ue)*e.props.scale,F+=Ue*e.props.scale}}let N=T.Angle(_.center,R),B=T.Angle(_.center,D),Y=C(N,B),K=Y*_.radius;const V=R.clone(),W=D.clone();if(k!==0&&V.setTo(_.center).add(T.FromAngle(N+Y*(k/K*(w?1:-1))).mul(_.radius)),$!==0&&W.setTo(_.center).add(T.FromAngle(B+Y*($/K*(w?-1:1))).mul(_.radius)),T.DistMin(V,W,F)&&(k!==0&&$!==0?(k*=-1.5,$*=-1.5):k!==0?k*=-2:$!==0&&($*=-2)),k!==0&&R.setTo(_.center).add(T.FromAngle(N+Y*(k/K*(w?1:-1))).mul(_.radius)),$!==0&&D.setTo(_.center).add(T.FromAngle(B+Y*($/K*(w?-1:1))).mul(_.radius)),g&&m&&!g.isExact&&!m.isExact){N=T.Angle(_.center,R),B=T.Angle(_.center,D),Y=C(N,B),K=Y*_.radius;const H=EE(t,g.shape.id,m.shape.id);H==="double-bound"&&K<30?(R.setTo(S),D.setTo(b),L.setTo(v)):H==="safe"&&(g&&!g.didIntersect&&R.setTo(S),(m&&!m.didIntersect||C(M,N)>C(M,B))&&D.setTo(_.center).add(T.FromAngle(N+Y*(Math.min(.9,xf*e.props.scale/K)*(w?1:-1))).mul(_.radius)))}_se(_.center,_.radius,R,D,L,A,w),R.equals(D)&&(R.setTo(L.clone().addXY(1,1)),D.setTo(L.clone().subXY(1,1))),S.setTo(R),b.setTo(D),v.setTo(L);const ee=ZO(S,b,v);return{bindings:n,isStraight:!1,start:{point:S,handle:o.start,arrowhead:e.props.arrowheadStart},end:{point:b,handle:o.end,arrowhead:e.props.arrowheadEnd},middle:v,handleArc:_,bodyArc:ee,isValid:ee.length!==0&&isFinite(ee.center.x)&&isFinite(ee.center.y)}}function ZO(t,e,n){const r=W_(t,e,n)??T.Med(t,e),i=T.Dist(r,t),s=+T.Clockwise(t,n,e),o=((t.y-e.y)**2+(t.x-e.x)**2)**.5,l=((e.y-n.y)**2+(e.x-n.x)**2)**.5,u=((n.y-t.y)**2+(n.x-t.x)**2)**.5,d=Math.acos((l*l+u*u-o*o)/(2*l*u))*2,f=+(yt>d),g=(It-d)*(s?1:-1),m=g*i;return{center:r,radius:i,size:g,length:m,largeArcFlag:f,sweepFlag:s}}function _se(t,e,n,r,i,s,o){const l=T.Angle(t,n),u=T.Angle(t,r);let d=tp(l,u);if(o||(d=It-d),i.setTo(t).add(T.FromAngle(l+d*(.5*(o?1:-1))).mul(e)),d>s){i.rotWith(t,yt);const f=r.clone();r.setTo(n),n.setTo(f)}}const Ese=8;function Pse(t){return Math.abs(t.props.bend)<Ese*t.props.scale}function $y(t,e,n){const r=t.getBindingsFromShape(e,"arrow").find(u=>u.props.terminal===n);if(!r)return;const i=t.getShape(r.toId);if(!i)return;const s=t.getShapePageTransform(i),o=t.getShapeGeometry(i),l=o instanceof ns?o.children[0].vertices:o.vertices;return{shape:i,transform:s,isClosed:o.isClosed,isExact:r.props.isExact,didIntersect:!1,outline:l}}function QO(t,e,n,r){const i=t.getShape(n.toId);if(i){const{point:s,size:o}=t.getShapeGeometry(i).bounds,l=T.Add(s,T.MulV(n.props.isPrecise||r?n.props.normalizedAnchor:{x:.5,y:.5},o)),u=be.applyToPoint(t.getShapePageTransform(i),l);return be.applyToPoint(be.Inverse(e),u)}else return new T(0,0)}function ei(t,e){const n=t.getBindingsFromShape(e,"arrow");return{start:n.find(r=>r.props.terminal==="start"),end:n.find(r=>r.props.terminal==="end")}}const Tse=NG("arrow info",(t,e)=>{const n=ei(t,e);return Pse(e)?FC(t,e,n):Cse(t,e,n)});function ao(t,e){const n=typeof e=="string"?e:e.id;return Tse.get(t,n)}function Vu(t,e,n){var l,u;const r=t.getShapePageTransform(e),i=EE(t,(l=n.start)==null?void 0:l.toId,(u=n.end)==null?void 0:u.toId),s=n.start?QO(t,r,n.start,i==="double-bound"||i==="start-contains-end"):T.From(e.props.start),o=n.end?QO(t,r,n.end,i==="double-bound"||i==="end-contains-start"):T.From(e.props.end);return{start:s,end:o}}function Yh(t,e,n,r){const i=typeof e=="string"?e:e.id,s=typeof n=="string"?n:n.id,o=t.getBindingsFromShape(i,"arrow").filter(u=>u.props.terminal===r.terminal);o.length>1&&t.deleteBindings(o.slice(1));const l=o[0];l?t.updateBinding({...l,toId:s,props:r}):t.createBinding({type:"arrow",fromId:i,toId:s,props:r})}function km(t,e,n){const r=t.getBindingsFromShape(e,"arrow").filter(i=>i.props.terminal===n);t.deleteBindings(r)}const xf=10,By=10,Ise=10,lo={s:2,m:3.5,l:5,xl:10};function EE(t,e,n){if(!e||!n)return"safe";if(e===n)return"double-bound";const r=t.getShapePageBounds(e),i=t.getShapePageBounds(n);if(r&&i){if(r.contains(i))return"start-contains-end";if(i.contains(r))return"end-contains-start"}return"safe"}class Rm extends Tm{getDefaultProps(){return{isPrecise:!1,isExact:!1,normalizedAnchor:{x:.5,y:.5}}}onAfterCreate({binding:e}){const n=this.editor.getShape(e.fromId);n&&f1(this.editor,n)}onAfterChange({bindingAfter:e}){const n=this.editor.getShape(e.fromId);n&&f1(this.editor,n)}onAfterChangeFromShape({shapeAfter:e}){f1(this.editor,e)}onAfterChangeToShape({binding:e}){S$(this.editor,e.fromId)}onBeforeIsolateFromShape({binding:e}){const n=this.editor.getShape(e.fromId);n&&Fy({editor:this.editor,arrow:n,terminal:e.props.terminal})}}O(Rm,"type","arrow"),O(Rm,"props",l3),O(Rm,"migrations",c3);function S$(t,e){var w;const n=t.getShape(e);if(!n)return;const r=ei(t,n),{start:i,end:s}=r,o=i?t.getShape(i.toId):void 0,l=s?t.getShape(s.toId):void 0,u=t.getAncestorPageId(n);if(!u)return;let d;if(o&&l)d=t.findCommonAncestor([o,l])??u;else if(o||l){const C=(w=o||l)==null?void 0:w.parentId;C&&C===n.parentId?d=n.parentId:d=u}else return;d&&d!==n.parentId&&t.reparentShapes([e],d);const f=t.getShape(e);if(!f)throw Error("no reparented arrow");const g=t.getShapeNearestSibling(f,o),m=t.getShapeNearestSibling(f,l);let S;if(g&&m)S=g.index>m.index?g:m;else if(g&&!m)S=g;else if(m&&!g)S=m;else return;let b;const v=t.getSortedChildIdsForParent(S.parentId).map(C=>t.getShape(C)).filter(C=>C.index>S.index);if(v.length){const C=v.find(_=>_.type!=="arrow");if(f.index>S.index&&(!C||f.index<C.index))return;b=Mf(S.index,v[0].index)}else b=so(S.index);b!==f.index&&t.updateShapes([{id:e,type:"arrow",index:b}])}function f1(t,e){const n=ei(t,e);for(const r of["start","end"]){const i=n[r];if(!i)continue;const s=t.getShape(i.toId),o=t.getAncestorPageId(e)===t.getAncestorPageId(s);(!s||!o)&&Fy({editor:t,arrow:e,terminal:r,unbind:!0})}S$(t,e.id)}function Fy({editor:t,arrow:e,terminal:n,unbind:r=!1,useHandle:i=!1}){const s=ao(t,e);if(!s)throw new Error("expected arrow info");const o=i?s.start.handle:s.start.point,l=i?s.end.handle:s.end.point,u=n==="start"?o:l,d={id:e.id,type:"arrow",props:{[n]:{x:u.x,y:u.y},bend:e.props.bend}};if(!s.isStraight){const f=n==="start"?o:s.start.handle,g=n==="end"?l:s.end.handle,m=T.Med(f,g),S=T.Sub(f,g).per().uni().mul(s.handleArc.radius*2*Math.sign(e.props.bend)),b=op(s.handleArc.center,T.Add(m,S),s.handleArc.center,s.handleArc.radius);xt((b==null?void 0:b.length)===1);const v=T.Dist(m,b[0])*Math.sign(e.props.bend);gl(v,d.props.bend)||(d.props.bend=v)}t.updateShape(d),r&&km(t,e,n)}const v$=[Rm],Cr={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},wr={s:2,m:3.5,l:5,xl:10},ld={s:18,m:24,l:36,xl:44},ma={s:18,m:22,l:26,xl:32},Mse={s:18,m:20,l:24,xl:28},va={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},Ase=20,PE=4.25,Vi=16;function kse(t,e){const n=t.w/e.w,r=t.h/e.h;return n<=1&&r<=1?t:n>r?{w:t.w/n,h:t.h/n}:{w:t.w/r,h:t.h/r}}async function Rse(t,e,n){var C,_,M;const{elements:r,files:i}=e,s={shapes:[],bindings:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},o=new Map,l=new Map,u=t.getCurrentPageId(),d=new Map,f=[],g=new Set;r.forEach(I=>{if(d.set(I.id,Lt()),I.boundElements!==null)for(const A of I.boundElements)A.type==="text"&&g.add(A.id)});let m=ZD;for(const I of r){if(g.has(I.id))continue;const A=d.get(I.id),R={id:A,typeName:"shape",parentId:u,index:m,x:I.x,y:I.y,rotation:0,isLocked:I.locked,opacity:Ose(I.opacity),meta:{}};switch(I.angle!==0&&l.set(A,I.angle),I.groupIds&&I.groupIds.length>0?o.has(I.groupIds[0])?(C=o.get(I.groupIds[0]))==null||C.push(A):o.set(I.groupIds[0],[A]):f.push(A),I.type){case"rectangle":case"ellipse":case"diamond":{let D="",L="middle";if(I.boundElements!==null){for(const k of I.boundElements)if(k.type==="text"){const $=r.find(F=>F.id===k.id);$&&(D=$.text,L=Bse[$.textAlign])}}const G=I.backgroundColor==="transparent"?I.strokeColor:I.backgroundColor;s.shapes.push({...R,type:"geo",props:{geo:I.type,url:I.link??"",w:I.width,h:I.height,size:am[I.strokeWidth]??"draw",color:Vh[G]??"black",text:D,align:L,dash:lm(I),fill:Hse(I)}});break}case"freedraw":{s.shapes.push({...R,type:"draw",props:{dash:lm(I),size:am[I.strokeWidth],color:Vh[I.strokeColor]??"black",segments:[{type:"free",points:I.points.map(([D,L,G=.5])=>({x:D,y:L,z:G}))}]}});break}case"line":{if(I.points.slice().length<2)break;const L=Af(I.points.length);s.shapes.push({...R,type:"line",props:{dash:lm(I),size:am[I.strokeWidth],color:Vh[I.strokeColor]??"black",spline:I.roundness?"cubic":"line",points:{...Object.fromEntries(I.points.map(([G,k],$)=>{const F=L[$];return[F,{id:F,index:F,x:G,y:k}]}))}}});break}case"arrow":{let D="";if(I.boundElements!==null){for(const F of I.boundElements)if(F.type==="text"){const N=r.find(B=>B.id===F.id);N&&(D=N.text)}}const L=I.points[0],G=I.points[I.points.length-1],k=d.get((_=I.startBinding)==null?void 0:_.elementId),$=d.get((M=I.endBinding)==null?void 0:M.elementId);s.shapes.push({...R,type:"arrow",props:{text:D,bend:Use(I,L,G),dash:lm(I),size:am[I.strokeWidth]??"m",color:Vh[I.strokeColor]??"black",start:{x:L[0],y:L[1]},end:{x:G[0],y:G[1]},arrowheadEnd:JO[I.endArrowhead]??"none",arrowheadStart:JO[I.startArrowhead]??"none"}}),k&&s.bindings.push({id:Sc(),typeName:"binding",type:"arrow",fromId:A,toId:k,props:{terminal:"start",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}}),$&&s.bindings.push({id:Sc(),typeName:"binding",type:"arrow",fromId:A,toId:$,props:{terminal:"end",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}});break}case"text":{const{size:D,scale:L}=Dse(I.fontSize);s.shapes.push({...R,type:"text",props:{size:D,scale:L,font:Lse[I.fontFamily]??"draw",color:Vh[I.strokeColor]??"black",text:I.text,textAlign:Fse[I.textAlign]}});break}case"image":{const D=i[I.fileId];if(!D)break;const L=yl.createId();s.assets.push({id:L,typeName:"asset",type:"image",props:{w:I.width,h:I.height,fileSize:D.size,name:I.id??"Untitled",isAnimated:!1,mimeType:D.mimeType,src:D.dataURL},meta:{}}),s.shapes.push({...R,type:"image",props:{w:I.width,h:I.height,assetId:L}})}}m=so(m)}const S=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.putContentOntoCurrentPage(s,{point:S,select:!1,preserveIds:!0});for(const I of o.values())if(I.length>1){t.groupShapes(I);const A=t.getShape(I[0]);A!=null&&A.parentId&&Zr(A.parentId)&&f.push(A.parentId)}for(const[I,A]of l)t.select(I),t.rotateShapesBy([I],A);const b=We(f.map(I=>t.getShape(I))),v=xe.Common(b.map(I=>t.getShapePageBounds(I))),w=t.getViewportPageBounds().center;t.updateShapes(b.map(I=>{const A={x:(I.x??0)-(v.x+v.w/2),y:(I.y??0)-(v.y+v.h/2)};return{id:I.id,type:I.type,x:w.x+A.x,y:w.y+A.y}})),t.setSelectedShapes(f)}const Ose=t=>{const e=t/100;return e<.2?.1:e<.4?.25:e<.6?.5:e<.8?.75:1},am={1:"s",2:"m",3:"l",4:"xl"},jse={16:"s",20:"m",28:"l",36:"xl"};function Dse(t){const e=jse[t];return e?{size:e,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}const Lse={1:"draw",2:"sans",3:"mono"},Nse={gray:["#f8f9fa","#e9ecef","#ced4da","#868e96","#343a40"],red:["#fff5f5","#ffc9c9","#ff8787","#fa5252","#e03131"],pink:["#fff0f6","#fcc2d7","#f783ac","#e64980","#c2255c"],grape:["#f8f0fc","#eebefa","#da77f2","#be4bdb","#9c36b5"],violet:["#f3f0ff","#d0bfff","#9775fa","#7950f2","#6741d9"],indigo:["#edf2ff","#bac8ff","#748ffc","#4c6ef5","#3b5bdb"],blue:["#e7f5ff","#a5d8ff","#4dabf7","#228be6","#1971c2"],cyan:["#e3fafc","#99e9f2","#3bc9db","#15aabf","#0c8599"],teal:["#e6fcf5","#96f2d7","#38d9a9","#12b886","#099268"],green:["#ebfbee","#b2f2bb","#69db7c","#40c057","#2f9e44"],lime:["#f4fce3","#d8f5a2","#a9e34b","#82c91e","#66a80f"],yellow:["#fff9db","#ffec99","#ffd43b","#fab005","#f08c00"],orange:["#fff4e6","#ffd8a8","#ffa94d","#fd7e14","#e8590c"]};function Xs(t,e,n){const r=[0,1,2,3,4].map(i=>Nse[t][i]);return Object.fromEntries(r.map((i,s)=>[i,s<3?e:n]))}const Vh={...Xs("gray","grey","black"),...Xs("red","light-red","red"),...Xs("pink","light-red","red"),...Xs("grape","light-violet","violet"),...Xs("blue","light-blue","blue"),...Xs("cyan","light-blue","blue"),...Xs("teal","light-green","green"),...Xs("green","light-green","green"),...Xs("yellow","yellow","orange"),...Xs("orange","yellow","orange"),"#ffffff":"white","#000000":"black"},zse={solid:"draw",dashed:"dashed",dotted:"dotted"},$se={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},Bse={left:"start",center:"middle",right:"end"},Fse={left:"start",center:"middle",right:"end"},JO={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function Use(t,e,n){let r=0;if(t.points.length>2){const i=new T(e[0],e[1]),s=new T(n[0],n[1]),o=new T(t.points[1][0],t.points[1][1]),l=T.Sub(s,i),u=T.Per(l),d=T.Med(s,i),f=T.Sub(d,u),g=T.Add(d,u),m=T.NearestPointOnLineSegment(f,g,o,!1);r=T.Dist(m,d),T.Clockwise(m,s,d)&&(r*=-1)}return r}const lm=t=>{let e=zse[t.strokeStyle]??"draw";return e==="draw"&&t.roughness===0&&(e="solid"),e},Hse=t=>t.backgroundColor==="transparent"?"none":$se[t.fillStyle]??"solid";/*!
 * MIT License
 * Adapted (mostly copied) the work of https://github.com/fregante/text-field-edit
 * Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)
 */const Wu="  ",Ar=class Ar{static insertTextFirefox(e,n){e.setRangeText(n,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(e,n){const r=e.ownerDocument,i=r.activeElement;i!==e&&e.focus(),r.execCommand("insertText",!1,n)||Ar.insertTextFirefox(e,n),i===r.body?e.blur():i instanceof HTMLElement&&i!==e&&i.focus()}static set(e,n){e.select(),Ar.insert(e,n)}static getSelection(e){const{selectionStart:n,selectionEnd:r}=e;return e.value.slice(n||void 0,r||void 0)}static wrapSelection(e,n,r){const{selectionStart:i,selectionEnd:s}=e,o=Ar.getSelection(e);Ar.insert(e,n+o+(r??n)),e.selectionStart=(i||0)+n.length,e.selectionEnd=(s||0)+n.length}static replace(e,n,r){let i=0;e.value.replace(n,(...s)=>{const o=i+s[s.length-2],l=s[0].length;e.selectionStart=o,e.selectionEnd=o+l;const u=typeof r=="string"?r:r(...s);return Ar.insert(e,u),e.selectionStart=o,i+=u.length-l,u})}static findLineEnd(e,n){const r=e.lastIndexOf(`
`,n-1)+1;return e.charAt(r)!=="	"?n:r+1}static indent(e){var l;const{selectionStart:n,selectionEnd:r,value:i}=e,s=i.slice(n,r),o=(l=/\n/g.exec(s))==null?void 0:l.length;if(o&&o>0){const u=i.lastIndexOf(`
`,n-1)+1,d=e.value.slice(u,r-1),f=d.replace(/^|\n/g,`$&${Wu}`),g=f.length-d.length;e.setSelectionRange(u,r-1),Ar.insert(e,f),e.setSelectionRange(n+1,r+g)}else Ar.insert(e,Wu)}static unindent(e){const{selectionStart:n,selectionEnd:r,value:i}=e,s=i.lastIndexOf(`
`,n-1)+1,o=Ar.findLineEnd(i,r),l=e.value.slice(s,o),u=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),d=l.length-u.length;e.setSelectionRange(s,o),Ar.insert(e,u);const f=/\t| {1,2}/.exec(i.slice(s,n)),g=f?f[0].length:0,m=n-g;e.setSelectionRange(n-g,Math.max(m,r-d))}static indentCE(e){var u;const n=window.getSelection(),r=e.innerText,i=cm(e)??0,s=cm(e)??0,o=r.slice(i,s),l=(u=/\n/g.exec(o))==null?void 0:u.length;if(l&&l>0){const d=r.lastIndexOf(`
`,i-1)+1,f=r.slice(d,s-1),m=f.replace(/^|\n/g,`$&${Wu}`).length-f.length;n&&n.setBaseAndExtent(e,i+1,e,s+m)}else{const d=window.getSelection();e.innerText=r.slice(0,i)+Wu+r.slice(i),d==null||d.setBaseAndExtent(e,i+1,e,i+2)}}static unindentCE(e){const n=window.getSelection(),r=e.innerText,i=cm(e)??0,s=cm(e)??0,o=r.lastIndexOf(`
`,i-1)+1,l=Ar.findLineEnd(r,s),u=r.slice(o,l),d=u.replace(/(^|\n)(\t| {1,2})/g,"$1"),f=u.length-d.length;if(n){n.setBaseAndExtent(e,o,e,l);const g=/\t| {1,2}/.exec(r.slice(o,i)),m=g?g[0].length:0,S=i-m;n.setBaseAndExtent(e,i-m,e,Math.max(S,s-f))}}static normalizeText(e){return e.replace(Ar.fixNewLines,`
`)}static normalizeTextForDom(e){return e.replace(Ar.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};O(Ar,"fixNewLines",/\r?\n|\r/g);let cd=Ar;function cm(t){if(typeof window.getSelection>"u")return;const e=window.getSelection();if(!e)return;let n=0;if(e.rangeCount!==0){const r=e.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(t),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}const Kse=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function b$(t){return Kse.test(t)}function Gse(t){return t.replace(/\t/g,Wu)}function qse(t){const e=t.split(`
`);for(;e[0]&&e[0].trim().length===0;)e.shift();let n=1/0;for(const r of e)if(r.trim().length>0){const i=r.length-r.trimStart().length;n=Math.min(n,i)}return e.map(r=>r.slice(n)).join(`
`)}const x$={"&amp;":"&","&quot;":'"',"&apos;":"'","&#34;":'"',"&#38;":"&","&#39;":"'","&#8211;":"","&#8212;":"","&#8216;":"","&#8217;":"","&#8220;":"","&#8221;":"","&#8230;":""},Yse=new RegExp(Object.keys(x$).join("|"),"g");function Vse(t){return t.replace(Yse,e=>x$[e])}function Wse(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function Xse(t){return Wse(qse(Gse(t)))}const Zse=5e3,w$=10*1024*1024;function Qse(t,e){t.registerExternalAssetHandler("file",async n=>Jse(t,n,e)),t.registerExternalAssetHandler("url",async n=>eoe(t,n,e)),t.registerExternalContentHandler("svg-text",async n=>toe(t,n)),t.registerExternalContentHandler("embed",n=>noe(t,n)),t.registerExternalContentHandler("files",async n=>roe(t,n,e)),t.registerExternalContentHandler("text",async n=>ioe(t,n)),t.registerExternalContentHandler("url",async n=>soe(t,n,e)),t.registerExternalContentHandler("tldraw",async n=>ooe(t,n)),t.registerExternalContentHandler("excalidraw",async n=>aoe(t,n))}async function Jse(t,{file:e,assetId:n},{acceptedImageMimeTypes:r=Vf,acceptedVideoMimeTypes:i=Zy,maxAssetSize:s=w$,maxImageDimension:o=Zse,toasts:l,msg:u}){const d=r.includes(e.type),f=i.includes(e.type);!d&&!f&&l.addToast({title:u("assets.files.type-not-allowed"),severity:"error"}),xt(d||f,`File type not allowed: ${e.type}`),e.size>s&&l.addToast({title:u("assets.files.size-too-big"),severity:"error"}),xt(e.size<=s,`File size too big: ${(e.size/1024).toFixed()}kb > ${(s/1024).toFixed()}kb`);const g=DD(await e.arrayBuffer());n=n??yl.createId(g);const m=await C$(e,n,d,f);if(isFinite(o)){const b={w:m.props.w,h:m.props.h},v=kse(b,{w:o,h:o});b!==v&&bi.isStaticImageType(e.type)&&(m.props.w=v.w,m.props.h=v.h)}const S=await t.uploadAsset(m,e);return m.props.src=S.src,S.meta&&(m.meta={...m.meta,...S.meta}),yl.create(m)}async function eoe(t,{url:e},{toasts:n,msg:r}){var s,o,l,u,d;let i;try{const g=await(await go(e,{method:"GET",mode:"no-cors"})).text(),m=new DOMParser().parseFromString(g,"text/html");i={image:((s=m.head.querySelector('meta[property="og:image"]'))==null?void 0:s.getAttribute("content"))??"",favicon:((o=m.head.querySelector('link[rel="apple-touch-icon"]'))==null?void 0:o.getAttribute("href"))??((l=m.head.querySelector('link[rel="icon"]'))==null?void 0:l.getAttribute("href"))??"",title:((u=m.head.querySelector('meta[property="og:title"]'))==null?void 0:u.getAttribute("content"))??e,description:((d=m.head.querySelector('meta[property="og:description"]'))==null?void 0:d.getAttribute("content"))??""},i.image.startsWith("http")||(i.image=new URL(i.image,e).href),i.favicon.startsWith("http")||(i.favicon=new URL(i.favicon,e).href)}catch(f){console.error(f),n.addToast({title:r("assets.url.failed"),severity:"error"}),i={image:"",favicon:"",title:"",description:""}}return{id:yl.createId(I_(e)),typeName:"asset",type:"bookmark",props:{src:e,description:i.description,image:i.image,favicon:i.favicon,title:i.title},meta:{}}}async function toe(t,{point:e,text:n}){const r=e??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),i=new DOMParser().parseFromString(n,"image/svg+xml").querySelector("svg");if(!i)throw new Error("No <svg/> element present");let s=parseFloat(i.getAttribute("width")||"0"),o=parseFloat(i.getAttribute("height")||"0");if(!(s&&o)){document.body.appendChild(i);const u=i.getBoundingClientRect();document.body.removeChild(i),s=u.width,o=u.height}const l=await t.getAssetForExternalContent({type:"file",file:new File([n],"asset.svg",{type:"image/svg+xml"})});if(!l)throw Error("Could not create an asset");_$(t,[l],r)}function noe(t,{point:e,url:n,embed:r}){const i=e??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),{width:s,height:o}=r,l=Lt(),u={id:l,type:"embed",x:i.x-(s||450)/2,y:i.y-(o||450)/2,props:{w:s,h:o,url:n}};t.createShapes([u]).select(l)}async function roe(t,{point:e,files:n},{maxAssetSize:r=w$,acceptedImageMimeTypes:i=Vf,acceptedVideoMimeTypes:s=Zy,toasts:o,msg:l}){if(n.length>t.options.maxFilesAtOnce){o.addToast({title:l("assets.files.amount-too-big"),severity:"error"});return}const u=e??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),d=new T(u.x,u.y),f=[];for(const m of n){if(m.size>r){o.addToast({title:l("assets.files.size-too-big"),severity:"error"}),console.warn(`File size too big: ${(m.size/1024).toFixed()}kb > ${(r/1024).toFixed()}kb`);continue}if(!m.type){o.addToast({title:l("assets.files.upload-failed"),severity:"error"}),console.error("No mime type");continue}if(![...i,...s].includes(m.type)){o.addToast({title:l("assets.files.type-not-allowed"),severity:"error"}),console.warn(`${m.name} not loaded - Mime type not allowed ${m.type}.`);continue}const b=i.includes(m.type),v=s.includes(m.type),w=DD(await m.arrayBuffer()),C=yl.createId(w),_=await C$(m,C,b,v);let M;b&&(M=t.createTemporaryAssetPreview(C,m)),f.push({asset:_,file:m,temporaryAssetPreview:M})}const g=[];await Promise.allSettled(f.map(async m=>{try{const S=await t.getAssetForExternalContent({type:"file",file:m.file});if(!S)throw Error("Could not create an asset");const b={...S,id:m.asset.id};g.push(b),t.updateAssets([b])}catch(S){o.addToast({title:l("assets.files.upload-failed"),severity:"error"}),console.error(S);return}})),_$(t,g,d)}async function ioe(t,{point:e,text:n}){const r=e??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),i=t.getShapeUtil("text").getDefaultProps(),s=Xse(n),o=t.getOnlySelectedShape();if(o&&"text"in o.props){t.updateShapes([{id:o.id,type:o.type,props:{text:s}}]);return}let l,u,d,f="middle";const g=s.split(`
`).length>1,m=b$(s);g&&(f=g?m?"end":"start":"middle");const S=t.textMeasure.measureText(s,{...Cr,fontFamily:va[i.font],fontSize:ld[i.size],maxWidth:null}),b=Math.min(g?t.getViewportPageBounds().width*.9:920,Math.max(200,t.getViewportPageBounds().width*.9));if(S.w>b){const v=t.textMeasure.measureText(s,{...Cr,fontFamily:va[i.font],fontSize:ld[i.size],maxWidth:b});l=v.w,u=v.h,d=!1,f=m?"end":"start"}else l=S.w,u=S.h,d=!0;r.y-u/2<t.getViewportPageBounds().minY+40&&(r.y=t.getViewportPageBounds().minY+40+u/2),t.createShapes([{id:Lt(),type:"text",x:r.x-l/2,y:r.y-u/2,props:{text:s,textAlign:f,autoSize:d,w:l}}])}async function soe(t,{point:e,url:n},{toasts:r,msg:i}){const s=t.getShapeUtil("embed"),o=s==null?void 0:s.getEmbedDefinition(n);if(o)return t.putExternalContent({type:"embed",url:o.url,point:e,embed:o.definition});const l=e??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),u=yl.createId(I_(n)),d=loe(t,n,l);let f=t.getAsset(u),g=!1;if(!f){g=!0;try{const m=await t.getAssetForExternalContent({type:"url",url:n});if(!m)throw Error("Could not create an asset");f=m}catch{r.addToast({title:i("assets.url.failed"),severity:"error"});return}}t.run(()=>{g&&t.createAssets([f]),t.updateShapes([{id:d.id,type:d.type,props:{assetId:f.id}}])})}async function ooe(t,{point:e,content:n}){t.run(()=>{const r=t.getSelectionPageBounds();t.markHistoryStoppingPoint("paste"),t.putContentOntoCurrentPage(n,{point:e,select:!0});const i=t.getSelectionPageBounds();r&&i&&(r!=null&&r.collides(i))&&(t.updateInstanceState({isChangingStyle:!0}),t.timers.setTimeout(()=>{t.updateInstanceState({isChangingStyle:!1})},150))})}async function aoe(t,{point:e,content:n}){t.run(()=>{Rse(t,n,e)})}async function C$(t,e,n,r){let i=t.type;t.type==="video/quicktime"&&(i="video/mp4");const s=n?await bi.getImageSize(t):await bi.getVideoSize(t),o=await bi.isAnimated(t)||r;return{id:e,type:n?"image":"video",typeName:"asset",props:{name:t.name,src:"",w:s.w,h:s.h,fileSize:t.size,mimeType:i,isAnimated:o},meta:{}}}async function _$(t,e,n){if(!e.length)return[];const r=T.From(n),i=[];for(let s=0;s<e.length;s++){const o=e[s];switch(o.type){case"image":{i.push({id:Lt(),type:"image",x:r.x,y:r.y,opacity:1,props:{assetId:o.id,w:o.props.w,h:o.props.h}}),r.x+=o.props.w;break}case"video":i.push({id:Lt(),type:"video",x:r.x,y:r.y,opacity:1,props:{assetId:o.id,w:o.props.w,h:o.props.h}}),r.x+=o.props.w}}return t.run(()=>{const s=e.filter(o=>!t.getAsset(o.id));s.length&&t.createAssets(s),t.createShapes(i).select(...i.map(o=>o.id)),E$(t,n)}),i.map(s=>s.id)}function E$(t,e){const n=t.getViewportPageBounds();let r=t.getSelectionPageBounds();if(r){const i=r.center.sub(e);t.updateShapes(t.getSelectedShapes().map(s=>{const o=t.getShapeParentTransform(s).decompose().rotation,l=T.Rot(i,-o);return{id:s.id,type:s.type,x:s.x-l.x,y:s.y-l.y}}))}if(r=t.getSelectionPageBounds(),r&&t.getInstanceState().isGridMode){const i=t.getDocumentSettings().gridSize,s=new T(r.minX,r.minY),o=s.clone().snapToGrid(i),l=T.Sub(s,o);t.updateShapes(t.getSelectedShapes().map(u=>{const d={x:u.x-l.x,y:u.y-l.y};return{id:u.id,type:u.type,x:d.x,y:d.y}}))}r=t.getSelectionPageBounds(),r&&!n.contains(r)&&t.zoomToSelection({animation:{duration:t.options.animationMediumMs}})}function loe(t,e,n){const r={id:Lt(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:null,url:e}};return t.run(()=>{t.createShapes([r]).select(r.id),E$(t,n)}),t.getShape(r.id)}var O1;let coe=(O1=class extends Ae{onPointerDown(e){this.parent.transition("pointing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onCancel(){this.editor.setCurrentTool("select")}onKeyUp(e){var n;if(e.key==="Enter"){if(this.editor.getIsReadonly())return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(n=this.editor.root.getCurrent())==null||n.transition("editing_shape",{...e,target:"shape",shape:r}))}}},O(O1,"id","idle"),O1);var j1;let uoe=(j1=class extends Ae{constructor(){super(...arguments);O(this,"shape");O(this,"markId","");O(this,"preciseTimeout",-1);O(this,"didTimeout",!1)}onEnter(){this.markId="",this.didTimeout=!1;const n=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:r=>!r.isLocked&&this.editor.canBindShapes({fromShape:"arrow",toShape:r,binding:"arrow"}),margin:0,hitInside:!0,renderingOnly:!0});n?this.editor.setHintingShapes([n.id]):this.createArrowShape(),this.startPreciseTimeout()}onExit(){this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()}onPointerMove(){if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:{id:"end",type:"vertex",index:"a3",x:0,y:0},isCreating:!0,creatingMarkId:this.markId||void 0,onInteractionEnd:"arrow"})}}onPointerUp(){this.cancel()}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var g;const{originPagePoint:n}=this.editor.inputs,r=Lt();this.markId=this.editor.markHistoryStoppingPoint(`creating_arrow:${r}`);const i=Rs(n,this.editor);this.editor.createShape({id:r,type:"arrow",x:i.x,y:i.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const s=this.editor.getShape(r);if(!s)throw Error("expected shape");const o=this.editor.getShapeHandles(s);if(!o)throw Error("expected handles for arrow");const l=this.editor.getShapeUtil("arrow"),u=this.shape,d=o.find(m=>m.id==="start"),f=(g=l.onHandleDrag)==null?void 0:g.call(l,s,{handle:{...d,x:0,y:0},isPrecise:!0,initial:u});f&&this.editor.updateShapes([f]),this.shape=this.editor.getShape(r),this.editor.select(r)}updateArrowShapeEndHandle(){var i,s;const n=this.shape;if(!n)throw Error("expected shape");const r=this.editor.getShapeHandles(n);if(!r)throw Error("expected handles for arrow");{const o=this.editor.getShapeUtil("arrow"),l=this.shape,u=r.find(f=>f.id==="start"),d=(i=o.onHandleDrag)==null?void 0:i.call(o,n,{handle:{...u,x:0,y:0},isPrecise:this.didTimeout,initial:l});d&&this.editor.updateShapes([d])}{const o=this.editor.getShapeUtil("arrow"),l=this.shape,u=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint),d=r.find(g=>g.id==="end"),f=(s=o.onHandleDrag)==null?void 0:s.call(o,this.editor.getShape(n),{handle:{...d,x:u.x,y:u.y},isPrecise:!1,initial:l});f&&this.editor.updateShapes([f])}this.shape=this.editor.getShape(n.id)}startPreciseTimeout(){this.preciseTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},O(j1,"id","pointing"),j1);class UC extends Ae{constructor(){super(...arguments);O(this,"shapeType","arrow")}static children(){return[coe,uoe]}}O(UC,"id","arrow"),O(UC,"initial","idle");class TE extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"initialShape");O(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");O(this,"util",this.editor.getShapeUtil(this.shapeType));O(this,"isPen",!1);O(this,"isPenOrStylus",!1);O(this,"segmentMode","free");O(this,"didJustShiftClickToExtendPreviousShapeLine",!1);O(this,"pagePointWhereCurrentSegmentChanged",{});O(this,"pagePointWhereNextSegmentChanged",null);O(this,"lastRecordedPoint",{});O(this,"mergeNextPoint",!1);O(this,"currentLineLength",0);O(this,"markId",null)}onEnter(n){this.markId=null,this.info=n,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.startShape()}onPointerMove(){const{inputs:n}=this.editor;if(this.isPen&&!n.isPen&&this.markId){this.editor.bailToMark(this.markId),this.startShape();return}this.isPenOrStylus?T.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateDrawingShape()}onKeyDown(n){if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateDrawingShape()}onKeyUp(n){if(n.key==="Shift")switch(this.editor.snaps.clearIndicators(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateDrawingShape()}onExit(){this.editor.snaps.clearIndicators(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()}canClose(){return this.shapeType!=="highlight"}getIsClosed(n,r,i){if(!this.canClose())return!1;const s=wr[r],o=n[0].points[0],l=n[n.length-1],u=l.points[l.points.length-1];return o!==u&&this.currentLineLength>s*4*i&&T.DistMin(o,u,s*2*i)}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.editor;this.markId=this.editor.markHistoryStoppingPoint("draw start");const{z:i=.5}=this.info.point;this.isPen=r,this.isPenOrStylus=r||i>0&&i<.5||i>.5&&i<1;const s=this.isPenOrStylus?i*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const l=this.editor.getShape(this.initialShape.id);if(l&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const u=Qn(l.props.segments);if(!u)throw Error("Expected a previous segment!");const d=Qn(u.points);if(!d)throw Error("Expected a previous point!");const{x:f,y:g}=this.editor.getPointInShapeSpace(l,n).toFixed(),m={type:this.segmentMode,points:[{x:d.x,y:d.y,z:+s.toFixed(2)},{x:f,y:g,z:+s.toFixed(2)}]},S=be.applyToPoint(this.editor.getShapePageTransform(l.id),d);this.pagePointWhereCurrentSegmentChanged=S,this.pagePointWhereNextSegmentChanged=null;const b=[...l.props.segments,m];this.currentLineLength<wr[l.props.size]*4&&(this.currentLineLength=this.getLineLength(b));const v={id:l.id,type:this.shapeType,props:{segments:b}};this.canClose()&&(v.props.isClosed=this.getIsClosed(b,l.props.size,l.props.scale)),this.editor.updateShapes([v]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const o=Lt();this.editor.createShapes([{id:o,type:this.shapeType,x:n.x,y:n.y,props:{isPen:this.isPenOrStylus,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+s.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(o)}updateDrawingShape(){const{initialShape:n}=this,{inputs:r}=this.editor;if(!n)return;const{id:i,props:{size:s,scale:o}}=n,l=this.editor.getShape(i);if(!l)return;const{segments:u}=l.props,{x:d,y:f,z:g}=this.editor.getPointInShapeSpace(l,r.currentPagePoint).toFixed(),m=this.isPenOrStylus?+(r.currentPagePoint.z*1.25).toFixed(2):.5,S={x:d,y:f,z:m};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:b}=this;if(b===null)throw Error("We should have a point where the segment changed");if(T.Dist2(b,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const w=Qn(u);if(!w)throw Error("Expected a previous segment!");const C=Qn(w.points);if(!C)throw Error("Expected a previous last point!");let _;const M=this.editor.getPointInShapeSpace(l,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(w.type==="straight"){this.currentLineLength+=T.Dist(C,M),_={type:"straight",points:[{...C},M]};const A=this.editor.getShapePageTransform(l);this.pagePointWhereCurrentSegmentChanged=be.applyToPoint(A,C)}else _={type:"straight",points:[M,S]};const I={id:i,type:this.shapeType,props:{segments:[...u,_]}};this.canClose()&&(I.props.isClosed=this.getIsClosed(u,s,o)),this.editor.updateShapes([I])}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:b}=this;if(b===null)throw Error("We should have a point where the segment changed");if(T.Dist2(b,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const w=u.slice(),C=w[w.length-1],_=Qn(C.points);if(!_)throw Error("No previous point!");const M={type:"free",points:[...T.PointsBetween(_,S,6).map(R=>({x:la(R.x),y:la(R.y),z:la(R.z)}))]},I=[...w,M];this.currentLineLength<wr[l.props.size]*4&&(this.currentLineLength=this.getLineLength(I));const A={id:i,type:this.shapeType,props:{segments:I}};this.canClose()&&(A.props.isClosed=this.getIsClosed(I,s,o)),this.editor.updateShapes([A])}break}case"straight":{const b=u.slice(),v=b[b.length-1],{pagePointWhereCurrentSegmentChanged:w}=this,{ctrlKey:C,currentPagePoint:_}=this.editor.inputs;if(!w)throw Error("We should have a point where the segment changed");let M,I=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(I=!C,this.didJustShiftClickToExtendPreviousShapeLine=!1):I=!C;let A=this.editor.getPointInShapeSpace(l,_).toFixed().toJson(),R=!1,D;if((this.editor.user.getIsSnapMode()?!C:C)&&b.length>2){let k,$=8/this.editor.getZoomLevel();for(let F=0,N=u.length-2;F<N;F++){const B=u[F];if(!B)break;if(B.type==="free")continue;const Y=B.points[0],K=Qn(B.points);if(!(Y&&K))continue;const V=T.NearestPointOnLineSegment(Y,K,A);if(T.DistMin(V,A,$)){k=V.toFixed().toJson(),$=T.Dist(V,A),D=B;break}}k&&(R=!0,A=k)}if(R&&D){const k=this.editor.getShapePageTransform(l),$=D.points[0],F=Qn(D.points);if(!F)throw Error("Expected a last point!");const N=be.applyToPoint(k,$),B=be.applyToPoint(k,F),Y=be.applyToPoint(k,A);this.editor.snaps.setIndicators([{id:At(),type:"points",points:[N,Y,B]}])}else{if(this.editor.snaps.clearIndicators(),I){const k=T.Angle(w,_),F=hy(k,24)-k;M=T.RotWith(_,w,F)}else M=_;A=this.editor.getPointInShapeSpace(l,M).toFixed().toJson()}this.currentLineLength+=T.Dist(v.points[0],A),b[b.length-1]={...v,type:"straight",points:[v.points[0],A]};const G={id:i,type:this.shapeType,props:{segments:b}};this.canClose()&&(G.props.isClosed=this.getIsClosed(u,s,o)),this.editor.updateShapes([G]);break}case"free":{const b=u.slice(),v=b[b.length-1],w=[...v.points];if(w.length&&this.mergeNextPoint){const{z:_}=w[w.length-1];w[w.length-1]={x:S.x,y:S.y,z:_?Math.max(_,S.z):S.z}}else this.currentLineLength+=T.Dist(w[w.length-1],S),w.push(S);b[b.length-1]={...v,points:w},this.currentLineLength<wr[l.props.size]*4&&(this.currentLineLength=this.getLineLength(b));const C={id:i,type:this.shapeType,props:{segments:b}};if(this.canClose()&&(C.props.isClosed=this.getIsClosed(b,s,o)),this.editor.updateShapes([C]),w.length>this.util.options.maxPointsPerShape){this.editor.updateShapes([{id:i,type:this.shapeType,props:{isComplete:!0}}]);const _=Lt(),M=this.editor.getShape(i).props;this.editor.createShapes([{id:_,type:this.shapeType,x:la(r.currentPagePoint.x),y:la(r.currentPagePoint.y),props:{isPen:this.isPenOrStylus,scale:M.scale,segments:[{type:"free",points:[{x:0,y:0,z:this.isPenOrStylus?+(g*1.25).toFixed():.5}]}]}}]),this.initialShape=Xt(this.editor.getShape(_)),this.mergeNextPoint=!1,this.lastRecordedPoint=r.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const i of n)for(let s=0;s<i.points.length-1;s++){const o=i.points[s],l=i.points[s+1];r+=T.Dist2(l,o)}return Math.sqrt(r)}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.complete()}onInterrupt(){this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())}complete(){const{initialShape:n}=this;n&&(this.editor.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}O(TE,"id","drawing");var D1;let P$=(D1=class extends Ae{onPointerDown(e){this.parent.transition("drawing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onCancel(){this.editor.setCurrentTool("select")}},O(D1,"id","idle"),D1);class Om extends Ae{constructor(){super(...arguments);O(this,"shapeType","draw")}static children(){return[P$,TE]}onExit(){const n=this.children.drawing;n.initialShape=void 0}}O(Om,"id","draw"),O(Om,"initial","idle"),O(Om,"isLockable",!1);class HC extends _C{constructor(){super(...arguments);O(this,"shapeType","frame")}onCreate(n){if(!n)return;const r=this.editor.getShapePageBounds(n),i=[],s=this.editor.getShapeAncestors(n).map(o=>o.id);this.editor.getSortedChildIdsForParent(n.parentId).map(o=>{const l=this.editor.getShape(o);if(!l||l.id===n.id||l.isLocked)return;const u=this.editor.getShapePageBounds(l);u&&r.contains(u)&&doe(l,s,n)&&i.push(l.id)}),this.editor.reparentShapes(i,n.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")}}O(HC,"id","frame"),O(HC,"initial","idle");function doe(t,e,n){return e.includes(t.id)?!1:t.parentId===n.parentId}var L1;let hoe=(L1=class extends Ae{onPointerDown(e){this.parent.transition("pointing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onKeyUp(e){var n;if(e.key==="Enter"){if(this.editor.getIsReadonly())return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(n=this.editor.root.getCurrent())==null||n.transition("editing_shape",{...e,target:"shape",shape:r}))}}onCancel(){this.editor.setCurrentTool("select")}},O(L1,"id","idle"),L1);var N1;let foe=(N1=class extends Ae{onPointerUp(){this.complete()}onPointerMove(e){if(this.editor.inputs.isDragging){const{originPagePoint:n}=this.editor.inputs,r=Lt(),i=this.editor.markHistoryStoppingPoint(`creating_geo:${r}`),s=Rs(n,this.editor);this.editor.createShapes([{id:r,type:"geo",x:s.x,y:s.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(Ms),scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]).select(r).setCurrentTool("select.resizing",{...e,target:"selection",handle:"bottom_right",isCreating:!0,creatingMarkId:i,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}}onCancel(){this.cancel()}onComplete(){this.complete()}onInterrupt(){this.cancel()}complete(){const{originPagePoint:e}=this.editor.inputs,n=Lt();this.editor.markHistoryStoppingPoint(`creating_geo:${n}`);const r=this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,i=this.editor.getStyleForNextShape(Ms),s=i==="star"?{w:200,h:190}:i==="cloud"?{w:300,h:180}:{w:200,h:200};this.editor.createShapes([{id:n,type:"geo",x:e.x,y:e.y,props:{geo:this.editor.getStyleForNextShape(Ms),scale:r,...s}}]);const o=this.editor.getShape(n);if(!o)return;const{w:l,h:u}=o.props,d=new T(l/2,u/2).mul(r),f=this.editor.getShapeParentTransform(o);f&&d.rot(-f.rotation());const g=Rs(new T(o.x-d.x,o.y-d.y),this.editor);this.editor.select(n),this.editor.updateShape({id:o.id,type:"geo",x:g.x,y:g.y,props:{geo:this.editor.getStyleForNextShape(Ms),w:l*r,h:u*r}}),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},O(N1,"id","pointing"),N1);class KC extends Ae{constructor(){super(...arguments);O(this,"shapeType","geo")}static children(){return[hoe,foe]}}O(KC,"id","geo"),O(KC,"initial","idle");class jm extends Ae{constructor(){super(...arguments);O(this,"shapeType","highlight")}static children(){return[P$,TE]}onExit(){const n=this.children.drawing;n.initialShape=void 0}}O(jm,"id","highlight"),O(jm,"initial","idle"),O(jm,"isLockable",!1);var z1;let poe=(z1=class extends Ae{constructor(){super(...arguments);O(this,"shapeId","")}onEnter(n){this.shapeId=n.shapeId,this.editor.setCursor({type:"cross",rotation:0})}onPointerDown(){this.parent.transition("pointing",{shapeId:this.shapeId})}onCancel(){this.editor.setCurrentTool("select")}},O(z1,"id","idle"),z1);const ej=2;var $1;let goe=($1=class extends Ae{constructor(){super(...arguments);O(this,"shape",{});O(this,"markId")}onEnter(n){const{inputs:r}=this.editor,{currentPagePoint:i}=r;this.markId=void 0;const s=n.shapeId&&this.editor.getShape(n.shapeId);if(s&&r.shiftKey){this.markId=this.editor.markHistoryStoppingPoint(`creating_line:${s.id}`),this.shape=s;const o=this.editor.getShapeHandles(this.shape);if(!o)return;const l=o.filter(b=>b.type==="vertex").sort(vr),u=l[l.length-1],d=l[l.length-2],f=be.applyToPoint(this.editor.getShapeParentTransform(this.shape),new T(this.shape.x,this.shape.y)),g=T.Sub(i,f).addXY(.1,.1),m=Rs(g,this.editor),S=Xt(this.shape.props.points);if(T.DistMin(u,d,ej)||T.DistMin(m,u,ej))S[u.id]={id:u.id,index:u.index,x:m.x,y:m.y};else{const b=so(u.index);S[b]={id:b,index:b,x:m.x,y:m.y}}this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{points:S}}])}else{const o=Lt();this.markId=this.editor.markHistoryStoppingPoint(`creating_line:${o}`);const l=Rs(i,this.editor);this.editor.createShapes([{id:o,type:"line",x:l.x,y:l.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]),this.editor.select(o),this.shape=this.editor.getShape(o)}}onPointerMove(){if(this.shape&&this.editor.inputs.isDragging){const n=this.editor.getShapeHandles(this.shape);if(!n)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const r=Qn(n);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,creatingMarkId:this.markId,handle:{...r,x:r.x-.1,y:r.y-.1},onInteractionEnd:"line"})}}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.complete()}onInterrupt(){this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators()}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}},O($1,"id","pointing"),$1);class GC extends Ae{constructor(){super(...arguments);O(this,"shapeType","line")}static children(){return[poe,goe]}}O(GC,"id","line"),O(GC,"initial","idle");var B1;let moe=(B1=class extends Ae{onPointerDown(e){this.parent.transition("pointing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onCancel(){this.editor.setCurrentTool("select")}},O(B1,"id","idle"),B1);const yoe=0,Dt=200,XS=new T(Dt/2,Dt/2),T$=10,Soe=t=>[[["a1"],new T(Dt*.5,Dt*-.5-t.options.adjacentShapeMargin)],[["a2"],new T(Dt*1.5+t.options.adjacentShapeMargin,Dt*.5)],[["a3"],new T(Dt*.5,Dt*1.5+t.options.adjacentShapeMargin)],[["a4"],new T(Dt*-.5-t.options.adjacentShapeMargin,Dt*.5)]];function voe(t,e){if(e===1)return Soe(t);const n=Dt*e,r=t.options.adjacentShapeMargin*e;return[[["a1"],new T(n*.5,n*-.5-r)],[["a2"],new T(n*1.5+r,n*.5)],[["a3"],new T(n*.5,n*1.5+r)],[["a4"],new T(n*-.5-r,n*.5)]]}function I$(t,e,n,r,i,s){return Object.fromEntries(voe(t,s).map(([o,l],u)=>{const d=l.clone();return u===0&&i?d.y-=i:u===2&&r&&(d.y+=r),[o,d.rot(n).add(e)]}))}function M$(t,e,n,r){const i=new Set(t.getSelectedShapeIds()),s=(Dt+t.options.adjacentShapeMargin+r)**2,o=new Map,l=[];for(const f of t.getCurrentPageShapes()){if(!t.isShapeOfType(f,"note")||n!==f.props.scale||i.has(f.id))continue;const g=t.getShapePageTransform(f.id);e===g.rotation()&&(o.set(f,t.getShapePageBounds(f).center),l.push(...Object.values(I$(t,g.point(),e,f.props.growY,r,n))))}const u=l.length;let d;for(const[f,g]of o)for(let m=0;m<u;m++)d=l[m],d&&(T.Dist2(g,d)>s||t.isPointInShape(f,d)&&(l[m]=void 0));return We(l)}function A$(t,e,n,r,i=!1){let s;const o=t.getCurrentPageShapesSorted(),l=(Dt+t.options.adjacentShapeMargin**2)**e.props.scale;for(let u=o.length-1;u>=0;u--){const d=o[u];if(d.type==="note"&&d.id!==e.id){const f=t.getShapePageBounds(d);if(f&&T.Dist2(f.center,n)<l&&t.isPointInShape(d,n)){s=d;break}}}if(t.complete(),!s||i){t.markHistoryStoppingPoint("creating note shape");const u=Lt();t.createShape({id:u,type:"note",x:n.x,y:n.y,rotation:r,opacity:e.opacity,props:{...e.props,text:"",growY:0,fontSizeAdjustment:0,url:""}});const d=t.getShape(u);if(!d)return;const f=t.getPointInParentSpace(d,T.Sub(n,T.Rot(XS.clone().mul(d.props.scale),r)));t.updateShape({id:u,type:"note",x:f.x,y:f.y}),s=t.getShape(u)}return xoe(t),s}const boe=16;function xoe(t){const e=t.getSelectionPageBounds(),n=t.getViewportPageBounds();if(e&&!n.contains(e)){const r=e.clone().expandBy(boe/t.getZoomLevel()).expand(n),i=n.clone().translate({x:(r.center.x-n.center.x)*2,y:(r.center.y-n.center.y)*2});t.zoomToBounds(i,{animation:{duration:t.options.animationMediumMs},inset:0})}}var F1;let woe=(F1=class extends Ae{constructor(){super(...arguments);O(this,"dragged",!1);O(this,"info",{});O(this,"markId","");O(this,"shape",{})}onEnter(){const{editor:n}=this,r=Lt();this.markId=n.markHistoryStoppingPoint(`creating_note:${r}`);const i=this.editor.inputs.originPagePoint.clone(),s=Coe(this.editor,i,this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1);s&&i.sub(s),this.shape=_oe(this.editor,r,i)}onPointerMove(n){this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.translating",{...n,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,creatingMarkId:this.markId,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}})}onPointerUp(){this.complete()}onInterrupt(){this.cancel()}onComplete(){this.complete()}onCancel(){this.cancel()}complete(){this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape}))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}},O(F1,"id","pointing"),F1);function Coe(t,e,n){let r=T$/t.getZoomLevel(),i;for(const s of M$(t,0,n,0)){const o=T.Sub(e,s),l=o.len();l<r&&(r=l,i=o)}return i}function _oe(t,e,n){t.createShape({id:e,type:"note",x:n.x,y:n.y,props:{scale:t.user.getIsDynamicResizeMode()?1/t.getZoomLevel():1}}).select(e);const r=t.getShape(e),i=t.getShapeGeometry(r).bounds,s=Rs(new T(r.x-i.width/2,r.y-i.height/2),t);return t.updateShapes([{id:e,type:"note",x:s.x,y:s.y}]),t.getShape(e)}class qC extends Ae{constructor(){super(...arguments);O(this,"shapeType","note")}static children(){return[moe,woe]}}O(qC,"id","note"),O(qC,"initial","idle");function Eoe(t){const e=t.getShapeAtPoint(t.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:t.options.hitTestMargin/t.getZoomLevel(),renderingOnly:!0});if(!e)return t.setHoveredShape(null);let n;const r=t.getOutermostSelectableShape(e);return r===e||r.id===t.getFocusedGroupId()||t.getSelectedShapeIds().includes(r.id)?n=e:n=r,t.setHoveredShape(n.id)}const da=kD(Eoe,32);var U1;let Poe=(U1=class extends Ae{onPointerMove(e){switch(e.target){case"shape":case"canvas":da(this.editor)}}onPointerDown(e){this.parent.transition("pointing",e)}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onExit(){da.cancel()}onKeyDown(e){var n;if(e.key==="Enter"){if(this.editor.getIsReadonly())return null;const r=this.editor.getOnlySelectedShape();r&&this.editor.getShapeUtil(r).canEdit(r)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(r.id),(n=this.editor.root.getCurrent())==null||n.transition("editing_shape",{...e,target:"shape",shape:r}))}}onCancel(){this.editor.setCurrentTool("select")}},O(U1,"id","idle"),U1);var H1;let Toe=(H1=class extends Ae{constructor(){super(...arguments);O(this,"shape");O(this,"markId","");O(this,"enterTime",0)}onEnter(){this.enterTime=Date.now()}onExit(){this.editor.setHintingShapes([])}onPointerMove(n){if(Date.now()-this.enterTime<150)return;const{editor:r}=this,{isPointing:i}=r.inputs;if(!i)return;const{originPagePoint:s,currentPagePoint:o}=r.inputs,l=Math.abs(s.x-o.x),d=Math.sqrt(r.getInstanceState().isCoarsePointer?r.options.coarseDragDistanceSquared:r.options.dragDistanceSquared)*6/r.getZoomLevel();if(l>d){const f=Lt();this.markId=r.markHistoryStoppingPoint(`creating_text:${f}`);const g=this.createTextShape(f,s,!1,l);if(!g){this.cancel();return}this.shape=r.getShape(g),r.select(f),r.setCurrentTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creatingMarkId:this.markId,creationCursorOffset:{x:l,y:1},onInteractionEnd:"text",onCreate:()=>{r.setEditingShape(g.id)}})}}onPointerUp(){this.complete()}onComplete(){this.cancel()}onCancel(){this.cancel()}onInterrupt(){this.cancel()}complete(){this.editor.markHistoryStoppingPoint("creating text shape");const n=Lt(),{originPagePoint:r}=this.editor.inputs;this.createTextShape(n,r,!0,20)&&(this.editor.select(n),this.editor.setEditingShape(n))}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}createTextShape(n,r,i,s){this.editor.createShape({id:n,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:i,w:s,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const o=this.editor.getShape(n);if(!o){this.cancel();return}const l=this.editor.getShapePageBounds(o),u=new T;if(i)switch(o.props.textAlign){case"start":{u.x=0;break}case"middle":{u.x=-l.width/2;break}case"end":{u.x=-l.width;break}}else u.x=0;if(u.y=-l.height/2,Zr(o.parentId)){const g=this.editor.getShapeParentTransform(o);u.rot(-g.rotation())}const d=o.x+u.x,f=o.y+u.y;if(this.editor.getInstanceState().isGridMode){const g=new T(d,f),m=Rs(g,this.editor),S=T.Sub(g,m);this.editor.updateShape({...o,x:d-S.x,y:f-S.y})}else this.editor.updateShape({...o,x:d,y:f});return o}},O(H1,"id","pointing"),H1);class YC extends Ae{constructor(){super(...arguments);O(this,"shapeType","text")}static children(){return[Poe,Toe]}}O(YC,"id","text"),O(YC,"initial","idle");const Ioe=[YC,Om,KC,qC,GC,HC,UC,jm];function ss(){return Ca({isDarkMode:dp()})}function ZS(t){return{key:`${mo.id}:${t}`,async getElement(){const e=Moe(t);if(!e)return null;const{url:n,fontFaceRule:r}=e,i=await(await go(n)).blob(),s=await Ts.blobToDataUrl(i),o=r.replace(n,s);return p.jsx("style",{children:o})}}}function Moe(t){const e=i3[t];for(const n of document.fonts)if(e.includes(n.family)&&"$$_url"in n&&typeof n.$$_url=="string"&&"$$_fontface"in n&&typeof n.$$_fontface=="string")return{url:n.$$_url,fontFaceRule:n.$$_fontface};return null}function IE(t){return{key:`${mo.id}:${t}`,async getElement(){return t!=="pattern"?null:p.jsx(Aoe,{})}}}function Aoe(){const t=AE(),e=xd(),n=ss(),r=8/12;return p.jsxs(p.Fragment,{children:[p.jsxs("mask",{id:e,children:[p.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:"white"}),p.jsxs("g",{strokeLinecap:"round",stroke:"black",children:[p.jsx("line",{x1:r*1,y1:r*3,x2:r*3,y2:r*1}),p.jsx("line",{x1:r*5,y1:r*7,x2:r*7,y2:r*5}),p.jsx("line",{x1:r*9,y1:r*11,x2:r*11,y2:r*9})]})]}),p.jsx("pattern",{id:t(1,n.id),width:"8",height:"8",patternUnits:"userSpaceOnUse",children:p.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:n.solid,mask:`url(#${e})`})})]})}function ME(){return{key:`${mo.id}:pattern`,component:joe}}const cf=8,tj=(t,e,n)=>new Promise((r,i)=>{const s=cf*e*t,o=document.createElement("canvas");o.width=s,o.height=s;const l=o.getContext("2d");if(!l)return;l.fillStyle=n?vy.darkMode.solid:vy.lightMode.solid,l.fillRect(0,0,s,s),l.globalCompositeOperation="destination-out",l.lineCap="round",l.lineWidth=1.25*e*t;const u=8/12,d=f=>f*e*t;l.beginPath(),l.moveTo(d(u*1),d(u*3)),l.lineTo(d(u*3),d(u*1)),l.moveTo(d(u*5),d(u*7)),l.lineTo(d(u*7),d(u*5)),l.moveTo(d(u*9),d(u*11)),l.lineTo(d(u*11),d(u*9)),l.stroke(),o.toBlob(f=>{!f||xn.throwToBlob.get()?i():r(f)})}),nj=(t,e)=>{const n=document.createElement("canvas");n.width=t[0],n.height=t[1];const r=n.getContext("2d");return r?(e(r),n.toDataURL()):""};let p1=null;function koe(){return p1||(p1={white:nj([1,1],t=>{t.fillStyle="#f8f9fa",t.fillRect(0,0,1,1)}),black:nj([1,1],t=>{t.fillStyle="#212529",t.fillRect(0,0,1,1)})}),p1}function k$(t){return Math.ceil(Math.log2(Math.max(1,t)))}function AE(){const t=As("hash_pattern");return E.useCallback((e,n)=>{const r=k$(e);return u2(t,`${n}_${r}`)},[t])}function R$(t){const e=[],r=k$(t);for(let i=0;i<=r;i++)e.push(Math.pow(2,i));return e}function Roe(t){const e=koe();return R$(t).flatMap(n=>[{zoom:n,url:e.white,theme:"light"},{zoom:n,url:e.black,theme:"dark"}])}function Ooe(){const t=re(),e=oe("devicePixelRatio",()=>t.getInstanceState().devicePixelRatio,[t]),n=oe("maxZoom",()=>Math.ceil(Qn(t.getCameraOptions().zoomSteps)),[t]),[r,i]=E.useState(!1),[s,o]=E.useState(()=>Roe(n)),l=AE();return E.useEffect(()=>{const d=Promise.all(R$(n).flatMap(g=>[tj(e,g,!1).then(m=>({zoom:g,theme:"light",url:URL.createObjectURL(m)})),tj(e,g,!0).then(m=>({zoom:g,theme:"dark",url:URL.createObjectURL(m)}))]));let f=!1;return d.then(g=>{f||(o(g),i(!0))}),()=>{f=!0,i(!1),d.then(g=>{for(const{url:m}of g)URL.revokeObjectURL(m)})}},[e,n]),{defs:p.jsx(p.Fragment,{children:s.map(d=>{const f=l(d.zoom,d.theme);return p.jsx("pattern",{id:f,width:cf,height:cf,patternUnits:"userSpaceOnUse",children:p.jsx("image",{href:d.url,width:cf,height:cf})},f)})}),isReady:r}}function joe(){const t=re(),e=E.useRef(null),{defs:n,isReady:r}=Ooe();return E.useEffect(()=>{if(r&&Ft.isSafari){const i=O$(e.current);i&&t.timers.requestAnimationFrame(()=>{i.style.display="none",t.timers.requestAnimationFrame(()=>{i.style.display=""})})}},[t,r]),p.jsx("g",{ref:e,"data-testid":r?"ready-pattern-fill-defs":void 0,children:n})}function O$(t){return t.classList.contains("tl-html-layer")?t:t.parentElement?O$(t.parentElement):null}const mr=et.memo(function({theme:e,d:n,color:r,fill:i,scale:s}){switch(i){case"none":return null;case"solid":return p.jsx("path",{fill:e[r].semi,d:n});case"semi":return p.jsx("path",{fill:e.solid,d:n});case"fill":return p.jsx("path",{fill:e[r].fill,d:n});case"pattern":return p.jsx(Doe,{theme:e,color:r,fill:i,d:n,scale:s})}});function Doe({d:t,color:e,theme:n}){const r=re(),i=ap(),s=oe("zoomLevel",()=>r.getZoomLevel(),[r]),o=AE(),l=r.getZoomLevel()<=.18;return p.jsxs(p.Fragment,{children:[p.jsx("path",{fill:n[e].pattern,d:t}),p.jsx("path",{fill:i?`url(#${o(1,n.id)})`:l?n[e].semi:`url(#${o(s,n.id)})`,d:t})]})}function Loe(t){return t.replace(/\s/g,"")}function VC(t,e,n){const{padding:r=0}=n;if(e.length===0)return null;const i=xe.From(e[0].box);for(const{box:d}of e)i.union(d);const s=r+(n.offsetX??0),o=(n.offsetY??0)+n.fontSize/2+(n.verticalTextAlign==="start"?r:n.verticalTextAlign==="end"?n.height-r-i.height:(Math.ceil(n.height)-i.height)/2);let l=null;const u=[];for(const{text:d,box:f}of e)l!==null&&f.y>l&&u.push(p.jsx("tspan",{alignmentBaseline:"mathematical",x:s,y:f.y+o,children:`
`},u.length)),u.push(p.jsx("tspan",{alignmentBaseline:"mathematical",x:f.x+s,y:f.y+o,unicodeBidi:"plaintext",children:Loe(d)},u.length)),l=f.y;return p.jsx("text",{fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,dominantBaseline:"mathematical",alignmentBaseline:"mathematical",stroke:n.stroke,strokeWidth:n.strokeWidth,fill:n.fill,children:u})}function Noe(t,e,n,r){if((t==="start-legacy"||t==="end-legacy")&&n.length!==0){const i=xe.From(n[0].box);for(const{box:s}of n)i.union(s);if(t==="start-legacy")return(r-2*e-i.width)/2;if(t==="end-legacy")return-(r-2*e-i.width)/2}}function zoe(t){return t==="start-legacy"||t==="middle-legacy"||t==="end-legacy"}function QS({fontSize:t,font:e,align:n,verticalAlign:r,text:i,labelColor:s,bounds:o,padding:l=16,stroke:u=!0}){const d=re(),f=ss(),g={fontSize:t,fontFamily:i3[e],textAlign:n,verticalTextAlign:r,width:Math.ceil(o.width),height:Math.ceil(o.height),padding:l,lineHeight:Cr.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0,offsetY:0,fill:s,stroke:void 0,strokeWidth:void 0},m=d.textMeasure.measureTextSpans(i,g),S=Noe(n,l,m,o.width);S&&(g.offsetX=S),g.offsetX+=o.x,g.offsetY+=o.y;const b=VC(d,m,g);let v=null;return u&&(g.fill=f.background,g.stroke=f.background,g.strokeWidth=2,v=VC(d,m,g)),p.jsxs(p.Fragment,{children:[v,b]})}const $oe=E.forwardRef(function({isEditing:e,text:n,handleFocus:r,handleChange:i,handleKeyDown:s,handleBlur:o,handleInputPointerDown:l,handleDoubleClick:u},d){return p.jsx("textarea",{ref:d,className:"tl-text tl-text-input",name:"text",tabIndex:-1,readOnly:!e,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",defaultValue:n,onFocus:r,onChange:i,onKeyDown:s,onBlur:o,onTouchEnd:_n,onContextMenu:e?_n:void 0,onPointerDown:l,onDoubleClick:u,onDragStart:Je})});function Boe(t,e,n){const r=re(),i=E.useRef(null),s=oe("isEditing",()=>r.getEditingShapeId()===t,[r]),o=oe("isEditingAnything",()=>!!r.getEditingShapeId(),[r]);E.useEffect(()=>{function f(g){var m;g.shapeId===t&&((m=i.current)==null||m.select())}return r.on("select-all-text",f),()=>{r.off("select-all-text",f)}},[r,t,s]),E.useEffect(()=>{var f,g,m,S;s&&(document.activeElement!==i.current&&((f=i.current)==null||f.focus()),r.getInstanceState().isCoarsePointer&&((g=i.current)==null||g.select()),Ft.isSafari&&((m=i.current)==null||m.blur(),(S=i.current)==null||S.focus()))},[r,s]);const l=E.useCallback(f=>{if(r.getEditingShapeId()===t)switch(f.key){case"Enter":{(f.ctrlKey||f.metaKey)&&r.complete();break}}},[r,t]),u=E.useCallback(f=>{if(r.getEditingShapeId()!==t)return;let g=cd.normalizeText(f.currentTarget.value);const m=g.replace(/\t/g,Wu);if(m!==g){const S=f.currentTarget.selectionStart;f.currentTarget.value=m,f.currentTarget.selectionStart=S+(m.length-g.length),f.currentTarget.selectionEnd=S+(m.length-g.length),g=m}r.updateShape({id:t,type:e,props:{text:g}})},[r,t,e]),d=E.useCallback(f=>{r.dispatch({...xi(f),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(t)}),_n(f)},[r,t]);return{rInput:i,handleFocus:Tf,handleBlur:Tf,handleKeyDown:l,handleChange:u,handleInputPointerDown:d,handleDoubleClick:_n,isEmpty:n.trim().length===0,isEditing:s,isEditingAnything:o}}const JS=et.memo(function({shapeId:e,type:n,text:r,labelColor:i,font:s,fontSize:o,lineHeight:l,align:u,verticalAlign:d,wrap:f,isSelected:g,padding:m=0,onKeyDown:S,classNamePrefix:b,style:v,textWidth:w,textHeight:C}){const{rInput:_,isEmpty:M,isEditing:I,isEditingAnything:A,...R}=Boe(e,n,r),[D,L]=E.useState(r);E.useEffect(()=>{I||L(r)},[I,r]);const G=cd.normalizeTextForDom(r),k=G.length>0,$=zoe(u);if(!I&&!k)return null;const F=b||"tl-text";return p.jsx("div",{className:`${F}-label tl-text-wrapper`,"data-font":s,"data-align":u,"data-hastext":!M,"data-isediting":I,"data-iseditinganything":A,"data-textwrap":!!f,"data-isselected":g,style:{justifyContent:u==="middle"||$?"center":u,alignItems:d==="middle"?"center":d,padding:m,...v},children:p.jsxs("div",{className:`${F}-label__inner tl-text-content__wrapper`,style:{fontSize:o,lineHeight:Math.floor(o*l)+"px",minHeight:Math.floor(o*l)+"px",minWidth:Math.ceil(w||0),color:i,width:w?Math.ceil(w):void 0,height:C?Math.ceil(C):void 0},children:[p.jsx("div",{className:`${F} tl-text tl-text-content`,dir:"auto",children:G.split(`
`).map((N,B)=>p.jsx("div",{dir:"auto",children:N},B))}),(A||g)&&p.jsx($oe,{ref:_,text:r,isEditing:I,...R,handleKeyDown:S??R.handleKeyDown},D)]})})}),Foe=new po;function Uoe(t){return Foe.get(t,()=>t.store.createComputedCache("arrowLabelSize",e=>{const n=ao(t,e);let r=0,i=0;const s=n.isStraight?new ua({start:T.From(n.start.point),end:T.From(n.end.point)}):new Yu({center:T.Cast(n.handleArc.center),start:T.Cast(n.start.point),end:T.Cast(n.end.point),sweepFlag:n.bodyArc.sweepFlag,largeArcFlag:n.bodyArc.largeArcFlag});if(e.props.text.trim()){const o=s.bounds,l=WC(e),{w:u,h:d}=t.textMeasure.measureText(e.props.text,{...Cr,fontFamily:va[e.props.font],fontSize:l,maxWidth:null});r=u,i=d;let f=!1;if(o.width>o.height?(r=Math.max(Math.min(u,64),Math.min(o.width-64,u)),f=!0):r>16*l&&(r=16*l,f=!0),f){const{w:g,h:m}=t.textMeasure.measureText(e.props.text,{...Cr,fontFamily:va[e.props.font],fontSize:l,maxWidth:r});r=g,i=m}}return new T(r,i).addScalar(PE*2*e.props.scale)}))}function kE(t,e){return e.props.text.trim()===""?new T(0,0).addScalar(PE*2*e.props.scale):Uoe(t).get(e.id)??new T(0,0)}function j$(t){const e=wr[t.props.size];return(Ase+(e-wr.s)*2+(e===wr.xl?20:0))*t.props.scale}function Hoe(t,e,n){const r=kE(t,e),i=j$(e),s=T.Nudge(n.start.point,n.end.point,i),o=T.Nudge(n.end.point,n.start.point,i),l=x2(s,o,xe.FromCenter(n.middle,r).corners);if(!l||l.length!==2)return{start:.5,end:.5};let[u,d]=l;T.Dist2(u,s)>T.Dist2(d,s)&&([d,u]=l);const f=s.add(T.Sub(n.middle,u)),g=o.add(T.Sub(n.middle,d)),m=T.Dist(n.start.point,f)/n.length,S=T.Dist(n.start.point,g)/n.length;return{start:m,end:S}}function Koe(t,e,n){const r=kE(t,e),i=j$(e),s=Math.sign(e.props.bend),o=i/n.handleArc.radius*s,l=T.Angle(n.bodyArc.center,n.start.point)-o,u=T.Angle(n.bodyArc.center,n.end.point)+o,d=bc(n.bodyArc.center,n.bodyArc.radius,l),f=bc(n.bodyArc.center,n.bodyArc.radius,u),g=[],m=ij(n.bodyArc.center,n.bodyArc.radius,l,u,s,xe.FromCenter(d,r).corners);g.push(new bn({points:xe.FromCenter(d,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));const S=ij(n.bodyArc.center,n.bodyArc.radius,l,u,s,xe.FromCenter(f,r).corners);g.push(new bn({points:xe.FromCenter(f,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));for(const D of[...m??[],...S??[],d,f])g.push(new j2({x:D.x-3,y:D.y-3,radius:3,isFilled:!1,debugColor:"magenta",ignore:!0}));const b=(m&&sj(n.start.point,m))??n.middle,v=(S&&sj(n.end.point,S))??n.middle,w=T.Angle(n.bodyArc.center,n.start.point),C=T.Angle(n.bodyArc.center,n.end.point),_=T.Angle(n.bodyArc.center,b),M=T.Angle(n.bodyArc.center,v);if(ll(w,_,s)>ll(w,M,s))return{start:.5,end:.5,dbg:g};const I=ll(w,C,s),A=ll(w,_,s)/I,R=ll(w,M,s)/I;return{start:A,end:R,dbg:g}}function Dm(t,e){let n;const r=[],i=ao(t,e),s={hasStartBinding:!!i.bindings.start,hasEndBinding:!!i.bindings.end,hasStartArrowhead:i.start.arrowhead!=="none",hasEndArrowhead:i.end.arrowhead!=="none"};if(i.isStraight){const l=Hoe(t,e,i),u=rj(t,e,l,s);n=T.Lrp(i.start.point,i.end.point,u)}else{const l=Koe(t,e,i);l.dbg&&r.push(...l.dbg);const u=rj(t,e,l,s),d=Goe(T.Angle(i.bodyArc.center,i.start.point),T.Angle(i.bodyArc.center,i.end.point),Math.sign(e.props.bend),u);n=bc(i.bodyArc.center,i.bodyArc.radius,d)}const o=kE(t,e);return{box:xe.FromCenter(n,o),debugGeom:r}}function rj(t,e,n,r){const{hasEndArrowhead:i,hasEndBinding:s,hasStartBinding:o,hasStartArrowhead:l}=r,u=z$(t,e);let d=Xn(e.props.labelPosition,l||o?n.start:0,i||s?n.end:1);const f=Math.min(.02,500/u*.02);return d=d>=.5-f&&d<=.5+f?.5:d,d}function ij(t,e,n,r,i,s){const o=mC(t,e,s),l=ll(n,r,i);return o==null?void 0:o.filter(u=>{const d=ll(n,T.Angle(t,u),i);return d>=0&&d<=l})}function sj(t,e){let n=null,r=-1/0;for(const i of e){const s=T.Dist2(t,i);s>r&&(n=i,r=s)}return n}function Goe(t,e,n,r){const i=ll(t,e,n);return t+i*r*n*-1}function WC(t){return Mse[t.props.size]*t.props.scale}function qoe(t,e,n){const r=e==="end"?t.end.point:t.start.point,i=e==="end"?t.start.point:t.end.point,s=t.isStraight?T.Dist(i,r):Math.abs(t.bodyArc.length),o=Math.max(Math.min(s/5,n*3),n);let l;if(t.isStraight)l=T.Nudge(r,i,o);else{const u=RW(r,o,t.handleArc.center,t.handleArc.radius);l=e==="end"?t.handleArc.sweepFlag?u[0]:u[1]:t.handleArc.sweepFlag?u[1]:u[0]}return T.IsNaN(l)&&(l=t.start.point),{point:r,int:l}}function Yoe({point:t,int:e}){const n=T.RotWith(e,t,yt/6),r=T.RotWith(e,t,-yt/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y}`}function Voe({point:t,int:e}){const n=T.RotWith(e,t,yt/6),r=T.RotWith(e,t,-yt/6);return`M ${n.x} ${n.y} L ${r.x} ${r.y} L ${t.x} ${t.y} Z`}function Woe({point:t,int:e}){const n=T.Sub(e,t).div(2),r=T.Add(t,T.Rot(n,Yt)),i=T.Sub(t,T.Rot(n,Yt));return`M ${r.x} ${r.y} L ${e.x} ${e.y} L ${i.x} ${i.y} Z`}function Xoe({point:t,int:e}){const n=T.Lrp(t,e,.45),r=T.Dist(n,t);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function Zoe({point:t,int:e}){const n=T.Lrp(t,e,.75),r=T.RotWith(n,t,yt/4),i=T.RotWith(n,t,-yt/4),s=T.Lrp(r,i,.5);return s.add(T.Sub(s,t)),`M ${s.x} ${s.y} L ${i.x} ${i.y} ${t.x} ${t.y} L ${r.x} ${r.y} Z`}function Qoe({int:t,point:e}){const n=T.Lrp(e,t,.85),r=T.Sub(n,e).div(2),i=T.Add(e,T.Rot(r,Yt)),s=T.Sub(e,T.Rot(r,Yt)),o=T.Add(n,T.Rot(r,Yt)),l=T.Sub(n,T.Rot(r,Yt));return`M ${i.x} ${i.y} L ${o.x} ${o.y} L ${l.x} ${l.y} L ${s.x} ${s.y} Z`}function Joe({int:t,point:e}){const n=T.Sub(t,e).div(2),r=T.Add(e,T.Rot(n,Yt)),i=T.Sub(e,T.Rot(n,Yt));return`M ${r.x} ${r.y} L ${i.x} ${i.y}`}function Uy(t,e,n){const r=e==="end"?t.end.arrowhead:t.start.arrowhead;if(r==="none")return;const i=qoe(t,e,n);if(i){switch(r){case"bar":return Joe(i);case"square":return Qoe(i);case"diamond":return Zoe(i);case"dot":return Xoe(i);case"inverted":return Woe(i);case"arrow":return Yoe(i);case"triangle":return Voe(i)}return""}}function eae(t){const{start:e,end:n,handleArc:{radius:r,largeArcFlag:i,sweepFlag:s}}=t;return`M${e.handle.x},${e.handle.y} A${r} ${r} 0 ${i} ${s} ${n.handle.x},${n.handle.y}`}function D$(t){const{start:e,end:n,bodyArc:{radius:r,largeArcFlag:i,sweepFlag:s}}=t;return`M${e.point.x},${e.point.y} A${r} ${r} 0 ${i} ${s} ${n.point.x},${n.point.y}`}function L$(t,e){return`M${t.x},${t.y}L${e.x},${e.y}`}function tae(t){return L$(t.start.handle,t.end.handle)}function N$(t){return L$(t.start.point,t.end.point)}class Lm extends si{constructor(){super(...arguments);O(this,"_resizeInitialBindings",new po)}canEdit(){return!0}canBind({toShapeType:n}){return n!=="arrow"}canSnap(){return!1}hideResizeHandles(){return!0}hideRotateHandle(){return!0}hideSelectionBoundsBg(){return!0}hideSelectionBoundsFg(){return!0}canBeLaidOut(n){const r=ei(this.editor,n);return!r.start&&!r.end}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{x:0,y:0},end:{x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",labelPosition:.5,font:"draw",scale:1}}getGeometry(n){const r=ao(this.editor,n),i=[],s=r.isStraight?new ua({start:T.From(r.start.point),end:T.From(r.end.point)}):new Yu({center:T.Cast(r.handleArc.center),start:T.Cast(r.start.point),end:T.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let o;if(n.props.text.trim()){const l=Dm(this.editor,n);i.push(...l.debugGeom),o=new Rr({x:l.box.x,y:l.box.y,width:l.box.w,height:l.box.h,isFilled:!0,isLabel:!0})}return new ns({children:[...o?[s,o]:[s],...i]})}getHandles(n){const r=ao(this.editor,n);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y}].filter(Boolean)}getText(n){return n.props.text}onHandleDrag(n,{handle:r,isPrecise:i}){const s=r.id,o=ei(this.editor,n);if(s==="middle"){const{start:R,end:D}=Vu(this.editor,n,o),L=T.Sub(D,R),G=T.Per(L),k=T.Med(D,R),$=T.Sub(k,G),F=T.Add(k,G),N=T.NearestPointOnLineSegment($,F,r,!1);let B=T.Dist(N,k);return T.Clockwise(N,D,k)&&(B*=-1),{id:n.id,type:n.type,props:{bend:B}}}const l={id:n.id,type:"arrow",props:{}},u=o[s],f=o[s==="start"?"end":"start"];if(this.editor.inputs.ctrlKey)return km(this.editor,n,s),l.props[s]={x:r.x,y:r.y},l;const g=this.editor.getShapePageTransform(n.id).applyToPoint(r),m=this.editor.getShapeAtPoint(g,{hitInside:!0,hitFrameInside:!0,margin:0,filter:R=>!R.isLocked&&this.editor.canBindShapes({fromShape:n,toShape:R,binding:"arrow"})});if(!m){km(this.editor,n,s);const R=Rs(new T(r.x,r.y),this.editor);return l.props[s]={x:R.x,y:R.y},l}const S=this.editor.getShapeGeometry(m),b=xe.ZeroFix(S.bounds),w=this.editor.getShapePageTransform(l.id).applyToPoint(r),C=this.editor.getPointInShapeSpace(m,w);let _=i;_||(!u||u&&m.id!==u.toId)&&(_=this.editor.inputs.pointerVelocity.len()<.5),i||(S.isClosed||(_=!0),f&&m.id===f.toId&&f.props.isPrecise&&(_=!0));const M={x:(C.x-b.minX)/b.width,y:(C.y-b.minY)/b.height};_&&T.Dist(C,b.center)<Math.max(4,Math.min(Math.min(b.width,b.height)*.15,16))/this.editor.getZoomLevel()&&(M.x=.5,M.y=.5);const I={terminal:s,normalizedAnchor:M,isPrecise:_,isExact:this.editor.inputs.altKey};Yh(this.editor,n,m.id,I),this.editor.setHintingShapes([m.id]);const A=ei(this.editor,n);return A.start&&A.end&&A.start.toId===A.end.toId&&T.Equals(A.start.props.normalizedAnchor,A.end.props.normalizedAnchor)&&Yh(this.editor,n,A.end.toId,{...A.end.props,normalizedAnchor:{x:A.end.props.normalizedAnchor.x+.05,y:A.end.props.normalizedAnchor.y}}),l}onTranslateStart(n){const r=ei(this.editor,n),i=Vu(this.editor,n,r),s=this.editor.getShapePageTransform(n.id),o=this.editor.getSelectedShapeIds();if(!(r.start&&(o.includes(r.start.toId)||this.editor.isAncestorSelected(r.start.toId))||r.end&&(o.includes(r.end.toId)||this.editor.isAncestorSelected(r.end.toId)))){aj.set(n,{pagePosition:s.applyToPoint(n),terminalBindings:Wf(i,(l,u)=>{const d=r[l];return d?{binding:d,shapePosition:u,pagePosition:s.applyToPoint(u)}:null})}),r.start&&(Fy({editor:this.editor,arrow:n,terminal:"start",useHandle:!0}),n=this.editor.getShape(n.id)),r.end&&Fy({editor:this.editor,arrow:n,terminal:"end",useHandle:!0});for(const l of["start","end"]){const u=r[l];u&&this.editor.updateBinding({...u,props:{...u.props,isPrecise:!0}})}}}onTranslate(n,r){const i=aj.get(n);if(!i)return;const s=this.editor.getShapePageTransform(r.id),o=T.Sub(s.applyToPoint(r),i.pagePosition);for(const l of Object.values(i.terminalBindings)){if(!l)continue;const u=T.Add(l.pagePosition,T.Mul(o,.5)),d=this.editor.getShapeAtPoint(u,{hitInside:!0,hitFrameInside:!0,margin:0,filter:f=>!f.isLocked&&this.editor.canBindShapes({fromShape:r,toShape:f,binding:"arrow"})});if((d==null?void 0:d.id)===l.binding.toId){const f=xe.ZeroFix(this.editor.getShapeGeometry(d).bounds),g=this.editor.getPointInShapeSpace(d,u),m={x:(g.x-f.minX)/f.width,y:(g.y-f.minY)/f.height};Yh(this.editor,r,d.id,{...l.binding.props,normalizedAnchor:m,isPrecise:!0})}else km(this.editor,r,l.binding.props.terminal)}}onResize(n,r){const{scaleX:i,scaleY:s}=r,o=this._resizeInitialBindings.get(n,()=>ei(this.editor,n)),l=Vu(this.editor,n,o),{start:u,end:d}=Xt(n.props);let{bend:f}=n.props;o.start||(u.x=l.start.x*i,u.y=l.start.y*s),o.end||(d.x=l.end.x*i,d.y=l.end.y*s);const g=Math.abs(i),m=Math.abs(s),S=o!=null&&o.start?T.From(o.start.props.normalizedAnchor):null,b=o!=null&&o.end?T.From(o.end.props.normalizedAnchor):null;return i<0&&s>=0?(f!==0&&(f*=-1,f*=Math.max(g,m)),S&&(S.x=1-S.x),b&&(b.x=1-b.x)):i>=0&&s<0?(f!==0&&(f*=-1,f*=Math.max(g,m)),S&&(S.y=1-S.y),b&&(b.y=1-b.y)):i>=0&&s>=0?f!==0&&(f*=Math.max(g,m)):i<0&&s<0&&(f!==0&&(f*=Math.max(g,m)),S&&(S.x=1-S.x,S.y=1-S.y),b&&(b.x=1-b.x,b.y=1-b.y)),o.start&&S&&Yh(this.editor,n,o.start.toId,{...o.start.props,normalizedAnchor:S.toJson()}),o.end&&b&&Yh(this.editor,n,o.end.toId,{...o.end.props,normalizedAnchor:b.toJson()}),{props:{start:u,end:d,bend:f}}}onDoubleClickHandle(n,r){switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}}component(n){const r=ss(),i=this.editor.getOnlySelectedShape(),s=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","select.translating","arrow.dragging")&&!this.editor.getIsReadonly(),o=ao(this.editor,n);if(!(o!=null&&o.isValid))return null;const l=Dm(this.editor,n),u=n.id===this.editor.getOnlySelectedShapeId(),f=this.editor.getEditingShapeId()===n.id||n.props.text;return p.jsxs(p.Fragment,{children:[p.jsx(Sl,{style:{minWidth:50,minHeight:50},children:p.jsx(oj,{shape:n,shouldDisplayHandles:s&&(i==null?void 0:i.id)===n.id})}),f&&p.jsx(JS,{shapeId:n.id,classNamePrefix:"tl-arrow",type:"arrow",font:n.props.font,fontSize:WC(n),lineHeight:Cr.lineHeight,align:"middle",verticalAlign:"middle",text:n.props.text,labelColor:r[n.props.labelColor].solid,textWidth:l.box.w-PE*2*n.props.scale,isSelected:u,padding:0,style:{transform:`translate(${l.box.center.x}px, ${l.box.center.y}px)`}})]})}indicator(n){const r=ES(n.id),i=As(n.id+"_clip"),s=ao(this.editor,n);if(!s)return null;const{start:o,end:l}=Vu(this.editor,n,s==null?void 0:s.bindings),u=this.editor.getShapeGeometry(n),d=u.bounds,f=n.props.text.trim()?u.children[1]:null;if(T.Equals(o,l))return null;const g=wr[n.props.size]*n.props.scale,m=s.start.arrowhead&&Uy(s,"start",g),S=s.end.arrowhead&&Uy(s,"end",g),b=s.isStraight?N$(s):D$(s),v=m&&s.start.arrowhead!=="arrow"||S&&s.end.arrowhead!=="arrow"||!!f;if(r&&f)return p.jsx("rect",{x:ne(f.x),y:ne(f.y),width:f.w,height:f.h,rx:3.5*n.props.scale,ry:3.5*n.props.scale});const w=!(s.start.arrowhead==="none"||s.start.arrowhead==="arrow"),C=!(s.end.arrowhead==="none"||s.end.arrowhead==="arrow");return p.jsxs("g",{children:[v&&p.jsx("defs",{children:p.jsx($$,{hasText:n.props.text.trim().length>0,bounds:d,labelBounds:f?f.getBounds():new xe(0,0,0,0),as:w&&m?m:"",ae:C&&S?S:""})}),p.jsxs("g",{style:{clipPath:v?`url(#${i})`:void 0,WebkitClipPath:v?`url(#${i})`:void 0},children:[v&&p.jsx("rect",{x:d.minX-100,y:d.minY-100,width:d.width+200,height:d.height+200,opacity:0}),p.jsx("path",{d:b})]}),m&&p.jsx("path",{d:m}),S&&p.jsx("path",{d:S}),f&&p.jsx("rect",{x:ne(f.x),y:ne(f.y),width:f.w,height:f.h,rx:3.5,ry:3.5})]})}onEditEnd(n){const{id:r,type:i,props:{text:s}}=n;s.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:s.trimEnd()}}])}toSvg(n,r){r.addExportDef(IE(n.props.fill)),n.props.text&&r.addExportDef(ZS(n.props.font));const i=Ca(r),s=1/n.props.scale;return p.jsxs("g",{transform:`scale(${s})`,children:[p.jsx(oj,{shape:n,shouldDisplayHandles:!1}),p.jsx(QS,{fontSize:WC(n),font:n.props.font,align:"middle",verticalAlign:"middle",text:n.props.text,labelColor:i[n.props.labelColor].solid,bounds:Dm(this.editor,n).box.clone().expandBy(-4.25*n.props.scale),padding:0})]})}getCanvasSvgDefs(){return[ME(),{key:"arrow:dot",component:nae},{key:"arrow:cross",component:rae}]}getInterpolatedProps(n,r,i){return{...i>.5?r.props:n.props,scale:ct(n.props.scale,r.props.scale,i),start:{x:ct(n.props.start.x,r.props.start.x,i),y:ct(n.props.start.y,r.props.start.y,i)},end:{x:ct(n.props.end.x,r.props.end.x,i),y:ct(n.props.end.y,r.props.end.y,i)},bend:ct(n.props.bend,r.props.bend,i),labelPosition:ct(n.props.labelPosition,r.props.labelPosition,i)}}}O(Lm,"type","arrow"),O(Lm,"props",o3),O(Lm,"migrations",a3);function z$(t,e){const n=ao(t,e);return n.isStraight?T.Dist(n.start.handle,n.end.handle):Math.abs(n.handleArc.length)}const oj=ir(function({shape:e,shouldDisplayHandles:n}){const r=re(),i=ss(),s=ao(r,e),o=xe.ZeroFix(r.getShapeGeometry(e).bounds),l=ei(r,e),u=oe("force solid",()=>r.getZoomLevel()<.2,[r]),d=As(e.id+"_clip"),f=As("arrowhead-dot"),g=As("arrowhead-cross");if(!(s!=null&&s.isValid))return null;const m=wr[e.props.size]*e.props.scale,S=s.start.arrowhead&&Uy(s,"start",m),b=s.end.arrowhead&&Uy(s,"end",m),v=s.isStraight?N$(s):D$(s);let w=null;if(n){const R=2/r.getZoomLevel(),{strokeDasharray:D,strokeDashoffset:L}=Ps(z$(r,e),R,{end:"skip",start:"skip",lengthRatio:2.5});w=l.start||l.end?p.jsx("path",{className:"tl-arrow-hint",d:s.isStraight?tae(s):eae(s),strokeDasharray:D,strokeDashoffset:L,strokeWidth:R,markerStart:l.start?l.start.props.isExact?"":l.start.props.isPrecise?`url(#${g})`:`url(#${f})`:"",markerEnd:l.end?l.end.props.isExact?"":l.end.props.isPrecise?`url(#${g})`:`url(#${f})`:"",opacity:.16}):null}const{strokeDasharray:C,strokeDashoffset:_}=Ps(s.isStraight?s.length:Math.abs(s.bodyArc.length),m,{style:e.props.dash,forceSolid:u}),M=Dm(r,e),I=!(s.start.arrowhead==="none"||s.start.arrowhead==="arrow"),A=!(s.end.arrowhead==="none"||s.end.arrowhead==="arrow");return p.jsxs(p.Fragment,{children:[p.jsx("defs",{children:p.jsx("clipPath",{id:d,children:p.jsx($$,{hasText:e.props.text.trim().length>0,bounds:o,labelBounds:M.box,as:I&&S?S:"",ae:A&&b?b:""})})}),p.jsxs("g",{fill:"none",stroke:i[e.props.color].solid,strokeWidth:m,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[w,p.jsxs("g",{style:{clipPath:`url(#${d})`,WebkitClipPath:`url(#${d})`},children:[p.jsx("rect",{x:ne(o.minX-100),y:ne(o.minY-100),width:ne(o.width+200),height:ne(o.height+200),opacity:0}),p.jsx("path",{d:v,strokeDasharray:C,strokeDashoffset:_})]}),S&&I&&e.props.fill!=="none"&&p.jsx(mr,{theme:i,d:S,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),b&&A&&e.props.fill!=="none"&&p.jsx(mr,{theme:i,d:b,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),S&&p.jsx("path",{d:S}),b&&p.jsx("path",{d:b})]})]})});function $$({hasText:t,bounds:e,labelBounds:n,as:r,ae:i}){const s=`M${ne(e.minX-100)},${ne(e.minY-100)} h${e.width+200} v${e.height+200} h-${e.width+200} Z`,o=`M${ne(n.minX)},${ne(n.minY)} v${n.height} h${n.width} v-${n.height} Z`;return p.jsx("path",{d:`${s}${t?o:""}${r}${i}`})}const aj=new WeakMap;function nae(){const t=As("arrowhead-dot");return p.jsx("marker",{id:t,className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:p.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function rae(){const t=As("arrowhead-cross");return p.jsxs("marker",{id:t,className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[p.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),p.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const lj="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function ud({url:t}){const e=re(),n=oe("zoomLevel",()=>e.getZoomLevel()<.32,[e]);return p.jsx("a",{className:je("tl-hyperlink-button",{"tl-hyperlink-button__hidden":n}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:_n,onPointerUp:_n,title:t,draggable:!1,children:p.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${lj}") center 100% / 100% no-repeat`,WebkitMask:`url("${lj}") center 100% / 100% no-repeat`}})})}const cj="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E",iae=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function Hy(t){return iae.map(n=>{const{offsetX:r,offsetY:i,blur:s,spread:o,color:l}=n,u=new T(r,i),{x:d,y:f}=u.rot(-t);return`${d}px ${f}px ${s}px ${o}px ${l}`}).join(", ")}const sae=300,B$=320,oae=46,aae=101;class Nm extends Id{canResize(){return!1}hideSelectionBoundsFg(){return!0}getText(e){return e.props.url}getDefaultProps(){return{url:"",w:sae,h:B$,assetId:null}}component(e){return p.jsx(lae,{shape:e,util:this})}indicator(e){return p.jsx("rect",{width:ne(e.props.w),height:ne(e.props.h),rx:"6",ry:"6"})}onBeforeCreate(e){return uj(this.editor,e)}onBeforeUpdate(e,n){if(e.props.url!==n.props.url)if(Ii.isValid(n.props.url))uae(this.editor,n);else return{...n,props:{...n.props,url:e.props.url}};if(e.props.assetId!==n.props.assetId)return uj(this.editor,n)}getInterpolatedProps(e,n,r){return{...r>.5?n.props:e.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r)}}}O(Nm,"type","bookmark"),O(Nm,"props",f3),O(Nm,"migrations",p3);function lae({shape:t,util:e}){const n=t.props.assetId?e.editor.getAsset(t.props.assetId):null,r=!!ap()&&Ft.isSafari,i=e.editor.getShapePageTransform(t).rotation(),s=cae(t),[o,l]=E.useState(!0),u=()=>l(!1);return p.jsx(ks,{children:p.jsxs("div",{className:je("tl-bookmark__container",r&&"tl-bookmark__container--safariExport"),style:{boxShadow:r?void 0:Hy(i),maxHeight:t.props.h},children:[(!n||n.props.image)&&p.jsxs("div",{className:"tl-bookmark__image_container",children:[n?p.jsx("img",{className:"tl-bookmark__image",draggable:!1,referrerPolicy:"strict-origin-when-cross-origin",src:n==null?void 0:n.props.image,alt:(n==null?void 0:n.props.title)||""}):p.jsx("div",{className:"tl-bookmark__placeholder"}),(n==null?void 0:n.props.image)&&p.jsx(ud,{url:t.props.url})]}),p.jsxs("div",{className:"tl-bookmark__copy_container",children:[n!=null&&n.props.title?p.jsx("h2",{className:"tl-bookmark__heading",children:Vse(n.props.title)}):null,n!=null&&n.props.description&&(n!=null&&n.props.image)?p.jsx("p",{className:"tl-bookmark__description",children:n.props.description}):null,p.jsxs("a",{className:"tl-bookmark__link",href:t.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:_n,onPointerUp:_n,onClick:_n,children:[o&&(n!=null&&n.props.favicon)?p.jsx("img",{className:"tl-bookmark__favicon",src:n==null?void 0:n.props.favicon,referrerPolicy:"strict-origin-when-cross-origin",onError:u,alt:`favicon of ${s}`}):p.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${cj}") center 100% / 100% no-repeat`,WebkitMask:`url("${cj}") center 100% / 100% no-repeat`}}),p.jsx("span",{children:s})]})]})]})})}function uj(t,e){const n=e.props.assetId?t.getAsset(e.props.assetId):null;let r=B$;return n&&(n.props.image||(n.props.title?r=aae:r=oae)),{...e,props:{...e.props,h:r}}}const cae=t=>{try{return new URL(t.props.url).hostname.replace(/^www\./,"")}catch{return t.props.url}};function uae(t,e){const{url:n}=e.props,r=yl.createId(I_(n));t.getAsset(r)?e.props.assetId!==r&&t.updateShapes([{id:e.id,type:e.type,props:{assetId:r}}]):(t.updateShapes([{id:e.id,type:e.type,props:{assetId:null}}]),dae(t,e))}const dae=P_(async(t,e)=>{if(t.isDisposed)return;const{url:n}=e.props,r=await t.getAssetForExternalContent({type:"url",url:n});r&&t.run(()=>{t.createAssets([r]),t.updateShapes([{id:e.id,type:e.type,props:{assetId:r.id}}])})},500);function kc(t,e=!1){const n=t.length;if(n<2)return"";let r=t[0].point,i=t[1].point;if(n===2)return`M${mt(r)}L${mt(i)}`;let s="";for(let o=2,l=n-1;o<l;o++)r=t[o].point,i=t[o+1].point,s+=Jr(r,i);return e?`M${Jr(t[0].point,t[1].point)}Q${mt(t[1].point)}${Jr(t[1].point,t[2].point)}T${s}${Jr(t[n-1].point,t[0].point)}${Jr(t[0].point,t[1].point)}Z`:`M${mt(t[0].point)}Q${mt(t[1].point)}${Jr(t[1].point,t[2].point)}${t.length>3?"T":""}${s}L${mt(t[n-1].point)}`}function hae(t,e={}){const{start:n={},end:r={}}=e,{cap:i=!0}=n,{cap:s=!0}=r;xt(!n.taper&&!r.taper,"cap taper not supported here"),xt(!n.easing&&!r.easing,"cap easing not supported here"),xt(i&&s,"cap must be true");const o=bo(t,e);WS(o,e);const l=fae(o);let u="";for(const d of l)u+=gae(d,e);return u}function fae(t){if(t.length<=2)return[t];const e=[];let n=[t[0]],r=T.Sub(t[1].point,t[0].point).uni(),i,s,o,l,u;for(let d=1,f=t.length;d<f-1;d++){if(o=t[d-1],l=t[d],u=t[d+1],i=T.Sub(u.point,l.point).uni(),s=T.Dpr(r,i),r=i,s<-.8){const g={...l,point:l.input};n.push(g),e.push(g1(n)),n=[g];continue}if(n.push(l),!(s>.7)&&(T.Dist2(o.point,l.point)+T.Dist2(l.point,u.point))/((o.radius+l.radius+u.radius)/3)**2<1.5){n.push(l),e.push(g1(n)),n=[l];continue}}return n.push(t[t.length-1]),e.push(g1(n)),e}function g1(t){const e=t[0];let n;for(;t.length>2&&(n=t[1],T.Dist2(e.point,n.point)<((e.radius+n.radius)/2*.5)**2);)t.splice(1,1);const r=t[t.length-1];let i;for(;t.length>2&&(i=t[t.length-2],T.Dist2(r.point,i.point)<((r.radius+i.radius)/2*.5)**2);)t.splice(t.length-2,1);return t.length>1&&(t[0]={...t[0],vector:T.Sub(t[0].point,t[1].point).uni()},t[t.length-1]={...t[t.length-1],vector:T.Sub(t[t.length-2].point,t[t.length-1].point).uni()}),t}function pae(t,e,n){return"M "+t+" "+e+" m -"+n+", 0 a "+n+","+n+" 0 1,1 "+n*2+",0 a "+n+","+n+" 0 1,1 -"+n*2+",0"}function gae(t,e={}){if(t.length===0)return"";if(t.length===1)return pae(t[0].point.x,t[0].point.y,t[0].radius);const{left:n,right:r}=y$(t,e);r.reverse();let i=`M${mt(n[0])}T`;for(let s=1;s<n.length;s++)i+=Jr(n[s-1],n[s]);{const s=t[t.length-1],o=s.radius,l=s.vector.clone().per().neg(),u=T.Add(s.point,T.Mul(l,o)),d=T.Add(s.point,T.Mul(l,-o));i+=`${mt(u)}A${ne(o)},${ne(o)} 0 0 1 ${mt(d)}T`}for(let s=1;s<r.length;s++)i+=Jr(r[s-1],r[s]);{const s=t[0],o=s.radius,l=s.vector.clone().per(),u=T.Add(s.point,T.Mul(l,o)),d=T.Add(s.point,T.Mul(l,-o));i+=`${mt(u)}A${ne(o)},${ne(o)} 0 0 1 ${mt(d)}Z`}return i}const F$=(t,e,n)=>{const r=[],i=[];t.forEach(d=>r.push(...d.points)),e.forEach(d=>i.push(...d.points));const s=Math.max(r.length,i.length),o=[],l=[];for(let d=0;d<s;d++)o.push(r[d]||r[r.length-1]),l.push(i[d]||i[i.length-1]);return[{type:"free",points:o.map((d,f)=>{let g=.5;return l[f].z!==void 0&&d.z!==void 0&&(g=ct(d.z,l[f].z,n)),{x:ct(d.x,l[f].x,n),y:ct(d.y,l[f].y,n),z:g}})}]},mae=t=>t*.65+cG(t*yt/2)*.35,yae=t=>({size:t,thinning:.5,streamline:sd(t,[9,16],[.64,.74],!0),smoothing:.62,easing:Kn.easeOutSine,simulatePressure:!0}),Sae=t=>({size:1+t*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:mae}),dj=t=>({size:t,thinning:0,streamline:sd(t,[9,16],[.64,.74],!0),smoothing:.62,simulatePressure:!1,easing:Kn.linear}),vae=t=>({size:t,thinning:0,streamline:.62,smoothing:.62,simulatePressure:!1,easing:Kn.linear});function RE({strokeWidth:t,showAsComplete:e}){return{size:1+t,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:Kn.easeOutSine,last:e}}function XC(t,e,n,r){const i=t.isComplete||n;return r?t.isPen?{...vae(e),last:i}:{...dj(e),last:i}:t.dash==="draw"?t.isPen?{...Sae(e),last:i}:{...yae(e),last:i}:{...dj(e),last:i}}function dd(t){const e=[];for(const n of t)if(n.type==="free"||n.points.length<2)e.push(...n.points.map(T.Cast));else{const r=Math.max(4,Math.floor(T.Dist(n.points[0],n.points[1])/16));e.push(...T.PointsBetween(n.points[0],n.points[1],r))}return e}function bae(t,e,n){return{draw:"none",solid:"none",dotted:`${n} ${e*2}`,dashed:`${e*2} ${e*2}`}[t.props.dash]}class zm extends si{constructor(){super(...arguments);O(this,"options",{maxPointsPerShape:600})}hideResizeHandles(n){return m1(n)}hideRotateHandle(n){return m1(n)}hideSelectionBoundsFg(n){return m1(n)}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1,scale:1}}getGeometry(n){const r=dd(n.props.segments),i=(wr[n.props.size]+1)*n.props.scale;if(n.props.segments.length===1){const o=xe.FromPoints(r);if(o.width<i*2&&o.height<i*2)return new j2({x:-i,y:-i,radius:i,isFilled:!0})}const s=bo(r,XC(n.props,i,n.props.isPen,!0)).map(o=>o.point);return n.props.isClosed?new bn({points:s,isFilled:n.props.fill!=="none"}):new _d({points:s})}component(n){return p.jsx(Sl,{children:p.jsx(hj,{shape:n})})}indicator(n){var f;const r=dd(n.props.segments);let i=(wr[n.props.size]+1)*n.props.scale;!oe("force solid",()=>{const g=this.editor.getZoomLevel();return g<.5&&g<1.5/i},[this.editor,i])&&!n.props.isPen&&n.props.dash==="draw"&&r.length===1&&(i+=Ds(n.id)()*(i/6));const o=n.props.isComplete||((f=Qn(n.props.segments))==null?void 0:f.type)==="straight",l=XC(n.props,i,o,!0),u=bo(r,l),d=u.length>1?kc(u,n.props.isClosed):U$(r[0],i);return p.jsx("path",{d})}toSvg(n,r){r.addExportDef(IE(n.props.fill));const i=1/n.props.scale;return p.jsx("g",{transform:`scale(${i})`,children:p.jsx(hj,{shape:n,zoomOverride:1})})}getCanvasSvgDefs(){return[ME()]}onResize(n,r){const{scaleX:i,scaleY:s}=r,o=[];for(const l of n.props.segments)o.push({...l,points:l.points.map(({x:u,y:d,z:f})=>({x:la(i*u),y:la(s*d),z:f}))});return{props:{segments:o}}}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return wr[n.props.size]*r/2*n.props.scale}getInterpolatedProps(n,r,i){return{...i>.5?r.props:n.props,segments:F$(n.props.segments,r.props.segments,i),scale:ct(n.props.scale,r.props.scale,i)}}}O(zm,"type","draw"),O(zm,"props",m3),O(zm,"migrations",y3);function U$(t,e){const n=(e+1)*.5;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function m1(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function hj({shape:t,zoomOverride:e}){var S;const n=ss(),r=re(),i=dd(t.props.segments),s=t.props.isComplete||((S=Qn(t.props.segments))==null?void 0:S.type)==="straight";let o=(wr[t.props.size]+1)*t.props.scale;const l=oe("force solid",()=>{const b=e??r.getZoomLevel();return b<.5&&b<1.5/o},[r,o,e]),u=oe("dot adjustment",()=>(e??r.getZoomLevel())<.2?0:.1,[r,e]);!l&&!t.props.isPen&&t.props.dash==="draw"&&i.length===1&&(o+=Ds(t.id)()*(o/6));const d=XC(t.props,o,s,l);if(!l&&t.props.dash==="draw")return p.jsxs(p.Fragment,{children:[t.props.isClosed&&t.props.fill&&i.length>1?p.jsx(mr,{d:kc(bo(i,d),t.props.isClosed),theme:n,color:t.props.color,fill:t.props.isClosed?t.props.fill:"none",scale:t.props.scale}):null,p.jsx("path",{d:hae(i,d),strokeLinecap:"round",fill:n[t.props.color].solid})]});const f=bo(i,d),g=f.length<2,m=g?U$(i[0],0):kc(f,t.props.isClosed);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{d:m,theme:n,color:t.props.color,fill:g||t.props.isClosed?t.props.fill:"none",scale:t.props.scale}),p.jsx("path",{d:m,strokeLinecap:"round",fill:g?n[t.props.color].solid:"none",stroke:n[t.props.color].solid,strokeWidth:o,strokeDasharray:g?"none":bae(t,o,u),strokeDashoffset:"0"})]})}function xae(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function wae(t,e){const n=Ge(e);if(!n)return;const r=n.host.replace("www.","");for(const i of t)if(H$(i.hostnames,r)){const s=i.fromEmbedUrl(e);if(s)return{definition:i,url:s,embedUrl:e}}}const Cae=t=>t.split("*").map(e=>xae(e)).join(".+"),H$=(t,e)=>!!t.find(n=>{const r=new RegExp(Cae(n));return e.match(r)});function _ae(t,e){const n=Ge(e);if(!n)return;const r=n.host.replace("www.","");for(const i of t)if(H$(i.hostnames,r)){const s=i.toEmbedUrl(e);if(s)return{definition:i,embedUrl:s,url:e}}}function Eae(t,e){try{return _ae(t,e)??wae(t,e)}catch{return}}const Pae=t=>Object.entries(t).filter(([e,n])=>n).map(([e])=>e).join(" "),aa=class aa extends Id{static setEmbedDefinitions(e){aa.embedDefinitions=e}getEmbedDefinitions(){return aa.embedDefinitions}getEmbedDefinition(e){return Eae(aa.embedDefinitions,e)}getText(e){return e.props.url}hideSelectionBoundsFg(e){return!this.canResize(e)}canEdit(){return!0}canResize(e){var n,r;return!!((r=(n=this.getEmbedDefinition(e.props.url))==null?void 0:n.definition)!=null&&r.doesResize)}canEditInReadOnly(){return!0}getDefaultProps(){return{w:300,h:300,url:""}}isAspectRatioLocked(e){const n=this.getEmbedDefinition(e.props.url);return(n==null?void 0:n.definition.isAspectRatioLocked)??!1}onResize(e,n){const r=this.isAspectRatioLocked(e),i=this.getEmbedDefinition(e.props.url);let s=(i==null?void 0:i.definition.minWidth)??200,o=(i==null?void 0:i.definition.minHeight)??200;if(r){const l=e.props.w/e.props.h;l>1?s*=l:o/=l}return Nc(e,n,{minWidth:s,minHeight:o})}component(e){const n=ap(),{w:r,h:i,url:s}=e.props,o=ES(e.id),l=this.getEmbedDefinition(s),u=oe("is hovering",()=>{const{editingShapeId:S,hoveredShapeId:b}=this.editor.getCurrentPageState();if(S&&b!==S){const v=this.editor.getShape(S);if(v&&this.editor.isShapeOfType(v,"embed"))return!0}return!1},[]),d=this.editor.getShapePageTransform(e).rotation();if(n)return p.jsx(ks,{className:"tl-embed-container",id:e.id,children:p.jsx("div",{className:"tl-embed",style:{border:0,boxShadow:Hy(d),borderRadius:(l==null?void 0:l.definition.overrideOutlineRadius)??8,background:(l==null?void 0:l.definition.backgroundColor)??"var(--color-background)",width:r,height:i}})});const f=o||u;if(typeof window<"u"&&(window!==window.top||window.self!==window.parent)&&(l==null?void 0:l.definition.type)==="tldraw")return null;if((l==null?void 0:l.definition.type)==="github_gist"){const S=l.url.split("/").pop();if(!S)throw Error("No gist id!");return p.jsx(ks,{className:"tl-embed-container",id:e.id,children:p.jsx(Tae,{id:S,width:ne(r),height:ne(i),isInteractive:f,pageRotation:d})})}const m=Pae({...$re,...(l==null?void 0:l.definition.overridePermissions)??{}});return p.jsx(ks,{className:"tl-embed-container",id:e.id,children:l!=null&&l.definition?p.jsx("iframe",{className:"tl-embed",sandbox:m,src:l.embedUrl,width:ne(r),height:ne(i),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:f?"auto":"none",zIndex:f?"":"-1",boxShadow:Hy(d),borderRadius:(l==null?void 0:l.definition.overrideOutlineRadius)??8,background:l==null?void 0:l.definition.backgroundColor}}):null})}indicator(e){const n=this.getEmbedDefinition(e.props.url);return p.jsx("rect",{width:ne(e.props.w),height:ne(e.props.h),rx:(n==null?void 0:n.definition.overrideOutlineRadius)??8,ry:(n==null?void 0:n.definition.overrideOutlineRadius)??8})}getInterpolatedProps(e,n,r){return{...r>.5?n.props:e.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r)}}};O(aa,"type","embed"),O(aa,"props",S3),O(aa,"migrations",v3),O(aa,"embedDefinitions",mE);let Ky=aa;function Tae({id:t,isInteractive:e,width:n,height:r,style:i,pageRotation:s}){if(!t.match(/^[0-9a-f]+$/))throw Error("No gist id!");return p.jsx("iframe",{className:"tl-embed",draggable:!1,width:ne(n),height:ne(r),frameBorder:"0",scrolling:"no",referrerPolicy:"no-referrer-when-downgrade",style:{...i,pointerEvents:e?"all":"none",zIndex:e?"":"-1",boxShadow:Hy(s)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${t}.js`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}function ZC(t,e){const i=((yc(t.getShapePageTransform(e.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4;return Math.floor(i)}const fj=new WeakMap;function pj(t,e,n){let r=fj.get(e.props);if(!r){const i=OE(e.props.name,"Frame")+"",s=t.textMeasure.measureTextSpans(i,n),o=s[0],l=Qn(s);r=l.box.w+l.box.x-o.box.x,fj.set(e.props,r)}return new xe(0,-n.height,r,n.height)}function gj(t,e){return{fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:t.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle",fill:e,offsetY:-34,offsetX:2}}function K$(t,e,n){const r=n?"":"px",i=n?"":"deg";let s;switch(e){case 0:s="";break;case 3:s=`translate(${ne(t.props.w)}${r}, 0${r}) rotate(90${i})`;break;case 2:s=`translate(${ne(t.props.w)}${r}, ${ne(t.props.h)}${r}) rotate(180${i})`;break;case 1:s=`translate(0${r}, ${ne(t.props.h)}${r}) rotate(270${i})`;break;default:throw Error("labelSide out of bounds")}return s}const Iae=E.forwardRef(({id:t,name:e,isEditing:n},r)=>{const i=re(),s=E.useCallback(u=>{u.key==="Enter"&&!u.nativeEvent.isComposing&&(_n(u),u.currentTarget.blur(),i.setEditingShape(null))},[i]),o=E.useCallback(u=>{const d=i.getShape(t);if(!d)return;const f=d.props.name,g=u.currentTarget.value.trim();f!==g&&i.updateShapes([{id:t,type:"frame",props:{name:g}}])},[t,i]),l=E.useCallback(u=>{const d=i.getShape(t);if(!d)return;const f=d.props.name,g=u.currentTarget.value;f!==g&&i.updateShapes([{id:t,type:"frame",props:{name:g}}])},[t,i]);return p.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[p.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:e,autoFocus:!0,onKeyDown:s,onBlur:o,onChange:l}),OE(e,"Frame")+""]})}),Mae=E.memo(function({id:e,name:n,width:r,height:i}){const s=re(),{side:o,translation:l}=oe("shape rotation",()=>{const f=s.getShape(e);if(!f)return{side:0,translation:"translate(0, 0)"};const g=ZC(s,f);return{side:g,translation:K$(f,g,!1)}},[s,e]),u=E.useRef(null),d=ES(e);return E.useEffect(()=>{const f=u.current;f&&d&&(f.focus(),f.select())},[u,d]),p.jsx("div",{className:"tl-frame-heading",style:{overflow:d?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(o===0||o===2?r:i)}px + var(--space-5))`,bottom:"100%",transform:`${l} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},children:p.jsx("div",{className:"tl-frame-heading-hit-area",children:p.jsx(Iae,{ref:u,id:e,name:n,isEditing:d})})})});function OE(t,e){return t.match(/^\s*$/)?e:t}class $m extends Id{canEdit(){return!0}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(e){const{editor:n}=this,r=n.getZoomLevel(),i=gj(e,"black"),s=pj(n,e,i),o=ZC(n,e);let l,u,d,f;const{w:g,h:m}=s,S=Math.min(g,e.props.w*r),b=Math.min(m,e.props.h*r);switch(o){case 0:{l=-8/r,u=(-m-4)/r,d=(S+16)/r,f=m/r;break}case 1:{l=(-m-4)/r,f=(b+16)/r,u=e.props.h-f+8/r,d=m/r;break}case 2:{l=e.props.w-(S+8)/r,u=e.props.h+4/r,d=(b+16)/r,f=m/r;break}case 3:{l=e.props.w+4/r,f=(b+16)/r,u=-8/r,d=m/r;break}}return new ns({children:[new Rr({width:e.props.w,height:e.props.h,isFilled:!1}),new Rr({x:l,y:u,width:d,height:f,isFilled:!0,isLabel:!0})]})}getText(e){return e.props.name}component(e){const n=ss(),r=oe("is creating this shape",()=>{const i=this.editor.getStateDescendant("select.resizing");if(!i||!i.getIsActive())return!1;const s=i==null?void 0:i.info;return s?s.isCreating&&this.editor.getOnlySelectedShapeId()===e.id:!1},[e.id]);return p.jsxs(p.Fragment,{children:[p.jsx(Sl,{children:p.jsx("rect",{className:je("tl-frame__body",{"tl-frame__creating":r}),width:e.props.w,height:e.props.h,fill:n.solid,stroke:n.text})}),r?null:p.jsx(Mae,{id:e.id,name:e.props.name,width:e.props.w,height:e.props.h})]})}toSvg(e,n){const r=Ca({isDarkMode:n.isDarkMode}),i=ZC(this.editor,e),s=K$(e,i,!0),o=gj(e,r.text),l=OE(e.props.name,"Frame")+"",u=pj(this.editor,e,o),d=this.editor.textMeasure.measureTextSpans(l,o),f=VC(this.editor,d,o);return p.jsxs(p.Fragment,{children:[p.jsx("rect",{width:e.props.w,height:e.props.h,fill:r.solid,stroke:r.black.solid,strokeWidth:1,rx:1,ry:1}),p.jsxs("g",{transform:s,children:[p.jsx("rect",{x:u.x-8,y:u.y-4,width:u.width+20,height:u.height,fill:r.background,rx:4,ry:4}),f]})]})}indicator(e){return p.jsx("rect",{width:ne(e.props.w),height:ne(e.props.h),className:"tl-frame-indicator"})}canReceiveNewChildrenOfType(e,n){return!e.isLocked}providesBackgroundForChildren(){return!0}canDropShapes(e,n){return!e.isLocked}onDragShapesOver(e,n){n.every(r=>r.parentId===e.id)||this.editor.reparentShapes(n,e.id)}onDragShapesOut(e,n){const r=this.editor.getShape(e.parentId);r&&this.editor.isShapeOfType(r,"group")?this.editor.reparentShapes(n,r.id):this.editor.reparentShapes(n,this.editor.getCurrentPageId())}onResize(e,n){return Nc(e,n)}getInterpolatedProps(e,n,r){return{...r>.5?n.props:e.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r)}}}O($m,"type","frame"),O($m,"props",b3),O($m,"migrations",x3);function mj(t,e){return t>e?(yt*(e/2)+(t-e))*2:(yt*(t/2)+(e-t))*2}function G$(t,e){return jE(t,e).map((n,r)=>n.getSvgPathData(r===0)).join(" ")+" Z"}function Aae(t,e,n,r){const i=t/4,s=e/4,o=Ds(r),l=n*.75,u=_=>_.addXY(o()*l,o()*l),d=new T(t/2,e),f=new T(0,s*1.2),g=new T(t/2,s*.9),m=new T(t,s*1.2),S=u(new T(t/2,e)),b=u(new T(0,s*1.2)),v=u(new T(t/2,s*.9)),w=u(new T(t,s*1.2));return[new Sr({start:d,cp1:new T(i*1.5,s*3),cp2:new T(0,s*2.5),end:f}),new Sr({start:f,cp1:new T(0,-s*.32),cp2:new T(i*1.85,-s*.32),end:g}),new Sr({start:g,cp1:new T(i*2.15,-s*.32),cp2:new T(t,-s*.32),end:m}),new Sr({start:m,cp1:new T(t,s*2.5),cp2:new T(i*2.5,s*3),end:S}),new Sr({start:S,cp1:new T(i*1.5,s*3),cp2:new T(0,s*2.5),end:b}),new Sr({start:b,cp1:new T(0,-s*.32),cp2:new T(i*1.85,-s*.32),end:v}),new Sr({start:v,cp1:new T(i*2.15,-s*.32),cp2:new T(t,-s*.32),end:w}),new Sr({start:w,cp1:new T(t,s*2.5),cp2:new T(i*2.5,s*3),end:d})].map((_,M)=>_.getSvgPathData(M===0)).join(" ")+" Z"}function jE(t,e){const n=t/4,r=e/4;return[new Sr({start:new T(t/2,e),cp1:new T(n*1.5,r*3),cp2:new T(0,r*2.5),end:new T(0,r*1.2)}),new Sr({start:new T(0,r*1.2),cp1:new T(0,-r*.32),cp2:new T(n*1.85,-r*.32),end:new T(t/2,r*.9)}),new Sr({start:new T(t/2,r*.9),cp1:new T(n*2.15,-r*.32),cp2:new T(t,-r*.32),end:new T(t,r*1.2)}),new Sr({start:new T(t,r*1.2),cp1:new T(t,r*2.5),cp2:new T(n*2.5,r*3),end:new T(t/2,e)})]}function kae(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function Rae(t,e,n,r){const i=Ds(t),s=e/2,o=n/2,l=$5(s,o),u=[],d=It*i(),f=It+Yt/2+Math.abs(i())*Yt,g=Math.max(16,l/10);for(let m=0;m<g;m++){const S=m/(g-1),b=d+S*f,v=Math.cos(b),w=Math.sin(b);u.push(new T(s*v+e*.5+.05*i(),o*w+n/2+.05*i(),Math.min(1,.5+Math.abs(.5-(i()>0?Kn.easeInOutSine(S):Kn.easeInExpo(S)))/2)))}return bo(u,kae(r))}function Oae(t,e,n,r){return kc(Rae(t,e,n,r))}function QC(t){let e="M";const n=t.length;let r,i,s;for(let o=0,l=n;o<l;o+=3)r=t[o],i=t[o+1],s=t[o+2],e+=`${mt(r)}L${mt(i)}Q${mt(s)}`;return e+=`${mt(t[0])}`,e}function JC(t,e,n,r,i){const s=[],o=Ds(t);let l=e[0],u;const d=e.length;for(let f=0,g=d*i;f<g;f++){u=T.AddXY(e[(f+1)%d],o()*n,o()*n);const m=T.Sub(u,l),S=T.Len(m),b=T.Div(m,S).mul(Math.min(S/4,r));s.push(T.Add(l,b),T.Add(u,b.neg()),u),l=u}return s}function jae(t,e,n){const r=Math.min(t,e)/2,i=Math.max(t,e)-r*2,o=(Math.PI*(r*2)+2*i)/n,l=t>e?[{type:"straight",start:new T(r,0),delta:new T(1,0)},{type:"arc",center:new T(t-r,r),startAngle:-yt/2},{type:"straight",start:new T(t-r,e),delta:new T(-1,0)},{type:"arc",center:new T(r,r),startAngle:yt/2}]:[{type:"straight",start:new T(t,r),delta:new T(0,1)},{type:"arc",center:new T(r,e-r),startAngle:0},{type:"straight",start:new T(0,e-r),delta:new T(0,-1)},{type:"arc",center:new T(r,r),startAngle:yt}];let u=0;const d=[];for(let f=0;f<n;f++){const g=l[0];g.type==="straight"?d.push(T.Add(g.start,T.Mul(g.delta,u))):d.push(bc(g.center,r,g.startAngle+u/r)),u+=o;let m=g.type==="straight"?i:yt*r;for(;u>m;)u-=m,l.push(l.shift()),m=l[0].type==="straight"?i:yt*r}return d}const Dae={s:50,m:70,l:100,xl:130},Lae=.2;function ev(t,e,n,r,i){const s=Ds(n),o=mj(t,e),l=Math.max(Math.ceil(o/Dae[r]),6,Math.ceil(o/Math.min(t,e))),u=o/l*Lae,d=Math.max(t-u*2,1),f=Math.max(e-u*2,1),m=mj(d,f)/l,S=(t-d)/2,b=(e-f)/2,v=jae(d,f,l).map(I=>I.addXY(S,b)),w=t<20?0:u*.3,C=e<20?0:u*.3,_=v.slice(0);for(let I=0;I<Math.floor(l/2);I++)_[I]=T.AddXY(_[I],s()*w*i,s()*C*i),_[l-I-1]=T.AddXY(_[l-I-1],s()*w*i,s()*C*i);const M=[];for(let I=0;I<_.length;I++){const A=I===_.length-1?0:I+1,R=_[I],D=_[A],L=v[I],G=v[A],k=T.Dist(L,G),$=m-k,N=T.Dist(R,D)/k,B=(Math.max(S,b)+$)*N,Y=T.Lrp(L,G,.5).add(T.Sub(G,L).uni().per().mul(B));Y.x<0?Y.x=0:Y.x>t&&(Y.x=t),Y.y<0?Y.y=0:Y.y>e&&(Y.y=e);const K=W_(R,D,Y),V=T.Dist(K||T.Average([R,D]),R);M.push({leftPoint:R,rightPoint:D,arcPoint:Y,center:K,radius:V})}return M}function Nae(t,e,n,r,i){const s=[],o=ev(t,e,n,r,i);for(const{center:l,radius:u,leftPoint:d,rightPoint:f}of o)s.push(...fG(d,f,l,u,10));return s}function e_(t,e,n,r,i){const s=ev(t,e,n,r,i);let o=`M${s[0].leftPoint.toFixed()}`;for(const{leftPoint:l,rightPoint:u,radius:d,center:f}of s){if(f===null){o+=` L${u.toFixed()}`;continue}const g=T.Clockwise(l,u,f)?"0":"1";o+=` A${ne(d)},${ne(d)} 0 ${g},1 ${u.toFixed()}`}return o+=" Z",o}const zae={s:.5,m:.7,l:.9,xl:1.6};function $ae(t,e,n,r,i){const s=Ds(n),o=zae[r]*i,l=ev(t,e,n,r,i),f=l.reduce((b,v)=>b+T.Dist2(v.leftPoint,v.rightPoint),0)/l.length>(o*15)**2?b=>T.AddXY(b,s()*o*2,s()*o*2):b=>b;let g=`M${l[0].leftPoint.toFixed()}`,m=f(l[0].leftPoint),S=`M${m.toFixed()}`;for(const{leftPoint:b,center:v,rightPoint:w,radius:C,arcPoint:_}of l){if(v===null){g+=` L${w.toFixed()}`;const L=f(w);S+=` L${L.toFixed()}`,m=L;continue}const M=T.Clockwise(b,w,v)?"0":"1";g+=` A${ne(C)},${ne(C)} 0 ${M},1 ${w.toFixed()}`;const I=f(w),A=f(_),R=W_(m,I,A);if(!R){S+=` L${I.toFixed()}`,m=I;continue}const D=Math.abs(T.Dist(R,m));S+=` A${ne(D)},${ne(D)} 0 ${M},1 ${I.toFixed()}`,m=I}return g+S+" Z"}function t_(t,e){switch(t.geo){case"x-box":return Bae(t.w,t.h,e,t.dash);case"check-box":return Fae(t.w,t.h);default:return}}function Bae(t,e,n,r){const i=r==="draw"?.62:0;if(r==="dashed")return[[new T(0,0),new T(t/2,e/2)],[new T(t,e),new T(t/2,e/2)],[new T(0,e),new T(t/2,e/2)],[new T(t,0),new T(t/2,e/2)]];const s=l=>Math.max(0,Math.min(t,l)),o=l=>Math.max(0,Math.min(e,l));return[[new T(s(n*i),o(n*i)),new T(s(t-n*i),o(e-n*i))],[new T(s(n*i),o(e-n*i)),new T(s(t-n*i),o(n*i))]]}function Fae(t,e){const n=Math.min(t,e)*.82,r=(t-n)/2,i=(e-n)/2,s=l=>Math.max(0,Math.min(t,l)),o=l=>Math.max(0,Math.min(e,l));return[[new T(s(r+n*.25),o(i+n*.52)),new T(s(r+n*.45),o(i+n*.82))],[new T(s(r+n*.45),o(i+n*.82)),new T(s(r+n*.82),o(i+n*.22))]]}function yj({shape:t,shouldScale:e,forceSolid:n}){const r=e?t.props.scale:1,i=re(),s=ss(),{id:o,props:l}=t,{w:u,color:d,fill:f,dash:g,growY:m,size:S,scale:b}=l,v=wr[S]*r,w=l.h+m;switch(l.geo){case"cloud":if(g==="solid"){const C=e_(u,w,o,S,b);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:C,color:d,fill:f,scale:r}),p.jsx("path",{d:C,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}else if(g==="draw"){const C=$ae(u,w,o,S,b);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:C,color:d,fill:f,scale:r}),p.jsx("path",{d:C,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}else{const C=e_(u,w,o,S,b),_=ev(u,w,o,S,b);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:C,color:d,fill:f,scale:r}),p.jsx("g",{strokeWidth:v,stroke:s[d].solid,fill:"none",pointerEvents:"all",children:_.map(({leftPoint:M,rightPoint:I,center:A,radius:R},D)=>{const L=A?R*yc(yc(T.Angle(A,I))-yc(T.Angle(A,M))):T.Dist(M,I),{strokeDasharray:G,strokeDashoffset:k}=Ps(L,v,{style:g,start:"outset",end:"outset",forceSolid:n});return p.jsx("path",{d:A?`M${M.x},${M.y}A${R},${R},0,0,1,${I.x},${I.y}`:`M${M.x},${M.y}L${I.x},${I.y}`,strokeDasharray:G,strokeDashoffset:k},D)})})]})}case"ellipse":{const C=e?i.getShapeGeometry(t):i.getShapeUtil(t).getGeometry(t),_=C.getSvgPathData(!0);if(g==="dashed"||g==="dotted"){const M=C.length,{strokeDasharray:I,strokeDashoffset:A}=Ps(M<64?M*2:M,v,{style:g,snap:4,closed:!0,forceSolid:n});return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:_,color:d,fill:f,scale:r}),p.jsx("path",{d:_,strokeWidth:v,fill:"none",stroke:s[d].solid,strokeDasharray:I,strokeDashoffset:A})]})}else{const I=(e?i.getShapeGeometry(t):i.getShapeUtil(t).getGeometry(t)).getSvgPathData(!0);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:I,color:d,fill:f,scale:r}),p.jsx("path",{d:I,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}}case"oval":{const C=e?i.getShapeGeometry(t):i.getShapeUtil(t).getGeometry(t),_=C.getSvgPathData(!0);if(g==="dashed"||g==="dotted"){const M=C.getLength(),{strokeDasharray:I,strokeDashoffset:A}=Ps(M<64?M*2:M,v,{style:g,snap:4,start:"outset",end:"outset",closed:!0,forceSolid:n});return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:_,color:d,fill:f,scale:r}),p.jsx("path",{d:_,strokeWidth:v,fill:"none",stroke:s[d].solid,strokeDasharray:I,strokeDashoffset:A})]})}else return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:_,color:d,fill:f,scale:r}),p.jsx("path",{d:_,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}case"heart":if(g==="dashed"||g==="dotted"||g==="solid"){const C=G$(u,w),_=jE(u,w);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:C,color:d,fill:f,scale:r}),_.map((M,I)=>{const{strokeDasharray:A,strokeDashoffset:R}=Ps(M.length,v,{style:g,snap:1,start:"outset",end:"outset",closed:!0,forceSolid:n});return p.jsx("path",{d:M.getSvgPathData(),strokeWidth:v,fill:"none",stroke:s[d].solid,strokeDasharray:A,strokeDashoffset:R,pointerEvents:"all"},`curve_${I}`)})]})}else{const C=Aae(u,w,v,t.id);return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:C,color:d,fill:f,scale:r}),p.jsx("path",{d:C,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}default:{const C=e?i.getShapeGeometry(t):i.getShapeUtil(t).getGeometry(t),_=C instanceof ns?C.children[0].vertices:C.vertices,M=t_(t.props,v);if(g==="solid"){let I="M"+_[0]+"L"+_.slice(1)+"Z";if(M)for(const[A,R]of M)I+=`M${A.x},${A.y}L${R.x},${R.y}`;return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:I,color:d,fill:f,scale:r}),p.jsx("path",{d:I,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}else if(g==="dashed"||g==="dotted"){const I="M"+_[0]+"L"+_.slice(1)+"Z";return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:I,color:d,fill:f,scale:r}),p.jsxs("g",{strokeWidth:v,stroke:s[d].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(_.length)).map((A,R)=>{const D=T.ToFixed(_[R]),L=T.ToFixed(_[(R+1)%_.length]),G=T.Dist(D,L),{strokeDasharray:k,strokeDashoffset:$}=Ps(G,v,{style:g,start:"outset",end:"outset",forceSolid:n});return p.jsx("line",{x1:D.x,y1:D.y,x2:L.x,y2:L.y,strokeDasharray:k,strokeDashoffset:$},R)}),M&&M.map(([A,R],D)=>{const L=T.Dist(A,R),{strokeDasharray:G,strokeDashoffset:k}=Ps(L,v,{style:g,start:"skip",end:"skip",snap:g==="dotted"?4:void 0,forceSolid:n});return p.jsx("path",{d:`M${A.x},${A.y}L${R.x},${R.y}`,stroke:s[d].solid,strokeWidth:v,fill:"none",strokeDasharray:G,strokeDashoffset:k},`line_fg_${D}`)})]})]})}else if(g==="draw"){let I=QC(JC(o,_,v/3,v*2,2));if(M)for(const[R,D]of M)I+=`M${R.toFixed()}L${D.toFixed()}`;const A=QC(JC(o,_,0,v*2,1));return p.jsxs(p.Fragment,{children:[p.jsx(mr,{theme:s,d:A,color:d,fill:f,scale:r}),p.jsx("path",{d:I,stroke:s[d].solid,strokeWidth:v,fill:"none"})]})}}}}const Sj=17*3;class Bm extends Id{canEdit(){return!0}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:"",scale:1}}getGeometry(e){const n=Math.max(1,e.props.w),r=Math.max(1,e.props.h+e.props.growY),i=n/2,s=r/2,o=e.props.fill!=="none";let l;switch(e.props.geo){case"cloud":{l=new bn({points:Nae(n,r,e.id,e.props.size,e.props.scale),isFilled:o});break}case"triangle":{l=new bn({points:[new T(i,0),new T(n,r),new T(0,r)],isFilled:o});break}case"diamond":{l=new bn({points:[new T(i,0),new T(n,s),new T(i,r),new T(0,s)],isFilled:o});break}case"pentagon":{l=new bn({points:Mw(n,r,5),isFilled:o});break}case"hexagon":{l=new bn({points:Mw(n,r,6),isFilled:o});break}case"octagon":{l=new bn({points:Mw(n,r,8),isFilled:o});break}case"ellipse":{l=new sJ({width:n,height:r,isFilled:o});break}case"oval":{l=new oJ({width:n,height:r,isFilled:o});break}case"star":{const _=It/5/2,M=Math.floor(5/4)*2,I=5*2-M,A=0,R=Math.floor(5/2)*2,D=Math.cos(-Yt+M*_)*n/2,L=Math.cos(-Yt+I*_)*n/2,G=Math.sin(-Yt+A*_)*r/2,k=Math.sin(-Yt+R*_)*r/2,$=n-Math.abs(D-L),F=r-Math.abs(k-G),N=n/2+L-(n/2-D),B=r/2+G-(r/2-k),Y=1,K=(n-N)/2,V=(r-B)/2,W=(n+$)/2,ee=(r+F)/2,H=W*Y/2,te=ee*Y/2;l=new bn({points:Array.from(Array(5*2)).map((ge,de)=>{const Se=-Yt+de*_;return new T(K+(de%2?H:W)*Math.cos(Se),V+(de%2?te:ee)*Math.sin(Se))}),isFilled:o});break}case"rhombus":{const C=Math.min(n*.38,r*.38);l=new bn({points:[new T(C,0),new T(n,0),new T(n-C,r),new T(0,r)],isFilled:o});break}case"rhombus-2":{const C=Math.min(n*.38,r*.38);l=new bn({points:[new T(0,0),new T(n-C,0),new T(n,r),new T(C,r)],isFilled:o});break}case"trapezoid":{const C=Math.min(n*.38,r*.38);l=new bn({points:[new T(C,0),new T(n-C,0),new T(n,r),new T(0,r)],isFilled:o});break}case"arrow-right":{const C=Math.min(n,r)*.38,_=r*.16;l=new bn({points:[new T(0,_),new T(n-C,_),new T(n-C,0),new T(n,r/2),new T(n-C,r),new T(n-C,r-_),new T(0,r-_)],isFilled:o});break}case"arrow-left":{const C=Math.min(n,r)*.38,_=r*.16;l=new bn({points:[new T(C,0),new T(C,_),new T(n,_),new T(n,r-_),new T(C,r-_),new T(C,r),new T(0,r/2)],isFilled:o});break}case"arrow-up":{const C=n*.16,_=Math.min(n,r)*.38;l=new bn({points:[new T(n/2,0),new T(n,_),new T(n-C,_),new T(n-C,r),new T(C,r),new T(C,_),new T(0,_)],isFilled:o});break}case"arrow-down":{const C=n*.16,_=Math.min(n,r)*.38;l=new bn({points:[new T(C,0),new T(n-C,0),new T(n-C,r-_),new T(n,r-_),new T(n/2,r),new T(0,r-_),new T(C,r-_)],isFilled:o});break}case"check-box":case"x-box":case"rectangle":{l=new Rr({width:n,height:r,isFilled:o});break}case"heart":{const _=jE(n,r).reduce((M,I)=>(M.push(...I.vertices),M),[]);l=new bn({points:_,isFilled:o});break}default:An(e.props.geo)}const u=um(this.editor,e),d=n/e.props.scale,f=r/e.props.scale,g=Math.min(100,d/2),m=Math.min(ma[e.props.size]*Cr.lineHeight+Vi*2,f/2),S=Math.min(d,Math.max(u.w,Math.min(g,Math.max(1,d-8)))),b=Math.min(f,Math.max(u.h,Math.min(m,Math.max(1,f-8)))),v=t_(e.props,wr[e.props.size]*e.props.scale),w=v?v.map(C=>new _d({points:C})):[];return new ns({children:[l,new Rr({x:e.props.align==="start"?0:e.props.align==="end"?(d-S)*e.props.scale:(d-S)/2*e.props.scale,y:e.props.verticalAlign==="start"?0:e.props.verticalAlign==="end"?(f-b)*e.props.scale:(f-b)/2*e.props.scale,width:S*e.props.scale,height:b*e.props.scale,isFilled:!0,isLabel:!0}),...w]})}getHandleSnapGeometry(e){const n=this.getGeometry(e),r=n.children[0];switch(e.props.geo){case"arrow-down":case"arrow-left":case"arrow-right":case"arrow-up":case"check-box":case"diamond":case"hexagon":case"octagon":case"pentagon":case"rectangle":case"rhombus":case"rhombus-2":case"star":case"trapezoid":case"triangle":case"x-box":return{outline:r,points:[...r.getVertices(),n.bounds.center]};case"cloud":case"ellipse":case"heart":case"oval":return{outline:r,points:[n.bounds.center]};default:An(e.props.geo)}}getText(e){return e.props.text}onEditEnd(e){const{id:n,type:r,props:{text:i}}=e;i.trimEnd()!==e.props.text&&this.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])}component(e){const{id:n,type:r,props:i}=e,{fill:s,font:o,align:l,verticalAlign:u,size:d,text:f}=i,g=ss(),{editor:m}=this,S=oe("isGeoOnlySelected",()=>e.id===m.getOnlySelectedShapeId(),[]),v=m.getEditingShapeId()!==null||e.props.text,w=oe("force solid",()=>m.getZoomLevel()<.2,[m]);return p.jsxs(p.Fragment,{children:[p.jsx(Sl,{children:p.jsx(yj,{shape:e,shouldScale:!0,forceSolid:w})}),v&&p.jsx(ks,{style:{overflow:"hidden",width:e.props.w,height:e.props.h+i.growY},children:p.jsx(JS,{shapeId:n,type:r,font:o,fontSize:ma[d]*e.props.scale,lineHeight:Cr.lineHeight,padding:Vi*e.props.scale,fill:s,align:l,verticalAlign:u,text:f,isSelected:S,labelColor:g[i.labelColor].solid,wrap:!0})}),e.props.url&&p.jsx(ud,{url:e.props.url})]})}indicator(e){const{id:n,props:r}=e,{w:i,size:s}=r,o=r.h+r.growY,l=wr[s],u=this.editor.getShapeGeometry(e);switch(r.geo){case"ellipse":return r.dash==="draw"?p.jsx("path",{d:Oae(n,i,o,l)}):p.jsx("path",{d:u.getSvgPathData(!0)});case"heart":return p.jsx("path",{d:G$(i,o)});case"oval":return p.jsx("path",{d:u.getSvgPathData(!0)});case"cloud":return p.jsx("path",{d:e_(i,o,n,s,e.props.scale)});default:{const d=this.editor.getShapeGeometry(e),f=d instanceof ns?d.children[0].vertices:d.vertices;let g;if(r.dash==="draw"){const S=JC(n,f,0,l*2*e.props.scale,1);g=QC(S)}else g="M"+f[0]+"L"+f.slice(1)+"Z";const m=t_(e.props,l);if(m)for(const[S,b]of m)g+=`M${S.x},${S.y}L${b.x},${b.y}`;return p.jsx("path",{d:g})}}}toSvg(e,n){const r={...e,props:{...e.props,w:e.props.w/e.props.scale,h:e.props.h/e.props.scale}},i=r.props;n.addExportDef(IE(i.fill));let s;if(i.text){n.addExportDef(ZS(i.font));const o=Ca(n),l=new xe(0,0,i.w,i.h+i.growY);s=p.jsx(QS,{fontSize:ma[i.size],font:i.font,align:i.align,verticalAlign:i.verticalAlign,text:i.text,labelColor:o[i.labelColor].solid,bounds:l,padding:16})}return p.jsxs(p.Fragment,{children:[p.jsx(yj,{shouldScale:!1,shape:r,forceSolid:!1}),s]})}getCanvasSvgDefs(){return[ME()]}onResize(e,{handle:n,newPoint:r,scaleX:i,scaleY:s,initialShape:o}){const l=o.props.w/o.props.scale,u=o.props.h/o.props.scale,d=o.props.growY/o.props.scale;let f=l*i,g=(u+d)*s,m=0,S=0;const b=Sj;if(e.props.text.trim()){let I=Math.max(Math.abs(f),b),A=Math.max(Math.abs(g),b);I<b&&A===b&&(I=b),I===b&&A<b&&(A=b);const R=um(this.editor,{...e,props:{...e.props,w:I*e.props.scale,h:A*e.props.scale}}),D=Math.max(Math.abs(f),R.w)*Math.sign(f),L=Math.max(Math.abs(g),R.h)*Math.sign(g);m=Math.abs(D)-Math.abs(f),S=Math.abs(L)-Math.abs(g),f=D,g=L}const v=f*e.props.scale,w=g*e.props.scale,C=new T(0,0);i<0&&(C.x+=v),(n==="left"||n==="top_left"||n==="bottom_left")&&(C.x+=i<0?m:-m),s<0&&(C.y+=w),(n==="top"||n==="top_left"||n==="top_right")&&(C.y+=s<0?S:-S);const{x:_,y:M}=C.rot(e.rotation).add(r);return{x:_,y:M,props:{w:Math.max(Math.abs(v),1),h:Math.max(Math.abs(w),1),growY:0}}}onBeforeCreate(e){if(!e.props.text)return e.props.growY?{...e,props:{...e.props,growY:0}}:void 0;const n=e.props.h/e.props.scale,r=um(this.editor,e).h;let i=null;if(r>n?i=r-n:e.props.growY&&(i=0),i!==null)return{...e,props:{...e.props,growY:i*e.props.scale}}}onBeforeUpdate(e,n){const r=e.props.text,i=n.props.text;if(r===i&&e.props.font===n.props.font&&e.props.size===n.props.size)return;if(r&&!i)return{...n,props:{...n.props,growY:0}};const s=e.props.w/e.props.scale,o=e.props.h/e.props.scale,l=e.props.growY/e.props.scale,u=um(this.editor,n);if(!r&&i&&i.length===1){let f=Math.max(s,u.w),g=Math.max(o,u.h);const m=Sj;return s<m&&o<m&&(f=Math.max(f,m),g=Math.max(g,m),f=Math.max(f,g),g=Math.max(f,g)),{...n,props:{...n.props,w:f*n.props.scale,h:g*n.props.scale,growY:0}}}let d=null;if(u.h>o?d=u.h-o:l&&(d=0),d!==null){const f=n.props.w/n.props.scale;return{...n,props:{...n.props,growY:d*n.props.scale,w:Math.max(f,u.w)*n.props.scale}}}if(u.w>s)return{...n,props:{...n.props,w:u.w*n.props.scale}}}onDoubleClick(e){if(this.editor.inputs.altKey)switch(e.props.geo){case"rectangle":return{...e,props:{geo:"check-box"}};case"check-box":return{...e,props:{geo:"rectangle"}}}}getInterpolatedProps(e,n,r){return{...r>.5?n.props:e.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r),scale:ct(e.props.scale,n.props.scale,r)}}}O(Bm,"type","geo"),O(Bm,"props",w3),O(Bm,"migrations",C3);function um(t,e){const{text:n,font:r,size:i,w:s}=e.props;if(!n)return{w:0,h:0};const o=t.textMeasure.measureText("w",{...Cr,fontFamily:va[r],fontSize:ma[i],maxWidth:100}),l={s:2,m:3.5,l:5,xl:10},u=t.textMeasure.measureText(n,{...Cr,fontFamily:va[r],fontSize:ma[i],minWidth:o.w,maxWidth:Math.max(0,Math.ceil(o.w+l[i]),Math.ceil(s/e.props.scale-Vi*2))});return{w:u.w+Vi*2,h:u.h+Vi*2}}function Uae(){const[t,e]=E.useState(!1);return E.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),i=matchMedia("(color-gamut: p3)");e(r&&i.matches);const s=()=>e(r&&i.matches);return i.addEventListener("change",s),()=>i.removeEventListener("change",s)},[]),oe(xn.forceSrgb)||!t?"srgb":"p3"}class Fm extends si{constructor(){super(...arguments);O(this,"options",{maxPointsPerShape:600,underlayOpacity:.82,overlayOpacity:.35})}hideResizeHandles(n){return dm(n)}hideRotateHandle(n){return dm(n)}hideSelectionBoundsFg(n){return dm(n)}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1,scale:1}}getGeometry(n){const r=fc(n);if(dm(n))return new j2({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:i,sw:s}=vj(n,r,!0),o=RE({strokeWidth:s,showAsComplete:!0});return WS(i,o),new bn({points:_E(i,o),isFilled:!0})}component(n){const r=y1(this.editor,n),i=fc(n);return p.jsx(Sl,{children:p.jsx(hm,{shape:n,forceSolid:r,strokeWidth:i,opacity:this.options.overlayOpacity})})}backgroundComponent(n){const r=y1(this.editor,n),i=fc(n);return p.jsx(Sl,{children:p.jsx(hm,{shape:n,forceSolid:r,strokeWidth:i,opacity:this.options.underlayOpacity})})}indicator(n){const r=y1(this.editor,n),i=fc(n),{strokePoints:s,sw:o}=vj(n,i,r),l=dd(n.props.segments);let u;return s.length<2?u=Kae(l[0],o):u=kc(s,!1),p.jsx("path",{d:u})}toSvg(n){const r=fc(n),i=r<1.5,s=1/n.props.scale;return p.jsx("g",{transform:`scale(${s})`,children:p.jsx(hm,{forceSolid:i,strokeWidth:r,shape:n,opacity:this.options.overlayOpacity})})}toBackgroundSvg(n){const r=fc(n),i=r<1.5,s=1/n.props.scale;return p.jsx("g",{transform:`scale(${s})`,children:p.jsx(hm,{forceSolid:i,strokeWidth:r,shape:n,opacity:this.options.underlayOpacity})})}onResize(n,r){const{scaleX:i,scaleY:s}=r,o=[];for(const l of n.props.segments)o.push({...l,points:l.points.map(({x:u,y:d,z:f})=>({x:i*u,y:s*d,z:f}))});return{props:{segments:o}}}getInterpolatedProps(n,r,i){return{...i>.5?r.props:n.props,...r.props,segments:F$(n.props.segments,r.props.segments,i),scale:ct(n.props.scale,r.props.scale,i)}}}O(Fm,"type","highlight"),O(Fm,"props",P3),O(Fm,"migrations",T3);function Hae(t){return`M ${t.x} ${t.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function Kae(t,e){const n=e/2;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function vj(t,e,n){var u;const r=dd(t.props.segments),i=t.props.isComplete||((u=Qn(t.props.segments))==null?void 0:u.type)==="straight";let s=e;!n&&!t.props.isPen&&r.length===1&&(s+=Ds(t.id)()*(e/6));const o=RE({strokeWidth:s,showAsComplete:i});return{strokePoints:bo(r,o),sw:s}}function fc(t){return ld[t.props.size]*1.12*t.props.scale}function dm(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function hm({strokeWidth:t,forceSolid:e,shape:n,opacity:r}){var m;const i=ss(),s=dd(n.props.segments);let o=t;!e&&!n.props.isPen&&s.length===1&&(o+=Ds(n.id)()*(o/6));const l=RE({strokeWidth:o,showAsComplete:n.props.isComplete||((m=Qn(n.props.segments))==null?void 0:m.type)==="straight"}),u=bo(s,l),d=u.length>1?kc(u,!1):Hae(n.props.segments[0].points[0]),f=Uae(),g=i[n.props.color].highlight[f];return p.jsx("path",{d,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:g,strokeWidth:o,opacity:r})}function y1(t,e){return oe("forceSolid",()=>{const n=fc(e),r=t.getZoomLevel();return n/r<1.5},[t])}function q$(){return p.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[p.jsx("path",{d:"M3,11 L3,3 11,3",strokeWidth:"2"}),p.jsx("path",{d:"M19,27 L27,27 L27,19",strokeWidth:"2"}),p.jsx("path",{d:"M27,3 L3,27",strokeWidth:"2"})]})}const bj=8;function Gae(){return{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}}function Ff(t,e){if(!e)return{w:t.w,h:t.h};const n=t.w/(e.bottomRight.x-e.topLeft.x),r=t.h/(e.bottomRight.y-e.topLeft.y);return{w:n,h:r}}function qae(t,e,n={}){const{handle:r,change:i,crop:s}=e,{w:o,h:l}=e.uncroppedSize,{minWidth:u=bj,minHeight:d=bj}=n,f=Xt(s),g=new T(t.x,t.y),m=new T(0,0);let S=!1;switch(r){case"top":case"top_left":case"top_right":{if(l<d)break;S=!0,f.topLeft.y=f.topLeft.y+i.y/l,l*(f.bottomRight.y-f.topLeft.y)<d?(f.topLeft.y=f.bottomRight.y-d/l,m.y=(f.topLeft.y-s.topLeft.y)*l):f.topLeft.y<=0?(f.topLeft.y=0,m.y=(f.topLeft.y-s.topLeft.y)*l):m.y=i.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(l<d)break;S=!0,f.bottomRight.y=Math.min(1,f.bottomRight.y+i.y/l),l*(f.bottomRight.y-f.topLeft.y)<d&&(f.bottomRight.y=f.topLeft.y+d/l);break}}switch(r){case"left":case"top_left":case"bottom_left":{if(o<u)break;S=!0,f.topLeft.x=f.topLeft.x+i.x/o,o*(f.bottomRight.x-f.topLeft.x)<u?(f.topLeft.x=f.bottomRight.x-u/o,m.x=(f.topLeft.x-s.topLeft.x)*o):f.topLeft.x<=0?(f.topLeft.x=0,m.x=(f.topLeft.x-s.topLeft.x)*o):m.x=i.x;break}case"right":case"top_right":case"bottom_right":{if(o<u)break;S=!0,f.bottomRight.x=Math.min(1,f.bottomRight.x+i.x/o),o*(f.bottomRight.x-f.topLeft.x)<u&&(f.bottomRight.x=f.topLeft.x+u/o);break}}if(S)return g.add(m.rot(t.rotation)),{id:t.id,type:t.type,x:g.x,y:g.y,props:{w:(f.bottomRight.x-f.topLeft.x)*o,h:(f.bottomRight.y-f.topLeft.y)*l,crop:f}}}function Y$({shapeId:t,assetId:e,width:n}){const r=re(),i=ap(),s=pX(),[o,l]=E.useState(()=>({asset:e?r.getAsset(e)??null:null,url:null})),u=E.useRef(!1),d=E.useRef(null);return E.useEffect(()=>{if(!e)return;let f=!1,g;const m=co("update state",()=>{if(!i&&t&&r.getCulledShapes().has(t))return;const S=r.getAsset(e);if(!S)return;if(!S.props.src){const w=r.getTemporaryAssetPreview(S.id);if(w){d.current!==w&&(d.current=w,l(C=>({...C,isPlaceholder:!0,url:w})),s());return}}const b=i?i.scale*(n/S.props.w):r.getZoomLevel()*(n/S.props.w);function v(w,C){f||d.current!==C&&(u.current=!0,d.current=C,l({asset:w,url:C}),s())}if(u.current){let w=0;const C=()=>{w++,w>500/16&&(xj(r,e,b,i,_=>v(S,_)),g==null||g())};g==null||g(),r.on("tick",C),g=()=>r.off("tick",C)}else xj(r,e,b,i,w=>v(S,w))});return()=>{m(),g==null||g(),f=!0}},[r,e,i,s,t,n]),o}function xj(t,e,n,r,i){t.resolveAssetUrl(e,{screenScale:n,shouldResolveToOriginal:r?r.pixelRatio===null:!1,dpr:(r==null?void 0:r.pixelRatio)??void 0}).then(s=>{i(s)})}async function Yae(t){const n=await(await go(t)).blob();return Ts.blobToDataUrl(n)}class Um extends Id{isAspectRatioLocked(){return!0}canCrop(){return!0}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null,flipX:!1,flipY:!1}}onResize(e,n){let r=Nc(e,n);const{flipX:i,flipY:s}=n.initialShape.props,{scaleX:o,scaleY:l,mode:u}=n;if(r={...r,props:{...r.props,flipX:o<0!==i,flipY:l<0!==s}},!e.props.crop)return r;const d=u==="scale_shape"&&o===-1||u==="resize_bounds"&&i!==r.props.flipX,f=u==="scale_shape"&&l===-1||u==="resize_bounds"&&s!==r.props.flipY,{topLeft:g,bottomRight:m}=e.props.crop;return r.props.crop={topLeft:{x:d?1-m.x:g.x,y:f?1-m.y:g.y},bottomRight:{x:d?1-g.x:m.x,y:f?1-g.y:m.y}},r}component(e){return p.jsx(Vae,{shape:e})}indicator(e){return this.editor.getCroppingShapeId()===e.id?null:p.jsx("rect",{width:ne(e.props.w),height:ne(e.props.h)})}async toSvg(e,n){if(!e.props.assetId||!this.editor.getAsset(e.props.assetId))return null;const{w:i}=Ff(e.props,e.props.crop);let s=await n.resolveAssetUrl(e.props.assetId,i);return s?((s.startsWith("blob:")||s.startsWith("http")||s.startsWith("/")||s.startsWith("./"))&&(s=await Yae(s)||""),p.jsx(Xae,{shape:e,src:s})):null}onDoubleClickEdge(e){const n=e.props;if(!n||this.editor.getCroppingShapeId()!==e.id)return;const r=Xt(n.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},{w:i,h:s}=Ff(e.props,r),o=new T(r.topLeft.x*i,r.topLeft.y*s).rot(e.rotation),l={id:e.id,type:e.type,x:e.x-o.x,y:e.y-o.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:s}};this.editor.updateShapes([l])}getInterpolatedProps(e,n,r){function i(s,o){var g,m,S,b;if(s.props.crop===null&&o.props.crop===null)return null;const l=((g=s.props.crop)==null?void 0:g.topLeft)||{x:0,y:0},u=((m=s.props.crop)==null?void 0:m.bottomRight)||{x:1,y:1},d=((S=o.props.crop)==null?void 0:S.topLeft)||{x:0,y:0},f=((b=o.props.crop)==null?void 0:b.bottomRight)||{x:1,y:1};return{topLeft:{x:ct(l.x,d.x,r),y:ct(l.y,d.y,r)},bottomRight:{x:ct(u.x,f.x,r),y:ct(u.y,f.y,r)}}}return{...r>.5?n.props:e.props,w:ct(e.props.w,n.props.w,r),h:ct(e.props.h,n.props.h,r),crop:i(e,n)}}}O(Um,"type","image"),O(Um,"props",I3),O(Um,"migrations",M3);const Vae=E.memo(function({shape:e}){var _;const n=re(),{w:r}=Ff(e.props,e.props.crop),{asset:i,url:s}=Y$({shapeId:e.id,assetId:e.props.assetId,width:r}),o=IN(),[l,u]=E.useState(""),[d,f]=E.useState(null),g=Wae(n,e);E.useEffect(()=>{if(s&&g){let M=!1;const I=If();return I.onload=()=>{if(M)return;const A=document.createElement("canvas");A.width=I.width,A.height=I.height;const R=A.getContext("2d");R&&(R.drawImage(I,0,0),u(A.toDataURL()),f(s))},I.crossOrigin="anonymous",I.src=s,()=>{M=!0}}},[n,g,o,s]);const m=oe("show crop preview",()=>e.id===n.getOnlySelectedShapeId()&&n.getCroppingShapeId()===e.id&&n.isIn("select.crop"),[n,e.id]),S=o&&(((_=i==null?void 0:i.props.mimeType)==null?void 0:_.includes("video"))||g),b=V$(e),v=s===d?null:s,w=S?l:d;if(!s&&!(i!=null&&i.props.src))return p.jsxs(ks,{id:e.id,style:{overflow:"hidden",width:e.props.w,height:e.props.h,color:"var(--color-text-3)",backgroundColor:"var(--color-low)",border:"1px solid var(--color-low-border)"},children:[p.jsx("div",{className:je("tl-image-container",i&&"tl-image-container-loading"),style:b,children:i?null:p.jsx(q$,{})}),"url"in e.props&&e.props.url&&p.jsx(ud,{url:e.props.url})]});const C=g?"anonymous":void 0;return p.jsxs(p.Fragment,{children:[m&&w&&p.jsx("div",{style:b,children:p.jsx("img",{className:"tl-image",style:{...wf(e),opacity:.1},crossOrigin:C,src:w,referrerPolicy:"strict-origin-when-cross-origin",draggable:!1})}),p.jsxs(ks,{id:e.id,style:{overflow:"hidden",width:e.props.w,height:e.props.h},children:[p.jsxs("div",{className:je("tl-image-container"),style:b,children:[w&&p.jsx("img",{className:"tl-image",style:wf(e),crossOrigin:C,src:w,referrerPolicy:"strict-origin-when-cross-origin",draggable:!1},w),v&&p.jsx("img",{className:"tl-image",style:wf(e),crossOrigin:C,src:v,referrerPolicy:"strict-origin-when-cross-origin",draggable:!1,onLoad:()=>f(v)},v)]}),e.props.url&&p.jsx(ud,{url:e.props.url})]})]})});function Wae(t,e){const n=e.props.assetId?t.getAsset(e.props.assetId):void 0;return n?"mimeType"in n.props&&bi.isAnimatedImageType(n==null?void 0:n.props.mimeType)||"isAnimated"in n.props&&n.props.isAnimated:!1}function V$(t){const e=t.props.crop,n=e==null?void 0:e.topLeft;if(!n)return{width:t.props.w,height:t.props.h};const{w:r,h:i}=Ff(t.props,e),s=-n.x*r,o=-n.y*i;return{transform:`translate(${s}px, ${o}px)`,width:r,height:i}}function wf(t,e){const{flipX:n,flipY:r}=t.props;if(!n&&!r)return;const i=`scale(${n?-1:1}, ${r?-1:1})`;return{transform:`${e?`translate(${n?e.width:0}px, ${r?e.height:0}px)`:""} ${i}`,transformOrigin:e?"0 0":"center center"}}function Xae({shape:t,src:e}){const n=xd(),r=V$(t),i=t.props.crop;if(r.transform&&i){const{transform:s,width:o,height:l}=r,u=(i.bottomRight.x-i.topLeft.x)*o,d=(i.bottomRight.y-i.topLeft.y)*l,f=[new T(0,0),new T(u,0),new T(u,d),new T(0,d)],g=wf(t,{width:o,height:l});return p.jsxs(p.Fragment,{children:[p.jsx("defs",{children:p.jsx("clipPath",{id:n,children:p.jsx("polygon",{points:f.map(m=>`${m.x},${m.y}`).join(" ")})})}),p.jsx("g",{clipPath:`url(#${n})`,children:p.jsx("image",{href:e,width:o,height:l,style:g?{...g,transform:`${s} ${g.transform}`}:{transform:s}})})]})}else return p.jsx("image",{href:e,width:t.props.w,height:t.props.h,style:wf(t,{width:t.props.w,height:t.props.h})})}function W$(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function X$(t,e,n){const r=e.vertices,i=W$(n);return bo(r,i)}function Zae(t,e,n){const r=W$(n);return _E(WS(X$(t,e,n),r),r)}function Qae(t,e,n){const r=Zae(t,e,n);return m2(r)}function Jae(t,e,n){if(t.props.dash==="draw"){const r=X$(t,e,n);return kc(r)}return e.getSvgPathData()}function Z$(t,e,n){let r=`M ${mt(e[0])}L`,i=`M ${mt(e[0])}L`;const s=n/3,o=n*2,l=Ds(t);let u=e[0],d,f=e[0],g;const m=e.length;for(let S=0,b=m-1;S<b;S++){d=e[S+1],g=T.AddXY(e[S+1],l()*s,l()*s);const v=T.Sub(d,u),w=T.Len(v),C=T.Div(v,w).mul(Math.min(w/4,o)),_=T.Add(u,C),M=T.Add(d,C.neg()),I=T.Sub(g,f),A=T.Len(I),R=T.Div(I,A).mul(Math.min(A/4,o)),D=T.Add(f,R),L=T.Add(g,R.neg());S===b-1?(r+=`${mt(_)}L ${mt(d)}`,i+=`${mt(D)}L ${mt(g)}`):(r+=`${mt(_)}L ${mt(M)}Q ${mt(d)}`,i+=`${mt(D)}L ${mt(L)}Q ${mt(g)}`,u=d,f=g)}return[r,r+i]}const ele=new po;class Hm extends si{hideResizeHandles(){return!0}hideRotateHandle(){return!0}hideSelectionBoundsFg(){return!0}hideSelectionBoundsBg(){return!0}getDefaultProps(){const[e,n]=Af(2);return{dash:"draw",size:"m",color:"black",spline:"line",points:{[e]:{id:e,index:e,x:0,y:0},[n]:{id:n,index:n,x:.1,y:.1}},scale:1}}getGeometry(e){return df(e)}getHandles(e){return ele.get(e.props,()=>{const n=df(e),r=uf(e),i=r.map(s=>({...s,id:s.index,type:"vertex",canSnap:!0}));for(let s=0;s<r.length-1;s++){const o=Mf(r[s].index,r[s+1].index),u=n.segments[s].midPoint();i.push({id:o,type:"create",index:o,x:u.x,y:u.y,canSnap:!0})}return i.sort(vr)})}onResize(e,n){const{scaleX:r,scaleY:i}=n;return{props:{points:Wf(e.props.points,(s,{id:o,index:l,x:u,y:d})=>({id:o,index:l,x:u*r,y:d*i}))}}}onBeforeCreate(e){const{props:{points:n}}=e,r=Object.keys(n);if(r.length<2)return;const i=n[r[0]];if(r.every(o=>{const l=n[o];return l.x===i.x&&l.y===i.y})){const o=r[r.length-1];return n[o]={...n[o],x:n[o].x+.1,y:n[o].y+.1},e}}onHandleDrag(e,{handle:n}){if(n.type!=="vertex")return;const r=Rs(new T(n.x,n.y),this.editor);return{...e,props:{...e.props,points:{...e.props.points,[n.id]:{id:n.id,index:n.index,x:r.x,y:r.y}}}}}component(e){return p.jsx(Sl,{style:{minWidth:50,minHeight:50},children:p.jsx(wj,{shape:e})})}indicator(e){const n=lo[e.props.size]*e.props.scale,r=df(e),{dash:i}=e.props;let s;if(e.props.spline==="line"){const o=r.points;if(i==="solid"||i==="dotted"||i==="dashed")s="M"+o[0]+"L"+o.slice(1);else{const[l]=Z$(e.id,o,n);s=l}}else s=Jae(e,r,n);return p.jsx("path",{d:s})}toSvg(e){return p.jsx(wj,{shouldScale:!0,shape:e})}getHandleSnapGeometry(e){const n=uf(e);return{points:n,getSelfSnapPoints:r=>{const i=this.getHandles(e).filter(s=>s.type==="vertex").findIndex(s=>s.id===r.id);return n.filter((s,o)=>Math.abs(o-i)>1).map(T.From)},getSelfSnapOutline:r=>{const i=this.getHandles(e).filter(o=>o.type==="vertex").findIndex(o=>o.id===r.id),s=df(e).segments.filter((o,l)=>l!==i-1&&l!==i);return s.length?new ns({children:s}):null}}}getInterpolatedProps(e,n,r){const i=uf(e),s=uf(n),o=[],l=[];let u=ZD;if(i.length>s.length)for(let d=0;d<i.length;d++)o[d]={...i[d]},s[d]===void 0?l[d]={...s[s.length-1],id:u}:l[d]={...s[d],id:u},u=so(u);else if(s.length>i.length)for(let d=0;d<s.length;d++)l[d]={...s[d]},i[d]===void 0?o[d]={...i[i.length-1],id:u}:o[d]={...i[d],id:u},u=so(u);else for(let d=0;d<s.length;d++)o[d]=i[d],l[d]=s[d];return{...r>.5?n.props:e.props,points:Object.fromEntries(o.map((d,f)=>{const g=l[f];return[d.id,{...d,x:ct(d.x,g.x,r),y:ct(d.y,g.y,r)}]})),scale:ct(e.props.scale,n.props.scale,r)}}}O(Hm,"type","line"),O(Hm,"props",A3),O(Hm,"migrations",k3);function uf(t){return Object.values(t.props.points).sort(vr)}function df(t){const e=uf(t).map(T.From);switch(t.props.spline){case"cubic":return new iJ({points:e});case"line":return new _d({points:e})}}function wj({shape:t,shouldScale:e=!1,forceSolid:n=!1}){const r=ss(),i=df(t),{dash:s,color:o,size:l}=t.props,u=1/t.props.scale,d=e?u:1,f=lo[l]*t.props.scale;if(t.props.spline==="line"){if(s==="solid"){const g=i.points,m="M"+g[0]+"L"+g.slice(1);return p.jsx("path",{d:m,stroke:r[o].solid,strokeWidth:f,fill:"none",transform:`scale(${d})`})}if(s==="dashed"||s==="dotted")return p.jsx("g",{stroke:r[o].solid,strokeWidth:f,transform:`scale(${d})`,children:i.segments.map((g,m)=>{const{strokeDasharray:S,strokeDashoffset:b}=n?{strokeDasharray:"none",strokeDashoffset:"none"}:Ps(g.length,f,{style:s,start:m>0?"outset":"none",end:m<i.segments.length-1?"outset":"none"});return p.jsx("path",{strokeDasharray:S,strokeDashoffset:b,d:g.getSvgPathData(!0),fill:"none"},m)})});if(s==="draw"){const g=i.points,[m,S]=Z$(t.id,g,f);return p.jsx("path",{d:S,stroke:r[o].solid,strokeWidth:f,fill:"none",transform:`scale(${d})`})}}if(t.props.spline==="cubic"){const g=i.getSvgPathData();if(s==="solid")return p.jsx("path",{strokeWidth:f,stroke:r[o].solid,fill:"none",d:g,transform:`scale(${d})`});if(s==="dashed"||s==="dotted")return p.jsx("g",{stroke:r[o].solid,strokeWidth:f,transform:`scale(${d})`,children:i.segments.map((m,S)=>{const{strokeDasharray:b,strokeDashoffset:v}=Ps(m.length,f,{style:s,start:S>0?"outset":"none",end:S<i.segments.length-1?"outset":"none",forceSolid:n});return p.jsx("path",{strokeDasharray:b,strokeDashoffset:v,d:m.getSvgPathData(),fill:"none"},S)})});if(s==="draw")return p.jsx("path",{d:Qae(t,i,f),strokeWidth:1,stroke:r[o].solid,fill:r[o].solid,transform:`scale(${d})`})}}class Km extends si{constructor(){super(...arguments);O(this,"options",{resizeMode:"none"})}canEdit(){return!0}hideResizeHandles(){const{resizeMode:n}=this.options;switch(n){case"none":return!0;case"scale":return!1;default:throw An(n)}}isAspectRatioLocked(){return this.options.resizeMode==="scale"}hideSelectionBoundsFg(){return!1}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",labelColor:"black",growY:0,fontSizeAdjustment:0,url:"",scale:1}}getGeometry(n){const{labelHeight:r,labelWidth:i}=Q$(this.editor,n),{scale:s}=n.props,o=r*s,l=i*s,u=Dt*s,d=fm(n);return new ns({children:[new Rr({width:u,height:d,isFilled:!0}),new Rr({x:n.props.align==="start"?0:n.props.align==="end"?u-l:(u-l)/2,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?d-o:(d-o)/2,width:l,height:o,isFilled:!0,isLabel:!0})]})}getHandles(n){const{scale:r}=n.props;if(this.editor.getInstanceState().isCoarsePointer)return[];const s=this.editor.getZoomLevel();if(s*r<.25)return[];const o=fm(n),l=Dt*r,u=yoe/s*r;return s*r<.5?[{id:"bottom",index:"a3",type:"clone",x:l/2,y:o+u}]:[{id:"top",index:"a1",type:"clone",x:l/2,y:-u},{id:"right",index:"a2",type:"clone",x:l+u,y:o/2},{id:"bottom",index:"a3",type:"clone",x:l/2,y:o+u},{id:"left",index:"a4",type:"clone",x:-u,y:o/2}]}onResize(n,r){const{resizeMode:i}=this.options;switch(i){case"none":return;case"scale":return U5(n,r);default:throw An(i)}}getText(n){return n.props.text}component(n){const{id:r,type:i,props:{labelColor:s,scale:o,color:l,font:u,size:d,align:f,text:g,verticalAlign:m,fontSizeAdjustment:S}}=n,b=rle(r),v=ss(),w=Dt*o,C=fm(n),_=oe("shape rotation",()=>{var R;return((R=this.editor.getShapePageTransform(r))==null?void 0:R.rotation())??0},[this.editor]),M=oe("zoom",()=>this.editor.getZoomLevel()<.35/o,[o,this.editor]),I=oe("dark mode",()=>this.editor.user.getIsDarkMode(),[this.editor]),A=n.id===this.editor.getOnlySelectedShapeId();return p.jsxs(p.Fragment,{children:[p.jsx("div",{id:r,className:"tl-note__container",style:{width:w,height:C,backgroundColor:v[l].note.fill,borderBottom:M?I?`${2*o}px solid rgb(20, 20, 20)`:`${2*o}px solid rgb(144, 144, 144)`:"none",boxShadow:M?"none":ile(n.id,_,o)},children:p.jsx(JS,{shapeId:r,type:i,font:u,fontSize:(S||ma[d])*o,lineHeight:Cr.lineHeight,align:f,verticalAlign:m,text:g,isNote:!0,isSelected:A,labelColor:s==="black"?v[l].note.text:v[s].fill,wrap:!0,padding:16*o,onKeyDown:b})}),"url"in n.props&&n.props.url&&p.jsx(ud,{url:n.props.url})]})}indicator(n){const{scale:r}=n.props;return p.jsx("rect",{rx:r,width:ne(Dt*r),height:ne(fm(n))})}toSvg(n,r){n.props.text&&r.addExportDef(ZS(n.props.font));const i=Ca({isDarkMode:r.isDarkMode}),s=sle(n);return p.jsxs(p.Fragment,{children:[p.jsx("rect",{x:5,y:5,rx:1,width:Dt-10,height:s.h,fill:"rgba(0,0,0,.1)"}),p.jsx("rect",{rx:1,width:Dt,height:s.h,fill:i[n.props.color].note.fill}),p.jsx(QS,{fontSize:n.props.fontSizeAdjustment||ma[n.props.size],font:n.props.font,align:n.props.align,verticalAlign:n.props.verticalAlign,text:n.props.text,labelColor:i[n.props.color].note.text,bounds:s,stroke:!1})]})}onBeforeCreate(n){return Cj(this.editor,n)}onBeforeUpdate(n,r){if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return Cj(this.editor,r)}onEditEnd(n){const{id:r,type:i,props:{text:s}}=n;s.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:i,props:{text:s.trimEnd()}}])}getInterpolatedProps(n,r,i){return{...i>.5?r.props:n.props,scale:ct(n.props.scale,r.props.scale,i)}}}O(Km,"type","note"),O(Km,"props",R3),O(Km,"migrations",O3);function Cj(t,e){const{labelHeight:n,fontSizeAdjustment:r}=Q$(t,e),i=Math.max(0,n-Dt);if(i!==e.props.growY||r!==e.props.fontSizeAdjustment)return{...e,props:{...e.props,growY:i,fontSizeAdjustment:r}}}function tle(t,e){const{text:n}=e.props;if(!n)return{labelHeight:ma[e.props.size]*Cr.lineHeight+Vi*2,labelWidth:100,fontSizeAdjustment:0};const r=ma[e.props.size];let i=0,s=0,o=Dt,l=Dt;const u=1;do{i=Math.min(r,r-s);const d=t.textMeasure.measureText(n,{...Cr,fontFamily:va[e.props.font],fontSize:i,maxWidth:Dt-Vi*2-u,disableOverflowWrapBreaking:!0});if(o=d.h+Vi*2,l=d.w+Vi*2,i<=14){const f=t.textMeasure.measureText(n,{...Cr,fontFamily:va[e.props.font],fontSize:i,maxWidth:Dt-Vi*2-u});o=f.h+Vi*2,l=f.w+Vi*2;break}if(d.scrollWidth.toFixed(0)===d.w.toFixed(0))break}while(s++<50);return{labelHeight:o,labelWidth:l,fontSizeAdjustment:i}}const nle=new po;function Q$(t,e){return nle.get(e,()=>tle(t,e))}function rle(t){const e=re(),n=k8();return E.useCallback(r=>{const i=e.getShape(t);if(!i)return;const s=r.key==="Tab",o=(r.metaKey||r.ctrlKey)&&r.key==="Enter";if(s||o){r.preventDefault();const l=e.getShapePageTransform(t),u=l.rotation(),d=!!(n.dir==="rtl"||b$(i.props.text)),f=(Dt+e.options.adjacentShapeMargin+(o&&!r.shiftKey?i.props.growY:0))*i.props.scale,g=new T(s?r.shiftKey!=d?-1:1:0,o?r.shiftKey?-1:1:0).mul(f).add(XS.clone().mul(i.props.scale)).rot(u).add(l.point()),m=A$(e,i,g,u);m&&(e.markHistoryStoppingPoint("editing adjacent shape"),Ly(e,m,!0))}},[t,e,n.dir])}function fm(t){return(Dt+t.props.growY)*t.props.scale}function ile(t,e,n){const r=Ds(t),i=Math.abs(r())+.5,s=Math.cos(e),o=5*n,l=4*n,u=6*n,d=7*n;return`0px ${o-i}px ${o}px -${o}px rgba(15, 23, 31, .6),
	0px ${(l+i*d)*Math.max(0,s)}px ${u+i*d}px -${l+i*u}px rgba(15, 23, 31, ${(.3+i*.1).toFixed(2)}), 
	0px ${48*n}px ${10*n}px -${10*n}px inset rgba(15, 23, 44, ${((.022+r()*.005)*((1+s)/2)).toFixed(2)})`}function sle(t){return new xe(0,0,Dt,Dt+t.props.growY)}const ole=new po;class Gm extends si{getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",textAlign:"start",autoSize:!0,scale:1}}getMinDimensions(e){return ole.get(e.props,n=>_j(this.editor,n))}getGeometry(e){const{scale:n}=e.props,{width:r,height:i}=this.getMinDimensions(e);return new Rr({width:r*n,height:i*n,isFilled:!0,isLabel:!0})}getText(e){return e.props.text}canEdit(){return!0}isAspectRatioLocked(){return!0}component(e){const{id:n,props:{font:r,size:i,text:s,color:o,scale:l,textAlign:u}}=e,{width:d,height:f}=this.getMinDimensions(e),g=e.id===this.editor.getOnlySelectedShapeId(),m=ss(),S=ale(n);return p.jsx(JS,{shapeId:n,classNamePrefix:"tl-text-shape",type:"text",font:r,fontSize:ld[i],lineHeight:Cr.lineHeight,align:u,verticalAlign:"middle",text:s,labelColor:m[o].solid,isSelected:g,textWidth:d,textHeight:f,style:{transform:`scale(${l})`,transformOrigin:"top left"},wrap:!0,onKeyDown:S})}indicator(e){const n=this.editor.getShapeGeometry(e).bounds,r=re();return e.props.autoSize&&r.getEditingShapeId()===e.id?null:p.jsx("rect",{width:ne(n.width),height:ne(n.height)})}toSvg(e,n){e.props.text&&n.addExportDef(ZS(e.props.font));const r=this.editor.getShapeGeometry(e).bounds,i=r.width/(e.props.scale??1),s=r.height/(e.props.scale??1),o=Ca(n);return p.jsx(QS,{fontSize:ld[e.props.size],font:e.props.font,align:e.props.textAlign,verticalAlign:"middle",text:e.props.text,labelColor:o[e.props.color].solid,bounds:new xe(0,0,i,s),padding:0})}onResize(e,n){const{newPoint:r,initialBounds:i,initialShape:s,scaleX:o,handle:l}=n;if(n.mode==="scale_shape"||l!=="right"&&l!=="left")return{id:e.id,type:e.type,...U5(e,n)};{const u=Math.max(1,Math.abs(i.width*o)),{x:d,y:f}=o<0?T.Sub(r,T.FromAngle(e.rotation).mul(u)):r;return{id:e.id,type:e.type,x:d,y:f,props:{w:u/s.props.scale,autoSize:!1}}}}onEditEnd(e){const{id:n,type:r,props:{text:i}}=e,s=e.props.text.trimEnd();s.length===0?this.editor.deleteShapes([e.id]):s!==e.props.text&&this.editor.updateShapes([{id:n,type:r,props:{text:i.trimEnd()}}])}onBeforeUpdate(e,n){if(!n.props.autoSize)return;const r=e.props.size!==n.props.size||e.props.textAlign!==n.props.textAlign||e.props.font!==n.props.font||e.props.scale!==1&&n.props.scale===1,i=e.props.text!==n.props.text;if(!r&&!i)return;const s=this.getMinDimensions(e),o=_j(this.editor,n.props),l=s.width*e.props.scale,u=s.height*e.props.scale,d=o.width*n.props.scale,f=o.height*n.props.scale;let g;switch(n.props.textAlign){case"middle":{g=new T((d-l)/2,i?0:(f-u)/2);break}case"end":{g=new T(d-l,i?0:(f-u)/2);break}default:{if(i)break;g=new T(0,(f-u)/2);break}}if(g){g.rot(n.rotation);const{x:m,y:S}=n;return{...n,x:m-g.x,y:S-g.y,props:{...n.props,w:d}}}else return{...n,props:{...n.props,w:d}}}}O(Gm,"type","text"),O(Gm,"props",j3),O(Gm,"migrations",D3);function _j(t,e){const{font:n,text:r,autoSize:i,size:s,w:o}=e,l=i?16:Math.max(16,o),u=ld[s],d=i?null:Math.floor(Math.max(l,o)),f=t.textMeasure.measureText(r,{...Cr,fontFamily:va[n],fontSize:u,maxWidth:d});return i&&(f.w+=1),{width:Math.max(l,f.w),height:Math.max(u,f.h)}}function ale(t){const e=re();return E.useCallback(n=>{if(e.getEditingShapeId()===t)switch(n.key){case"Enter":{(n.ctrlKey||n.metaKey)&&e.complete();break}case"Tab":{Je(n),n.shiftKey?cd.unindent(n.currentTarget):cd.indent(n.currentTarget);break}}},[e,t])}class qm extends Id{canEdit(){return!0}isAspectRatioLocked(){return!0}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(e){return p.jsx(lle,{shape:e})}indicator(e){return p.jsx("rect",{width:ne(e.props.w),height:ne(e.props.h)})}async toSvg(e,n){if(!e.props.assetId)return null;const r=await n.resolveAssetUrl(e.props.assetId,e.props.w);if(!r)return null;const i=await bi.loadVideo(r),s=await bi.getVideoFrameAsDataUrl(i,0);return s?p.jsx("image",{href:s,width:e.props.w,height:e.props.h}):null}}O(qm,"type","video"),O(qm,"props",L3),O(qm,"migrations",N3);const lle=E.memo(function({shape:e}){const n=re(),r=n.getShapeGeometry(e).bounds.w*n.getZoomLevel()>=110,i=ES(e.id),s=IN(),{Spinner:o}=Zt(),{asset:l,url:u}=Y$({shapeId:e.id,assetId:e.props.assetId,width:e.props.w}),d=E.useRef(null),[f,g]=E.useState(!1),[m,S]=E.useState(!1);E.useEffect(()=>{const v=()=>S(document.fullscreenElement===d.current);return document.addEventListener("fullscreenchange",v),()=>document.removeEventListener("fullscreenchange",v)});const b=E.useCallback(v=>{v.currentTarget&&g(!0)},[]);return E.useEffect(()=>{const v=d.current;v&&i&&document.activeElement!==v&&v.focus()},[i,f]),E.useEffect(()=>{if(s){const v=d.current;if(!v)return;v.pause(),v.currentTime=0}},[d,s]),p.jsxs(p.Fragment,{children:[p.jsx(ks,{id:e.id,style:{color:"var(--color-text-3)",backgroundColor:l?"transparent":"var(--color-low)",border:l?"none":"1px solid var(--color-low-border)"},children:p.jsx("div",{className:"tl-counter-scaled",children:p.jsx("div",{className:"tl-video-container",children:l?o&&!l.props.src?p.jsx(o,{}):u?p.jsxs(p.Fragment,{children:[p.jsx("video",{ref:d,style:i?{pointerEvents:"all"}:f?void 0:{display:"none"},className:je("tl-video",`tl-video-shape-${e.id.split(":")[1]}`,{"tl-video-is-fullscreen":m}),width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:i&&r,onLoadedData:b,hidden:!f,children:p.jsx("source",{src:u})}),!f&&o&&p.jsx(o,{})]}):null:p.jsx(q$,{})})})}),"url"in e.props&&e.props.url&&p.jsx(ud,{url:e.props.url})]})}),J$=[Gm,Nm,zm,Bm,Km,Hm,$m,Lm,Fm,Ky,Um,qm];function cle(t){return t.sideEffects.register({instance_page_state:{afterChange:(e,n)=>{if(e.croppingShapeId!==n.croppingShapeId){const r=t.isIn("select.crop");!e.croppingShapeId&&n.croppingShapeId?r||t.setCurrentTool("select.crop.idle"):e.croppingShapeId&&!n.croppingShapeId&&r&&t.setCurrentTool("select.idle")}if(e.editingShapeId!==n.editingShapeId)if(!e.editingShapeId&&n.editingShapeId){if(!t.isIn("select.editing_shape")){const r=t.getEditingShape();r&&r.type==="text"&&t.isInAny("text.pointing","select.resizing")&&t.getInstanceState().isToolLocked?t.setCurrentTool("select.editing_shape",{isCreatingTextWhileToolLocked:!0}):t.setCurrentTool("select.editing_shape")}}else e.editingShapeId&&!n.editingShapeId&&t.isIn("select.editing_shape")&&t.setCurrentTool("select.idle")}}})}class eB extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"scribbleId","id");O(this,"markId","");O(this,"excludedShapeIds",new Set)}onEnter(n){this.markId=this.editor.markHistoryStoppingPoint("erase scribble begin"),this.info=n;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(s=>{if(this.editor.isShapeOrAncestorLocked(s))return!0;if(this.editor.isShapeOfType(s,"group")||this.editor.isShapeOfType(s,"frame")){const o=this.editor.getPointInShapeSpace(s,r);return this.editor.getShapeGeometry(s).bounds.containsPoint(o)}return!1}).map(s=>s.id));const i=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=i.id,this.update()}pushPointToScribble(){const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)}onExit(){this.editor.setErasingShapes([]),this.editor.scribbles.stop(this.scribbleId)}onPointerMove(){this.update()}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.complete()}update(){const{editor:n,excludedShapeIds:r}=this,i=n.getErasingShapeIds(),s=n.getZoomLevel(),o=n.getCurrentPageRenderingShapesSorted(),{inputs:{currentPagePoint:l,previousPagePoint:u}}=n;this.pushPointToScribble();const d=new Set(i),f=this.editor.options.hitTestMargin/s;for(const g of o){if(n.isShapeOfType(g,"group"))continue;const m=n.getShapeMask(g.id);if(m&&!Ci(l,m))continue;const S=n.getShapeGeometry(g),b=n.getShapePageTransform(g);if(!S||!b)continue;const v=b.clone().invert(),w=v.applyToPoint(u),C=v.applyToPoint(l),{bounds:_}=S;_.minX-f>Math.max(w.x,C.x)||_.minY-f>Math.max(w.y,C.y)||_.maxX+f<Math.min(w.x,C.x)||_.maxY+f<Math.min(w.y,C.y)||S.hitTestLineSegment(w,C,f)&&d.add(n.getOutermostSelectableShape(g).id)}this.editor.setErasingShapes([...d].filter(g=>!r.has(g)))}complete(){const{editor:n}=this;n.deleteShapes(n.getCurrentPageState().erasingShapeIds),this.parent.transition("idle")}cancel(){const{editor:n}=this;n.bailToMark(this.markId),this.parent.transition("idle",this.info)}}O(eB,"id","erasing");var K1;let ule=(K1=class extends Ae{onPointerDown(e){this.parent.transition("pointing",e)}onCancel(){this.editor.setCurrentTool("select")}},O(K1,"id","idle"),K1);var G1;let dle=(G1=class extends Ae{onEnter(){const e=this.editor.getZoomLevel(),n=this.editor.getCurrentPageRenderingShapesSorted(),{inputs:{currentPagePoint:r}}=this.editor,i=new Set,s=i.size;for(let o=n.length,l=o-1;l>=0;l--){const u=n[l];if(!(this.editor.isShapeOrAncestorLocked(u)||this.editor.isShapeOfType(u,"group"))&&this.editor.isPointInShape(u,r,{hitInside:!1,margin:this.editor.options.hitTestMargin/e})){const d=this.editor.getOutermostSelectableShape(u);if(this.editor.isShapeOfType(d,"frame")&&i.size>s)break;i.add(d.id)}}this.editor.setErasingShapes([...i])}onLongPress(e){this.startErasing(e)}onExit(e,n){n!=="erasing"&&this.editor.setErasingShapes([])}onPointerMove(e){this.editor.inputs.isDragging&&this.startErasing(e)}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.complete()}onInterrupt(){this.cancel()}startErasing(e){this.parent.transition("erasing",e)}complete(){const e=this.editor.getErasingShapeIds();e.length&&(this.editor.markHistoryStoppingPoint("erase end"),this.editor.deleteShapes(e)),this.parent.transition("idle")}cancel(){this.parent.transition("idle")}},O(G1,"id","pointing"),G1);class Ym extends Ae{static children(){return[ule,dle,eB]}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}}O(Ym,"id","eraser"),O(Ym,"initial","idle"),O(Ym,"isLockable",!1);class tB extends Ae{constructor(){super(...arguments);O(this,"initialCamera",new T)}onEnter(){this.initialCamera=T.From(this.editor.getCamera()),this.update()}onPointerMove(){this.update()}onPointerUp(){this.complete()}onCancel(){this.parent.transition("idle")}onComplete(){this.complete()}update(){const{initialCamera:n,editor:r}=this,{currentScreenPoint:i,originScreenPoint:s}=r.inputs,o=T.Sub(i,s).div(r.getZoomLevel());o.len2()!==0&&r.setCamera(n.clone().add(o))}complete(){const{editor:n}=this,{pointerVelocity:r}=n.inputs,i=Math.min(r.len(),2);i>.1&&this.editor.slideCamera({speed:i,direction:r}),this.parent.transition("idle")}}O(tB,"id","dragging");var q1;let hle=(q1=class extends Ae{onEnter(){this.editor.setCursor({type:"grab",rotation:0})}onPointerDown(e){this.parent.transition("pointing",e)}onCancel(){this.editor.setCurrentTool("select")}},O(q1,"id","idle"),q1);var Y1;let fle=(Y1=class extends Ae{onEnter(){this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing",rotation:0})}onLongPress(){this.startDragging()}onPointerMove(){this.editor.inputs.isDragging&&this.startDragging()}startDragging(){this.parent.transition("dragging")}onPointerUp(){this.complete()}onCancel(){this.complete()}onComplete(){this.complete()}onInterrupt(){this.complete()}complete(){this.parent.transition("idle")}},O(Y1,"id","pointing"),Y1);class Vm extends Ae{static children(){return[hle,fle,tB]}onDoubleClick(e){if(e.phase==="settle"){const{currentScreenPoint:n}=this.editor.inputs;this.editor.zoomIn(n,{animation:{duration:220,easing:Kn.easeOutQuint}})}}onTripleClick(e){if(e.phase==="settle"){const{currentScreenPoint:n}=this.editor.inputs;this.editor.zoomOut(n,{animation:{duration:320,easing:Kn.easeOutQuint}})}}onQuadrupleClick(e){if(e.phase==="settle"){const n=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:r}}=this.editor;n===1?this.editor.zoomToFit({animation:{duration:400,easing:Kn.easeOutQuint}}):this.editor.resetZoom(r,{animation:{duration:320,easing:Kn.easeOutQuint}})}}}O(Vm,"id","hand"),O(Vm,"initial","idle"),O(Vm,"isLockable",!1);var V1;let ple=(V1=class extends Ae{onPointerDown(e){this.parent.transition("lasering",e)}},O(V1,"id","idle"),V1);class nB extends Ae{constructor(){super(...arguments);O(this,"scribbleId","id")}onEnter(){const n=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:this.editor.options.laserDelayMs,shrink:.05,taper:!0});this.scribbleId=n.id,this.pushPointToScribble()}onExit(){this.editor.scribbles.stop(this.scribbleId)}onPointerMove(){this.pushPointToScribble()}onPointerUp(){this.complete()}pushPointToScribble(){const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)}onCancel(){this.cancel()}onComplete(){this.complete()}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}O(nB,"id","lasering");class Wm extends Ae{static children(){return[ple,nB]}onEnter(){this.editor.setCursor({type:"cross",rotation:0})}}O(Wm,"id","laser"),O(Wm,"initial","idle"),O(Wm,"isLockable",!1);class rB extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"initialSelectedShapeIds",[]);O(this,"excludedShapeIds",new Set);O(this,"isWrapMode",!1);O(this,"initialStartShape",null)}onEnter(n){const{altKey:r,currentPagePoint:i}=this.editor.inputs;if(this.isWrapMode=this.editor.user.getIsWrapMode(),r){this.parent.transition("scribble_brushing",n);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(s=>this.editor.isShapeOfType(s,"group")||this.editor.isShapeOrAncestorLocked(s)).map(s=>s.id)),this.info=n,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(i)[0],this.hitTestShapes()}onExit(){this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})}onTick({elapsed:n}){const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(n)}onPointerMove(){this.hitTestShapes()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(n){this.editor.setSelectedShapes(this.initialSelectedShapeIds),this.parent.transition("idle",n)}onKeyDown(n){this.editor.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()}onKeyUp(){this.hitTestShapes()}complete(){this.hitTestShapes(),this.parent.transition("idle")}hitTestShapes(){const{editor:n,excludedShapeIds:r,isWrapMode:i}=this,{inputs:{originPagePoint:s,currentPagePoint:o,shiftKey:l,ctrlKey:u}}=n,d=new Set(l?this.initialSelectedShapeIds:[]),f=i?!u:u,g=xe.FromPoints([s,o]),{corners:m}=g;let S,b,v,w,C,_;const M=n.getCurrentPageRenderingShapesSorted(),I=n.getCurrentPageId();e:for(let D=0,L=M.length;D<L;D++){if(v=M[D],r.has(v.id)||d.has(v.id)||(w=n.getShapePageBounds(v),!w))continue e;if(g.contains(w)){this.handleHit(v,o,I,d,m);continue e}if(f||n.isShapeOfType(v,"frame"))continue e;if(g.collides(w)){if(C=n.getShapePageTransform(v),!C)continue e;_=C.clone().invert().applyToPoints(m);const G=n.getShapeGeometry(v);t:for(let k=0;k<4;k++)if(S=_[k],b=_[(k+1)%4],G.hitTestLineSegment(S,b,0)){this.handleHit(v,o,I,d,m);break t}}}const A=n.getInstanceState().brush;(!A||!g.equals(A))&&n.updateInstanceState({brush:{...g.toJson()}});const R=n.getSelectedShapeIds();(R.length!==d.size||R.some(D=>!d.has(D)))&&n.setSelectedShapes(Array.from(d))}onInterrupt(){this.editor.updateInstanceState({brush:null})}handleHit(n,r,i,s,o){if(n.parentId===i){s.add(n.id);return}const l=this.editor.getOutermostSelectableShape(n),u=this.editor.getShapeMask(l.id);u&&!C2(u,o)&&!Ci(r,u)||s.add(l.id)}}O(rB,"id","brushing");const hd={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class iB extends Ae{constructor(){super(...arguments);O(this,"info",{})}updateCursor(){const n=this.editor.getSelectedShapes(),r=hd[this.info.handle];this.editor.setCursor({type:r,rotation:n.length===1?this.editor.getSelectionRotation():0})}onEnter(n){this.info=n,this.updateCursor()}onPointerMove(){this.editor.inputs.isDragging&&this.startResizing()}onLongPress(){this.startResizing()}startResizing(){this.editor.getIsReadonly()||this.parent.transition("resizing",this.info)}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}O(iB,"id","pointing_resize_handle");class DE extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"markId","");O(this,"snapshot",{})}onEnter(n){this.info=n,this.markId=this.editor.markHistoryStoppingPoint("cropping"),this.snapshot=this.createSnapshot(),this.updateShapes()}onPointerMove(){this.updateShapes()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(){this.cancel()}updateCursor(){if(!this.editor.getSelectedShapes()[0])return;const r=hd[this.info.handle];this.editor.setCursor({type:r,rotation:this.editor.getSelectionRotation()})}updateShapes(){var m;const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n)return;const i=this.editor.getShapeUtil(n.type);if(!i)return;const s=this.editor.inputs.currentPagePoint.clone().sub(r),o=this.editor.inputs.originPagePoint.clone().sub(r),l=s.clone().sub(o).rot(-n.rotation),u=n.props.crop??Gae(),d={w:1/(u.bottomRight.x-u.topLeft.x)*n.props.w,h:1/(u.bottomRight.y-u.topLeft.y)*n.props.h},g=(((m=i.onCrop)==null?void 0:m.bind(i))??qae)(n,{handle:this.info.handle,change:l,crop:u,uncroppedSize:d,initialShape:this.snapshot.shape});g&&(this.editor.updateShapes([{id:n.id,type:n.type,...g}]),this.updateCursor())}complete(){this.updateShapes(),qt(this.editor,[this.snapshot.shape.id]),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}createSnapshot(){const n=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,i=this.editor.getOnlySelectedShape(),s=this.editor.getSelectionRotatedPageBounds(),o=T.RotWith(s.getHandlePoint(this.info.handle),s.point,n),l=T.Sub(r,o);return{shape:i,cursorHandleOffset:l}}}O(DE,"id","cropping");function sB(t,e=!1){const n=t.getZoomLevel(),{inputs:{currentPagePoint:r}}=t;return t.getShapeAtPoint(r,{hitInside:!1,hitLabels:e,margin:t.options.hitTestMargin/n,renderingOnly:!0})??t.getSelectedShapeAtPoint(r)}function oB(t,e,n){if(!e)throw Error("Needs to translate a cropped shape!");const{crop:r}=e.props;if(!r)return;const i=t.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;i==="x"?n.x=0:i==="y"&&(n.y=0),n.rot(-e.rotation);const{w:s,h:o}=Ff(e.props,r),l=r.bottomRight.y-r.topLeft.y,u=r.bottomRight.x-r.topLeft.x,d=Xt(r);return d.topLeft.x=Math.min(1-u,Math.max(0,d.topLeft.x-n.x/s)),d.topLeft.y=Math.min(1-l,Math.max(0,d.topLeft.y-n.y/o)),d.bottomRight.x=d.topLeft.x+u,d.bottomRight.y=d.topLeft.y+l,{id:e.id,type:e.type,props:{crop:d}}}var W1;let gle=(W1=class extends Ae{onEnter(){this.editor.setCursor({type:"default",rotation:0});const e=this.editor.getOnlySelectedShape();e&&this.editor.setCroppingShape(e.id)}onExit(){this.editor.setCursor({type:"default",rotation:0})}onCancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}onPointerDown(e){var n;if(e.accelKey){this.cancel(),this.editor.root.handleEvent(e);return}switch(e.target){case"canvas":{const r=sB(this.editor);if(r&&!this.editor.isShapeOfType(r,"group")){this.onPointerDown({...e,shape:r,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(e);break}case"shape":{if(e.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",e);return}else(n=this.editor.getShapeUtil(e.shape))!=null&&n.canCrop(e.shape)?(this.editor.setCroppingShape(e.shape.id),this.editor.setSelectedShapes([e.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",e)):(this.cancel(),this.editor.root.handleEvent(e));break}case"selection":{switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...e,onInteractionEnd:"select.crop.idle"});break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.crop.pointing_crop_handle",{...e,onInteractionEnd:"select.crop.idle"});break}default:this.cancel()}break}}}onDoubleClick(e){var s;if(this.editor.inputs.shiftKey||e.phase!=="up")return;const n=this.editor.getCroppingShapeId();if(!n)return;const r=this.editor.getShape(n);if(!r)return;const i=this.editor.getShapeUtil(r);if(i){if(e.target==="selection"){(s=i.onDoubleClickEdge)==null||s.call(i,r);return}this.cancel(),this.editor.root.handleEvent(e)}}onKeyDown(){this.nudgeCroppingImage(!1)}onKeyRepeat(){this.nudgeCroppingImage(!0)}onKeyUp(e){switch(e.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(e=!1){const{editor:{inputs:{keys:n}}}=this,r=n.has("ShiftLeft"),i=new T(0,0);if(n.has("ArrowLeft")&&(i.x+=1),n.has("ArrowRight")&&(i.x-=1),n.has("ArrowUp")&&(i.y+=1),n.has("ArrowDown")&&(i.y-=1),i.equals(new T(0,0)))return;r&&i.mul(10);const s=this.editor.getShape(this.editor.getCroppingShapeId());if(!s)return;const o=oB(this.editor,s,i);o&&(e||this.editor.markHistoryStoppingPoint("translate crop"),this.editor.updateShapes([o]))}},O(W1,"id","idle"),W1);class aB extends Ae{onCancel(){this.editor.setCurrentTool("select.crop.idle",{})}onPointerMove(e){this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",e)}onPointerUp(e){this.editor.setCurrentTool("select.crop.idle",e)}}O(aB,"id","pointing_crop");class LE extends Ae{constructor(){super(...arguments);O(this,"info",{})}onEnter(n){this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];if(!r)return;const i=hd[this.info.handle];this.editor.setCursor({type:i,rotation:this.editor.getSelectionRotation()}),this.editor.setCroppingShape(r.id)}onExit(){this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0)}onPointerMove(){this.editor.inputs.isDragging&&this.startCropping()}onLongPress(){this.startCropping()}startCropping(){this.editor.getIsReadonly()||this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})}onPointerUp(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}}O(LE,"id","pointing_crop_handle");class lB extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"markId","");O(this,"snapshot",{})}onEnter(n){this.info=n,this.snapshot=this.createSnapshot(),this.markId=this.editor.markHistoryStoppingPoint("translating_crop"),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()}onExit(){this.editor.setCursor({type:"default",rotation:0})}onPointerMove(){this.updateShapes()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(){this.cancel()}onKeyDown(n){switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}}onKeyUp(n){switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:i}=this.editor.inputs,s=i.clone().sub(r),o=oB(this.editor,n,s);o&&this.editor.updateShapes([o])}}O(lB,"id","translating_crop");class n_ extends Ae{constructor(){super(...arguments);O(this,"markId","");O(this,"didExit",!1)}static children(){return[gle,lB,aB,LE,DE]}onEnter(){this.didExit=!1,this.markId=this.editor.markHistoryStoppingPoint("crop")}onExit(){this.didExit||(this.didExit=!0,this.editor.squashToMark(this.markId))}onCancel(){this.didExit||(this.didExit=!0,this.editor.bailToMark(this.markId))}}O(n_,"id","crop"),O(n_,"initial","idle");class cB extends Ae{constructor(){super(...arguments);O(this,"shapeId","");O(this,"initialHandle",{});O(this,"initialAdjacentHandle",null);O(this,"initialPagePoint",{});O(this,"markId","");O(this,"initialPageTransform");O(this,"initialPageRotation");O(this,"info",{});O(this,"isPrecise",!1);O(this,"isPreciseId",null);O(this,"pointingId",null);O(this,"exactTimeout",-1)}onEnter(n){const{shape:r,isCreating:i,creatingMarkId:s,handle:o}=n;if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.shapeId=r.id,this.markId="",i)if(s)this.markId=s;else{const d=this.editor.getMarkIdMatching(`creating:${this.editor.getOnlySelectedShapeId()}`);d&&(this.markId=d)}else this.markId=this.editor.markHistoryStoppingPoint("dragging handle");if(this.initialHandle=Xt(o),this.editor.isShapeOfType(r,"line")&&this.initialHandle.type==="create"){this.editor.updateShape({...r,props:{points:{...r.props.points,[o.index]:{id:o.index,index:o.index,x:o.x,y:o.y}}}});const f=this.editor.getShapeHandles(r).find(g=>g.index===o.index);this.initialHandle=Xt(f)}this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.setCursor({type:i?"cross":"grabbing",rotation:0});const l=this.editor.getShapeHandles(r).sort(vr),u=l.findIndex(d=>d.id===n.handle.id);this.initialAdjacentHandle=null;for(let d=u+1;d<l.length;d++){const f=l[d];if(f.type==="vertex"&&f.id!=="middle"&&f.id!==n.handle.id){this.initialAdjacentHandle=f;break}}if(!this.initialAdjacentHandle)for(let d=l.length-1;d>=0;d--){const f=l[d];if(f.type==="vertex"&&f.id!=="middle"&&f.id!==n.handle.id){this.initialAdjacentHandle=f;break}}if(this.editor.isShapeOfType(r,"arrow")){const d=ei(this.editor,r)[n.handle.id];this.isPrecise=!1,d?(this.editor.setHintingShapes([d.toId]),this.isPrecise=d.props.isPrecise,this.isPrecise?this.isPreciseId=d.toId:this.resetExactTimeout()):this.editor.setHintingShapes([])}this.update(),this.editor.select(this.shapeId)}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}onPointerMove(){this.update()}onKeyDown(){this.update()}onKeyUp(){this.update()}onPointerUp(){this.complete()}onComplete(){this.update(),this.complete()}onCancel(){this.cancel()}onExit(){this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0})}complete(){this.editor.snaps.clearIndicators(),qt(this.editor,[this.shapeId]);const{onInteractionEnd:n}=this.info;if(this.editor.getInstanceState().isToolLocked&&n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators();const{onInteractionEnd:n}=this.info;if(n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var D;const{editor:n,shapeId:r,initialPagePoint:i}=this,{initialHandle:s,initialPageRotation:o,initialAdjacentHandle:l}=this,u=this.editor.getHintingShapeIds(),d=this.editor.user.getIsSnapMode(),{snaps:f,inputs:{currentPagePoint:g,shiftKey:m,ctrlKey:S,altKey:b,pointerVelocity:v}}=n,w=this.info.shape,C=n.getShape(r);if(!C)return;const _=n.getShapeUtil(C);let M=g.clone().sub(i).rot(-o).add(s);if(m&&l&&s.id!=="middle"){const L=T.Angle(l,M),k=hy(L,24)-L;M=T.RotWith(M,l,k)}n.snaps.clearIndicators();let I={...s,x:M.x,y:M.y};if(s.canSnap&&(d?!S:S)){if(!n.getShapePageTransform(C.id))throw Error("Expected a page transform");const G=f.handles.snapHandle({currentShapeId:r,handle:I});G&&(G.nudge.rot(-n.getShapeParentTransform(C).rotation()),M.add(G.nudge),I={...s,x:M.x,y:M.y})}const A=(D=_.onHandleDrag)==null?void 0:D.call(_,C,{handle:I,isPrecise:this.isPrecise||b,initial:w}),R={id:C.id,type:C.type,...A};if(s.type==="vertex"&&this.editor.isShapeOfType(C,"arrow")){const L=ei(n,C)[s.id];L?u[0]!==L.toId&&(n.setHintingShapes([L.toId]),this.pointingId=L.toId,this.isPrecise=v.len()<.5||b,this.isPreciseId=this.isPrecise?L.toId:null,this.resetExactTimeout()):u.length>0&&(n.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}A&&n.updateShapes([R])}}O(cB,"id","dragging_handle");function uB(t){return t.isLabel?[t]:t instanceof ns?t.children.filter(e=>e.isLabel):[]}class dB extends Ae{constructor(){super(...arguments);O(this,"hitShapeForPointerUp",null);O(this,"info",{})}onEnter(n){const r=this.editor.getEditingShape();if(!r)throw Error("Entered editing state without an editing shape");this.hitShapeForPointerUp=null,this.info=n,n.isCreatingTextWhileToolLocked&&this.parent.setCurrentToolIdMask("text"),da(this.editor),this.editor.select(r)}onExit(){var s;const{editingShapeId:n}=this.editor.getCurrentPageState();if(!n)return;this.editor.setEditingShape(null),da.cancel();const r=this.editor.getShape(n),i=this.editor.getShapeUtil(r);(s=i.onEditEnd)==null||s.call(i,r),this.info.isCreatingTextWhileToolLocked&&(this.parent.setCurrentToolIdMask(void 0),this.editor.setCurrentTool("text",{}))}onPointerMove(n){if(this.hitShapeForPointerUp&&this.editor.inputs.isDragging){if(this.editor.getIsReadonly()||this.hitShapeForPointerUp.isLocked)return;this.editor.select(this.hitShapeForPointerUp),this.parent.transition("translating",n),this.hitShapeForPointerUp=null;return}switch(n.target){case"shape":case"canvas":{da(this.editor);return}}}onPointerDown(n){switch(this.hitShapeForPointerUp=null,n.target){case"shape":{const{shape:r}=n,i=this.editor.getEditingShape();if(!i)throw Error("Expected an editing shape!");const s=this.editor.getShapeUtil(r).getGeometry(r),o=uB(s),l=o.length===1?o[0]:void 0,u=this.editor.isShapeOfType(i,"text")&&i.props.text.trim()==="";if(l&&!u){const d=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(l.bounds.containsPoint(d,0)&&l.hitTestPoint(d)){if(r.id===i.id)return;this.hitShapeForPointerUp=r,this.editor.markHistoryStoppingPoint("editing on pointer up"),this.editor.select(r.id);return}}else{if(r.id===i.id)this.editor.isShapeOfType(r,"frame")&&(this.editor.setEditingShape(null),this.parent.transition("idle",n));else{this.parent.transition("pointing_shape",n);return}return}break}}this.parent.transition("idle",n),this.editor.root.handleEvent(n)}onPointerUp(n){const r=this.hitShapeForPointerUp;if(!r)return;this.hitShapeForPointerUp=null;const i=this.editor.getShapeUtil(r);if(!r.isLocked){if(this.editor.getIsReadonly()&&!i.canEditInReadOnly(r)){this.parent.transition("pointing_shape",n);return}this.editor.select(r.id),this.editor.setEditingShape(r.id),da(this.editor)}}onComplete(n){this.parent.transition("idle",n)}onCancel(n){this.parent.transition("idle",n)}}O(dB,"id","editing_shape");function Ej(t){const e=t.getOnlySelectedShape();return!!(e&&!t.isShapeOrAncestorLocked(e)&&t.getShapeUtil(e).canCrop(e))}function Gy(t,e){const n=t.getSelectedShapeIds(),{currentPagePoint:r}=t.inputs,{shiftKey:i,altKey:s,accelKey:o}=e,l=i||o,u=t.getShapeAtPoint(r,{hitInside:!1,margin:t.options.hitTestMargin/t.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:d=>!d.isLocked});if(u){const d=t.getOutermostSelectableShape(u);if(l&&!s)t.cancelDoubleClick(),n.includes(d.id)?(t.markHistoryStoppingPoint("deselecting shape"),t.deselect(d)):(t.markHistoryStoppingPoint("shift selecting shape"),t.setSelectedShapes([...n,d.id]));else{let f;d===u||d.id===t.getFocusedGroupId()||n.includes(d.id)?f=u:f=d,f&&!n.includes(f.id)&&(t.markHistoryStoppingPoint("selecting shape"),t.select(f.id))}}else{if(l)return;{n.length>0&&(t.markHistoryStoppingPoint("selecting none"),t.selectNone());const d=t.getFocusedGroupId();if(Zr(d)){const f=t.getShape(d);t.isPointInShape(f,r,{margin:0,hitInside:!0})||t.setFocusedGroup(null)}}}}const mle=["Delete","Backspace","[","]","Enter"," ","Shift","Tab"];var X1;let yle=(X1=class extends Ae{onEnter(){this.parent.setCurrentToolIdMask(void 0),da(this.editor),this.editor.setCursor({type:"default",rotation:0})}onExit(){da.cancel()}onPointerMove(){da(this.editor)}onPointerDown(e){const n=e.ctrlKey&&Ej(this.editor);switch(e.target){case"canvas":{const r=sB(this.editor);if(r&&!r.isLocked){this.onPointerDown({...e,shape:r,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),s=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:o}}=this.editor;if((i.length>1||s&&!this.editor.getShapeUtil(s).hideSelectionBoundsBg(s))&&Pj(this.editor,o)){this.onPointerDown({...e,target:"selection"});return}this.parent.transition("pointing_canvas",e);break}case"shape":{const{shape:r}=e;if(this.isOverArrowLabelTest(r)){this.parent.transition("pointing_arrow_label",e);break}if(this.editor.isShapeOrAncestorLocked(r)){this.parent.transition("pointing_canvas",e);break}this.parent.transition("pointing_shape",e);break}case"handle":{if(this.editor.getIsReadonly())break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",e):this.parent.transition("pointing_handle",e);break}case"selection":{switch(e.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{if(e.accelKey){this.parent.transition("brushing",e);break}this.parent.transition("pointing_rotate_handle",e);break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{if(n)this.parent.transition("crop.pointing_crop_handle",e);else{if(e.accelKey){this.parent.transition("brushing",e);break}this.parent.transition("pointing_resize_handle",e)}break}default:{const r=this.editor.getHoveredShape();if(r&&!this.editor.getSelectedShapeIds().includes(r.id)&&!r.isLocked){this.onPointerDown({...e,shape:r,target:"shape"});return}this.parent.transition("pointing_selection",e)}}break}}}onDoubleClick(e){var n,r,i,s;if(!(this.editor.inputs.shiftKey||e.phase!=="up")&&!(e.ctrlKey||e.shiftKey))switch(e.target){case"canvas":{const o=this.editor.getHoveredShape(),l=o&&!this.editor.isShapeOfType(o,"group")?o:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1}),u=this.editor.getFocusedGroupId();if(l){if(this.editor.isShapeOfType(l,"group")){Gy(this.editor,e);return}else{const d=this.editor.getShape(l.parentId);if(d&&this.editor.isShapeOfType(d,"group")&&!(u&&d.id===u)){Gy(this.editor,e);return}}this.onDoubleClick({...e,shape:l,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(e);break}case"selection":{if(this.editor.getIsReadonly())break;const o=this.editor.getOnlySelectedShape();if(o){const l=this.editor.getShapeUtil(o);if(!this.canInteractWithShapeInReadOnly(o))return;if(e.handle==="right"||e.handle==="left"||e.handle==="top"||e.handle==="bottom"){const u=(n=l.onDoubleClickEdge)==null?void 0:n.call(l,o);if(u){this.editor.markHistoryStoppingPoint("double click edge"),this.editor.updateShapes([u]),qt(this.editor,[o.id]);return}}if(l.canCrop(o)&&!this.editor.isShapeOrAncestorLocked(o)){this.parent.transition("crop",e);return}this.shouldStartEditingShape(o)&&this.startEditingShape(o,e,!0)}break}case"shape":{const{shape:o}=e,l=this.editor.getShapeUtil(o);if(o.type!=="video"&&o.type!=="embed"&&this.editor.getIsReadonly())break;if(l.onDoubleClick){const u=(r=l.onDoubleClick)==null?void 0:r.call(l,o);if(u){this.editor.updateShapes([u]);return}}if(l.canCrop(o)&&!this.editor.isShapeOrAncestorLocked(o)){this.editor.markHistoryStoppingPoint("select and crop"),this.editor.select((i=e.shape)==null?void 0:i.id),this.parent.transition("crop",e);return}this.shouldStartEditingShape(o)?this.startEditingShape(o,e,!0):this.handleDoubleClickOnCanvas(e);break}case"handle":{if(this.editor.getIsReadonly())break;const{shape:o,handle:l}=e,u=this.editor.getShapeUtil(o),d=(s=u.onDoubleClickHandle)==null?void 0:s.call(u,o,l);d?this.editor.updateShapes([d]):this.shouldStartEditingShape(o)&&this.startEditingShape(o,e,!0)}}}onRightClick(e){switch(e.target){case"canvas":{const n=this.editor.getHoveredShape(),r=n&&!this.editor.isShapeOfType(n,"group")?n:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitLocked:!0,hitFrameInside:!0,renderingOnly:!0});if(r){this.onRightClick({...e,shape:r,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),s=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:o}}=this.editor;if((i.length>1||s&&!this.editor.getShapeUtil(s).hideSelectionBoundsBg(s))&&Pj(this.editor,o)){this.onRightClick({...e,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:n}=this.editor.getCurrentPageState(),{shape:r}=e,i=this.editor.getOutermostSelectableShape(r,s=>!n.includes(s.id));!n.includes(i.id)&&!this.editor.findShapeAncestor(i,s=>n.includes(s.id))&&(this.editor.markHistoryStoppingPoint("selecting shape"),this.editor.setSelectedShapes([i.id]));break}}}onCancel(){this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.markHistoryStoppingPoint("clearing selection"),this.editor.selectNone())}onKeyDown(e){switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);return}}if(xn.editOnType.get()&&!mle.includes(e.key)&&!e.altKey&&!e.ctrlKey){const n=this.editor.getOnlySelectedShape();if(n&&this.editor.isShapeOfType(n,"note")&&this.shouldStartEditingShape(n)){this.startEditingShape(n,{...e,target:"shape",shape:n},!0);return}}}onKeyRepeat(e){switch(e.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}}onKeyUp(e){switch(e.code){case"Enter":{const n=this.editor.getSelectedShapes();if(n.every(i=>this.editor.isShapeOfType(i,"group"))){this.editor.setSelectedShapes(n.flatMap(i=>this.editor.getSortedChildIdsForParent(i.id)));return}const r=this.editor.getOnlySelectedShape();if(r&&this.shouldStartEditingShape(r)){this.startEditingShape(r,{...e,target:"shape",shape:r},!0);return}Ej(this.editor)&&this.parent.transition("crop",e);break}}}shouldStartEditingShape(e=this.editor.getOnlySelectedShape()){return!e||this.editor.isShapeOrAncestorLocked(e)&&e.type!=="embed"||!this.canInteractWithShapeInReadOnly(e)?!1:this.editor.getShapeUtil(e).canEdit(e)}startEditingShape(e,n,r){this.editor.isShapeOrAncestorLocked(e)&&e.type!=="embed"||(this.editor.markHistoryStoppingPoint("editing shape"),Ly(this.editor,e,r),this.parent.transition("editing_shape",n))}isOverArrowLabelTest(e){if(!e)return!1;const n=this.editor.getPointInShapeSpace(e,this.editor.inputs.currentPagePoint);if(this.editor.isShapeOfType(e,"arrow")){const r=this.editor.getShapeGeometry(e).children[1];if(r&&Ci(n,r.vertices))return!0}return!1}handleDoubleClickOnCanvas(e){if(this.editor.getIsReadonly()||!this.editor.options.createTextOnCanvasDoubleClick)return;this.editor.markHistoryStoppingPoint("creating text shape");const n=Lt(),{x:r,y:i}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:n,type:"text",x:r,y:i,props:{text:"",autoSize:!0}}]);const s=this.editor.getShape(n);if(!s)return;const o=this.editor.getShapeUtil(s);this.editor.getIsReadonly()&&!o.canEditInReadOnly(s)||(this.editor.setEditingShape(n),this.editor.select(n),this.parent.transition("editing_shape",e))}nudgeSelectedShapes(e=!1){const{editor:{inputs:{keys:n}}}=this,r=n.has("ShiftLeft"),i=new T(0,0);if(n.has("ArrowLeft")&&(i.x-=1),n.has("ArrowRight")&&(i.x+=1),n.has("ArrowUp")&&(i.y-=1),n.has("ArrowDown")&&(i.y+=1),i.equals(new T(0,0)))return;e||this.editor.markHistoryStoppingPoint("nudge shapes");const{gridSize:s}=this.editor.getDocumentSettings(),o=this.editor.getInstanceState().isGridMode?r?s*ble:s:r?Sle:vle,l=this.editor.getSelectedShapeIds();this.editor.nudgeShapes(l,i.mul(o)),qt(this.editor,l)}canInteractWithShapeInReadOnly(e){return!!(!this.editor.getIsReadonly()||this.editor.getShapeUtil(e).canEditInReadOnly(e))}},O(X1,"id","idle"),X1);const Sle=10,vle=1,ble=5;function Pj(t,e){const n=t.getSelectionRotatedPageBounds();if(!n)return!1;const r=t.getSelectionRotation();return r?Ci(e,n.corners.map(i=>T.RotWith(i,n.point,r))):n.containsPoint(e)}class hB extends Ae{constructor(){super(...arguments);O(this,"shapeId","");O(this,"markId","");O(this,"wasAlreadySelected",!1);O(this,"didDrag",!1);O(this,"didCtrlOnEnter",!1);O(this,"info",{});O(this,"_labelDragOffset",new T(0,0))}updateCursor(){this.editor.setCursor({type:"grabbing",rotation:0})}onEnter(n){const{shape:r}=n;this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.shapeId=r.id,this.didDrag=!1,this.didCtrlOnEnter=n.accelKey,this.wasAlreadySelected=this.editor.getOnlySelectedShapeId()===r.id,this.updateCursor();const s=this.editor.getShapeGeometry(r).children[1];if(!s)throw Error(`Expected to find an arrow label geometry for shape: ${r.id}`);const{currentPagePoint:o}=this.editor.inputs,l=this.editor.getPointInShapeSpace(r,o);if(this._labelDragOffset=T.Sub(s.center,l),this.markId=this.editor.markHistoryStoppingPoint("label-drag start"),n.shiftKey||n.accelKey){const d=this.editor.getSelectedShapeIds();this.editor.setSelectedShapes([...d,this.shapeId]);return}this.editor.setSelectedShapes([this.shapeId])}onExit(){this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})}onPointerMove(){const{isDragging:n}=this.editor.inputs;if(!n)return;if(this.didCtrlOnEnter){this.parent.transition("brushing",this.info);return}const r=this.editor.getShape(this.shapeId);if(!r)return;const i=ao(this.editor,r),s=this.editor.getShapeGeometry(r),o=s.children[0],l=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint),u=o.nearestPoint(T.Add(l,this._labelDragOffset));let d;if(i.isStraight){const f=T.Dist(i.start.point,i.end.point);d=1-T.Dist(i.end.point,u)/f}else{const{_center:f,measure:g,angleEnd:m,angleStart:S}=s.children[0];d=iC(g,S,m,f.angle(u))}isNaN(d)&&(d=.5),this.didDrag=!0,this.editor.updateShape({id:r.id,type:r.type,props:{labelPosition:d}})}onPointerUp(){const n=this.editor.getShape(this.shapeId);n&&(this.didDrag||!this.wasAlreadySelected?this.complete():this.editor.getIsReadonly()||(this.editor.setEditingShape(n.id),this.editor.setCurrentTool("select.editing_shape")))}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}O(hB,"id","pointing_arrow_label");class fB extends Ae{onEnter(e){e.shiftKey||e.accelKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.markHistoryStoppingPoint("selecting none"),this.editor.selectNone())}onPointerMove(e){this.editor.inputs.isDragging&&this.parent.transition("brushing",e)}onPointerUp(e){Gy(this.editor,e),this.complete()}onComplete(){this.complete()}onInterrupt(){this.parent.transition("idle")}complete(){this.parent.transition("idle")}}O(fB,"id","pointing_canvas");class pB extends Ae{constructor(){super(...arguments);O(this,"didCtrlOnEnter",!1);O(this,"info",{})}onEnter(n){this.info=n,this.didCtrlOnEnter=n.accelKey;const{shape:r}=n;if(this.editor.isShapeOfType(r,"arrow")){const i=ei(this.editor,r)[n.handle.id];i&&this.editor.setHintingShapes([i.toId])}this.editor.setCursor({type:"grabbing",rotation:0})}onExit(){this.editor.setHintingShapes([]),this.editor.setCursor({type:"default",rotation:0})}onPointerUp(){const{shape:n,handle:r}=this.info;if(this.editor.isShapeOfType(n,"note")){const{editor:i}=this,s=Tj(i,n,r,!1);if(s){Ly(i,s,!0);return}}this.parent.transition("idle",this.info)}onPointerMove(n){const{editor:r}=this;r.inputs.isDragging&&(this.didCtrlOnEnter?this.parent.transition("brushing",n):this.startDraggingHandle())}onLongPress(){this.startDraggingHandle()}startDraggingHandle(){const{editor:n}=this;if(n.getIsReadonly())return;const{shape:r,handle:i}=this.info;if(n.isShapeOfType(r,"note")){const s=Tj(n,r,i,!0);if(s){const o=n.getPointInParentSpace(s,n.inputs.originPagePoint).sub(T.Rot(XS.clone().mul(r.props.scale),s.rotation));n.updateShape({...s,x:o.x,y:o.y}),n.setHoveredShape(s.id).select(s.id).setCurrentTool("select.translating",{...this.info,target:"shape",shape:n.getShape(s),onInteractionEnd:"note",isCreating:!0,onCreate:()=>{Ly(n,s,!0)}});return}}this.parent.transition("dragging_handle",this.info)}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}cancel(){this.parent.transition("idle")}}O(pB,"id","pointing_handle");function Tj(t,e,n,r){const i=t.getShapePageTransform(e.id),s=i.point(),o=i.rotation(),u=I$(t,s,o,e.props.growY*e.props.scale,0,e.props.scale)[n.index];if(u)return A$(t,e,u,o,r)}class gB extends Ae{constructor(){super(...arguments);O(this,"info",{})}updateCursor(){this.editor.setCursor({type:hd[this.info.handle],rotation:this.editor.getSelectionRotation()})}onEnter(n){this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.updateCursor()}onExit(){this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})}onPointerMove(){this.editor.inputs.isDragging&&this.startRotating()}onLongPress(){this.startRotating()}startRotating(){this.editor.getIsReadonly()||this.parent.transition("rotating",this.info)}onPointerUp(){this.complete()}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}O(gB,"id","pointing_rotate_handle");class mB extends Ae{constructor(){super(...arguments);O(this,"info",{})}onEnter(n){this.info=n}onPointerUp(n){Gy(this.editor,n),this.parent.transition("idle",n)}onPointerMove(n){this.editor.inputs.isDragging&&this.startTranslating(n)}onLongPress(n){this.startTranslating(n)}startTranslating(n){this.editor.getIsReadonly()||this.parent.transition("translating",n)}onDoubleClick(n){var s,o;const r=this.editor.getHoveredShape(),i=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(i){this.parent.transition("idle"),(o=(s=this.parent).onDoubleClick)==null||o.call(s,{...n,target:"shape",shape:this.editor.getShape(i)});return}}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}cancel(){this.parent.transition("idle")}}O(mB,"id","pointing_selection");class yB extends Ae{constructor(){super(...arguments);O(this,"hitShape",{});O(this,"hitShapeForPointerUp",{});O(this,"isDoubleClick",!1);O(this,"didCtrlOnEnter",!1);O(this,"didSelectOnEnter",!1)}onEnter(n){const r=this.editor.getSelectedShapeIds(),i=this.editor.getSelectionRotatedPageBounds(),s=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:o}}=this.editor,{shiftKey:l,altKey:u,accelKey:d}=n;this.hitShape=n.shape,this.isDoubleClick=!1,this.didCtrlOnEnter=d;const f=this.editor.getOutermostSelectableShape(n.shape),g=this.editor.findShapeAncestor(f,m=>r.includes(m.id));if(this.didCtrlOnEnter||this.editor.getShapeUtil(n.shape).onClick||f.id===s||r.includes(f.id)||g||r.length>1&&(i!=null&&i.containsPoint(o))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=f;return}this.didSelectOnEnter=!0,l&&!u?(this.editor.cancelDoubleClick(),r.includes(f.id)||(this.editor.markHistoryStoppingPoint("shift selecting shape"),this.editor.setSelectedShapes([...r,f.id]))):(this.editor.markHistoryStoppingPoint("selecting shape"),this.editor.setSelectedShapes([f.id]))}onPointerUp(n){var f;const r=this.editor.getSelectedShapeIds(),i=this.editor.getFocusedGroupId(),s=this.editor.getZoomLevel(),{inputs:{currentPagePoint:o}}=this.editor,l=n.shiftKey||n.accelKey,u=this.editor.getShapeAtPoint(o,{margin:this.editor.options.hitTestMargin/s,hitInside:!0,renderingOnly:!0})??this.hitShape,d=u?this.editor.getOutermostSelectableShape(u):this.hitShapeForPointerUp;if(d){const g=this.editor.getShapeUtil(d);if(g.onClick){const m=(f=g.onClick)==null?void 0:f.call(g,d);if(m){this.editor.markHistoryStoppingPoint("shape on click"),this.editor.updateShapes([m]),this.parent.transition("idle",n);return}}if(d.id===i){r.length>0?(this.editor.markHistoryStoppingPoint("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",n);return}}if(!this.didSelectOnEnter){const g=this.editor.getOutermostSelectableShape(u,m=>!r.includes(m.id));if(r.includes(g.id))if(l)this.editor.markHistoryStoppingPoint("deselecting on pointer up"),this.editor.deselect(d);else if(r.includes(d.id)){if(r.length===1){const m=this.editor.getShapeUtil(d).getGeometry(d),S=uB(m),b=S.length===1?S[0]:void 0;if(b){const v=this.editor.getPointInShapeSpace(d,o);if(b.bounds.containsPoint(v,0)&&b.hitTestPoint(v)){this.editor.run(()=>{this.editor.markHistoryStoppingPoint("editing on pointer up"),this.editor.select(d.id);const w=this.editor.getShapeUtil(d);this.editor.getIsReadonly()&&!w.canEditInReadOnly(d)||(this.editor.setEditingShape(d.id),this.editor.setCurrentTool("select.editing_shape"),this.isDoubleClick&&this.editor.emit("select-all-text",{shapeId:d.id}))});return}}}this.editor.markHistoryStoppingPoint("selecting on pointer up"),this.editor.select(d.id)}else this.editor.markHistoryStoppingPoint("selecting on pointer up"),this.editor.select(d);else if(l){const m=this.editor.getShapeAncestors(g);this.editor.markHistoryStoppingPoint("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(S=>!m.find(b=>b.id===S)),g.id])}else this.editor.markHistoryStoppingPoint("selecting on pointer up"),this.editor.setSelectedShapes([g.id])}this.parent.transition("idle",n)}onDoubleClick(){this.isDoubleClick=!0}onPointerMove(n){this.editor.inputs.isDragging&&(this.didCtrlOnEnter?this.parent.transition("brushing",n):this.startTranslating(n))}onLongPress(n){this.startTranslating(n)}startTranslating(n){this.editor.getIsReadonly()||(this.editor.focus(),this.parent.transition("translating",n))}onCancel(){this.cancel()}onComplete(){this.cancel()}onInterrupt(){this.cancel()}cancel(){this.parent.transition("idle")}}O(yB,"id","pointing_shape");class SB extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"markId","");O(this,"didHoldCommand",!1);O(this,"creationCursorOffset",{x:0,y:0});O(this,"snapshot",{})}onEnter(n){const{isCreating:r=!1,creatingMarkId:i,creationCursorOffset:s={x:0,y:0}}=n;if(this.info=n,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.creationCursorOffset=s,this.snapshot=this._createSnapshot(),this.markId="",r)if(i)this.markId=i;else{const o=this.editor.getMarkIdMatching(`creating:${this.editor.getOnlySelectedShapeId()}`);o&&(this.markId=o)}else this.markId=this.editor.markHistoryStoppingPoint("starting resizing");r&&this.editor.setCursor({type:"cross",rotation:0}),this.handleResizeStart(),this.updateShapes()}onTick({elapsed:n}){const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(n)}onPointerMove(){this.updateShapes()}onKeyDown(){this.updateShapes()}onKeyUp(){this.updateShapes()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(){this.cancel()}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var n,r;if(qt(this.editor,this.snapshot.selectedShapeIds),this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(n=this.info).onCreate)==null||r.call(n,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:i})=>{var l;const s=this.editor.getShapeUtil(i),o=(l=s.onResizeStart)==null?void 0:l.call(s,i);o&&r.push(o)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:i})=>{var u;const s=this.editor.getShape(i.id),o=this.editor.getShapeUtil(i),l=(u=o.onResizeEnd)==null?void 0:u.call(o,i,s);l&&r.push(l)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.editor.inputs,{frames:i,shapeSnapshots:s,selectionBounds:o,cursorHandleOffset:l,selectedShapeIds:u,selectionRotation:d,canShapesDeform:f}=this.snapshot;let g=r||!f;if(s.size===1){const L=[...s.values()][0];this.editor.isShapeOfType(L.shape,"text")&&(g=!(this.info.handle==="left"||this.info.handle==="right"))}const{ctrlKey:m}=this.editor.inputs,S=this.editor.inputs.currentPagePoint.clone().sub(l).sub(this.creationCursorOffset),b=this.editor.inputs.originPagePoint.clone().sub(l);if(this.editor.getInstanceState().isGridMode&&!m){const{gridSize:L}=this.editor.getDocumentSettings();S.snapToGrid(L)}const v=this.info.handle,w=Ij(v,Math.PI);if(this.editor.snaps.clearIndicators(),(this.editor.user.getIsSnapMode()?!m:m)&&d%Yt===0){const{nudge:L}=this.editor.snaps.shapeBounds.snapResizeShapes({dragDelta:T.Sub(S,b),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:Ij(v,d),isAspectRatioLocked:g,isResizingFromCenter:n});S.add(L)}const _=T.RotWith(n?o.center:o.getHandlePoint(w),o.point,d),M=T.Sub(S,_).rot(-d),I=T.Sub(b,_).rot(-d),A=T.DivV(M,I);Number.isFinite(A.x)||(A.x=1),Number.isFinite(A.y)||(A.y=1);const R=v==="top"||v==="bottom",D=v==="left"||v==="right";g?D?A.y=Math.abs(A.x):R?A.x=Math.abs(A.y):Math.abs(A.x)>Math.abs(A.y)?A.y=Math.abs(A.x)*(A.y<0?-1:1):A.x=Math.abs(A.y)*(A.x<0?-1:1):(R&&(A.x=1),D&&(A.y=1)),this.info.isCreating||this.updateCursor({dragHandle:v,isFlippedX:A.x<0,isFlippedY:A.y<0,rotation:d});for(const L of s.keys()){const G=s.get(L);this.editor.resizeShape(L,A,{initialShape:G.shape,initialBounds:G.bounds,initialPageTransform:G.pageTransform,dragHandle:v,mode:u.length===1&&L===u[0]?"resize_bounds":"scale_shape",scaleOrigin:_,isAspectRatioLocked:g,scaleAxisRotation:d,skipStartAndEndCallbacks:!0})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:L,children:G}of i){if(!G.length)continue;const k=s.get(L).shape,$=this.editor.getShape(L);if(!(k&&$))continue;const F=$.x-k.x,N=$.y-k.y,B=new T(F,N).rot(-k.rotation);if(B.x!==0||B.y!==0)for(const Y of G)this.editor.updateShape({id:Y.id,type:Y.type,x:Y.x-B.x,y:Y.y-B.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:L}of i)if(L.length)for(const G of L)this.editor.updateShape({id:G.id,type:G.type,x:G.x,y:G.y})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:i,rotation:s}){const o={...this.editor.getInstanceState().cursor};switch(n){case"top_left":case"bottom_right":{o.type="nwse-resize",r!==i&&(o.type="nesw-resize");break}case"top_right":case"bottom_left":{o.type="nesw-resize",r!==i&&(o.type="nwse-resize");break}}o.rotation=s,this.editor.setCursor(o)}onExit(){this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0}),this.editor.snaps.clearIndicators()}_createSnapshot(){const n=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:i}}=this.editor,s=this.editor.getSelectionRotatedPageBounds(),o=T.RotWith(s.getHandlePoint(this.info.handle),s.point,r),l=T.Sub(i,o),u=new Map,d=[];n.forEach(g=>{const m=this.editor.getShape(g);if(m){if(m.type==="frame"&&d.push({id:g,children:We(this.editor.getSortedChildIdsForParent(m).map(S=>this.editor.getShape(S)))}),u.set(m.id,this._createShapeSnapshot(m)),this.editor.isShapeOfType(m,"frame")&&n.length===1)return;this.editor.visitDescendants(m.id,S=>{const b=this.editor.getShape(S);if(b&&(u.set(b.id,this._createShapeSnapshot(b)),this.editor.isShapeOfType(b,"frame")))return!1})}});const f=![...u.values()].some(g=>!F5(g.pageRotation,r)||g.isAspectRatioLocked);return{shapeSnapshots:u,selectionBounds:s,cursorHandleOffset:l,selectionRotation:r,selectedShapeIds:n,canShapesDeform:f,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:d}}_createShapeSnapshot(n){const r=this.editor.getShapePageTransform(n),i=this.editor.getShapeUtil(n);return{shape:n,bounds:this.editor.getShapeGeometry(n).bounds,pageTransform:r,pageRotation:be.Decompose(r).rotation,isAspectRatioLocked:i.isAspectRatioLocked(n)}}}O(SB,"id","resizing");const S1=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function Ij(t,e){e=e%It;const n=Math.round(e/(yt/4)),r=S1.indexOf(t);return S1[(r+n)%S1.length]}const Mj=Math.PI/180;class vB extends Ae{constructor(){super(...arguments);O(this,"snapshot",{});O(this,"info",{});O(this,"markId","")}onEnter(n){this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.markId=this.editor.markHistoryStoppingPoint("rotate start");const r=V4({editor:this.editor,ids:this.editor.getSelectedShapeIds()});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r;const i=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Pm({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:hd[this.info.handle],rotation:i+this.snapshot.initialShapesRotation})}onExit(){this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}}onPointerMove(){this.update()}onKeyDown(){this.update()}onKeyUp(){this.update()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(){this.cancel()}update(){const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Pm({editor:this.editor,delta:n,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:hd[this.info.handle],rotation:n+this.snapshot.initialShapesRotation})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)}complete(){Pm({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),qt(this.editor,this.snapshot.shapeSnapshots.map(n=>n.shape.id)),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)}_getRotationFromPointerPosition({snapToNearestDegree:n}){const r=this.editor.getSelectionRotation(),i=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:s,currentPagePoint:o}}=this.editor,{initialCursorAngle:l,initialShapesRotation:u}=this.snapshot;if(!i)return u;const f=i.center.clone().rotWith(i.point,r).angle(o)-l;let g=u+f;if(s)g=hy(g,24);else if(n&&(g=Math.round(g/Mj)*Mj,this.editor.getInstanceState().isCoarsePointer)){const m=hy(g,4),S=xm(g,m);Math.abs(S)<uG(5)&&(g=m)}return g-u}}O(vB,"id","rotating");class bB extends Ae{constructor(){super(...arguments);O(this,"hits",new Set);O(this,"size",0);O(this,"scribbleId","id");O(this,"initialSelectedShapeIds",new Set);O(this,"newlySelectedShapeIds",new Set)}onEnter(){this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const n=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=n.id,this.updateScribbleSelection(!0),this.editor.updateInstanceState({brush:null})}onExit(){this.editor.scribbles.stop(this.scribbleId)}onPointerMove(){this.updateScribbleSelection(!0)}onPointerUp(){this.complete()}onKeyDown(){this.updateScribbleSelection(!1)}onKeyUp(){this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")}onCancel(){this.cancel()}onComplete(){this.complete()}pushPointToScribble(){const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)}updateScribbleSelection(n){const{editor:r}=this,i=this.editor.getCurrentPageRenderingShapesSorted(),{inputs:{shiftKey:s,originPagePoint:o,previousPagePoint:l,currentPagePoint:u}}=this.editor,{newlySelectedShapeIds:d,initialSelectedShapeIds:f}=this;n&&this.pushPointToScribble();const g=i;let m,S,b,v;const w=0;for(let M=0,I=g.length;M<I;M++){if(m=g[M],r.isShapeOfType(m,"group")||d.has(m.id)||r.isShapeOrAncestorLocked(m)||(S=r.getShapeGeometry(m),r.isShapeOfType(m,"frame")&&S.bounds.containsPoint(r.getPointInShapeSpace(m,o))))continue;const A=r.getShapePageTransform(m);if(!S||!A)continue;const R=A.clone().invert();b=R.applyToPoint(l),v=R.applyToPoint(u);const{bounds:D}=S;if(!(D.minX-w>Math.max(b.x,v.x)||D.minY-w>Math.max(b.y,v.y)||D.maxX+w<Math.min(b.x,v.x)||D.maxY+w<Math.min(b.y,v.y))&&S.hitTestLineSegment(b,v,w)){const L=this.editor.getOutermostSelectableShape(m),G=this.editor.getShapeMask(L.id);if(G&&x2(l,u,G)!==null&&!Ci(u,G))continue;d.add(L.id)}}const C=r.getSelectedShapeIds(),_=new Set(s?[...d,...f]:[...d]);(C.length!==_.size||C.some(M=>!_.has(M)))&&this.editor.setSelectedShapes(Array.from(_))}complete(){this.updateScribbleSelection(!0),this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds]),this.parent.transition("idle")}}O(bB,"id","scribble_brushing");var xle=Object.create,xB=Object.defineProperty,wle=Object.getOwnPropertyDescriptor,Cle=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),wB=t=>{throw TypeError(t)},CB=(t,e,n)=>e in t?xB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_le=t=>[,,,xle(null)],_B=["class","method","getter","setter","accessor","field","value","get","set"],EB=t=>t!==void 0&&typeof t!="function"?wB("Function expected"):t,Ele=(t,e,n,r,i)=>({kind:_B[t],name:e,metadata:r,addInitializer:s=>n._?wB("Already initialized"):i.push(EB(s||null))}),Ple=(t,e)=>CB(e,Cle("metadata"),t[3]),Tle=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},Ile=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=_B[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,wle(i,n)),C=r.length-1;C>=0;C--)u=Ele(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,EB(o)&&(w[b]=o);return w&&xB(i,n,w),i},v1=(t,e,n)=>CB(t,typeof e!="symbol"?e+"":e,n),PB,tv;const Mle=20,Ale=100;PB=[ni];class NE{constructor(e){this.editor=e,Tle(tv,5,this),v1(this,"prevDroppingShapeId",null),v1(this,"droppingNodeTimer",null),v1(this,"first",!0),e.disposables.add(this.dispose)}updateDroppingNode(e,n){var r;this.first&&(this.editor.setHintingShapes(e.map(i=>this.editor.findShapeAncestor(i,s=>s.type!=="group")).filter(i=>i)),this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,e))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(e,Mle,n):this.editor.inputs.pointerVelocity.len()>.5&&(clearTimeout(this.droppingNodeTimer),this.setDragTimer(e,Ale,n))}setDragTimer(e,n,r){this.droppingNodeTimer=this.editor.timers.setTimeout(()=>{this.editor.run(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,e,r)}),this.droppingNodeTimer=null},n)}handleDrag(e,n,r){var u,d,f,g,m;n=We(n.map(S=>this.editor.getShape(S.id)));const i=((u=this.editor.getDroppingOverShape(e,n))==null?void 0:u.id)??null;if(i===this.prevDroppingShapeId){this.hintParents(n);return}const{prevDroppingShapeId:s}=this,o=s&&this.editor.getShape(s),l=i&&this.editor.getShape(i);o&&((f=(d=this.editor.getShapeUtil(o)).onDragShapesOut)==null||f.call(d,o,n)),l&&((m=(g=this.editor.getShapeUtil(l)).onDragShapesOver)==null||m.call(g,l,n)),this.hintParents(n),r==null||r(),this.prevDroppingShapeId=i}hintParents(e){const n=new Map;for(const i of e){const s=this.editor.findShapeAncestor(i,o=>o.type!=="group");s&&(n.has(s.id)||n.set(s.id,[]),n.get(s.id).push(i.id))}const r=[];for(const[i,s]of n){const o=this.editor.getShape(i);o&&I8(this.editor,o).length<s.length&&r.push(o.id)}this.editor.setHintingShapes(r)}dropShapes(e){var r,i;const{prevDroppingShapeId:n}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,e),n){const s=this.editor.getShape(n);if(!s)return;(i=(r=this.editor.getShapeUtil(s)).onDropShapesOver)==null||i.call(r,s,e)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearTimeout(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}dispose(){this.clear()}}tv=_le();Ile(tv,1,"dispose",PB,NE);Ple(tv,NE);var kle=Object.create,TB=Object.defineProperty,Rle=Object.getOwnPropertyDescriptor,IB=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),MB=t=>{throw TypeError(t)},AB=(t,e,n)=>e in t?TB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ole=t=>[,,,kle((t==null?void 0:t[IB("metadata")])??null)],kB=["class","method","getter","setter","accessor","field","value","get","set"],RB=t=>t!==void 0&&typeof t!="function"?MB("Function expected"):t,jle=(t,e,n,r,i)=>({kind:kB[t],name:e,metadata:r,addInitializer:s=>n._?MB("Already initialized"):i.push(RB(s||null))}),Dle=(t,e)=>AB(e,IB("metadata"),t[3]),Lle=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},Nle=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=kB[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,Rle(i,n)),C=r.length-1;C>=0;C--)u=jle(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,RB(o)&&(w[b]=o);return w&&TB(i,n,w),i},al=(t,e,n)=>AB(t,typeof e!="symbol"?e+"":e,n),OB,r_,nv;class rv extends(r_=Ae,OB=[ni],r_){constructor(){super(...arguments),Lle(nv,5,this),al(this,"info",{}),al(this,"selectionSnapshot",{}),al(this,"snapshot",{}),al(this,"markId",""),al(this,"isCloning",!1),al(this,"isCreating",!1),al(this,"dragAndDropManager",new NE(this.editor))}onCreate(e){}onEnter(e){var s;const{isCreating:n=!1,creatingMarkId:r,onCreate:i=()=>{}}=e;if(!((s=this.editor.getSelectedShapeIds())!=null&&s.length)){this.parent.transition("idle");return}if(this.info=e,this.parent.setCurrentToolIdMask(e.onInteractionEnd),this.isCreating=n,this.markId="",n)if(r)this.markId=r;else{const o=this.editor.getMarkIdMatching(`creating:${this.editor.getOnlySelectedShapeId()}`);o&&(this.markId=o)}else this.markId=this.editor.markHistoryStoppingPoint("translating");if(this.onCreate=i,this.isCloning=!1,this.info=e,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=Aj(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()}onExit(){this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0}),this.dragAndDropManager.clear()}onTick({elapsed:e}){const{editor:n}=this;this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),n.edgeScrollManager.updateEdgeScrolling(e)}onPointerMove(){this.updateShapes()}onKeyDown(){if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()}onKeyUp(){if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()}onPointerUp(){this.complete()}onComplete(){this.complete()}onCancel(){this.cancel()}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId=this.editor.markHistoryStoppingPoint("translate cloning"),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=Aj(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId=this.editor.markHistoryStoppingPoint("translate"),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var e;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),qt(this.editor,this.snapshot.movingShapes.map(n=>n.id)),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(e=this.onCreate)==null||e.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:e}=this.snapshot,n=[];e.forEach(r=>{var o;const i=this.editor.getShapeUtil(r),s=(o=i.onTranslateStart)==null?void 0:o.call(i,r);s&&n.push(s)}),n.length>0&&this.editor.updateShapes(n),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:e}=this.snapshot;if(this.isCloning&&e.length>0){const r=T.Average(e.map(s=>this.editor.getShapePageTransform(s.id).point())),i=T.Sub(r,this.selectionSnapshot.averagePagePoint);T.IsNaN(i)||this.editor.updateInstanceState({duplicateProps:{shapeIds:e.map(s=>s.id),offset:{x:i.x,y:i.y}}})}const n=[];e.forEach(r=>{var l;const i=this.editor.getShape(r.id),s=this.editor.getShapeUtil(r),o=(l=s.onTranslateEnd)==null?void 0:l.call(s,r,i);o&&n.push(o)}),n.length>0&&this.editor.updateShapes(n)}updateShapes(){const{snapshot:e}=this;this.dragAndDropManager.updateDroppingNode(e.movingShapes,this.updateParentTransforms),zle({editor:this.editor,snapshot:e});const{movingShapes:n}=e,r=[];n.forEach(i=>{var u;const s=this.editor.getShape(i.id),o=this.editor.getShapeUtil(i),l=(u=o.onTranslate)==null?void 0:u.call(o,i,s);l&&r.push(l)}),r.length>0&&this.editor.updateShapes(r)}updateParentTransforms(){const{editor:e,snapshot:{shapeSnapshots:n}}=this;n.forEach(r=>{const i=e.getShape(r.shape.id);if(!i)return null;const s=Vr(i.parentId)?null:be.Inverse(e.getShapePageTransform(i.parentId));r.parentTransform=s})}}nv=Ole(r_);Nle(nv,1,"updateParentTransforms",OB,rv);Dle(nv,rv);al(rv,"id","translating");function Aj(t){var g;const e=[],n=[],r=t.getSelectedShapeIds(),i=We(r.map(m=>{const S=t.getShape(m);if(!S)return null;e.push(S);const b=t.getShapePageTransform(m),v=b.point(),w=b.rotation();n.push(v);const C=Ai.isId(S.parentId)?null:be.Inverse(t.getShapePageTransform(S.parentId));return{shape:S,pagePoint:v,pageRotation:w,parentTransform:C}})),s=t.getOnlySelectedShape();let o=[];if(s)o=t.snaps.shapeBounds.getSnapPoints(s.id);else{const m=t.getSelectionPageBounds();m&&(o=m.cornersAndCenter.map((S,b)=>({id:"selection:"+b,x:S.x,y:S.y})))}let l,u;const{originPagePoint:d}=t.inputs,f=i.filter(m=>t.isShapeOfType(m.shape,"note")&&t.isPointInShape(m.shape,d));if(f.length!==0)if(f.length===1)u=f[0];else{const m=t.getCurrentPageShapesSorted();u=(g=f.map(S=>({snapshot:S,index:m.findIndex(b=>b.id===S.shape.id)})).sort((S,b)=>b.index-S.index)[0])==null?void 0:g.snapshot}return u&&(l=M$(t,u.pageRotation,u.shape.props.scale,u.shape.props.growY??0)),{averagePagePoint:T.Average(n),movingShapes:e,shapeSnapshots:i,initialPageBounds:t.getSelectionPageBounds(),initialSnapPoints:o,noteAdjacentPositions:l,noteSnapshot:u}}function zle({editor:t,snapshot:e}){const{inputs:n}=t,{noteSnapshot:r,noteAdjacentPositions:i,initialPageBounds:s,initialSnapPoints:o,shapeSnapshots:l,averagePagePoint:u}=e,d=t.getInstanceState().isGridMode,f=t.getDocumentSettings().gridSize,g=T.Sub(n.currentPagePoint,n.originPagePoint),m=t.inputs.shiftKey?Math.abs(g.x)<Math.abs(g.y)?"x":"y":null;m==="x"?g.x=0:m==="y"&&(g.y=0),t.snaps.clearIndicators();const S=t.user.getIsSnapMode()?!n.ctrlKey:n.ctrlKey;let b=!1;if(S&&t.inputs.pointerVelocity.len()<.5){const{nudge:_}=t.snaps.shapeBounds.snapTranslateShapes({dragDelta:g,initialSelectionPageBounds:s,lockedAxis:m,initialSelectionSnapPoints:o});g.add(_)}else if(r&&i){const{scale:_}=r.shape.props,M=r.pagePoint.clone().add(g).add(XS.clone().mul(_).rot(r.pageRotation));let I=T$/t.getZoomLevel(),A=new T(0,0);for(const R of i){const D=T.Sub(M,R),L=D.len();L<I&&(b=!0,I=L,A=D)}g.sub(A)}const v=T.Add(u,g),w=t.snaps.getIndicators();d&&!n.ctrlKey&&!b&&w.length===0&&v.snapToGrid(f);const C=T.Sub(v,u);t.updateShapes(We(l.map(({shape:_,pagePoint:M,parentTransform:I})=>{const A=T.Add(M,C),R=I?be.applyToPoint(I,A):A;return{id:_.id,type:_.type,x:R.x,y:R.y}})))}class Xm extends Ae{constructor(){super(...arguments);O(this,"reactor")}static children(){return[n_,DE,yle,fB,yB,rv,rB,bB,LE,mB,iB,dB,SB,vB,gB,hB,pB,cB]}cleanUpDuplicateProps(){const n=this.editor.getSelectedShapeIds(),r=this.editor.getInstanceState();if(!r.duplicateProps)return;const i=new Set(r.duplicateProps.shapeIds);n.length===i.size&&n.every(s=>i.has(s))||this.editor.updateInstanceState({duplicateProps:null})}onEnter(){this.reactor=co("clean duplicate props",()=>{try{this.cleanUpDuplicateProps()}catch(n){console.error(n)}})}onExit(){var n;(n=this.reactor)==null||n.call(this),this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)}}O(Xm,"id","select"),O(Xm,"initial","idle"),O(Xm,"isLockable",!1);class jB extends Ae{constructor(){super(...arguments);O(this,"info",{})}onEnter(n){this.info=n}onPointerDown(){this.parent.transition("pointing",this.info)}}O(jB,"id","idle");class DB extends Ae{constructor(){super(...arguments);O(this,"info",{})}onEnter(n){this.info=n}onPointerUp(){this.complete()}onPointerMove(){this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)}onCancel(){this.cancel()}complete(){const{currentScreenPoint:n}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(n,{animation:{duration:220}}):this.editor.zoomIn(n,{animation:{duration:220}}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}O(DB,"id","pointing");class LB extends Ae{constructor(){super(...arguments);O(this,"info",{});O(this,"zoomBrush",new xe)}onEnter(n){this.info=n,this.update()}onExit(){this.editor.updateInstanceState({zoomBrush:null})}onPointerMove(){this.update()}onPointerUp(){this.complete()}onCancel(){this.cancel()}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(xe.FromPoints([n,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.editor.getZoomLevel();if(n.width<r&&n.height<r){const i=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(i,{animation:{duration:220}}):this.editor.zoomIn(i,{animation:{duration:220}})}else{const i=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(n,{targetZoom:i,animation:{duration:220}})}this.parent.transition("idle",this.info)}}O(LB,"id","zoom_brushing");class Zm extends Ae{constructor(){super(...arguments);O(this,"info",{})}static children(){return[jB,LB,DB]}onEnter(n){this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.updateCursor()}onExit(){this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}}),this.parent.setCurrentToolIdMask(void 0)}onKeyDown(){this.updateCursor()}onKeyUp(n){this.updateCursor(),n.code==="KeyZ"&&this.complete()}onInterrupt(){this.complete()}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out",rotation:0}):this.editor.setCursor({type:"zoom-in",rotation:0})}}O(Zm,"id","zoom"),O(Zm,"initial","idle"),O(Zm,"isLockable",!1);const $le=[Ym,Vm,Wm,Zm,Xm];function Ble(){const t=re(),e=oe("follow",()=>t.getInstanceState().followingUserId,[t]);return e?p.jsx(Fle,{userId:e}):null}function Fle({userId:t}){const e=dS(t);return e?p.jsx("div",{className:"tlui-following-indicator",style:{borderColor:e.color}}):null}let i_={fonts:{draw:`${hl()}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`${hl()}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`${hl()}/fonts/IBMPlexSans-Medium.woff2`,monospace:`${hl()}/fonts/IBMPlexMono-Medium.woff2`}};function NB(t){return E.useMemo(()=>t?{fonts:{...i_.fonts,...t==null?void 0:t.fonts}}:i_,[t])}const Ule=["align-bottom","align-center-horizontal","align-center-vertical","align-left","align-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","blob","bring-forward","bring-to-front","broken","check-circle","check","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","color","cross-2","cross-circle","dash-dashed","dash-dotted","dash-draw","dash-solid","disconnected","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","fill-fill","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-heart","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","horizontal-align-end","horizontal-align-middle","horizontal-align-start","info-circle","leading","link","lock","menu","minus","mixed","pack","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","send-backward","send-to-back","share-1","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","stretch-horizontal","stretch-vertical","text-align-center","text-align-left","text-align-right","toggle-off","toggle-on","tool-arrow","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-screenshot","tool-text","trash","twitter","undo","ungroup","unlock","vertical-align-end","vertical-align-middle","vertical-align-start","warning-triangle","zoom-in","zoom-out"];let Wh={...i_,icons:Object.fromEntries(Ule.map(t=>[t,`${hl()}/icons/icon/0_merged.svg#${t}`])),translations:Object.fromEntries(Rf.map(t=>[t.locale,`${hl()}/translations/${t.locale}.json`])),embedIcons:Object.fromEntries(mE.map(t=>[t.type,`${hl()}/embed-icons/${t.type}.png`]))};function Hle(t){return t?{fonts:Object.assign({...Wh.fonts},{...t==null?void 0:t.fonts}),icons:Object.assign({...Wh.icons},{...t==null?void 0:t.icons}),embedIcons:Object.assign({...Wh.embedIcons},{...t==null?void 0:t.embedIcons}),translations:Object.assign({...Wh.translations},{...t==null?void 0:t.translations})}:Wh}var zE="Popover",[zB,qye]=_o(zE,[RS]),vp=RS(),[Kle,jl]=zB(zE),$B=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:o=!1}=t,l=vp(e),u=E.useRef(null),[d,f]=E.useState(!1),[g=!1,m]=Rl({prop:r,defaultProp:i,onChange:s});return p.jsx(Y2,{...l,children:p.jsx(Kle,{scope:e,contentId:ga(),triggerRef:u,open:g,onOpenChange:m,onOpenToggle:E.useCallback(()=>m(S=>!S),[m]),hasCustomAnchor:d,onCustomAnchorAdd:E.useCallback(()=>f(!0),[]),onCustomAnchorRemove:E.useCallback(()=>f(!1),[]),modal:o,children:n})})};$B.displayName=zE;var BB="PopoverAnchor",Gle=E.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=jl(BB,n),s=vp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=i;return E.useEffect(()=>(o(),()=>l()),[o,l]),p.jsx(V2,{...s,...r,ref:e})});Gle.displayName=BB;var FB="PopoverTrigger",UB=E.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=jl(FB,n),s=vp(n),o=Vt(e,i.triggerRef),l=p.jsx(gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":YB(i.open),...r,ref:o,onClick:Re(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?l:p.jsx(V2,{asChild:!0,...s,children:l})});UB.displayName=FB;var $E="PopoverPortal",[qle,Yle]=zB($E,{forceMount:void 0}),HB=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,s=jl($E,e);return p.jsx(qle,{scope:e,forceMount:n,children:p.jsx(Ns,{present:n||s.open,children:p.jsx(pp,{asChild:!0,container:i,children:r})})})};HB.displayName=$E;var fd="PopoverContent",KB=E.forwardRef((t,e)=>{const n=Yle(fd,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,s=jl(fd,t.__scopePopover);return p.jsx(Ns,{present:r||s.open,children:s.modal?p.jsx(Vle,{...i,ref:e}):p.jsx(Wle,{...i,ref:e})})});KB.displayName=fd;var Vle=E.forwardRef((t,e)=>{const n=jl(fd,t.__scopePopover),r=E.useRef(null),i=Vt(e,r),s=E.useRef(!1);return E.useEffect(()=>{const o=r.current;if(o)return W2(o)},[]),p.jsx(DS,{as:Ec,allowPinchZoom:!0,children:p.jsx(GB,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),s.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;s.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:Re(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),Wle=E.forwardRef((t,e)=>{const n=jl(fd,t.__scopePopover),r=E.useRef(!1),i=E.useRef(!1);return p.jsx(GB,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,s),s.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var u,d;(u=t.onInteractOutside)==null||u.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const o=s.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),GB=E.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:f,...g}=t,m=jl(fd,n),S=vp(n);return N2(),p.jsx(IS,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:p.jsx(hp,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:p.jsx(nz,{"data-state":YB(m.open),role:"dialog",id:m.contentId,...S,...g,ref:e,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),qB="PopoverClose",Xle=E.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=jl(qB,n);return p.jsx(gt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,()=>i.onOpenChange(!1))})});Xle.displayName=qB;var Zle="PopoverArrow",Qle=E.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=vp(n);return p.jsx(rz,{...i,...r,ref:e})});Qle.displayName=Zle;function YB(t){return t?"open":"closed"}var BE=$B,FE=UB,UE=HB,HE=KB;function KE({id:t,children:e,onOpenChange:n,open:r}){const[i,s]=Ea(t,n);return p.jsx(BE,{onOpenChange:s,open:r||i,children:p.jsx("div",{className:"tlui-popover",children:e})})}function GE({children:t}){return p.jsx(FE,{asChild:!0,dir:"ltr",children:t})}function qE({side:t,children:e,align:n="center",sideOffset:r=8,alignOffset:i=0,disableEscapeKeyDown:s=!1}){const o=zn();return p.jsx(UE,{container:o,children:p.jsx(HE,{className:"tlui-popover__content",side:t,sideOffset:r,align:n,alignOffset:i,dir:"ltr",onEscapeKeyDown:l=>s&&l.preventDefault(),children:e})})}function Jle(t){return t.getSelectedShapeIds().map(r=>t.getShape(r)).filter(r=>{if(!r)return!1;if(t.isShapeOfType(r,"arrow")){const i=ei(t,r);if(i.start||i.end)return!1}return!0})}const VB=()=>{const t=re();return oe("threeStackableItems",()=>Jle(t).length>2,[t])},Pa=()=>{const t=re();return oe("isInSelectState",()=>t.isIn("select"),[t])},WB=()=>{const t=re();return oe("allow group",()=>{const e=t.getSelectedShapes();if(e.length<2)return!1;for(const n of e)if(t.isShapeOfType(n,"arrow")){const r=ei(t,n);if(r.start&&!e.some(i=>i.id===r.start.toId)||r.end&&!e.some(i=>i.id===r.end.toId))return!1}return!0},[t])},XB=()=>{const t=re();return oe("allowUngroup",()=>t.getSelectedShapeIds().some(e=>{var n;return((n=t.getShape(e))==null?void 0:n.type)==="group"}),[t])},ece=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read;function ZB(t,e){const n=re();return oe("selectedShapes",()=>n.getSelectedShapes().length>=t,[n,t,e])}function $r(t,e){const n=re();return oe("selectedShapes",()=>{const r=n.getSelectedShapes().filter(i=>!n.isShapeOrAncestorLocked(i)).length;return t===void 0?r:r>=t},[n])}function tce(){const t=re();return oe("showAutoSizeToggle",()=>{const e=t.getSelectedShapes();return e.length===1&&t.isShapeOfType(e[0],"text")&&e[0].props.autoSize===!1},[t])}function QB(){const t=re();return oe("hasLinkShapeSelected",()=>{const e=t.getOnlySelectedShape();return!!(e&&e.type!=="embed"&&"url"in e.props&&!e.isLocked)},[t])}function nce(){const t=re();return oe("onlyFlippableShape",()=>{const e=t.getOnlySelectedShape();return e&&(t.isShapeOfType(e,"group")||t.isShapeOfType(e,"image")||t.isShapeOfType(e,"arrow")||t.isShapeOfType(e,"line")||t.isShapeOfType(e,"draw"))},[t])}function JB(){const t=re();return oe("useCanRedo",()=>t.getCanRedo(),[t])}function e9(){const t=re();return oe("useCanUndo",()=>t.getCanUndo(),[t])}function rce(){return p.jsxs(p.Fragment,{children:[p.jsx(ice,{}),p.jsx(sce,{}),p.jsx(oce,{}),p.jsx(ace,{}),p.jsx(lce,{}),p.jsx(dce,{}),p.jsx(hce,{}),p.jsx(fce,{})]})}function ice(){const t=$r(2),e=Pa(),n=t&&e;return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"align-left",disabled:!n}),p.jsx(fe,{actionId:"align-center-horizontal",disabled:!n}),p.jsx(fe,{actionId:"align-right",disabled:!n}),p.jsx(fe,{actionId:"stretch-horizontal",disabled:!n}),p.jsx(fe,{actionId:"align-top",disabled:!n}),p.jsx(fe,{actionId:"align-center-vertical",disabled:!n}),p.jsx(fe,{actionId:"align-bottom",disabled:!n}),p.jsx(fe,{actionId:"stretch-vertical",disabled:!n})]})}function sce(){const t=$r(3),e=Pa(),n=t&&e;return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"distribute-horizontal",disabled:!n}),p.jsx(fe,{actionId:"distribute-vertical",disabled:!n})]})}function oce(){const t=VB(),e=Pa(),n=t&&e;return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"stack-horizontal",disabled:!n}),p.jsx(fe,{actionId:"stack-vertical",disabled:!n})]})}function ace(){const t=$r(1),e=Pa(),n=t&&e;return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"send-to-back",disabled:!n}),p.jsx(fe,{actionId:"send-backward",disabled:!n}),p.jsx(fe,{actionId:"bring-forward",disabled:!n}),p.jsx(fe,{actionId:"bring-to-front",disabled:!n})]})}function lce(){return zr()<Sn.TABLET_SM?p.jsx(cce,{}):p.jsx(uce,{})}function cce(){const t=re(),e=oe("zoom is 1",()=>t.getZoomLevel()===1,[t]);return p.jsx(fe,{actionId:"zoom-to-100",disabled:e})}function uce(){const t=$r(1),e=Pa(),n=t&&e;return p.jsx(fe,{actionId:"rotate-ccw",disabled:!n})}function dce(){const t=$r(1),e=Pa(),n=t&&e;return p.jsx(fe,{actionId:"rotate-cw",disabled:!n})}function hce(){const t=QB(),e=Pa(),n=t&&e;return p.jsx(fe,{actionId:"edit-link",disabled:!n})}function fce(){const t=WB(),e=XB();return t?p.jsx(kj,{}):e?p.jsx(pce,{}):p.jsx(kj,{})}function kj(){const t=$r(2),e=Pa(),n=t&&e;return p.jsx(fe,{actionId:"group",disabled:!n})}function pce(){return p.jsx(fe,{actionId:"ungroup"})}const gce=E.memo(function({children:e}){const n=ut(),r=zr(),i=Ri(),s=E.useRef(null);kl(s);const o=re(),l=oe("should display quick actions when in readonly",()=>o.isInAny("hand","zoom"),[o]),u=e??p.jsx(rce,{});if(!(i&&!l))return p.jsxs(KE,{id:"actions-menu",children:[p.jsx(GE,{children:p.jsx($e,{type:"icon","data-testid":"actions-menu.button",title:n("actions-menu.title"),children:p.jsx(it,{icon:"dots-vertical",small:!0})})}),p.jsx(qE,{side:r>=Sn.TABLET?"bottom":"top",sideOffset:6,children:p.jsx("div",{ref:s,className:"tlui-actions-menu tlui-buttons__grid","data-testid":"actions-menu.content",children:p.jsx(rs,{type:"icons",sourceId:"actions-menu",children:u})})})]})});function t9(){return tce()?p.jsx(fe,{actionId:"toggle-auto-size"}):null}function n9(){return QB()?p.jsx(fe,{actionId:"edit-link"}):null}function mce(){return $r(1)?p.jsx(fe,{actionId:"duplicate"}):null}function r9(){const t=re();return oe("should display flatten option",()=>{if(t.getSelectedShapeIds().length===0)return!1;const r=t.getOnlySelectedShape();return!(r&&t.isShapeOfType(r,"image"))},[t])?p.jsx(fe,{actionId:"flatten-to-image"}):null}function i9(){return WB()?p.jsx(fe,{actionId:"group"}):null}function s9(){return XB()?p.jsx(fe,{actionId:"ungroup"}):null}function o9(){const t=re();return oe("allow unframe",()=>{const n=t.getSelectedShapes();return n.length===0?!1:n.every(r=>t.isShapeOfType(r,"frame"))},[t])?p.jsx(fe,{actionId:"remove-frame"}):null}function a9(){const t=re();return oe("allow fit frame to content",()=>{const n=t.getOnlySelectedShape();return n?t.isShapeOfType(n,"frame")&&t.getSortedChildIdsForParent(n).length>0:!1},[t])?p.jsx(fe,{actionId:"fit-frame-to-content"}):null}function l9(){const t=re();return oe("selected shapes",()=>t.getSelectedShapes().length>0,[t])?p.jsx(fe,{actionId:"toggle-lock"}):null}function YE(){const t=re(),e=oe("isTransparentBg",()=>!t.getInstanceState().exportBackground,[t]);return p.jsx($s,{actionId:"toggle-transparent",checked:e,toggle:!0})}function yce(){const t=re(),e=oe("any shapes",()=>t.getCurrentPageShapeIds().size>0,[t]);return p.jsx(fe,{actionId:"unlock-all",disabled:!e})}function c9(){const t=re(),e=oe("zoomed to 100",()=>t.getZoomLevel()===1,[t]);return p.jsx(fe,{actionId:"zoom-to-100",noClose:!0,disabled:e})}function u9(){const t=re(),e=oe("has shapes",()=>t.getCurrentPageShapeIds().size>0,[t]);return p.jsx(fe,{actionId:"zoom-to-fit",disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0})}function d9(){const t=re(),e=oe("has shapes",()=>t.getSelectedShapeIds().length>0,[t]);return p.jsx(fe,{actionId:"zoom-to-selection",disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})}function h9(){return p.jsxs(Qe,{id:"clipboard",children:[p.jsx(vce,{}),p.jsx(bce,{}),p.jsx(xce,{}),p.jsx(mce,{}),p.jsx(wce,{})]})}function Sce(){var n;const t=re(),e=oe("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t]);return p.jsxs(ci,{id:"copy-as",label:"context-menu.copy-as",size:"small",disabled:!e,children:[p.jsxs(Qe,{id:"copy-as-group",children:[p.jsx(fe,{actionId:"copy-as-svg"}),!!((n=window.navigator.clipboard)!=null&&n.write)&&p.jsx(fe,{actionId:"copy-as-png"})]}),p.jsx(Qe,{id:"copy-as-bg",children:p.jsx(YE,{})})]})}function vce(){const t=$r(1);return p.jsx(fe,{actionId:"cut",disabled:!t})}function bce(){const t=ZB(1);return p.jsx(fe,{actionId:"copy",disabled:!t})}function xce(){const t=ece;return p.jsx(fe,{actionId:"paste",disabled:!t})}function f9(){const t=re();return oe("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t])?p.jsxs(Qe,{id:"conversions",children:[p.jsx(Sce,{}),p.jsxs(ci,{id:"export-as",label:"context-menu.export-as",size:"small",children:[p.jsxs(Qe,{id:"export-as-group",children:[p.jsx(fe,{actionId:"export-as-svg"}),p.jsx(fe,{actionId:"export-as-png"})]}),p.jsx(Qe,{id:"export-as-bg",children:p.jsx(YE,{})})]})]}):null}function p9(){const t=re(),e=oe("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t]);return p.jsx(fe,{actionId:"select-all",disabled:!e})}function wce(){const t=$r(1);return p.jsx(fe,{actionId:"delete",disabled:!t})}function Cce(){const t=Ri();return!ZB(1)||t?null:p.jsxs(ci,{id:"edit",label:"context-menu.edit",size:"small",children:[p.jsx(i9,{}),p.jsx(s9,{}),p.jsx(r9,{}),p.jsx(n9,{}),p.jsx(a9,{}),p.jsx(o9,{}),p.jsx(m9,{}),p.jsx(g9,{}),p.jsx(t9,{}),p.jsx(l9,{})]})}function _ce(){const t=$r(2),e=nce();return Ri()||!(t||e)?null:p.jsxs(ci,{id:"arrange",label:"context-menu.arrange",size:"small",children:[t&&p.jsxs(Qe,{id:"align",children:[p.jsx(fe,{actionId:"align-left"}),p.jsx(fe,{actionId:"align-center-horizontal"}),p.jsx(fe,{actionId:"align-right"}),p.jsx(fe,{actionId:"align-top"}),p.jsx(fe,{actionId:"align-center-vertical"}),p.jsx(fe,{actionId:"align-bottom"})]}),p.jsx(Ece,{}),t&&p.jsxs(Qe,{id:"stretch",children:[p.jsx(fe,{actionId:"stretch-horizontal"}),p.jsx(fe,{actionId:"stretch-vertical"})]}),(t||e)&&p.jsxs(Qe,{id:"flip",children:[p.jsx(fe,{actionId:"flip-horizontal"}),p.jsx(fe,{actionId:"flip-vertical"})]}),p.jsx(Pce,{})]})}function Ece(){return $r(3)?p.jsxs(Qe,{id:"distribute",children:[p.jsx(fe,{actionId:"distribute-horizontal"}),p.jsx(fe,{actionId:"distribute-vertical"})]}):null}function Pce(){const t=$r(2),e=VB();return t?p.jsxs(Qe,{id:"order",children:[p.jsx(fe,{actionId:"pack"}),e&&p.jsx(fe,{actionId:"stack-horizontal"}),e&&p.jsx(fe,{actionId:"stack-vertical"})]}):null}function Tce(){const t=Ri(),e=$r(1);return t||!e?null:p.jsx(ci,{id:"reorder",label:"context-menu.reorder",size:"small",children:p.jsxs(Qe,{id:"reorder",children:[p.jsx(fe,{actionId:"bring-to-front"}),p.jsx(fe,{actionId:"bring-forward"}),p.jsx(fe,{actionId:"send-backward"}),p.jsx(fe,{actionId:"send-to-back"})]})})}function Ice(){const t=re(),e=oe("pages",()=>t.getPages(),[t]),n=oe("current page id",()=>t.getCurrentPageId(),[t]),{addToast:r}=_a(),i=or(),s=Ri();return!$r(1)||s?null:p.jsxs(ci,{id:"move-to-page",label:"context-menu.move-to-page",size:"small",children:[p.jsx(Qe,{id:"pages",children:e.map(l=>p.jsx(kn,{id:l.id,disabled:n===l.id,label:l.name.length>30?`${l.name.slice(0,30)}`:l.name,onSelect:()=>{t.markHistoryStoppingPoint("move_shapes_to_page"),t.moveShapesToPage(t.getSelectedShapeIds(),l.id);const u=t.getPage(l.id);u&&r({title:"Changed Page",description:`Moved to ${u.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.markHistoryStoppingPoint("change-page"),t.setCurrentPage(n)}}]}),i("move-to-page",{source:"context-menu"})}},l.id))}),p.jsx(Qe,{id:"new-page",children:p.jsx(fe,{actionId:"move-to-new-page"})})]})}function g9(){const t=re();return oe("oneEmbedSelected",()=>{const n=t.getOnlySelectedShape();return n?!!(t.isShapeOfType(n,"embed")&&n.props.url&&!t.isShapeOrAncestorLocked(n)):!1},[t])?p.jsx(fe,{actionId:"convert-to-bookmark"}):null}function m9(){const t=re(),e=yE();return oe("oneEmbeddableBookmarkSelected",()=>{const r=t.getOnlySelectedShape();return r?!!(t.isShapeOfType(r,"bookmark")&&r.props.url&&e(r.props.url)&&!t.isShapeOrAncestorLocked(r)):!1},[t])?p.jsx(fe,{actionId:"convert-to-embed"}):null}function Mce(){const t=re(),e=oe("isSnapMode",()=>t.user.getIsSnapMode(),[t]);return p.jsx($s,{actionId:"toggle-snap-mode",checked:e})}function Ace(){const t=re(),e=oe("isToolLock",()=>t.getInstanceState().isToolLocked,[t]);return p.jsx($s,{actionId:"toggle-tool-lock",checked:e})}function kce(){const t=re(),e=oe("isGridMode",()=>t.getInstanceState().isGridMode,[t]);return p.jsx($s,{actionId:"toggle-grid",checked:e})}function Rce(){const t=re(),e=oe("isWrapMode",()=>t.user.getIsWrapMode(),[t]);return p.jsx($s,{actionId:"toggle-wrap-mode",checked:e})}function Oce(){const t=re(),e=oe("isFocusMode",()=>t.getInstanceState().isFocusMode,[t]);return p.jsx($s,{actionId:"toggle-focus-mode",checked:e})}function jce(){const t=re(),e=oe("edgeScrollSpeed",()=>t.user.getEdgeScrollSpeed(),[t]);return p.jsx($s,{actionId:"toggle-edge-scrolling",checked:e===1})}function Dce(){const t=re(),e=oe("animationSpeed",()=>t.user.getAnimationSpeed(),[t]);return p.jsx($s,{actionId:"toggle-reduce-motion",checked:e===0})}function Lce(){const t=re(),e=oe("isDebugMode",()=>t.getInstanceState().isDebugMode,[t]);return p.jsx($s,{actionId:"toggle-debug-mode",checked:e})}function Nce(){const t=re(),e=oe("dynamic resize",()=>t.user.getIsDynamicResizeMode(),[t]);return p.jsx($s,{actionId:"toggle-dynamic-size-mode",checked:e})}function zce(){const t=re(),e=oe("paste at cursor",()=>t.user.getIsPasteAtCursorMode(),[t]);return p.jsx($s,{actionId:"toggle-paste-at-cursor",checked:e})}function $ce(){const t=re();return oe("show cursor chat",()=>t.getCurrentToolId()==="select"&&!t.getInstanceState().isCoarsePointer,[t])?p.jsx(fe,{actionId:"open-cursor-chat"}):null}function Bce(){const t=re(),e=HS(),n=oe("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t]),r=oe("isSinglePageMode",()=>t.options.maxPages<=1,[t]);return n?p.jsxs(p.Fragment,{children:[e&&p.jsx($ce,{}),p.jsxs(Qe,{id:"modify",children:[p.jsx(Cce,{}),p.jsx(_ce,{}),p.jsx(Tce,{}),!r&&p.jsx(Ice,{})]}),p.jsx(h9,{}),p.jsx(f9,{}),p.jsx(Qe,{id:"select-all",children:p.jsx(p9,{})})]}):null}const Fce=E.memo(function({children:e,disabled:n=!1}){const r=re(),{Canvas:i}=Zt(),s=E.useCallback(f=>{if(f){if(r.getInstanceState().isCoarsePointer){const g=r.getSelectedShapes(),{inputs:{currentPagePoint:m}}=r,S=r.getShapesAtPoint(m);if(!r.getSelectedShapes().length||!S.some(b=>g.includes(b))){const b=S.filter(v=>r.isShapeOrAncestorLocked(v));b.length&&r.select(...b.map(v=>v.id))}}}else{const g=r.getOnlySelectedShape();g&&r.isShapeOrAncestorLocked(g)&&r.setSelectedShapes([])}},[r]),o=zn(),[l,u]=Ea("context menu",s),d=e??p.jsx(Bce,{});return p.jsxs(Lne,{dir:"ltr",onOpenChange:u,modal:!1,children:[p.jsx(Nne,{onContextMenu:void 0,dir:"ltr",disabled:n,children:i?p.jsx(i,{}):null}),l&&p.jsx(zne,{container:o,children:p.jsx($ne,{className:"tlui-menu scrollable","data-testid":"context-menu",alignOffset:-4,collisionPadding:4,onContextMenu:Je,children:p.jsx(rs,{type:"context-menu",sourceId:"context-menu",children:d})})})]})}),Uce=2e3,Hce=5e3,Kce=ir(function(){const e=re(),{isChatting:n,chatMessage:r}=e.getInstanceState(),i=E.useRef(-1),[s,o]=E.useState("");return E.useEffect(()=>{if(!n&&r||n){const u=n?Hce:Uce;i.current=e.timers.setTimeout(()=>{e.updateInstanceState({chatMessage:"",isChatting:!1}),o(""),e.focus()},u)}return()=>{clearTimeout(i.current)}},[e,r,n]),n?p.jsx(qce,{value:s,setValue:o,chatMessage:r}):r.trim()?p.jsx(Gce,{chatMessage:r}):null});function y9(t){const e=re();E.useLayoutEffect(()=>{var o;if(!t.current)return;const{x:r,y:i}=e.inputs.currentScreenPoint;(o=t.current)==null||o.style.setProperty("transform",`translate(${r}px, ${i}px)`);function s(l){var f;const{minX:u,minY:d}=e.getViewportScreenBounds();(f=t.current)==null||f.style.setProperty("transform",`translate(${l.clientX-u}px, ${l.clientY-d}px)`)}return window.addEventListener("pointermove",s),()=>{window.removeEventListener("pointermove",s)}},[t,e])}const Gce=({chatMessage:t})=>{const e=re(),n=E.useRef(null);return y9(n),p.jsx("div",{ref:n,className:"tl-cursor-chat tl-cursor-chat__bubble",style:{backgroundColor:e.user.getColor()},children:t})},qce=ir(function({chatMessage:e,value:n,setValue:r}){const i=re(),s=ut(),o=E.useRef(null),l=e||s("cursor-chat.type-to-chat");y9(o),E.useLayoutEffect(()=>{const m=o.current;if(!m)return;const S=i.textMeasure.measureText(n||l,{fontFamily:"var(--font-body)",fontSize:12,fontWeight:"500",fontStyle:"normal",maxWidth:null,lineHeight:1,padding:"6px"});m.style.setProperty("width",S.w+"px")},[i,n,l]),E.useLayoutEffect(()=>{const m=i.timers.requestAnimationFrame(()=>{var S;(S=o.current)==null||S.focus()});return()=>{cancelAnimationFrame(m)}},[i]);const u=E.useCallback(()=>{i.updateInstanceState({isChatting:!1}),i.focus()},[i]),d=E.useCallback(m=>{const{value:S}=m.target;r(S.slice(0,64)),i.updateInstanceState({chatMessage:S})},[i,r]),f=E.useCallback(m=>{const S=o.current;if(!S)return;const{value:b}=S;switch(m.key){case"Enter":{if(Je(m),m.stopPropagation(),!b){u();return}r("");break}case"Escape":{Je(m),m.stopPropagation(),u();break}}},[u,r]),g=E.useCallback(m=>{m.stopPropagation()},[]);return p.jsx("input",{ref:o,className:"tl-cursor-chat",style:{backgroundColor:i.user.getColor()},onBlur:u,onChange:d,onKeyDown:f,onPaste:g,value:n,placeholder:l,spellCheck:!1})});function s_({checked:t}){return p.jsx(vo,{icon:t?"check":"none",className:"tlui-button__icon",small:!0})}function Yce(){const t=re(),{addToast:e}=_a(),{addDialog:n}=Sp(),[r,i]=et.useState(!1);return p.jsxs(p.Fragment,{children:[p.jsxs(Qe,{id:"items",children:[p.jsx(kn,{id:"add-toast",onSelect:()=>{e({id:At(),title:"Something good happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"success"}),e({id:At(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"info",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:At(),title:"Something maybe bad happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"warning",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:At(),title:"Something bad happened",severity:"error",keepOpen:!0})},label:"Show toast"}),p.jsx(kn,{id:"show-dialog",label:"Show dialog",onSelect:()=>{n({component:({onClose:s})=>p.jsx(Xce,{displayDontShowAgain:!0,onCancel:()=>s(),onContinue:()=>s()}),onClose:()=>{}})}}),p.jsx(kn,{id:"create-shapes",label:"Create 100 shapes",onSelect:()=>Zce(t,100)}),p.jsx(kn,{id:"count-nodes",label:"Count shapes / nodes",onSelect:()=>{var l;const s=t.getSelectedShapes(),o=s.length===0?t.getRenderingShapes():s;window.alert(`Shapes ${o.length}, DOM nodes:${(l=document.querySelector(".tl-shapes").querySelectorAll("*"))==null?void 0:l.length}`)}}),(()=>{if(r)throw Error("oh no!");return null})(),p.jsx(kn,{id:"throw-error",onSelect:()=>i(!0),label:"Throw error"}),p.jsx(kn,{id:"hard-reset",onSelect:c4,label:"Hard reset"})]}),p.jsxs(Qe,{id:"flags",children:[p.jsx(Vce,{}),p.jsx(Wce,{})]})]})}function Vce(){const t=Object.values(xn);return t.length?p.jsx(ci,{id:"debug flags",label:"Debug Flags",children:p.jsx(Qe,{id:"debug flags",children:t.map(e=>p.jsx(S9,{flag:e},e.name))})}):null}function Wce(){const t=Object.values(oY);return t.length?p.jsx(ci,{id:"feature flags",label:"Feature Flags",children:p.jsx(Qe,{id:"feature flags",children:t.map(e=>p.jsx(S9,{flag:e},e.name))})}):null}function Xce({title:t="title",body:e="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:i=!1,onCancel:s,onContinue:o}){const[l,u]=et.useState(!1);return p.jsxs(p.Fragment,{children:[p.jsxs($S,{children:[p.jsx(BS,{children:t}),p.jsx(FS,{})]}),p.jsx(zf,{style:{maxWidth:350},children:e}),p.jsxs(gE,{className:"tlui-dialog__footer__actions",children:[i&&p.jsxs($e,{type:"normal",onClick:()=>u(!l),style:{marginRight:"auto"},children:[p.jsx(s_,{checked:l}),p.jsx(wn,{children:"Dont show again"})]}),p.jsx($e,{type:"normal",onClick:s,children:p.jsx(wn,{children:n})}),p.jsx($e,{type:"primary",onClick:async()=>o(),children:p.jsx(wn,{children:r})})]})]})}const S9=ir(function({flag:e,onChange:n}){const r=e.get();return p.jsx(YS,{id:e.name,title:e.name,label:e.name.replace(/([a-z0-9])([A-Z])/g,i=>`${i[0]} ${i[1].toLowerCase()}`).replace(/^[a-z]/,i=>i.toUpperCase()),checked:r,onSelect:()=>{e.set(!r),n==null||n(!r)}})});let Rj=0;function Zce(t,e){const n=Array(e),r=Math.floor(Math.sqrt(e));for(let i=0;i<e;i++)Rj++,n[i]={id:Lt("box"+Rj),type:"geo",x:i%r*132,y:Math.floor(i/r)*132};t.run(()=>{t.createShapes(n).setSelectedShapes(n.map(i=>i.id))})}function Qce({children:t}){const e=t??p.jsx(Yce,{});return p.jsxs(Ic,{id:"debug",children:[p.jsx(Mc,{children:p.jsx($e,{type:"icon",title:"Debug menu",children:p.jsx(it,{icon:"dots-horizontal"})})}),p.jsx(Ac,{side:"top",align:"end",alignOffset:0,children:p.jsx(rs,{type:"menu",sourceId:"debug-panel",children:e})})]})}const Jce=E.memo(function(){const{DebugMenu:e}=Dl(),n=E.useRef(null);return kl(n),p.jsxs("div",{ref:n,className:"tlui-debug-panel",children:[p.jsx(tue,{}),p.jsx(nue,{}),e&&p.jsx(e,{})]})});function eue(t=!0){const[e,n]=E.useState(0),r=re();E.useEffect(()=>{if(!t)return;const i=()=>n(s=>s+1);return r.on("tick",i),()=>{r.off("tick",i)}},[r,t])}const tue=ir(function(){eue();const e=re(),n=e.getPath(),r=e.getHoveredShape(),i=e.getOnlySelectedShape(),s=n==="select.idle"||!n.includes("select.")?r:i,o=s&&n.includes("select.")?` / ${s.type||""}${"geo"in s.props?" / "+s.props.geo:""} / [${T.ToInt(e.getPointInShapeSpace(s,e.inputs.currentPagePoint))}]`:"",l=n.startsWith("select.")&&!n.includes(".idle")?` / [${T.ToInt(e.inputs.originPagePoint)}]  [${T.ToInt(e.inputs.currentPagePoint)}] = ${T.Dist(e.inputs.originPagePoint,e.inputs.currentPagePoint).toFixed(0)}`:"";return p.jsx("div",{className:"tlui-debug-panel__current-state",children:`${n}${o}${l}`})});function nue(){const t=re(),e=oe("show_fps",()=>xn.showFps.get(),[xn]),n=E.useRef(null);return E.useEffect(()=>{if(!e)return;const r=250;let i=0,s=-1,o=performance.now(),l=0,u=0,d=!1;function f(){if(u++,l=performance.now()-o,l>r){const g=Math.round(u*(r/l)*(1e3/r));g>i&&(i=g);const m=i*.75;(g<m&&!d||g>=m&&d)&&(d=!d),n.current.innerHTML=`FPS ${g.toString()}`,n.current.className="tlui-debug-panel__fps"+(d?" tlui-debug-panel__fps__slow":""),l-=r,u=0,o=performance.now()}s=t.timers.requestAnimationFrame(f)}return f(),()=>{cancelAnimationFrame(s)}},[e,t]),e?p.jsx("div",{ref:n}):null}const rue=E.memo(function(){const e=zr(),n=E.useRef(null);kl(n);const{MainMenu:r,QuickActions:i,ActionsMenu:s,PageMenu:o}=Dl(),l=re(),u=oe("isSinglePageMode",()=>l.options.maxPages<=1,[l]),d=l.options.actionShortcutsLocation==="menu"?!0:l.options.actionShortcutsLocation==="toolbar"?!1:e>=Sn.TABLET;return!r&&!o&&!d?null:p.jsx("div",{ref:n,className:"tlui-menu-zone",children:p.jsxs("div",{className:"tlui-buttons__horizontal",children:[r&&p.jsx(r,{}),o&&!u&&p.jsx(o,{}),d?p.jsxs(p.Fragment,{children:[i&&p.jsx(i,{}),s&&p.jsx(s,{})]}):null]})})});function iue(){const t=re(),e=$c(),[n,r]=E.useState(!1),i=E.useRef(!1);return pl("toggle showback to content",()=>{const s=i.current,o=t.getCurrentPageShapeIds();let l=!1;o.size&&(l=o.size===t.getCulledShapes().size),s!==l&&(r(l),i.current=l)},[t]),n?p.jsx(fe,{actionId:"back-to-content",onSelect:()=>{e["back-to-content"].onSelect("helper-buttons"),r(!1)}}):null}function sue(){const t=re();return oe("is pen mode",()=>t.getInstanceState().isPenMode,[t])?p.jsx(fe,{actionId:"exit-pen-mode"}):null}function oue(){const t=re(),e=$c();return oe("is following user",()=>!!t.getInstanceState().followingUserId,[t])?p.jsx(kn,{...e["stop-following"]}):null}function aue(){return p.jsxs(p.Fragment,{children:[p.jsx(sue,{}),p.jsx(iue,{}),p.jsx(oue,{})]})}function lue({children:t}){const e=t??p.jsx(aue,{});return p.jsx("div",{className:"tlui-helper-buttons",children:p.jsx(rs,{type:"helper-buttons",sourceId:"helper-buttons",children:e})})}function cue(){const t=HS();return p.jsxs(p.Fragment,{children:[p.jsxs(Qe,{label:"shortcuts-dialog.tools",id:"tools",children:[p.jsx(fe,{actionId:"toggle-tool-lock"}),p.jsx(fe,{actionId:"insert-media"}),p.jsx(Wr,{toolId:"select"}),p.jsx(Wr,{toolId:"draw"}),p.jsx(Wr,{toolId:"eraser"}),p.jsx(Wr,{toolId:"hand"}),p.jsx(Wr,{toolId:"rectangle"}),p.jsx(Wr,{toolId:"ellipse"}),p.jsx(Wr,{toolId:"arrow"}),p.jsx(Wr,{toolId:"line"}),p.jsx(Wr,{toolId:"text"}),p.jsx(Wr,{toolId:"frame"}),p.jsx(Wr,{toolId:"note"}),p.jsx(Wr,{toolId:"laser"}),p.jsx(kn,{id:"pointer-down",label:"tool.pointer-down",kbd:",",onSelect:()=>{}})]}),p.jsxs(Qe,{label:"shortcuts-dialog.preferences",id:"preferences",children:[p.jsx(fe,{actionId:"toggle-dark-mode"}),p.jsx(fe,{actionId:"toggle-focus-mode"}),p.jsx(fe,{actionId:"toggle-grid"})]}),p.jsxs(Qe,{label:"shortcuts-dialog.edit",id:"edit",children:[p.jsx(fe,{actionId:"undo"}),p.jsx(fe,{actionId:"redo"}),p.jsx(fe,{actionId:"cut"}),p.jsx(fe,{actionId:"copy"}),p.jsx(fe,{actionId:"paste"}),p.jsx(fe,{actionId:"select-all"}),p.jsx(fe,{actionId:"delete"}),p.jsx(fe,{actionId:"duplicate"})]}),p.jsxs(Qe,{label:"shortcuts-dialog.view",id:"view",children:[p.jsx(fe,{actionId:"zoom-in"}),p.jsx(fe,{actionId:"zoom-out"}),p.jsx(fe,{actionId:"zoom-to-100"}),p.jsx(fe,{actionId:"zoom-to-fit"}),p.jsx(fe,{actionId:"zoom-to-selection"})]}),p.jsxs(Qe,{label:"shortcuts-dialog.transform",id:"transform",children:[p.jsx(fe,{actionId:"bring-to-front"}),p.jsx(fe,{actionId:"bring-forward"}),p.jsx(fe,{actionId:"send-backward"}),p.jsx(fe,{actionId:"send-to-back"}),p.jsx(fe,{actionId:"group"}),p.jsx(fe,{actionId:"ungroup"}),p.jsx(fe,{actionId:"flip-horizontal"}),p.jsx(fe,{actionId:"flip-vertical"}),p.jsx(fe,{actionId:"align-top"}),p.jsx(fe,{actionId:"align-center-vertical"}),p.jsx(fe,{actionId:"align-bottom"}),p.jsx(fe,{actionId:"align-left"}),p.jsx(fe,{actionId:"align-center-horizontal"}),p.jsx(fe,{actionId:"align-right"})]}),t&&p.jsx(Qe,{label:"shortcuts-dialog.collaboration",id:"collaboration",children:p.jsx(fe,{actionId:"open-cursor-chat"})})]})}const uue=E.memo(function({children:e}){const n=ut(),r=zr(),i=e??p.jsx(cue,{});return p.jsxs(p.Fragment,{children:[p.jsxs($S,{className:"tlui-shortcuts-dialog__header",children:[p.jsx(BS,{children:n("shortcuts-dialog.title")}),p.jsx(FS,{})]}),p.jsx(zf,{className:je("tlui-shortcuts-dialog__body",{"tlui-shortcuts-dialog__body__mobile":r<=Sn.MOBILE_XS,"tlui-shortcuts-dialog__body__tablet":r<=Sn.TABLET}),children:p.jsx(rs,{type:"keyboard-shortcuts",sourceId:"kbd",children:i})}),p.jsx("div",{className:"tlui-dialog__scrim"})]})});function v9(){const t=Ml(),e=or(),n=oe("locale",()=>t==null?void 0:t.user.getLocale(),[t]);return t?p.jsx(ci,{id:"help menu language",label:"menu.language",children:p.jsx(Qe,{id:"languages",children:Rf.map(({locale:r,label:i})=>p.jsx(YS,{id:`language-${r}`,title:r,label:i,checked:r===n,readonlyOk:!0,onSelect:()=>{t.user.updateUserPreferences({locale:r}),e("change-language",{source:"menu",locale:r})}},r))})}):null}function due(){return p.jsxs(p.Fragment,{children:[p.jsx(v9,{}),p.jsx(b9,{})]})}function b9(){const{KeyboardShortcutsDialog:t}=Dl(),{addDialog:e}=Sp(),n=E.useCallback(()=>{t&&e({component:t})},[e,t]);return t?p.jsx(kn,{id:"keyboard-shortcuts-button",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:n}):null}function hue(){return p.jsxs(p.Fragment,{children:[p.jsxs(Qe,{id:"basic",children:[p.jsx(pue,{}),p.jsx(Sue,{}),p.jsx(fue,{}),p.jsx(vue,{})]}),p.jsx(bue,{})]})}function fue(){return p.jsxs(ci,{id:"export-all-as",label:"context-menu.export-all-as",size:"small",children:[p.jsxs(Qe,{id:"export-all-as-group",children:[p.jsx(fe,{actionId:"export-all-as-svg"}),p.jsx(fe,{actionId:"export-all-as-png"})]}),p.jsx(Qe,{id:"export-all-as-bg",children:p.jsx(YE,{})})]})}function pue(){return p.jsxs(ci,{id:"edit",label:"menu.edit",children:[p.jsx(yue,{}),p.jsx(h9,{}),p.jsx(f9,{}),p.jsx(gue,{}),p.jsx(mue,{}),p.jsx(Qe,{id:"select-all",children:p.jsx(p9,{})})]})}function gue(){return p.jsxs(Qe,{id:"misc",children:[p.jsx(i9,{}),p.jsx(s9,{}),p.jsx(n9,{}),p.jsx(t9,{}),p.jsx(o9,{}),p.jsx(a9,{}),p.jsx(m9,{}),p.jsx(g9,{}),p.jsx(r9,{})]})}function mue(){return p.jsxs(Qe,{id:"lock",children:[p.jsx(l9,{}),p.jsx(yce,{})]})}function yue(){const t=e9(),e=JB();return p.jsxs(Qe,{id:"undo-redo",children:[p.jsx(fe,{actionId:"undo",disabled:!t}),p.jsx(fe,{actionId:"redo",disabled:!e})]})}function Sue(){return p.jsx(ci,{id:"view",label:"menu.view",children:p.jsxs(Qe,{id:"view-actions",children:[p.jsx(fe,{actionId:"zoom-in"}),p.jsx(fe,{actionId:"zoom-out"}),p.jsx(c9,{}),p.jsx(u9,{}),p.jsx(d9,{})]})})}function vue(){return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"insert-embed"}),p.jsx(fe,{actionId:"insert-media"})]})}function bue(){return p.jsxs(Qe,{id:"preferences",children:[p.jsxs(ci,{id:"preferences",label:"menu.preferences",children:[p.jsxs(Qe,{id:"preferences-actions",children:[p.jsx(Mce,{}),p.jsx(Ace,{}),p.jsx(kce,{}),p.jsx(Rce,{}),p.jsx(Oce,{}),p.jsx(jce,{}),p.jsx(Dce,{}),p.jsx(Nce,{}),p.jsx(zce,{}),p.jsx(Lce,{})]}),p.jsx(Qe,{id:"color-scheme",children:p.jsx(ise,{})})]}),p.jsx(v9,{}),p.jsx(b9,{})]})}const xue=E.memo(function({children:e}){const n=zn(),[r,i]=Ea("main menu"),s=ut(),o=e??p.jsx(hue,{});return p.jsxs(aE,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[p.jsx(lE,{asChild:!0,dir:"ltr",children:p.jsx($e,{type:"icon","data-testid":"main-menu.button",title:s("menu.title"),children:p.jsx(it,{icon:"menu",small:!0})})}),p.jsx(zS,{container:n,children:p.jsx(cE,{className:"tlui-menu",side:"bottom",align:"start",collisionPadding:4,alignOffset:0,sideOffset:6,children:p.jsx(rs,{type:"menu",sourceId:"main-menu",children:o})})})]})}),b1={};function Xh(t){if(b1[t])return b1[t];const n=document.createElement("canvas").getContext("2d");n.fillStyle=t,n.fillRect(0,0,1,1);const[r,i,s,o]=n.getImageData(0,0,1,1).data,l=new Float32Array([r/255,i/255,s/255,o/255]);return b1[t]=l,l}const Qm=10,x9=4*6*Qm+12+4*12;function Fu(t,{center:e,radius:n,numArcSegments:r=20,startAngle:i=0,endAngle:s=It,offset:o=0}){const l=(s-i)/r;let u=o;for(let d=i;d<s;d+=l)t[u++]=e.x,t[u++]=e.y,t[u++]=e.x+Math.cos(d)*n,t[u++]=e.y+Math.sin(d)*n,t[u++]=e.x+Math.cos(d+l)*n,t[u++]=e.y+Math.sin(d+l)*n;return t}function Uu(t,e,n,r,i,s){t[e++]=n,t[e++]=r,t[e++]=n,t[e++]=r+s,t[e++]=n+i,t[e++]=r,t[e++]=n+i,t[e++]=r,t[e++]=n,t[e++]=r+s,t[e++]=n+i,t[e++]=r+s}function wue(t,e,n){const r=Qm;n=Math.min(n,Math.min(e.w,e.h)/2);const i=xe.ExpandBy(e,-n);if(i.w<=0||i.h<=0)return Fu(t,{center:e.center,radius:n,numArcSegments:Qm*4}),Qm*4*6;let s=0;return Uu(t,s,i.minX,i.minY,i.w,i.h),s+=12,Uu(t,s,i.minX,e.minY,i.w,n),s+=12,Uu(t,s,i.maxX,i.minY,n,i.h),s+=12,Uu(t,s,i.minX,i.maxY,i.w,n),s+=12,Uu(t,s,e.minX,i.minY,n,i.h),s+=12,Fu(t,{numArcSegments:r,offset:s,center:i.point,radius:n,startAngle:yt,endAngle:yt*1.5}),s+=r*6,Fu(t,{numArcSegments:r,offset:s,center:T.Add(i.point,new T(i.w,0)),radius:n,startAngle:yt*1.5,endAngle:It}),s+=r*6,Fu(t,{numArcSegments:r,offset:s,center:T.Add(i.point,i.size),radius:n,startAngle:0,endAngle:Yt}),s+=r*6,Fu(t,{numArcSegments:r,offset:s,center:T.Add(i.point,new T(0,i.h)),radius:n,startAngle:Yt,endAngle:yt}),x9}function Cue(t){if(!t)throw new Error("Canvas element not found");const e=t.getContext("webgl2",{premultipliedAlpha:!1});if(!e)throw new Error("Failed to get webgl2 context");const n=`#version 300 es
  precision mediump float;
  
  in vec2 shapeVertexPosition;

	uniform vec4 canvasPageBounds;

	// taken (with thanks) from
	// https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html
  void main() {
		// convert the position from pixels to 0.0 to 1.0
		vec2 zeroToOne = (shapeVertexPosition - canvasPageBounds.xy) / canvasPageBounds.zw;
	
		// convert from 0->1 to 0->2
		vec2 zeroToTwo = zeroToOne * 2.0;
	
		// convert from 0->2 to -1->+1 (clipspace)
		vec2 clipSpace = zeroToTwo - 1.0;
	
		gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }`,r=e.createShader(e.VERTEX_SHADER);if(!r)throw new Error("Failed to create vertex shader");if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Failed to compile vertex shader");const i=`#version 300 es
  precision mediump float;
  
	uniform vec4 fillColor;
  out vec4 outputColor;

  void main() {
	outputColor = fillColor;
  }`,s=e.createShader(e.FRAGMENT_SHADER);if(!s)throw new Error("Failed to create fragment shader");if(e.shaderSource(s,i),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Error("Failed to compile fragment shader");const o=e.createProgram();if(!o)throw new Error("Failed to create program");if(e.attachShader(o,r),e.attachShader(o,s),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error("Failed to link program");e.useProgram(o);const l=e.getAttribLocation(o,"shapeVertexPosition");if(l<0)throw new Error("Failed to get shapeVertexPosition attribute location");e.enableVertexAttribArray(l);const u=e.getUniformLocation(o,"canvasPageBounds"),d=e.getUniformLocation(o,"fillColor");if(!e.createBuffer())throw new Error("Failed to create buffer");if(!e.createBuffer())throw new Error("Failed to create buffer");return{context:e,selectedShapes:pm(e,1024),unselectedShapes:pm(e,4096),viewport:pm(e,x9),collaborators:pm(e,1024),prepareTriangles(m,S){e.bindBuffer(e.ARRAY_BUFFER,m.buffer),e.bufferData(e.ARRAY_BUFFER,m.vertices,e.STATIC_DRAW,0,S),e.enableVertexAttribArray(l),e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0)},drawTrianglesTransparently(m){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawArrays(e.TRIANGLES,0,m/2),e.disable(e.BLEND)},drawTriangles(m){e.drawArrays(e.TRIANGLES,0,m/2)},setFillColor(m){e.uniform4fv(d,m)},setCanvasPageBounds(m){e.uniform4fv(u,m)}}}function pm(t,e){const n=t.createBuffer();if(!n)throw new Error("Failed to create buffer");return{buffer:n,vertices:new Float32Array(e)}}function Oj(t,e,n){let r=t.vertices.length;for(;r<e+n.length;)r*=2;if(r!=t.vertices.length){const i=new Float32Array(r);i.set(t.vertices),t.vertices=i}t.vertices.set(n,e)}var _ue=Object.create,w9=Object.defineProperty,Eue=Object.getOwnPropertyDescriptor,Pue=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),C9=t=>{throw TypeError(t)},_9=(t,e,n)=>e in t?w9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tue=t=>[,,,_ue(null)],E9=["class","method","getter","setter","accessor","field","value","get","set"],P9=t=>t!==void 0&&typeof t!="function"?C9("Function expected"):t,Iue=(t,e,n,r,i)=>({kind:E9[t],name:e,metadata:r,addInitializer:s=>n._?C9("Already initialized"):i.push(P9(s||null))}),Mue=(t,e)=>_9(e,Pue("metadata"),t[3]),Aue=(t,e,n,r)=>{for(var i=0,s=t[e>>1],o=s&&s.length;i<o;i++)s[i].call(n);return r},Po=(t,e,n,r,i,s)=>{for(var o,l,u,d,f=e&7,g=!1,m=!1,S=2,b=E9[f+5],v=t[S]||(t[S]=[]),w=(i=i.prototype,Eue(i,n)),C=r.length-1;C>=0;C--)u=Iue(f,n,l={},t[3],v),u.static=g,u.private=m,d=u.access={has:_=>n in _},d.get=_=>_[n],o=(0,r[C])(w[b],u),l._=1,P9(o)&&(w[b]=o);return w&&w9(i,n,w),i},ta=(t,e,n)=>_9(t,typeof e!="symbol"?e+"":e,n),T9,I9,M9,A9,k9,R9,O9,j9,D9,L9,Oi;L9=[ni],D9=[he],j9=[he],O9=[he],R9=[he],k9=[he],A9=[he],M9=[he],I9=[he],T9=[ni];class os{constructor(e,n,r){this.editor=e,this.elem=n,this.container=r,Aue(Oi,5,this),ta(this,"disposables",[]),ta(this,"gl"),ta(this,"shapeGeometryCache"),ta(this,"colors"),ta(this,"id",At()),ta(this,"canvasBoundingClientRect",On("canvasBoundingClientRect",new xe)),ta(this,"originPagePoint",new T),ta(this,"originPageCenter",new T),ta(this,"isInViewport",!1),this.gl=Cue(n),this.shapeGeometryCache=e.store.createComputedCache("webgl-geometry",i=>{const s=e.getShapeMaskedPageBounds(i.id);if(!s)return null;const o=new Float32Array(12);return Uu(o,0,s.x,s.y,s.w,s.h),o}),this.colors=this._getColors(),this.disposables.push(this._listenForCanvasResize(),co("minimap render",this.render))}close(){return this.disposables.forEach(e=>e())}_getColors(){const e=getComputedStyle(this.editor.getContainer());return{shapeFill:Xh(e.getPropertyValue("--color-text-3").trim()),selectFill:Xh(e.getPropertyValue("--color-selected").trim()),viewportFill:Xh(e.getPropertyValue("--color-muted-1").trim()),background:Xh(e.getPropertyValue("--color-low").trim())}}updateColors(){this.colors=this._getColors()}getDpr(){return this.editor.getInstanceState().devicePixelRatio}getContentPageBounds(){const e=this.editor.getViewportPageBounds(),n=this.editor.getCurrentPageBounds();return n?xe.Expand(n,e):e}getContentScreenBounds(){const e=this.getContentPageBounds(),n=this.editor.pageToScreen(e.point),r=this.editor.pageToScreen(new T(e.maxX,e.maxY));return new xe(n.x,n.y,r.x-n.x,r.y-n.y)}_getCanvasBoundingRect(){const{x:e,y:n,width:r,height:i}=this.elem.getBoundingClientRect();return new xe(e,n,r,i)}getCanvasScreenBounds(){return this.canvasBoundingClientRect.get()}_listenForCanvasResize(){const e=new ResizeObserver(()=>{const n=this._getCanvasBoundingRect();this.canvasBoundingClientRect.set(n)});return e.observe(this.elem),e.observe(this.container),()=>e.disconnect()}getCanvasSize(){const e=this.canvasBoundingClientRect.get(),n=this.getDpr();return new T(e.width*n,e.height*n)}getCanvasClientPosition(){return this.canvasBoundingClientRect.get().point}getCanvasPageBounds(){const e=this.getCanvasScreenBounds(),n=this.getContentPageBounds(),r=e.width/e.height;let i=n.width,s=i/r;s<n.height&&(s=n.height,i=s*r);const o=new xe(0,0,i,s);return o.center=n.center,o}getZoom(){return this.getCanvasPageBounds().width/this.getCanvasScreenBounds().width}getCanvasPageBoundsArray(){const{x:e,y:n,w:r,h:i}=this.getCanvasPageBounds();return new Float32Array([e,n,r,i])}getMinimapPagePoint(e,n){const r=this.getCanvasPageBounds(),i=this.getCanvasScreenBounds();let s=e-i.x,o=n-i.y;return s*=r.width/i.width,o*=r.height/i.height,s+=r.minX,o+=r.minY,new T(s,o,1)}minimapScreenPointToPagePoint(e,n,r=!1,i=!1){const{editor:s}=this,o=s.getViewportPageBounds();let{x:l,y:u}=this.getMinimapPagePoint(e,n);if(i){const d=this.editor.getCurrentPageBounds()??new xe,f=d.minX-o.width/2,g=d.maxX+o.width/2,m=d.minY-o.height/2,S=d.maxY+o.height/2,b=Math.max(0,f+o.width-l),v=Math.max(0,-(g-o.width-l)),w=Math.max(0,m+o.height-u),C=Math.max(0,-(S-o.height-u));l+=(b-v)/2,u+=(w-C)/2,l=Xn(l,f,g),u=Xn(u,m,S)}if(r){const{originPagePoint:d}=this,f=Math.abs(l-d.x),g=Math.abs(u-d.y);f>g?u=d.y:l=d.x}return new T(l,u)}render(){const e=this.gl.context,n=this.getCanvasSize();this.gl.setCanvasPageBounds(this.getCanvasPageBoundsArray()),this.elem.width=n.x,this.elem.height=n.y,e.viewport(0,0,n.x,n.y),e.clearColor(this.colors.background[0],this.colors.background[1],this.colors.background[2],1),e.clear(e.COLOR_BUFFER_BIT);const r=new Set(this.editor.getSelectedShapeIds()),i=this.colors;let s=0,o=0;const l=this.editor.getCurrentPageShapeIdsSorted();for(let u=0,d=l.length;u<d;u++){const f=l[u],g=this.shapeGeometryCache.get(f);if(!g)continue;const m=g.length;r.has(f)?(Oj(this.gl.selectedShapes,s,g),s+=m):(Oj(this.gl.unselectedShapes,o,g),o+=m)}this.drawShapes(this.gl.unselectedShapes,o,i.shapeFill),this.drawShapes(this.gl.selectedShapes,s,i.selectFill),this.drawViewport(),this.drawCollaborators()}drawShapes(e,n,r){this.gl.prepareTriangles(e,n),this.gl.setFillColor(r),this.gl.drawTriangles(n)}drawViewport(){const e=this.editor.getViewportPageBounds(),n=wue(this.gl.viewport.vertices,e,4*this.getZoom());this.gl.prepareTriangles(this.gl.viewport,n),this.gl.setFillColor(this.colors.viewportFill),this.gl.drawTrianglesTransparently(n),Ft.isSafari&&(this.gl.drawTrianglesTransparently(n),this.gl.drawTrianglesTransparently(n),this.gl.drawTrianglesTransparently(n))}drawCollaborators(){const e=this.editor.getCollaboratorsOnCurrentPage();if(!e.length)return;const n=20,r=n*6,i=r*e.length;this.gl.collaborators.vertices.length<i&&(this.gl.collaborators.vertices=new Float32Array(i));const s=this.gl.collaborators.vertices;let o=0;const l=this.getZoom();for(const{cursor:u}of e)u&&(Fu(s,{center:T.From(u),radius:3*l,offset:o,numArcSegments:n}),o+=r);this.gl.prepareTriangles(this.gl.collaborators,i),o=0;for(const{color:u}of e)this.gl.setFillColor(Xh(u)),this.gl.context.drawArrays(this.gl.context.TRIANGLES,o/2,r/2),o+=r}}Oi=Tue();Po(Oi,1,"close",L9,os);Po(Oi,1,"getDpr",D9,os);Po(Oi,1,"getContentPageBounds",j9,os);Po(Oi,1,"getContentScreenBounds",O9,os);Po(Oi,1,"getCanvasSize",R9,os);Po(Oi,1,"getCanvasClientPosition",k9,os);Po(Oi,1,"getCanvasPageBounds",A9,os);Po(Oi,1,"getZoom",M9,os);Po(Oi,1,"getCanvasPageBoundsArray",I9,os);Po(Oi,1,"render",T9,os);Mue(Oi,os);function kue(){const t=re(),e=zn(),n=E.useRef(null),r=E.useRef(!1),i=E.useRef();E.useEffect(()=>{try{const f=new os(t,n.current,e);return i.current=f,i.current.close}catch(f){t.annotateError(f,{origin:"minimap",willCrashApp:!1}),t.timers.setTimeout(()=>{throw f})}},[t,e]);const s=E.useCallback(f=>{if(!t.getCurrentPageShapeIds().size||!i.current)return;const g=i.current.minimapScreenPointToPagePoint(f.clientX,f.clientY,!1,!1),m=i.current.minimapScreenPointToPagePoint(f.clientX,f.clientY,!1,!0);i.current.originPagePoint.setTo(m),i.current.originPageCenter.setTo(t.getViewportPageBounds().center),t.centerOnPoint(g,{animation:{duration:t.options.animationMediumMs}})},[t]),o=E.useCallback(f=>{if(!i.current)return;const g=f.currentTarget;if(np(g,f),!t.getCurrentPageShapeIds().size)return;r.current=!0,i.current.isInViewport=!1;const m=i.current.minimapScreenPointToPagePoint(f.clientX,f.clientY,!1,!1),S=t.getViewportPageBounds(),b=i.current.getContentPageBounds();if(new xe(b.x-S.width/2,b.y-S.height/2,b.width+S.width,b.height+S.height).containsPoint(m)&&!S.containsPoint(m)){i.current.isInViewport=S.containsPoint(m);const C=T.Sub(S.center,S.point),_=T.Add(m,C);i.current.originPagePoint.setTo(_),i.current.originPageCenter.setTo(m),t.centerOnPoint(m,{animation:{duration:t.options.animationMediumMs}})}else{const C=i.current.minimapScreenPointToPagePoint(f.clientX,f.clientY,!1,!0);i.current.isInViewport=S.containsPoint(C),i.current.originPagePoint.setTo(C),i.current.originPageCenter.setTo(S.center)}function w(C){g&&rp(g,C),r.current=!1,document.body.removeEventListener("pointerup",w)}document.body.addEventListener("pointerup",w)},[t]),l=E.useCallback(f=>{if(!i.current)return;const g=i.current.minimapScreenPointToPagePoint(f.clientX,f.clientY,f.shiftKey,!0);if(r.current){if(i.current.isInViewport){const v=i.current.originPagePoint.clone().sub(i.current.originPageCenter);t.centerOnPoint(T.Sub(g,v));return}t.centerOnPoint(g)}const m=i.current.getMinimapPagePoint(f.clientX,f.clientY),S=t.pageToScreen(m),b={type:"pointer",target:"canvas",name:"pointer_move",...xi(f),point:S,isPen:t.getInstanceState().isPenMode};t.dispatch(b)},[t]),u=E.useCallback(f=>{const g=Q3(f);t.dispatch({type:"wheel",name:"wheel",delta:g,point:new T(f.clientX,f.clientY),shiftKey:f.shiftKey,altKey:f.altKey,ctrlKey:f.metaKey||f.ctrlKey,metaKey:f.metaKey,accelKey:br(f)})},[t]),d=dp();return E.useEffect(()=>{t.timers.setTimeout(()=>{var f,g;(f=i.current)==null||f.updateColors(),(g=i.current)==null||g.render()})},[d,t]),p.jsx("div",{className:"tlui-minimap",children:p.jsx("canvas",{role:"img","aria-label":"minimap",ref:n,className:"tlui-minimap__canvas",onDoubleClick:s,onPointerMove:l,onPointerDown:o,onWheelCapture:u})})}function Rue(t,e){const[n,r]=et.useState(e);et.useLayoutEffect(()=>{const s=O_(t);if(s)try{r(JSON.parse(s))}catch{console.error(`Could not restore value ${t} from local storage.`)}},[t]);const i=et.useCallback(s=>{r(o=>{const l=typeof s=="function"?s(o):s;return j_(t,JSON.stringify(l)),l})},[t]);return[n,i]}const Oue=E.memo(function(){const e=$c(),n=ut(),r=zr(),i=E.useRef(null);kl(i);const[s,o]=Rue("minimap",!0),l=E.useCallback(()=>{o(f=>!f)},[o]),{ZoomMenu:u,Minimap:d}=Dl();return r<Sn.MOBILE?null:p.jsxs("div",{ref:i,className:"tlui-navigation-panel",children:[p.jsx("div",{className:"tlui-buttons__horizontal",children:u&&r<Sn.TABLET?p.jsx(u,{}):s?p.jsxs(p.Fragment,{children:[u&&p.jsx(u,{}),d&&p.jsx($e,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:l,children:p.jsx(it,{icon:s?"chevrons-ne":"chevrons-sw"})})]}):p.jsxs(p.Fragment,{children:[p.jsx($e,{type:"icon","data-testid":"minimap.zoom-out",title:`${n($f(e["zoom-out"].label))} ${BC(e["zoom-out"].kbd)}`,onClick:()=>e["zoom-out"].onSelect("navigation-zone"),children:p.jsx(it,{icon:"minus"})}),u&&p.jsx(u,{}),p.jsx($e,{type:"icon","data-testid":"minimap.zoom-in",title:`${n($f(e["zoom-in"].label))} ${BC(e["zoom-in"].kbd)}`,onClick:()=>e["zoom-in"].onSelect("navigation-zone"),children:p.jsx(it,{icon:"plus"})}),d&&p.jsx($e,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:l,children:p.jsx(it,{icon:s?"chevrons-ne":"chevrons-sw"})})]})}),d&&r>=Sn.TABLET&&!s&&p.jsx(d,{})]})}),jue=function({name:e,id:n,isCurrentPage:r,onCancel:i}){const s=re(),o=or(),l=E.useRef(null),u=E.useRef(null),d=E.useCallback(()=>{u.current=s.markHistoryStoppingPoint("rename page")},[s]),f=E.useCallback(m=>{s.renamePage(n,m||"New Page"),o("rename-page",{source:"page-menu"})},[s,n,o]),g=E.useCallback(()=>{u.current&&s.bailToMark(u.current),i()},[s,i]);return p.jsx(US,{className:"tlui-page-menu__item__input",ref:m=>l.current=m,defaultValue:e,onValueChange:f,onCancel:g,onFocus:d,shouldManuallyMaintainScrollPositionWhenFocused:!0,autoFocus:r,autoSelect:!0})},o_=(t,e,n,r,i)=>{let s;const o=t.getPages(),l=n>r?o[r-1]:o[r],u=n>r?o[r]:o[r+1];l&&!u?s=so(l.index):!l&&u?s=RH(o[0].index):s=Mf(l.index,u.index),s!==o[n].index&&(t.markHistoryStoppingPoint("moving page"),t.updatePage({id:e,index:s}),i("move-page",{source:"page-menu"}))},jj=ir(function({index:e,listSize:n,item:r,onRename:i}){const s=re(),o=ut(),l=s.getPages(),u=or(),d=E.useCallback(()=>{s.markHistoryStoppingPoint("creating page");const S=Ai.createId();s.duplicatePage(r.id,S),u("duplicate-page",{source:"page-menu"})},[s,r,u]),f=E.useCallback(()=>{o_(s,r.id,e,e-1,u)},[s,r,e,u]),g=E.useCallback(()=>{o_(s,r.id,e,e+1,u)},[s,r,e,u]),m=E.useCallback(()=>{s.markHistoryStoppingPoint("deleting page"),s.deletePage(r.id),u("delete-page",{source:"page-menu"})},[s,r,u]);return p.jsxs(Ic,{id:`page item submenu ${e}`,children:[p.jsx(Mc,{children:p.jsx($e,{type:"icon",title:o("page-menu.submenu.title"),children:p.jsx(it,{icon:"dots-vertical",small:!0})})}),p.jsx(Ac,{alignOffset:0,side:"right",sideOffset:-4,children:p.jsxs(rs,{type:"menu",sourceId:"page-menu",children:[p.jsxs(Qe,{id:"modify",children:[i&&p.jsx(kn,{id:"rename",label:"page-menu.submenu.rename",onSelect:i}),p.jsx(kn,{id:"duplicate",label:"page-menu.submenu.duplicate-page",onSelect:d,disabled:l.length>=s.options.maxPages}),e>0&&p.jsx(kn,{id:"move-up",onSelect:f,label:"page-menu.submenu.move-up"}),e<n-1&&p.jsx(kn,{id:"move-down",label:"page-menu.submenu.move-down",onSelect:g})]}),n>1&&p.jsx(Qe,{id:"delete",children:p.jsx(kn,{id:"delete",onSelect:m,label:"page-menu.submenu.delete"})})]})})]})}),Due=E.memo(function(){const e=re(),n=or(),r=ut(),i=zr(),s=E.useCallback(()=>C(!1),[]),[o,l]=Ea("page-menu",s),u=36,d=E.useRef(null),f=oe("pages",()=>e.getPages(),[e]),g=oe("currentPage",()=>e.getCurrentPage(),[e]),m=oe("currentPageId",()=>e.getCurrentPageId(),[e]),S=Ri(),b=oe("maxPageCountReached",()=>e.getPages().length>=e.options.maxPages,[e]),v=oe("isCoarsePointer",()=>e.getInstanceState().isCoarsePointer,[e]),[w,C]=E.useState(!1),_=E.useCallback(()=>{S||C(N=>!N)},[S]),M=E.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[I,A]=E.useState(Object.fromEntries(f.map((N,B)=>[N.id,{y:B*u,offsetY:0,isSelected:!1}])));E.useLayoutEffect(()=>{A(Object.fromEntries(f.map((N,B)=>[N.id,{y:B*u,offsetY:0,isSelected:!1}])))},[u,f]),E.useEffect(()=>{o&&e.timers.requestAnimationFrame(()=>{const N=document.querySelector(`[data-testid="page-menu-item-${m}"]`);if(N){const B=d.current;if(!B)return;const Y=N.offsetTop,K=B.scrollTop;Y<K&&B.scrollTo({top:Y});const V=Y+u,W=B.scrollTop+B.offsetHeight;V>W&&B.scrollTo({top:V-B.offsetHeight})}})},[u,m,o,e]);const R=E.useCallback(N=>{const{clientY:B,currentTarget:Y}=N,{dataset:{id:K,index:V}}=Y;if(!K||!V)return;const W=M.current;np(N.currentTarget,N),W.status="pointing",W.pointing={id:K,index:+V};const H=I[K].y;W.startY=B,W.startIndex=Math.max(0,Math.min(Math.round(H/u),f.length-1))},[u,f.length,I]),D=E.useCallback(N=>{const B=M.current;if(B.status==="pointing"){const{clientY:Y}=N,K=Y-B.startY;Math.abs(K)>5&&(B.status="dragging")}if(B.status==="dragging"){const{clientY:Y}=N,K=Y-B.startY,V=I[B.pointing.id],{startIndex:W,pointing:ee}=B,H=V.y+K,te=Math.max(0,Math.min(Math.round(H/u),f.length-1)),ge={...I};if(ge[ee.id]={y:V.y,offsetY:K,isSelected:!0},te!==B.dragIndex){B.dragIndex=te;for(let de=0;de<f.length;de++){const Se=f[de];if(Se.id===B.pointing.id)continue;let{y:me}=ge[Se.id];te===W?me=de*u:te<W?te<=de&&de<W?me=(de+1)*u:me=de*u:te>W&&(te>=de&&de>W?me=(de-1)*u:me=de*u),me!==ge[Se.id].y&&(ge[Se.id]={y:me,offsetY:0,isSelected:!0})}}A(ge)}},[u,f,I]),L=E.useCallback(N=>{const B=M.current;if(B.status==="dragging"){const{id:Y,index:K}=B.pointing;o_(e,Y,K,B.dragIndex,n)}rp(N.currentTarget,N),B.status="idle"},[e,n]),G=E.useCallback(N=>{const B=M.current;N.key==="Escape"&&(B.status==="dragging"&&A(Object.fromEntries(f.map((Y,K)=>[Y.id,{y:K*u,offsetY:0,isSelected:!1}]))),B.status="idle")},[u,f]),k=E.useCallback(()=>{S||(e.run(()=>{e.markHistoryStoppingPoint("creating page");const N=Ai.createId();e.createPage({name:r("page-menu.new-page-initial-name"),id:N}),e.setCurrentPage(N),C(!0)}),n("new-page",{source:"page-menu"}))},[e,r,S,n]),$=E.useCallback(N=>{e.setCurrentPage(N),n("change-page",{source:"page-menu"})},[e,n]),F=E.useCallback((N,B)=>{e.renamePage(N,B),n("rename-page",{source:"page-menu"})},[e,n]);return p.jsxs(KE,{id:"pages",onOpenChange:l,open:o,children:[p.jsx(GE,{"data-testid":"main.page-menu",children:p.jsxs($e,{type:"menu",title:g.name,"data-testid":"page-menu.button",className:"tlui-page-menu__trigger",children:[p.jsx("div",{className:"tlui-page-menu__name",children:g.name}),p.jsx(it,{icon:"chevron-down",small:!0})]})}),p.jsx(qE,{side:"bottom",align:"start",sideOffset:6,disableEscapeKeyDown:w,children:p.jsxs("div",{className:"tlui-page-menu__wrapper",children:[p.jsxs("div",{className:"tlui-page-menu__header",children:[p.jsx("div",{className:"tlui-page-menu__header__title",children:r("page-menu.title")}),!S&&p.jsxs("div",{className:"tlui-buttons__horizontal",children:[p.jsx($e,{type:"icon","data-testid":"page-menu.edit",title:r(w?"page-menu.edit-done":"page-menu.edit-start"),onClick:_,children:p.jsx(it,{icon:w?"check":"edit"})}),p.jsx($e,{type:"icon","data-testid":"page-menu.create",title:r(b?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:b,onClick:k,children:p.jsx(it,{icon:"plus"})})]})]}),p.jsx("div",{"data-testid":"page-menu.list",className:"tlui-page-menu__list tlui-menu__group",style:{height:u*f.length+4},ref:d,children:f.map((N,B)=>{const Y=I[N.id]??{offsetY:0};return w?p.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page_menu__item__sortable",style:{zIndex:N.id===g.id?888:B,transform:`translate(0px, ${Y.y+Y.offsetY}px)`},children:[p.jsx($e,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",onPointerDown:R,onPointerUp:L,onPointerMove:D,onKeyDown:G,"data-id":N.id,"data-index":B,children:p.jsx(it,{icon:"drag-handle-dots"})}),i<Sn.TABLET_SM&&v?p.jsxs($e,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const K=window.prompt("Rename page",N.name);K&&K!==N.name&&F(N.id,K)},onDoubleClick:_,children:[p.jsx(s_,{checked:N.id===g.id}),p.jsx(wn,{children:N.name})]}):p.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:u},children:p.jsx(jue,{id:N.id,name:N.name,isCurrentPage:N.id===g.id,onCancel:()=>{C(!1),e.menus.clearOpenMenus()}})}),!S&&p.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":w,children:p.jsx(jj,{index:B,item:N,listSize:f.length})})]},N.id+"_editing"):p.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page-menu__item",children:[p.jsxs($e,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>$(N.id),onDoubleClick:_,title:r("page-menu.go-to-page"),children:[p.jsx(s_,{checked:N.id===g.id}),p.jsx(wn,{children:N.name})]}),!S&&p.jsx("div",{className:"tlui-page_menu__item__submenu",children:p.jsx(jj,{index:B,item:N,listSize:f.length,onRename:()=>{if(Ft.isIos){const K=window.prompt("Rename page",N.name);K&&K!==N.name&&F(N.id,K)}else C(!0),m!==N.id&&$(N.id)}})})]},N.id)})})]})})]})});function Lue(){const t=re(),e=Ri(),n=oe("should display quick actions",()=>t.isInAny("select","hand","zoom"),[t]);if(!(e&&!n))return p.jsxs(p.Fragment,{children:[p.jsx(zue,{}),p.jsx(Nue,{})]})}function Nue(){const t=$r(1),e=Pa(),n=t&&e;return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"delete",disabled:!n}),p.jsx(fe,{actionId:"duplicate",disabled:!n})]})}function zue(){const t=e9(),e=JB();return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"undo",disabled:!t}),p.jsx(fe,{actionId:"redo",disabled:!e})]})}const $ue=E.memo(function({children:e}){const n=e??p.jsx(Lue,{});return p.jsx(rs,{type:"small-icons",sourceId:"quick-actions",children:n})});function Bue({userId:t}){const e=dS(t);return e?p.jsx("div",{className:"tlui-people-menu__avatar",style:{backgroundColor:e.color},children:e.userName==="New User"?"":e.userName[0]??""},t):null}const Fue=ir(function({userId:e}){const n=re(),r=ut(),i=or(),s=dS(e),o=E.useCallback(()=>{n.getInstanceState().followingUserId===e?(n.stopFollowingUser(),i("stop-following",{source:"people-menu"})):(n.startFollowingUser(e),i("start-following",{source:"people-menu"}))},[n,e,i]),l=(s==null?void 0:s.followingUserId)===n.user.getId(),u=n.getInstanceState().followingUserId===e;return s?p.jsxs("div",{className:"tlui-people-menu__item tlui-buttons__horizontal",children:[p.jsxs($e,{type:"menu",className:"tlui-people-menu__item__button",onClick:()=>n.zoomToUser(e),onDoubleClick:o,children:[p.jsx(vo,{icon:"color",color:s.color}),p.jsx("div",{className:"tlui-people-menu__name",children:s.userName??"New User"})]}),p.jsx($e,{type:"icon",className:"tlui-people-menu__item__follow",title:r(l?"people-menu.leading":u?"people-menu.following":"people-menu.follow"),onClick:o,disabled:l,"data-active":u||l,children:p.jsx(it,{icon:l?"leading":u?"following":"follow"})})]}):null});function Uue({count:t}){return p.jsx("div",{className:"tlui-people-menu__more",children:"+"+Math.abs(t)})}const Hue=ir(function(){const e=re(),n=zn(),r=ut(),i=or(),s=E.useRef(!1),[o,l]=E.useState(!1),u=E.useCallback(v=>{l(v)},[]),d=e.user.getColor(),f=E.useCallback(v=>{e.user.updateUserPreferences({color:v}),i("set-color",{source:"people-menu"})},[e,i]),{handleButtonClick:g,handleButtonPointerDown:m,handleButtonPointerEnter:S,handleButtonPointerUp:b}=et.useMemo(()=>{const v=()=>{s.current=!1,window.removeEventListener("pointerup",v)};return{handleButtonClick:I=>{const{id:A}=I.currentTarget.dataset;A&&d!==A&&f(A)},handleButtonPointerDown:I=>{const{id:A}=I.currentTarget.dataset;A&&(f(A),s.current=!0,window.addEventListener("pointerup",v))},handleButtonPointerEnter:I=>{if(!s.current)return;const{id:A}=I.currentTarget.dataset;A&&f(A)},handleButtonPointerUp:I=>{const{id:A}=I.currentTarget.dataset;A&&f(A)}}},[d,f]);return p.jsxs(BE,{onOpenChange:u,open:o,children:[p.jsx(FE,{dir:"ltr",asChild:!0,children:p.jsx($e,{type:"icon",className:"tlui-people-menu__user__color",style:{color:e.user.getColor()},title:r("people-menu.change-color"),children:p.jsx(it,{icon:"color"})})}),p.jsx(UE,{container:n,children:p.jsx(HE,{dir:"ltr",className:"tlui-menu tlui-people-menu__user__color-picker",align:"start",side:"left",sideOffset:8,children:p.jsx("div",{className:"tlui-buttons__grid",children:pC.map(v=>p.jsx($e,{type:"icon","data-id":v,"data-testid":v,"aria-label":v,"data-state":d===v?"hinted":void 0,title:v,className:"tlui-button-grid__button",style:{color:v},onPointerEnter:S,onPointerDown:m,onPointerUp:b,onClick:g,children:p.jsx(it,{icon:"color"})},v))})})})]})});function Kue(){const t=re(),e=or(),n=oe("userName",()=>t.user.getName(),[]),r=ut(),i=E.useRef(n),s=E.useRef(n),[o,l]=E.useState(!1),u=E.useCallback(()=>{l(m=>!m)},[]),d=E.useCallback(m=>{s.current=m,t.user.updateUserPreferences({name:m})},[t]),f=E.useCallback(()=>{i.current!==s.current&&(e("change-user-name",{source:"people-menu"}),i.current=s.current)},[e]),g=E.useCallback(()=>{l(!1),t.user.updateUserPreferences({name:i.current}),t.menus.clearOpenMenus()},[t]);return p.jsxs("div",{className:"tlui-people-menu__user",children:[p.jsx(Hue,{}),o?p.jsx(US,{className:"tlui-people-menu__user__input",defaultValue:n,onValueChange:d,onComplete:u,onCancel:g,onBlur:f,shouldManuallyMaintainScrollPositionWhenFocused:!0,autoFocus:!0,autoSelect:!0}):p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"tlui-people-menu__user__name",onDoubleClick:()=>{o||l(!0)},children:n}),n==="New User"?p.jsx("div",{className:"tlui-people-menu__user__label",children:r("people-menu.user")}):null]}),p.jsx($e,{type:"icon",className:"tlui-people-menu__user__edit","data-testid":"people-menu.change-name",title:r("people-menu.change-name"),onClick:u,children:p.jsx(it,{icon:o?"check":"edit"})})]})}function Gue({displayUserWhenAlone:t,children:e}){const n=ut(),r=zn(),i=re(),s=t4(),o=oe("user",()=>i.user.getColor(),[i]),l=oe("user",()=>i.user.getName(),[i]),[u,d]=Ea("people menu");return p.jsxs(BE,{onOpenChange:d,open:u,children:[p.jsx(FE,{dir:"ltr",asChild:!0,children:p.jsxs("button",{className:"tlui-people-menu__avatars-button",title:n("people-menu.title"),children:[s.length>5&&p.jsx(Uue,{count:s.length-5}),p.jsxs("div",{className:"tlui-people-menu__avatars",children:[s.slice(-5).map(f=>p.jsx(Bue,{userId:f},f)),(t||s.length>0)&&p.jsx("div",{className:"tlui-people-menu__avatar",style:{backgroundColor:o},children:l==="New User"?"":l[0]??""})]})]})}),p.jsx(UE,{container:r,children:p.jsx(HE,{dir:"ltr",className:"tlui-menu",side:"bottom",sideOffset:2,collisionPadding:4,onEscapeKeyDown:Je,children:p.jsxs("div",{className:"tlui-people-menu__wrapper",children:[p.jsx("div",{className:"tlui-people-menu__section",children:p.jsx(Kue,{})}),s.length>0&&p.jsx("div",{className:"tlui-people-menu__section",children:s.map(f=>p.jsx(Fue,{userId:f},f+"_presence"))}),e]})})})]})}function que(){return p.jsx("div",{className:"tlui-share-zone",draggable:!1,children:p.jsx(Gue,{displayUserWhenAlone:!0})})}const Yue=Object.freeze([Mi,Cc,_c,yo]);function N9(t=Yue){const e=re();return oe("getRelevantStyles",()=>{var s;const n=new bC(e.getSharedStyles()),r=!!((s=e.root.getCurrent())!=null&&s.shapeType),i=e.isIn("select")&&e.getSelectedShapeIds().length>0;if(n.size===0&&e.isIn("select")&&e.getSelectedShapeIds().length===0)for(const o of t)n.applyValue(o,e.getStyleForNextShape(o));return r||i||n.size>0?n:null},[e])}const Qi={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],textAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],horizontalAlign:[{value:"start",icon:"horizontal-align-start"},{value:"middle",icon:"horizontal-align-middle"},{value:"end",icon:"horizontal-align-end"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-middle"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"star",icon:"geo-star"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"cloud",icon:"geo-cloud"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"},{value:"heart",icon:"geo-heart"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},pc=E.memo(function(e){const{uiType:n,items:r,title:i,style:s,value:o,onValueChange:l,onHistoryMark:u,theme:d}=e,f=ut(),g=E.useRef(!1),m=E.useRef(null),{handleButtonClick:S,handleButtonPointerDown:b,handleButtonPointerEnter:v,handleButtonPointerUp:w}=E.useMemo(()=>{const C=()=>{g.current=!1,window.removeEventListener("pointerup",C);const R=m.current;R&&["TEXTAREA","INPUT"].includes(R.nodeName)&&R.focus(),m.current=null};return{handleButtonClick:R=>{const{id:D}=R.currentTarget.dataset;o.type==="shared"&&o.value===D||(u==null||u("point picker item"),l(s,D))},handleButtonPointerDown:R=>{const{id:D}=R.currentTarget.dataset;u==null||u("point picker item"),l(s,D),g.current=!0,m.current=document.activeElement,window.addEventListener("pointerup",C)},handleButtonPointerEnter:R=>{if(!g.current)return;const{id:D}=R.currentTarget.dataset;l(s,D)},handleButtonPointerUp:R=>{const{id:D}=R.currentTarget.dataset;o.type==="shared"&&o.value===D||l(s,D)}}},[o,u,l,s]);return p.jsx("div",{"data-testid":`style.${n}`,className:je("tlui-buttons__grid"),children:r.map(C=>p.jsx($e,{type:"icon","data-id":C.value,"data-testid":`style.${n}.${C.value}`,"aria-label":C.value,"data-state":o.type==="shared"&&o.value===C.value?"hinted":void 0,title:i+"  "+f(`${n}-style.${C.value}`),className:je("tlui-button-grid__button"),style:s===Mi?{color:d[C.value].solid}:void 0,onPointerEnter:v,onPointerDown:b,onPointerUp:w,onClick:S,children:p.jsx(it,{icon:C.icon})},C.value))})});function z9(t,[e,n]){return Math.min(n,Math.max(e,t))}function Vue(t){const e=E.useRef({value:t,previous:t});return E.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var $9=["PageUp","PageDown"],B9=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],F9={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},kd="Slider",[a_,Wue,Xue]=TS(kd),[U9,Yye]=_o(kd,[Xue]),[Zue,iv]=U9(kd),H9=E.forwardRef((t,e)=>{const{name:n,min:r=0,max:i=100,step:s=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:u=0,defaultValue:d=[r],value:f,onValueChange:g=()=>{},onValueCommit:m=()=>{},inverted:S=!1,form:b,...v}=t,w=E.useRef(new Set),C=E.useRef(0),M=o==="horizontal"?Que:Jue,[I=[],A]=Rl({prop:f,defaultProp:d,onChange:$=>{var N;(N=[...w.current][C.current])==null||N.focus(),g($)}}),R=E.useRef(I);function D($){const F=ide(I,$);k($,F)}function L($){k($,C.current)}function G(){const $=R.current[C.current];I[C.current]!==$&&m(I)}function k($,F,{commit:N}={commit:!1}){const B=lde(s),Y=cde(Math.round(($-r)/s)*s+r,B),K=z9(Y,[r,i]);A((V=[])=>{const W=nde(V,K,F);if(ade(W,u*s)){C.current=W.indexOf(K);const ee=String(W)!==String(V);return ee&&N&&m(W),ee?W:V}else return V})}return p.jsx(Zue,{scope:t.__scopeSlider,name:n,disabled:l,min:r,max:i,valueIndexToChangeRef:C,thumbs:w.current,values:I,orientation:o,form:b,children:p.jsx(a_.Provider,{scope:t.__scopeSlider,children:p.jsx(a_.Slot,{scope:t.__scopeSlider,children:p.jsx(M,{"aria-disabled":l,"data-disabled":l?"":void 0,...v,ref:e,onPointerDown:Re(v.onPointerDown,()=>{l||(R.current=I)}),min:r,max:i,inverted:S,onSlideStart:l?void 0:D,onSlideMove:l?void 0:L,onSlideEnd:l?void 0:G,onHomeKeyDown:()=>!l&&k(r,0,{commit:!0}),onEndKeyDown:()=>!l&&k(i,I.length-1,{commit:!0}),onStepKeyDown:({event:$,direction:F})=>{if(!l){const Y=$9.includes($.key)||$.shiftKey&&B9.includes($.key)?10:1,K=C.current,V=I[K],W=s*Y*F;k(V+W,K,{commit:!0})}}})})})})});H9.displayName=kd;var[K9,G9]=U9(kd,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Que=E.forwardRef((t,e)=>{const{min:n,max:r,dir:i,inverted:s,onSlideStart:o,onSlideMove:l,onSlideEnd:u,onStepKeyDown:d,...f}=t,[g,m]=E.useState(null),S=Vt(e,M=>m(M)),b=E.useRef(void 0),v=L2(i),w=v==="ltr",C=w&&!s||!w&&s;function _(M){const I=b.current||g.getBoundingClientRect(),A=[0,I.width],D=VE(A,C?[n,r]:[r,n]);return b.current=I,D(M-I.left)}return p.jsx(K9,{scope:t.__scopeSlider,startEdge:C?"left":"right",endEdge:C?"right":"left",direction:C?1:-1,size:"width",children:p.jsx(q9,{dir:v,"data-orientation":"horizontal",...f,ref:S,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:M=>{const I=_(M.clientX);o==null||o(I)},onSlideMove:M=>{const I=_(M.clientX);l==null||l(I)},onSlideEnd:()=>{b.current=void 0,u==null||u()},onStepKeyDown:M=>{const A=F9[C?"from-left":"from-right"].includes(M.key);d==null||d({event:M,direction:A?-1:1})}})})}),Jue=E.forwardRef((t,e)=>{const{min:n,max:r,inverted:i,onSlideStart:s,onSlideMove:o,onSlideEnd:l,onStepKeyDown:u,...d}=t,f=E.useRef(null),g=Vt(e,f),m=E.useRef(void 0),S=!i;function b(v){const w=m.current||f.current.getBoundingClientRect(),C=[0,w.height],M=VE(C,S?[r,n]:[n,r]);return m.current=w,M(v-w.top)}return p.jsx(K9,{scope:t.__scopeSlider,startEdge:S?"bottom":"top",endEdge:S?"top":"bottom",size:"height",direction:S?1:-1,children:p.jsx(q9,{"data-orientation":"vertical",...d,ref:g,style:{...d.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const w=b(v.clientY);s==null||s(w)},onSlideMove:v=>{const w=b(v.clientY);o==null||o(w)},onSlideEnd:()=>{m.current=void 0,l==null||l()},onStepKeyDown:v=>{const C=F9[S?"from-bottom":"from-top"].includes(v.key);u==null||u({event:v,direction:C?-1:1})}})})}),q9=E.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:u,...d}=t,f=iv(kd,n);return p.jsx(gt.span,{...d,ref:e,onKeyDown:Re(t.onKeyDown,g=>{g.key==="Home"?(o(g),g.preventDefault()):g.key==="End"?(l(g),g.preventDefault()):$9.concat(B9).includes(g.key)&&(u(g),g.preventDefault())}),onPointerDown:Re(t.onPointerDown,g=>{const m=g.target;m.setPointerCapture(g.pointerId),g.preventDefault(),f.thumbs.has(m)?m.focus():r(g)}),onPointerMove:Re(t.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&i(g)}),onPointerUp:Re(t.onPointerUp,g=>{const m=g.target;m.hasPointerCapture(g.pointerId)&&(m.releasePointerCapture(g.pointerId),s(g))})})}),Y9="SliderTrack",V9=E.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=iv(Y9,n);return p.jsx(gt.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:e})});V9.displayName=Y9;var l_="SliderRange",W9=E.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=iv(l_,n),s=G9(l_,n),o=E.useRef(null),l=Vt(e,o),u=i.values.length,d=i.values.map(m=>Z9(m,i.min,i.max)),f=u>1?Math.min(...d):0,g=100-Math.max(...d);return p.jsx(gt.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:l,style:{...t.style,[s.startEdge]:f+"%",[s.endEdge]:g+"%"}})});W9.displayName=l_;var c_="SliderThumb",X9=E.forwardRef((t,e)=>{const n=Wue(t.__scopeSlider),[r,i]=E.useState(null),s=Vt(e,l=>i(l)),o=E.useMemo(()=>r?n().findIndex(l=>l.ref.current===r):-1,[n,r]);return p.jsx(ede,{...t,ref:s,index:o})}),ede=E.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,name:i,...s}=t,o=iv(c_,n),l=G9(c_,n),[u,d]=E.useState(null),f=Vt(e,_=>d(_)),g=u?o.form||!!u.closest("form"):!0,m=qN(u),S=o.values[r],b=S===void 0?0:Z9(S,o.min,o.max),v=rde(r,o.values.length),w=m==null?void 0:m[l.size],C=w?sde(w,b,l.direction):0;return E.useEffect(()=>{if(u)return o.thumbs.add(u),()=>{o.thumbs.delete(u)}},[u,o.thumbs]),p.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${b}% + ${C}px)`},children:[p.jsx(a_.ItemSlot,{scope:t.__scopeSlider,children:p.jsx(gt.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":o.min,"aria-valuenow":S,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...s,ref:f,style:S===void 0?{display:"none"}:t.style,onFocus:Re(t.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),g&&p.jsx(tde,{name:i??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:S},r)]})});X9.displayName=c_;var tde=t=>{const{value:e,...n}=t,r=E.useRef(null),i=Vue(e);return E.useEffect(()=>{const s=r.current,o=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(o,"value").set;if(i!==e&&u){const d=new Event("input",{bubbles:!0});u.call(s,e),s.dispatchEvent(d)}},[i,e]),p.jsx("input",{style:{display:"none"},...n,ref:r,defaultValue:e})};function nde(t=[],e,n){const r=[...t];return r[n]=e,r.sort((i,s)=>i-s)}function Z9(t,e,n){const s=100/(n-e)*(t-e);return z9(s,[0,100])}function rde(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function ide(t,e){if(t.length===1)return 0;const n=t.map(i=>Math.abs(i-e)),r=Math.min(...n);return n.indexOf(r)}function sde(t,e,n){const r=t/2,s=VE([0,50],[0,r]);return(r-s(e)*n)*n}function ode(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function ade(t,e){if(e>0){const n=ode(t);return Math.min(...n)>=e}return!0}function VE(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function lde(t){return(String(t).split(".")[1]||"").length}function cde(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var ude=H9,dde=V9,hde=W9,fde=X9;const pde=E.memo(function({onHistoryMark:e,title:n,steps:r,value:i,label:s,onValueChange:o,["data-testid"]:l}){const u=ut(),d=E.useCallback(m=>{o(m[0])},[o]),f=E.useCallback(()=>{e("click slider")},[e]),g=E.useCallback(()=>{i&&o(i)},[i,o]);return p.jsx("div",{className:"tlui-slider__container",children:p.jsxs(ude,{"data-testid":l,className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:i?[i]:void 0,onPointerDown:f,onValueChange:d,onPointerUp:g,title:n+"  "+u(s),children:[p.jsx(dde,{className:"tlui-slider__track",dir:"ltr",children:i!==null&&p.jsx(hde,{className:"tlui-slider__range",dir:"ltr"})}),i!==null&&p.jsx(fde,{className:"tlui-slider__thumb",dir:"ltr"})]})})});function gde({label:t,uiTypeA:e,uiTypeB:n,labelA:r,labelB:i,itemsA:s,itemsB:o,styleA:l,styleB:u,valueA:d,valueB:f,onValueChange:g}){const m=ut(),S=E.useMemo(()=>{var v;return((v=s.find(w=>d.type==="shared"&&d.value===w.value))==null?void 0:v.icon)??"mixed"},[s,d]),b=E.useMemo(()=>{var v;return((v=o.find(w=>f.type==="shared"&&f.value===w.value))==null?void 0:v.icon)??"mixed"},[o,f]);return d===void 0&&f===void 0?null:p.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[p.jsx("div",{title:m(t),className:"tlui-style-panel__double-select-picker-label",children:m(t)}),p.jsxs("div",{className:"tlui-buttons__horizontal",children:[p.jsxs(Ic,{id:`style panel ${e} A`,children:[p.jsx(Mc,{children:p.jsx($e,{type:"icon","data-testid":`style.${e}`,title:m(r)+"  "+(d===null||d.type==="mixed"?m("style-panel.mixed"):m(`${e}-style.${d.value}`)),children:p.jsx(it,{icon:S,small:!0,invertIcon:!0})})}),p.jsx(Ac,{side:"left",align:"center",sideOffset:80,alignOffset:0,children:p.jsx("div",{className:"tlui-buttons__grid",children:s.map((v,w)=>p.jsx(Bf,{"data-testid":`style.${e}.${v.value}`,children:p.jsx($e,{type:"icon",onClick:()=>g(l,v.value),title:`${m(r)}  ${m(`${e}-style.${v.value}`)}`,children:p.jsx(it,{icon:v.icon,invertIcon:!0})},v.value)},w))})})]}),p.jsxs(Ic,{id:`style panel ${n}`,children:[p.jsx(Mc,{children:p.jsx($e,{type:"icon","data-testid":`style.${n}`,title:m(i)+"  "+(f===null||f.type==="mixed"?m("style-panel.mixed"):m(`${n}-style.${f.value}`)),children:p.jsx(it,{icon:b,small:!0})})}),p.jsx(Ac,{side:"left",align:"center",sideOffset:116,alignOffset:0,children:p.jsx("div",{className:"tlui-buttons__grid",children:o.map(v=>p.jsx(Bf,{children:p.jsx($e,{type:"icon",title:`${m(i)}  ${m(`${n}-style.${v.value}`)}`,"data-testid":`style.${n}.${v.value}`,onClick:()=>g(u,v.value),children:p.jsx(it,{icon:v.icon})})},v.value))})})]})]})]})}const mde=E.memo(gde);function yde({id:t,label:e,uiType:n,stylePanelType:r,style:i,items:s,type:o,value:l,onValueChange:u}){const d=ut(),f=re(),g=E.useMemo(()=>{var v;return(v=s.find(w=>l.type==="shared"&&w.value===l.value))==null?void 0:v.icon},[s,l]),m=d(`style-panel.${r}`),S=l.type==="mixed"?d("style-panel.mixed"):m+"  "+d(`${n}-style.${l.value}`),b=e?d(e):"";return p.jsxs(Ic,{id:`style panel ${t}`,children:[p.jsx(Mc,{children:p.jsxs($e,{type:o,"data-testid":`style.${n}`,title:S,children:[b&&p.jsx(wn,{children:b}),p.jsx(it,{icon:g??"mixed"})]})}),p.jsx(Ac,{side:"left",align:"center",alignOffset:0,children:p.jsx("div",{className:"tlui-buttons__grid",children:s.map(v=>p.jsx(Bf,{children:p.jsx($e,{type:"icon","data-testid":`style.${n}.${v.value}`,title:m+"  "+d(`${n}-style.${v.value}`),onClick:()=>{f.markHistoryStoppingPoint("select style dropdown item"),u(i,v.value)},children:p.jsx(it,{icon:v.icon})})},v.value))})})]})}const WE=E.memo(yde);function Sde({styles:t}){const e=dp();if(!t)return null;const n=t.get(Ms),r=t.get(xy),i=t.get(by),s=t.get(Ey),o=t.get(mo),l=n===void 0,u=r===void 0&&i===void 0,d=s===void 0,f=o===void 0,g=Ca({isDarkMode:e});return p.jsxs(p.Fragment,{children:[p.jsx(vde,{theme:g,styles:t}),!f&&p.jsx(bde,{theme:g,styles:t}),!(l&&u&&d)&&p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[p.jsx(xde,{styles:t}),p.jsx(Cde,{styles:t}),p.jsx(wde,{styles:t})]})]})}function bp(){const t=re(),e=or();return et.useMemo(()=>function(r,i){t.run(()=>{t.isIn("select")&&t.setStyleForSelectedShapes(r,i),t.setStyleForNextShapes(r,i),t.updateInstanceState({isChangingStyle:!0})}),e("set-style",{source:"style-panel",id:r.id,value:i})},[t,e])}function vde({styles:t,theme:e}){const n=ut(),r=re(),i=E.useCallback(g=>r.markHistoryStoppingPoint(g),[r]),s=bp(),o=t.get(Mi),l=t.get(_c),u=t.get(Cc),d=t.get(yo),f=l!==void 0||u!==void 0||d!==void 0;return p.jsxs(p.Fragment,{children:[p.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles","data-testid":"style.panel",children:[o===void 0?null:p.jsx(pc,{title:n("style-panel.color"),uiType:"color",style:Mi,items:Qi.color,value:o,onValueChange:s,theme:e,onHistoryMark:i}),p.jsx(_de,{})]}),f&&p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[l===void 0?null:p.jsx(pc,{title:n("style-panel.fill"),uiType:"fill",style:_c,items:Qi.fill,value:l,onValueChange:s,theme:e,onHistoryMark:i}),u===void 0?null:p.jsx(pc,{title:n("style-panel.dash"),uiType:"dash",style:Cc,items:Qi.dash,value:u,onValueChange:s,theme:e,onHistoryMark:i}),d===void 0?null:p.jsx(pc,{title:n("style-panel.size"),uiType:"size",style:yo,items:Qi.size,value:d,onValueChange:(g,m)=>{s(g,m);const S=r.getSelectedShapeIds();S.length>0&&qt(r,S)},theme:e,onHistoryMark:i})]})]})}function bde({theme:t,styles:e}){const n=ut(),r=bp(),i=re(),s=E.useCallback(f=>i.markHistoryStoppingPoint(f),[i]),o=e.get(mo),l=e.get(dC),u=e.get(Cy),d=e.get(_y);return o===void 0&&u===void 0?null:p.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[o===void 0?null:p.jsx(pc,{title:n("style-panel.font"),uiType:"font",style:mo,items:Qi.font,value:o,onValueChange:r,theme:t,onHistoryMark:s}),l===void 0?null:p.jsxs("div",{className:"tlui-style-panel__row",children:[p.jsx(pc,{title:n("style-panel.align"),uiType:"align",style:dC,items:Qi.textAlign,value:l,onValueChange:r,theme:t,onHistoryMark:s}),p.jsx("div",{className:"tlui-style-panel__row__extra-button",children:p.jsx($e,{type:"icon",title:n("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:p.jsx(it,{icon:"vertical-align-middle"})})})]}),u===void 0?null:p.jsxs("div",{className:"tlui-style-panel__row",children:[p.jsx(pc,{title:n("style-panel.label-align"),uiType:"align",style:Cy,items:Qi.horizontalAlign,value:u,onValueChange:r,theme:t,onHistoryMark:s}),p.jsx("div",{className:"tlui-style-panel__row__extra-button",children:d===void 0?p.jsx($e,{type:"icon",title:n("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:p.jsx(it,{icon:"vertical-align-middle"})}):p.jsx(WE,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",stylePanelType:"vertical-align",style:_y,items:Qi.verticalAlign,value:d,onValueChange:r})})]})]})}function xde({styles:t}){const e=bp(),n=t.get(Ms);return n===void 0?null:p.jsx(WE,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",stylePanelType:"geo",style:Ms,items:Qi.geo,value:n,onValueChange:e})}function wde({styles:t}){const e=bp(),n=t.get(Ey);return n===void 0?null:p.jsx(WE,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",stylePanelType:"spline",style:Ey,items:Qi.spline,value:n,onValueChange:e})}function Cde({styles:t}){const e=bp(),n=t.get(xy),r=t.get(by);return!n||!r?null:p.jsx(mde,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:by,itemsA:Qi.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:xy,itemsB:Qi.arrowheadEnd,valueB:n,onValueChange:e,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}const Zh=[.1,.25,.5,.75,1];function _de(){const t=re(),e=E.useCallback(l=>t.markHistoryStoppingPoint(l),[t]),n=oe("opacity",()=>t.getSharedOpacity(),[t]),r=or(),i=ut(),s=et.useCallback(l=>{const u=Zh[l];t.run(()=>{t.isIn("select")&&t.setOpacityForSelectedShapes(u),t.setOpacityForNextShapes(u),t.updateInstanceState({isChangingStyle:!0})}),r("set-style",{source:"style-panel",id:"opacity",value:l})},[t,r]);if(n===void 0)return null;const o=n.type==="mixed"?-1:Zh.indexOf(tH(Zh,l=>Math.abs(l-n.value)));return p.jsx(pde,{"data-testid":"style.opacity",value:o>=0?o:Zh.length-1,label:n.type==="mixed"?"style-panel.mixed":`opacity-style.${n.value}`,onValueChange:s,steps:Zh.length-1,title:i("style-panel.opacity"),onHistoryMark:e})}const Ede=E.memo(function({isMobile:e,children:n}){const r=re(),i=E.useRef(null);kl(i);const s=N9(),o=E.useCallback(()=>{e||r.updateInstanceState({isChangingStyle:!1})},[r,e]),l=n??p.jsx(Sde,{styles:s});return p.jsx("div",{ref:i,className:je("tlui-style-panel",{"tlui-style-panel__wrapper":!e}),"data-ismobile":e,onPointerLeave:o,children:l})});function Pde(){const t=re(),e=ut(),n=N9(),r=n==null?void 0:n.get(Mi),i=Ca({isDarkMode:t.user.getIsDarkMode()}),s=((r==null?void 0:r.type)==="shared"?i[r.value]:i.black).solid,o=oe("disable style panel",()=>t.isInAny("hand","zoom","eraser","laser"),[t]),l=E.useCallback(d=>{d||t.updateInstanceState({isChangingStyle:!1})},[t]),{StylePanel:u}=Dl();return u?p.jsxs(KE,{id:"mobile style menu",onOpenChange:l,children:[p.jsx(GE,{children:p.jsx($e,{type:"tool","data-testid":"mobile-styles.button",style:{color:o?"var(--color-muted-1)":s},title:e("style-panel.title"),disabled:o,children:p.jsx(it,{icon:o?"blob":(r==null?void 0:r.type)==="mixed"?"mixed":"blob"})})}),p.jsx(qE,{side:"top",align:"end",children:u&&p.jsx(u,{isMobile:!0})})]}):null}function Q9(){return p.jsxs(p.Fragment,{children:[p.jsx(Tde,{}),p.jsx(Ide,{}),p.jsx(Mde,{}),p.jsx(Ade,{}),p.jsx(kde,{}),p.jsx(Rde,{}),p.jsx(Ode,{}),p.jsx(jde,{}),p.jsx(Dde,{}),p.jsx(Lde,{}),p.jsx(zde,{}),p.jsx(Nde,{}),p.jsx(Fde,{}),p.jsx(Kde,{}),p.jsx($de,{}),p.jsx(Hde,{}),p.jsx(Ude,{}),p.jsx(Bde,{}),p.jsx(Gde,{}),p.jsx(qde,{}),p.jsx(Yde,{}),p.jsx(Vde,{}),p.jsx(Wde,{}),p.jsx(Xde,{}),p.jsx(Zde,{}),p.jsx(Qde,{}),p.jsx(ehe,{}),p.jsx(Jde,{})]})}function Jm(t){var r;const e=re(),n=(r=t.meta)==null?void 0:r.geo;return oe("is tool selected",()=>{const i=e.getCurrentToolId(),s=e.getSharedStyles().getAsKnownValue(Ms);return n?i==="geo"&&s===n:i===t.id},[e,t.id,n])}function Ut({tool:t}){const e=VS(),n=Jm(e[t]);return p.jsx(Wr,{toolId:t,isSelected:n})}function Tde(){return p.jsx(Ut,{tool:"select"})}function Ide(){return p.jsx(Ut,{tool:"hand"})}function Mde(){return p.jsx(Ut,{tool:"draw"})}function Ade(){return p.jsx(Ut,{tool:"eraser"})}function kde(){return p.jsx(Ut,{tool:"arrow"})}function Rde(){return p.jsx(Ut,{tool:"text"})}function Ode(){return p.jsx(Ut,{tool:"note"})}function jde(){return p.jsx(Wr,{toolId:"asset"})}function Dde(){return p.jsx(Ut,{tool:"rectangle"})}function Lde(){return p.jsx(Ut,{tool:"ellipse"})}function Nde(){return p.jsx(Ut,{tool:"diamond"})}function zde(){return p.jsx(Ut,{tool:"triangle"})}function $de(){return p.jsx(Ut,{tool:"rhombus"})}function Bde(){return p.jsx(Ut,{tool:"heart"})}function Fde(){return p.jsx(Ut,{tool:"hexagon"})}function Ude(){return p.jsx(Ut,{tool:"cloud"})}function Hde(){return p.jsx(Ut,{tool:"star"})}function Kde(){return p.jsx(Ut,{tool:"oval"})}function Gde(){return p.jsx(Ut,{tool:"x-box"})}function qde(){return p.jsx(Ut,{tool:"check-box"})}function Yde(){return p.jsx(Ut,{tool:"arrow-left"})}function Vde(){return p.jsx(Ut,{tool:"arrow-up"})}function Wde(){return p.jsx(Ut,{tool:"arrow-down"})}function Xde(){return p.jsx(Ut,{tool:"arrow-right"})}function Zde(){return p.jsx(Ut,{tool:"line"})}function Qde(){return p.jsx(Ut,{tool:"highlight"})}function Jde(){return p.jsx(Ut,{tool:"frame"})}function ehe(){return p.jsx(Ut,{tool:"laser"})}const x1=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function w1(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on".concat(e),n)}function Qh(t,e,n,r){t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on".concat(e),n)}function J9(t,e){const n=e.slice(0,e.length-1);for(let r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function e7(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const e=t.split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function the(t,e){const n=t.length>=e.length?t:e,r=t.length>=e.length?e:t;let i=!0;for(let s=0;s<n.length;s++)r.indexOf(n[s])===-1&&(i=!1);return i}const Uf={backspace:8,"":8,tab:9,clear:12,enter:13,"":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"":20,",":188,".":190,"/":191,"`":192,"-":x1?173:189,"=":x1?61:187,";":x1?59:186,"'":222,"[":219,"]":221,"\\":220},xo={"":16,shift:16,"":18,alt:18,option:18,"":17,ctrl:17,control:17,"":91,cmd:91,command:91},ey={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Zn={16:!1,18:!1,17:!1,91:!1},un={};for(let t=1;t<20;t++)Uf["f".concat(t)]=111+t;let en=[],Cf=null,t7="all";const oa=new Map,xp=t=>Uf[t.toLowerCase()]||xo[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),nhe=t=>Object.keys(Uf).find(e=>Uf[e]===t),rhe=t=>Object.keys(xo).find(e=>xo[e]===t);function n7(t){t7=t||"all"}function Hf(){return t7||"all"}function ihe(){return en.slice(0)}function she(){return en.map(t=>nhe(t)||rhe(t)||String.fromCharCode(t))}function ohe(){const t=[];return Object.keys(un).forEach(e=>{un[e].forEach(n=>{let{key:r,scope:i,mods:s,shortcut:o}=n;t.push({scope:i,shortcut:o,mods:s,keys:r.split("+").map(l=>xp(l))})})}),t}function ahe(t){const e=t.target||t.srcElement,{tagName:n}=e;let r=!0;const i=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(i||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(r=!1),r}function lhe(t){return typeof t=="string"&&(t=xp(t)),en.indexOf(t)!==-1}function che(t,e){let n,r;t||(t=Hf());for(const i in un)if(Object.prototype.hasOwnProperty.call(un,i))for(n=un[i],r=0;r<n.length;)n[r].scope===t?n.splice(r,1).forEach(o=>{let{element:l}=o;return XE(l)}):r++;Hf()===t&&n7(e||"all")}function uhe(t){let e=t.keyCode||t.which||t.charCode;const n=en.indexOf(e);if(n>=0&&en.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&en.splice(0,en.length),(e===93||e===224)&&(e=91),e in Zn){Zn[e]=!1;for(const r in xo)xo[r]===e&&(Ji[r]=!1)}}function r7(t){if(typeof t>"u")Object.keys(un).forEach(i=>{Array.isArray(un[i])&&un[i].forEach(s=>gm(s)),delete un[i]}),XE(null);else if(Array.isArray(t))t.forEach(i=>{i.key&&gm(i)});else if(typeof t=="object")t.key&&gm(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];let[i,s]=n;typeof i=="function"&&(s=i,i=""),gm({key:t,scope:i,method:s,splitKey:"+"})}}const gm=t=>{let{key:e,scope:n,method:r,splitKey:i="+"}=t;e7(e).forEach(o=>{const l=o.split(i),u=l.length,d=l[u-1],f=d==="*"?"*":xp(d);if(!un[f])return;n||(n=Hf());const g=u>1?J9(xo,l):[],m=[];un[f]=un[f].filter(S=>{const v=(r?S.method===r:!0)&&S.scope===n&&the(S.mods,g);return v&&m.push(S.element),!v}),m.forEach(S=>XE(S))})};function Dj(t,e,n,r){if(e.element!==r)return;let i;if(e.scope===n||e.scope==="all"){i=e.mods.length>0;for(const s in Zn)Object.prototype.hasOwnProperty.call(Zn,s)&&(!Zn[s]&&e.mods.indexOf(+s)>-1||Zn[s]&&e.mods.indexOf(+s)===-1)&&(i=!1);(e.mods.length===0&&!Zn[16]&&!Zn[18]&&!Zn[17]&&!Zn[91]||i||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(en),e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function Lj(t,e){const n=un["*"];let r=t.keyCode||t.which||t.charCode;if(!Ji.filter.call(this,t))return;if((r===93||r===224)&&(r=91),en.indexOf(r)===-1&&r!==229&&en.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(l=>{const u=ey[l];t[l]&&en.indexOf(u)===-1?en.push(u):!t[l]&&en.indexOf(u)>-1?en.splice(en.indexOf(u),1):l==="metaKey"&&t[l]&&(en=en.filter(d=>d in ey||d===r))}),r in Zn){Zn[r]=!0;for(const l in xo)xo[l]===r&&(Ji[l]=!0);if(!n)return}for(const l in Zn)Object.prototype.hasOwnProperty.call(Zn,l)&&(Zn[l]=t[ey[l]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(en.indexOf(17)===-1&&en.push(17),en.indexOf(18)===-1&&en.push(18),Zn[17]=!0,Zn[18]=!0);const i=Hf();if(n)for(let l=0;l<n.length;l++)n[l].scope===i&&(t.type==="keydown"&&n[l].keydown||t.type==="keyup"&&n[l].keyup)&&Dj(t,n[l],i,e);if(!(r in un))return;const s=un[r],o=s.length;for(let l=0;l<o;l++)if((t.type==="keydown"&&s[l].keydown||t.type==="keyup"&&s[l].keyup)&&s[l].key){const u=s[l],{splitKey:d}=u,f=u.key.split(d),g=[];for(let m=0;m<f.length;m++)g.push(xp(f[m]));g.sort().join("")===en.sort().join("")&&Dj(t,u,i,e)}}function Ji(t,e,n){en=[];const r=e7(t);let i=[],s="all",o=document,l=0,u=!1,d=!0,f="+",g=!1,m=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(s=e.scope),e.element&&(o=e.element),e.keyup&&(u=e.keyup),e.keydown!==void 0&&(d=e.keydown),e.capture!==void 0&&(g=e.capture),typeof e.splitKey=="string"&&(f=e.splitKey),e.single===!0&&(m=!0)),typeof e=="string"&&(s=e),m&&r7(t,s);l<r.length;l++)t=r[l].split(f),i=[],t.length>1&&(i=J9(xo,t)),t=t[t.length-1],t=t==="*"?"*":xp(t),t in un||(un[t]=[]),un[t].push({keyup:u,keydown:d,scope:s,mods:i,shortcut:r[l],method:n,key:r[l],splitKey:f,element:o});if(typeof o<"u"&&window){if(!oa.has(o)){const S=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return Lj(v,o)},b=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;Lj(v,o),uhe(v)};oa.set(o,{keydownListener:S,keyupListenr:b,capture:g}),w1(o,"keydown",S,g),w1(o,"keyup",b,g)}if(!Cf){const S=()=>{en=[]};Cf={listener:S,capture:g},w1(window,"focus",S,g)}}}function dhe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(un).forEach(n=>{un[n].filter(i=>i.scope===e&&i.shortcut===t).forEach(i=>{i&&i.method&&i.method()})})}function XE(t){const e=Object.values(un).flat();if(e.findIndex(r=>{let{element:i}=r;return i===t})<0){const{keydownListener:r,keyupListenr:i,capture:s}=oa.get(t)||{};r&&i&&(Qh(t,"keyup",i,s),Qh(t,"keydown",r,s),oa.delete(t))}if((e.length<=0||oa.size<=0)&&(Object.keys(oa).forEach(i=>{const{keydownListener:s,keyupListenr:o,capture:l}=oa.get(i)||{};s&&o&&(Qh(i,"keyup",o,l),Qh(i,"keydown",s,l),oa.delete(i))}),oa.clear(),Object.keys(un).forEach(i=>delete un[i]),Cf)){const{listener:i,capture:s}=Cf;Qh(window,"focus",i,s),Cf=null}}const C1={getPressedKeyString:she,setScope:n7,getScope:Hf,deleteScope:che,getPressedKeyCodes:ihe,getAllKeyCodes:ohe,isPressed:lhe,filter:ahe,trigger:dhe,unbind:r7,keyMap:Uf,modifier:xo,modifierMap:ey};for(const t in C1)Object.prototype.hasOwnProperty.call(C1,t)&&(Ji[t]=C1[t]);if(typeof window<"u"){const t=window.hotkeys;Ji.noConflict=e=>(e&&window.hotkeys===Ji&&(window.hotkeys=t),Ji),window.hotkeys=Ji}const Nj=["copy","cut","paste","asset"];function hhe(){const t=re(),e=Ri(),n=$c(),r=VS(),i=oe("is focused",()=>t.getInstanceState().isFocused,[t]);E.useEffect(()=>{if(!i)return;const s=new Array,o=(u,d)=>{Ji(u,{element:document.body},d),s.push(()=>{Ji.unbind(u,d)})},l=(u,d)=>{Ji(u,{element:document.body,keyup:!0,keydown:!1},d),s.push(()=>{Ji.unbind(u,d)})};for(const u of Object.values(n))u.kbd&&(e&&!u.readonlyOk||Nj.includes(u.id)||o(zj(u.kbd),d=>{hf(t)||(Je(d),u.onSelect("kbd"))}));for(const u of Object.values(r))!u.kbd||!u.readonlyOk&&t.getIsReadonly()||Nj.includes(u.id)||o(zj(u.kbd),d=>{hf(t)||(Je(d),u.onSelect("kbd"))});return o(",",u=>{if(hf(t)||t.inputs.keys.has("Comma"))return;Je(u),t.focus(),t.inputs.keys.add("Comma");const{x:d,y:f,z:g}=t.inputs.currentPagePoint,m=t.pageToScreen({x:d,y:f}),S={type:"pointer",name:"pointer_down",point:{x:m.x,y:m.y,z:g},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey,metaKey:u.metaKey,accelKey:br(u),pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(S)}),l(",",u=>{if(hf(t)||!t.inputs.keys.has("Comma"))return;t.inputs.keys.delete("Comma");const{x:d,y:f,z:g}=t.inputs.currentScreenPoint,m={type:"pointer",name:"pointer_up",point:{x:d,y:f,z:g},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey,metaKey:u.metaKey,accelKey:br(u),pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(m)}),()=>{s.forEach(u=>u())}},[n,r,e,t,i])}function zj(t){return fhe(t).map(e=>{let n="";const r=e.split("");return r.length===1?n=r[0]:r[0]==="!"?n=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?n=`alt+shift+${r[2]}`:n=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?n=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?n=`cmd++${r[2]},ctrl+alt+${r[2]}`:n=`cmd+${r[1]},ctrl+${r[1]}`:n=e,n}).join(",")}function fhe(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const e=t.split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function hf(t){return t.menus.hasAnyOpenMenus()||t.getEditingShapeId()!==null||t.getCrashingError()}const phe=E.createContext(!1),ghe={1:0,2:1,3:2,4:3,5:4,6:5,7:6,8:7,9:8,0:9};function mhe({children:t}){const e=re(),n=xd(),r=zr(),i=ut(),s=E.useRef([]),o=Math.min(8,5+r),[l,u]=E.useState(0),d=E.useRef(null),[f,g]=E.useState(null),m=E.useMemo(()=>{const b=f?`:not([data-value="${f}"])`:"";return`
			#${n}_main > *:nth-child(n + ${o+(f?1:2)})${b} {
				display: none;
			}
			#${n}_more > *:nth-child(-n + ${o}) {
				display: none;
			}
        `},[f,n,o]),S=SS(()=>{var C;if(!d.current)return;const b=Array.from(d.current.children);u(b.length),b.findIndex(_=>_.getAttribute("data-value")===f)<=o&&g(null);const w=Array.from(d.current.children).findIndex(_=>_.getAttribute("aria-checked")==="true");w!==-1&&(w>=o&&g(b[w].getAttribute("data-value")),s.current=Array.from(((C=d.current)==null?void 0:C.children)??[]).filter(_=>!(_ instanceof HTMLElement)||_.tagName.toLowerCase()!=="button"?!1:!!(_.offsetWidth||_.offsetHeight)))});return E.useLayoutEffect(()=>{S()}),E.useLayoutEffect(()=>{if(!d.current)return;const b=new MutationObserver(S);return b.observe(d.current,{childList:!0,subtree:!0,attributeFilter:["data-value","aria-checked"]}),()=>{b.disconnect()}},[S]),E.useEffect(()=>{if(!e.options.enableToolbarKeyboardShortcuts)return;function b(v){var C;if(hf(e)||F3()||v.ctrlKey||v.metaKey||v.altKey||v.shiftKey)return;const w=ghe[v.key];typeof w=="number"&&(Je(v),(C=s.current[w])==null||C.click())}return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[e]),p.jsxs(p.Fragment,{children:[p.jsx("style",{children:m}),p.jsxs("div",{className:je("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<Sn.TABLET_SM}),role:"radiogroup",children:[p.jsx("div",{id:`${n}_main`,ref:d,className:"tlui-toolbar__tools__list",children:p.jsx(rs,{type:"toolbar",sourceId:"toolbar",children:t})}),l>o+1&&p.jsx(phe.Provider,{value:!0,children:p.jsxs(Ic,{id:"toolbar overflow",modal:!1,children:[p.jsx(Mc,{children:p.jsx($e,{title:i("tool-panel.more"),type:"tool",className:"tlui-toolbar__overflow","data-testid":"tools.more-button",children:p.jsx(it,{icon:"chevron-up"})})}),p.jsx(Ac,{side:"top",align:"center",children:p.jsx("div",{className:"tlui-buttons__grid","data-testid":"tools.more-content",id:`${n}_more`,children:p.jsx(rs,{type:"toolbar-overflow",sourceId:"toolbar",children:t})})})]})})]})]})}function yhe({activeToolId:t}){const e=re(),n=zr(),r=ut(),i=oe("is tool locked",()=>e.getInstanceState().isToolLocked,[e]),s=oe("current tool",()=>e.getCurrentTool(),[e]);return!t||!s.isLockable?null:p.jsx($e,{type:"normal",title:r("action.toggle-tool-lock"),"data-testid":"tool-lock",className:je("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<Sn.TABLET_SM}),onClick:()=>e.updateInstanceState({isToolLocked:!i}),children:p.jsx(it,{icon:i?"lock":"unlock",small:!0})})}const i7=E.memo(function({children:e}){const n=re(),r=zr(),i=Ri(),s=oe("current tool id",()=>n.getCurrentToolId(),[n]),o=E.useRef(null);kl(o);const{ActionsMenu:l,QuickActions:u}=Dl(),d=n.options.actionShortcutsLocation==="menu"?!1:n.options.actionShortcutsLocation==="toolbar"?!0:r<Sn.TABLET;return p.jsx("div",{ref:o,className:"tlui-toolbar",children:p.jsxs("div",{className:"tlui-toolbar__inner",children:[p.jsxs("div",{className:"tlui-toolbar__left",children:[!i&&p.jsxs("div",{className:"tlui-toolbar__extras",children:[d&&p.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[u&&p.jsx(u,{}),l&&p.jsx(l,{})]}),p.jsx(yhe,{activeToolId:s})]}),p.jsx(mhe,{children:e??p.jsx(Q9,{})})]}),r<Sn.TABLET_SM&&!i&&p.jsx("div",{className:"tlui-toolbar__tools",children:p.jsx(Pde,{})})]})})});function She(){const t=ut();return p.jsxs("div",{className:je("tlui-offline-indicator"),children:[t("status.offline"),p.jsx(vo,{"aria-label":"offline",icon:"status-offline",small:!0})]})}function vhe({maxWidth:t=420,ignoreRightWidth:e=0,stylePanelWidth:n=148,marginBetweenZones:r=12,squeezeAmount:i=52,children:s}){const o=E.useRef(null),l=zr(),u=E.useCallback(()=>{const d=o.current;if(!d)return;const f=d.parentElement.parentElement,g=f.querySelector(".tlui-layout__top__left"),m=f.querySelector(".tlui-layout__top__right"),S=f.offsetWidth,b=g.offsetWidth,v=m.offsetWidth,w=d.offsetWidth-e;let C=(S-w)/2;S%2!==0&&(C-=.5);const _=b+r,M=d.offsetLeft,I=Math.min(S-v-b-2*r,t),A=Math.max(C,_)-M;m.offsetWidth>n&&l<=6?d.style.setProperty("max-width",I-i+"px"):d.style.setProperty("max-width",I+"px"),d.style.setProperty("transform",`translate(${A}px, 0px)`)},[l,e,r,t,i,n]);return E.useLayoutEffect(()=>{const d=o.current;if(!d)return;const f=d.parentElement.parentElement,g=f.querySelector(".tlui-layout__top__left"),m=f.querySelector(".tlui-layout__top__right"),S=new ResizeObserver(u);return S.observe(g),S.observe(m),S.observe(f),S.observe(d),u(),()=>{S.disconnect()}},[u]),E.useLayoutEffect(()=>{u()}),p.jsx("div",{ref:o,className:"tlui-top-panel__container",children:s})}function bhe(){const t=Gre()==="offline";return p.jsx(vhe,{children:t&&p.jsx(She,{})})}function xhe(){return p.jsxs(p.Fragment,{children:[p.jsx(fe,{actionId:"zoom-in",noClose:!0}),p.jsx(fe,{actionId:"zoom-out",noClose:!0}),p.jsx(c9,{}),p.jsx(u9,{}),p.jsx(d9,{})]})}const whe=E.memo(function({children:e}){const n=zn(),[r,i]=Ea("zoom menu"),s=e??p.jsx(xhe,{});return p.jsxs(aE,{dir:"ltr",open:r,onOpenChange:i,modal:!1,children:[p.jsx(lE,{asChild:!0,dir:"ltr",children:p.jsx(Che,{})}),p.jsx(zS,{container:n,children:p.jsx(cE,{className:"tlui-menu",side:"top",align:"start",alignOffset:0,sideOffset:8,collisionPadding:4,children:p.jsx(rs,{type:"menu",sourceId:"zoom-menu",children:s})})})]})}),Che=E.forwardRef(function(e,n){const r=re(),i=zr(),s=oe("zoom",()=>r.getZoomLevel(),[r]),o=ut(),l=E.useCallback(()=>{r.resetZoom(r.getViewportScreenCenter(),{animation:{duration:r.options.animationMediumMs}})},[r]);return p.jsx($e,{ref:n,...e,type:"icon",title:`${o("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu-button",className:i<Sn.TABLET_SM?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:l,children:i<Sn.MOBILE?null:p.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(s*100),"%"]})})}),s7=E.createContext(null);function _he({overrides:t={},children:e}){const n=Cd(t),r=HS();return p.jsx(s7.Provider,{value:E.useMemo(()=>({ContextMenu:Fce,ActionsMenu:gce,HelpMenu:null,ZoomMenu:whe,MainMenu:xue,Minimap:kue,StylePanel:Ede,PageMenu:Due,NavigationPanel:Oue,Toolbar:i7,KeyboardShortcutsDialog:uue,QuickActions:$ue,HelperButtons:lue,DebugPanel:Jce,DebugMenu:Qce,MenuPanel:rue,SharePanel:r?que:null,CursorChatBubble:r?Kce:null,TopPanel:r?bhe:null,Dialogs:ose,Toasts:use,...n}),[n,r]),children:e})}function Dl(){const t=E.useContext(s7);if(!t)throw new Error("useTldrawUiComponents must be used within a TldrawUiComponentsProvider");return t}const Ehe=ir(function({overrides:e,components:n,assetUrls:r,onUiEvent:i,forceMobile:s,mediaMimeTypes:o,children:l}){const u=Ml();return p.jsx(d$.Provider,{value:o,children:p.jsx(yre,{assetUrls:Hle(r),children:p.jsx(bre,{overrides:qie(e),locale:(u==null?void 0:u.user.getLocale())??Qs.locale,children:p.jsx(cJ,{onEvent:i,children:p.jsx(mie,{children:p.jsx(Yre,{context:"tla",children:p.jsx(qre,{forceMobile:s,children:p.jsx(_he,{overrides:n,children:u?p.jsx(Phe,{overrides:e,children:l}):l})})})})})})})})});function Phe({overrides:t,children:e}){const n=Yie(t);return p.jsx(Wie,{overrides:n.actions,children:p.jsx(dse,{overrides:n.tools,children:e})})}function The(){const t=re(),{addToast:e}=_a();E.useEffect(()=>{function n({name:r,count:i}){e({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${i}). Please delete some shapes or move to a different page to continue.`,severity:"warning"})}return t.addListener("max-shapes",n),()=>{t.removeListener("max-shapes",n)}},[t,e])}const Ihe=et.memo(function({renderDebugMenuItems:e,children:n,hideUi:r,components:i,...s}){return p.jsx(Ehe,{...s,components:i,children:p.jsx(Mhe,{hideUi:r,renderDebugMenuItems:e,children:n})})}),Mhe=et.memo(function({children:e,hideUi:n,...r}){return p.jsxs(p.Fragment,{children:[e,n?null:p.jsx(Ahe,{...r})]})}),Ahe=et.memo(function(){const e=re(),n=ut(),r=zr(),i=Ri(),s=oe("focus",()=>e.getInstanceState().isFocusMode,[e]),o=oe("debug",()=>e.getInstanceState().isDebugMode,[e]),{SharePanel:l,TopPanel:u,MenuPanel:d,StylePanel:f,Toolbar:g,HelpMenu:m,NavigationPanel:S,HelperButtons:b,DebugPanel:v,CursorChatBubble:w,Toasts:C,Dialogs:_}=Dl();hhe(),jie(),The();const{"toggle-focus-mode":M}=$c();return p.jsxs("div",{className:je("tlui-layout",{"tlui-layout__mobile":r<Sn.TABLET_SM}),"data-breakpoint":r,children:[s?p.jsx("div",{className:"tlui-layout__top",children:p.jsx($e,{type:"icon",className:"tlui-focus-button",title:n("focus-mode.toggle-focus-mode"),onClick:()=>M.onSelect("menu"),children:p.jsx(it,{icon:"dot"})})}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"tlui-layout__top",children:[p.jsxs("div",{className:"tlui-layout__top__left",children:[d&&p.jsx(d,{}),b&&p.jsx(b,{})]}),p.jsx("div",{className:"tlui-layout__top__center",children:u&&p.jsx(u,{})}),p.jsxs("div",{className:"tlui-layout__top__right",children:[l&&p.jsx(l,{}),f&&r>=Sn.TABLET_SM&&!i&&p.jsx(f,{})]})]}),p.jsxs("div",{className:"tlui-layout__bottom",children:[p.jsxs("div",{className:"tlui-layout__bottom__main",children:[S&&p.jsx(S,{}),g&&p.jsx(g,{}),m&&p.jsx(m,{})]}),o&&v&&p.jsx(v,{})]})]}),C&&p.jsx(C,{}),_&&p.jsx(_,{}),p.jsx(Ble,{}),w&&p.jsx(w,{})]})});async function khe(t,e){const{url:n,style:r="normal",weight:i="500",display:s,featureSettings:o,stretch:l,unicodeRange:u,variant:d,format:f}=e,g={style:r,weight:i,display:s,featureSettings:o,stretch:l,unicodeRange:u,variant:d},m=new FontFace(t,`url(${n})`,g);return await m.load(),document.fonts.add(m),m.$$_url=n,m.$$_fontface=`
@font-face {
	font-family: ${m.family};
	font-stretch: ${m.stretch};
	font-weight: ${m.weight};
	font-style: ${m.style};
	src: url("${n}") format("${f}")
}`,m}const mm=(t,e)=>{const[n,r]=E.useState(2);return E.useEffect(()=>{let i=!1;return r(2),khe(t,e).then(()=>{i||r(0)}).catch(s=>{i||(console.error(s),r(1))}),()=>{i=!0}},[t,e]),n};function Rhe(t){return{draw:{url:t.fonts.draw,format:t.fonts.draw.split(".").pop()},serif:{url:t.fonts.serif,format:t.fonts.serif.split(".").pop()},sansSerif:{url:t.fonts.sansSerif,format:t.fonts.sansSerif.split(".").pop()},monospace:{url:t.fonts.monospace,format:t.fonts.monospace.split(".").pop()}}}function o7(t){const e=E.useMemo(()=>Rhe(t),[t]),n=[mm("tldraw_draw",e.draw),mm("tldraw_serif",e.serif),mm("tldraw_sans",e.sansSerif),mm("tldraw_mono",e.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}const Ohe=[...$le,...Ioe];function jhe(t){const{children:e,maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:i,acceptedVideoMimeTypes:s,onMount:o,components:l={},shapeUtils:u=[],bindingUtils:d=[],tools:f=[],embeds:g,...m}=t,S=Cd(l),b=E.useMemo(()=>({Scribble:WO,ShapeIndicators:wse,CollaboratorScribble:WO,SelectionForeground:vse,SelectionBackground:yse,Handles:hse,...S}),[S]),v=cl(u),w=E.useMemo(()=>Mb("type",v,J$),[v]),C=cl(d),_=E.useMemo(()=>Mb("type",C,v$),[C]),M=cl(f),I=E.useMemo(()=>Mb("id",Ohe,M),[M]),A=cl(i??Vf),R=cl(s??Zy),D=E.useMemo(()=>[...A,...R],[A,R]),L=NB(m.assetUrls),{done:G,error:k}=o7(L);return k?p.jsx(PN,{children:"Could not load assets. Please refresh the page."}):G?(w.find(F=>F.type==="embed")&&g&&Ky.setEmbedDefinitions(g),p.jsx(VQ,{initialState:"select",...m,components:b,shapeUtils:w,bindingUtils:_,tools:I,children:p.jsxs(Ihe,{...m,components:b,mediaMimeTypes:D,children:[p.jsx(Dhe,{maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:A,acceptedVideoMimeTypes:R,onMount:o}),e]})})):p.jsx(R2,{children:p.jsx(y2,{})})}function Dhe({maxImageDimension:t,maxAssetSize:e,acceptedImageMimeTypes:n,acceptedVideoMimeTypes:r,onMount:i}){const s=re(),o=_a(),l=ut();TN(()=>{const f=[];return f.push(cle(s)),Qse(s,{maxImageDimension:t,maxAssetSize:e,acceptedImageMimeTypes:n,acceptedVideoMimeTypes:r,toasts:o,msg:l}),f.push(s.store.props.onMount(s)),f.push(i==null?void 0:i(s)),()=>{f.forEach(g=>g==null?void 0:g())}});const{Canvas:u}=Zt(),{ContextMenu:d}=Dl();return d?p.jsx(d,{}):u?p.jsx(u,{}):null}E.memo(function(e){const[n,r]=E.useState(null),[i,s]=E.useState(null),o=cl(e.shapeUtils??[]),l=E.useMemo(()=>[...J$,...o],[o]),u=cl(e.bindingUtils??[]),d=E.useMemo(()=>[...v$,...u],[u]),f=tJ({snapshot:e.snapshot,shapeUtils:l}),g=NB(e.assetUrls),{done:m,error:S}=o7(g),{pageId:b,bounds:v,scale:w,pixelRatio:C,background:_,padding:M,darkMode:I,preserveAspectRatio:A,format:R="svg",licenseKey:D}=e;return E.useLayoutEffect(()=>{if(!i||!f||!m)return;let L=!1;const G=document.createElement("div");i.appendChild(G),i.classList.add("tl-container","tl-theme__light");const k=new _e({store:f,shapeUtils:l,bindingUtils:d,tools:[],getContainer:()=>G,licenseKey:D});b&&k.setCurrentPage(b);const $=k.getCurrentPageShapeIds();async function F(){const N=await k.toImage([...$],{bounds:v,scale:w,background:_,padding:M,darkMode:I,preserveAspectRatio:A,format:R});if(!N||L)return;const B=URL.createObjectURL(N.blob);r(B),k.dispose()}return F(),()=>{L=!0}},[R,i,f,l,d,b,v,w,_,M,I,A,m,S,D,C]),E.useEffect(()=>()=>{n&&URL.revokeObjectURL(n)},[n]),S?p.jsx(PN,{children:"Could not load assets."}):m?p.jsx("div",{ref:s,style:{position:"relative",width:"100%",height:"100%"},children:n&&p.jsx("img",{src:n,referrerPolicy:"strict-origin-when-cross-origin",style:{width:"100%",height:"100%"}})}):p.jsx(R2,{children:p.jsx(y2,{})})});E.memo(function({children:e}){const n=ut(),r=zr(),i=E.useRef(null);kl(i);const s=e??p.jsx(due,{});return r<Sn.MOBILE?null:p.jsx("div",{ref:i,className:"tlui-help-menu",children:p.jsxs(Ic,{id:"help menu",children:[p.jsx(Mc,{children:p.jsx($e,{type:"help",title:n("help-menu.title"),"data-testid":"help-menu.button",children:p.jsx(it,{icon:"question-mark",small:!0})})}),p.jsx(Ac,{side:"top",align:"end",alignOffset:0,sideOffset:8,children:p.jsx(rs,{type:"menu",sourceId:"help-menu",children:s})})]})})});const Lhe=st({schemaVersion:_r(1),storeVersion:Cm,recordVersions:Sy(Ye,st({version:Cm,subTypeVersions:Sy(Ye,Cm).optional(),subTypeKey:Ye.optional()}))}),Nhe=st({schemaVersion:_r(2),sequences:Sy(Ye,Cm)});st({tldrawFileFormatVersion:GG,schema:qG("schemaVersion",{1:Lhe,2:Nhe}),records:er(st({id:Ye,typeName:Ye}).allowUnknownProperties())});El("tldraw","3.8.1","esm");class u_ extends si{getDefaultProps(){return{w:200,h:200,text:"I'm a card!"}}getBoundsSnapGeometry(e){return new Rr({width:e.props.h/2,height:e.props.w/2,isFilled:!0})}canEdit(){return!1}canResize(){return!0}isAspectRatioLocked(){return!1}getGeometry(e){return new Rr({width:e.props.w,height:e.props.h,isFilled:!0})}onResize(e,n){return Nc(e,n)}component(e){return p.jsx(ks,{style:{backgroundColor:"#efefef"},children:p.jsx("span",{style:{position:"absolute",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:e.props.h/2,width:e.props.w/2},children:e.props.text})})}indicator(e){return p.jsx("rect",{width:e.props.w,height:e.props.h})}}O(u_,"type","card-shape"),O(u_,"props",{w:Le,h:Le,text:Ye});function zhe(t){const e=Math.floor(Math.random()*t.length);return t[e]}const a7=["Lorem","ipsum","dolor","sit","amet","consectetur","adipiscing","elit","Sed","placerat","auctor","eros","vitae","suscipit","Quisque","tempor","sodales","ipsum","sed","dictum","urna","luctus","ut","Vestibulum","vel","convallis","urna","Donec","eu","pellentesque","lacus","mattis","ultrices","nulla","Proin","tellus","odio","facilisis","quis","efficitur","at","tincidunt","et","urna","Sed","euismod","eros","vel","nulla","lobortis"],$j=12;class l7 extends Ae{onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onPointerDown(){const{currentPagePoint:e}=this.editor.inputs;this.editor.createShape({type:"card-shape",x:e.x-$j,y:e.y-$j,props:{text:zhe(a7)}})}}O(l7,"id","card");const Bj=12;class c7 extends Ae{onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onPointerDown(){const{currentPagePoint:e}=this.editor.inputs;this.editor.createShape({type:"cardgroup-shape",x:e.x-Bj,y:e.y-Bj,props:{}})}}O(c7,"id","cardgroup");class d_ extends si{getDefaultProps(){return{w:500,h:200}}getGeometry(e){return new Rr({width:e.props.w,height:e.props.h,isFilled:!0})}canEdit(){return!1}canResize(){return!0}isAspectRatioLocked(){return!1}onResize(e,n){return Nc(e,n)}canDropShapes(e,n){return!!n.every(r=>r.type==="card-shape")}onDragShapesOver(e,n){n.every(r=>r.parentId===e.id)||this.editor.reparentShapes(n,e.id)}onDragShapesOut(e,n){this.editor.reparentShapes(n,this.editor.getCurrentPageId())}component(){return p.jsx(ks,{style:{backgroundColor:"#ffffff",border:"1px solid #000000"}})}indicator(e){return p.jsx("rect",{width:e.props.w,height:e.props.h})}}O(d_,"type","cardgroup-shape"),O(d_,"props",{w:Le,h:Le});const Kf={black:"#000",white:"#fff"},Du={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Lu={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Nu={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},zu={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},$u={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},Jh={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},$he={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Rc(t,...e){const n=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${t}; visit ${n} for the full message.`}const Bhe="$$material";function qy(){return qy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qy.apply(null,arguments)}function Fhe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Uhe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var Hhe=function(){function t(n){var r=this;this._insertTag=function(i){var s;r.tags.length===0?r.insertionPoint?s=r.insertionPoint.nextSibling:r.prepend?s=r.container.firstChild:s=r.before:s=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,s),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Uhe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=Fhe(i);try{s.insertRule(r,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},t}(),pr="-ms-",Yy="-moz-",Et="-webkit-",u7="comm",ZE="rule",QE="decl",Khe="@import",d7="@keyframes",Ghe="@layer",qhe=Math.abs,sv=String.fromCharCode,Yhe=Object.assign;function Vhe(t,e){return Jn(t,0)^45?(((e<<2^Jn(t,0))<<2^Jn(t,1))<<2^Jn(t,2))<<2^Jn(t,3):0}function h7(t){return t.trim()}function Whe(t,e){return(t=e.exec(t))?t[0]:t}function Pt(t,e,n){return t.replace(e,n)}function h_(t,e){return t.indexOf(e)}function Jn(t,e){return t.charCodeAt(e)|0}function Gf(t,e,n){return t.slice(e,n)}function eo(t){return t.length}function JE(t){return t.length}function ym(t,e){return e.push(t),t}function Xhe(t,e){return t.map(e).join("")}var ov=1,pd=1,f7=0,oi=0,Rn=0,Rd="";function av(t,e,n,r,i,s,o){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:ov,column:pd,length:o,return:""}}function ef(t,e){return Yhe(av("",null,null,"",null,null,0),t,{length:-t.length},e)}function Zhe(){return Rn}function Qhe(){return Rn=oi>0?Jn(Rd,--oi):0,pd--,Rn===10&&(pd=1,ov--),Rn}function Pi(){return Rn=oi<f7?Jn(Rd,oi++):0,pd++,Rn===10&&(pd=1,ov++),Rn}function fo(){return Jn(Rd,oi)}function ty(){return oi}function wp(t,e){return Gf(Rd,t,e)}function qf(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function p7(t){return ov=pd=1,f7=eo(Rd=t),oi=0,[]}function g7(t){return Rd="",t}function ny(t){return h7(wp(oi-1,f_(t===91?t+2:t===40?t+1:t)))}function Jhe(t){for(;(Rn=fo())&&Rn<33;)Pi();return qf(t)>2||qf(Rn)>3?"":" "}function efe(t,e){for(;--e&&Pi()&&!(Rn<48||Rn>102||Rn>57&&Rn<65||Rn>70&&Rn<97););return wp(t,ty()+(e<6&&fo()==32&&Pi()==32))}function f_(t){for(;Pi();)switch(Rn){case t:return oi;case 34:case 39:t!==34&&t!==39&&f_(Rn);break;case 40:t===41&&f_(t);break;case 92:Pi();break}return oi}function tfe(t,e){for(;Pi()&&t+Rn!==57;)if(t+Rn===84&&fo()===47)break;return"/*"+wp(e,oi-1)+"*"+sv(t===47?t:Pi())}function nfe(t){for(;!qf(fo());)Pi();return wp(t,oi)}function rfe(t){return g7(ry("",null,null,null,[""],t=p7(t),0,[0],t))}function ry(t,e,n,r,i,s,o,l,u){for(var d=0,f=0,g=o,m=0,S=0,b=0,v=1,w=1,C=1,_=0,M="",I=i,A=s,R=r,D=M;w;)switch(b=_,_=Pi()){case 40:if(b!=108&&Jn(D,g-1)==58){h_(D+=Pt(ny(_),"&","&\f"),"&\f")!=-1&&(C=-1);break}case 34:case 39:case 91:D+=ny(_);break;case 9:case 10:case 13:case 32:D+=Jhe(b);break;case 92:D+=efe(ty()-1,7);continue;case 47:switch(fo()){case 42:case 47:ym(ife(tfe(Pi(),ty()),e,n),u);break;default:D+="/"}break;case 123*v:l[d++]=eo(D)*C;case 125*v:case 59:case 0:switch(_){case 0:case 125:w=0;case 59+f:C==-1&&(D=Pt(D,/\f/g,"")),S>0&&eo(D)-g&&ym(S>32?Uj(D+";",r,n,g-1):Uj(Pt(D," ","")+";",r,n,g-2),u);break;case 59:D+=";";default:if(ym(R=Fj(D,e,n,d,f,i,l,M,I=[],A=[],g),s),_===123)if(f===0)ry(D,e,R,R,I,s,g,l,A);else switch(m===99&&Jn(D,3)===110?100:m){case 100:case 108:case 109:case 115:ry(t,R,R,r&&ym(Fj(t,R,R,0,0,i,l,M,i,I=[],g),A),i,A,g,l,r?I:A);break;default:ry(D,R,R,R,[""],A,0,l,A)}}d=f=S=0,v=C=1,M=D="",g=o;break;case 58:g=1+eo(D),S=b;default:if(v<1){if(_==123)--v;else if(_==125&&v++==0&&Qhe()==125)continue}switch(D+=sv(_),_*v){case 38:C=f>0?1:(D+="\f",-1);break;case 44:l[d++]=(eo(D)-1)*C,C=1;break;case 64:fo()===45&&(D+=ny(Pi())),m=fo(),f=g=eo(M=D+=nfe(ty())),_++;break;case 45:b===45&&eo(D)==2&&(v=0)}}return s}function Fj(t,e,n,r,i,s,o,l,u,d,f){for(var g=i-1,m=i===0?s:[""],S=JE(m),b=0,v=0,w=0;b<r;++b)for(var C=0,_=Gf(t,g+1,g=qhe(v=o[b])),M=t;C<S;++C)(M=h7(v>0?m[C]+" "+_:Pt(_,/&\f/g,m[C])))&&(u[w++]=M);return av(t,e,n,i===0?ZE:l,u,d,f)}function ife(t,e,n){return av(t,e,n,u7,sv(Zhe()),Gf(t,2,-2),0)}function Uj(t,e,n,r){return av(t,e,n,QE,Gf(t,0,r),Gf(t,r+1,-1),r)}function rd(t,e){for(var n="",r=JE(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function sfe(t,e,n,r){switch(t.type){case Ghe:if(t.children.length)break;case Khe:case QE:return t.return=t.return||t.value;case u7:return"";case d7:return t.return=t.value+"{"+rd(t.children,r)+"}";case ZE:t.value=t.props.join(",")}return eo(n=rd(t.children,r))?t.return=t.value+"{"+n+"}":""}function ofe(t){var e=JE(t);return function(n,r,i,s){for(var o="",l=0;l<e;l++)o+=t[l](n,r,i,s)||"";return o}}function afe(t){return function(e){e.root||(e=e.return)&&t(e)}}function m7(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var lfe=function(e,n,r){for(var i=0,s=0;i=s,s=fo(),i===38&&s===12&&(n[r]=1),!qf(s);)Pi();return wp(e,oi)},cfe=function(e,n){var r=-1,i=44;do switch(qf(i)){case 0:i===38&&fo()===12&&(n[r]=1),e[r]+=lfe(oi-1,n,r);break;case 2:e[r]+=ny(i);break;case 4:if(i===44){e[++r]=fo()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=sv(i)}while(i=Pi());return e},ufe=function(e,n){return g7(cfe(p7(e),n))},Hj=new WeakMap,dfe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!Hj.get(r))&&!i){Hj.set(e,!0);for(var s=[],o=ufe(n,s),l=r.props,u=0,d=0;u<o.length;u++)for(var f=0;f<l.length;f++,d++)e.props[d]=s[u]?o[u].replace(/&\f/g,l[f]):l[f]+" "+o[u]}}},hfe=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function y7(t,e){switch(Vhe(t,e)){case 5103:return Et+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Et+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Et+t+Yy+t+pr+t+t;case 6828:case 4268:return Et+t+pr+t+t;case 6165:return Et+t+pr+"flex-"+t+t;case 5187:return Et+t+Pt(t,/(\w+).+(:[^]+)/,Et+"box-$1$2"+pr+"flex-$1$2")+t;case 5443:return Et+t+pr+"flex-item-"+Pt(t,/flex-|-self/,"")+t;case 4675:return Et+t+pr+"flex-line-pack"+Pt(t,/align-content|flex-|-self/,"")+t;case 5548:return Et+t+pr+Pt(t,"shrink","negative")+t;case 5292:return Et+t+pr+Pt(t,"basis","preferred-size")+t;case 6060:return Et+"box-"+Pt(t,"-grow","")+Et+t+pr+Pt(t,"grow","positive")+t;case 4554:return Et+Pt(t,/([^-])(transform)/g,"$1"+Et+"$2")+t;case 6187:return Pt(Pt(Pt(t,/(zoom-|grab)/,Et+"$1"),/(image-set)/,Et+"$1"),t,"")+t;case 5495:case 3959:return Pt(t,/(image-set\([^]*)/,Et+"$1$`$1");case 4968:return Pt(Pt(t,/(.+:)(flex-)?(.*)/,Et+"box-pack:$3"+pr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Et+t+t;case 4095:case 3583:case 4068:case 2532:return Pt(t,/(.+)-inline(.+)/,Et+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(eo(t)-1-e>6)switch(Jn(t,e+1)){case 109:if(Jn(t,e+4)!==45)break;case 102:return Pt(t,/(.+:)(.+)-([^]+)/,"$1"+Et+"$2-$3$1"+Yy+(Jn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~h_(t,"stretch")?y7(Pt(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Jn(t,e+1)!==115)break;case 6444:switch(Jn(t,eo(t)-3-(~h_(t,"!important")&&10))){case 107:return Pt(t,":",":"+Et)+t;case 101:return Pt(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Et+(Jn(t,14)===45?"inline-":"")+"box$3$1"+Et+"$2$3$1"+pr+"$2box$3")+t}break;case 5936:switch(Jn(t,e+11)){case 114:return Et+t+pr+Pt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Et+t+pr+Pt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Et+t+pr+Pt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Et+t+pr+t+t}return t}var ffe=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case QE:e.return=y7(e.value,e.length);break;case d7:return rd([ef(e,{value:Pt(e.value,"@","@"+Et)})],i);case ZE:if(e.length)return Xhe(e.props,function(s){switch(Whe(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return rd([ef(e,{props:[Pt(s,/:(read-\w+)/,":"+Yy+"$1")]})],i);case"::placeholder":return rd([ef(e,{props:[Pt(s,/:(plac\w+)/,":"+Et+"input-$1")]}),ef(e,{props:[Pt(s,/:(plac\w+)/,":"+Yy+"$1")]}),ef(e,{props:[Pt(s,/:(plac\w+)/,pr+"input-$1")]})],i)}return""})}},pfe=[ffe],gfe=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(v){var w=v.getAttribute("data-emotion");w.indexOf(" ")!==-1&&(document.head.appendChild(v),v.setAttribute("data-s",""))})}var i=e.stylisPlugins||pfe,s={},o,l=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(v){for(var w=v.getAttribute("data-emotion").split(" "),C=1;C<w.length;C++)s[w[C]]=!0;l.push(v)});var u,d=[dfe,hfe];{var f,g=[sfe,afe(function(v){f.insert(v)})],m=ofe(d.concat(i,g)),S=function(w){return rd(rfe(w),m)};u=function(w,C,_,M){f=_,S(w?w+"{"+C.styles+"}":C.styles),M&&(b.inserted[C.name]=!0)}}var b={key:n,sheet:new Hhe({key:n,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:u};return b.sheet.hydrate(l),b},_1={exports:{}},Tt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kj;function mfe(){if(Kj)return Tt;Kj=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,s=t?Symbol.for("react.profiler"):60114,o=t?Symbol.for("react.provider"):60109,l=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,d=t?Symbol.for("react.concurrent_mode"):60111,f=t?Symbol.for("react.forward_ref"):60112,g=t?Symbol.for("react.suspense"):60113,m=t?Symbol.for("react.suspense_list"):60120,S=t?Symbol.for("react.memo"):60115,b=t?Symbol.for("react.lazy"):60116,v=t?Symbol.for("react.block"):60121,w=t?Symbol.for("react.fundamental"):60117,C=t?Symbol.for("react.responder"):60118,_=t?Symbol.for("react.scope"):60119;function M(A){if(typeof A=="object"&&A!==null){var R=A.$$typeof;switch(R){case e:switch(A=A.type,A){case u:case d:case r:case s:case i:case g:return A;default:switch(A=A&&A.$$typeof,A){case l:case f:case b:case S:case o:return A;default:return R}}case n:return R}}}function I(A){return M(A)===d}return Tt.AsyncMode=u,Tt.ConcurrentMode=d,Tt.ContextConsumer=l,Tt.ContextProvider=o,Tt.Element=e,Tt.ForwardRef=f,Tt.Fragment=r,Tt.Lazy=b,Tt.Memo=S,Tt.Portal=n,Tt.Profiler=s,Tt.StrictMode=i,Tt.Suspense=g,Tt.isAsyncMode=function(A){return I(A)||M(A)===u},Tt.isConcurrentMode=I,Tt.isContextConsumer=function(A){return M(A)===l},Tt.isContextProvider=function(A){return M(A)===o},Tt.isElement=function(A){return typeof A=="object"&&A!==null&&A.$$typeof===e},Tt.isForwardRef=function(A){return M(A)===f},Tt.isFragment=function(A){return M(A)===r},Tt.isLazy=function(A){return M(A)===b},Tt.isMemo=function(A){return M(A)===S},Tt.isPortal=function(A){return M(A)===n},Tt.isProfiler=function(A){return M(A)===s},Tt.isStrictMode=function(A){return M(A)===i},Tt.isSuspense=function(A){return M(A)===g},Tt.isValidElementType=function(A){return typeof A=="string"||typeof A=="function"||A===r||A===d||A===s||A===i||A===g||A===m||typeof A=="object"&&A!==null&&(A.$$typeof===b||A.$$typeof===S||A.$$typeof===o||A.$$typeof===l||A.$$typeof===f||A.$$typeof===w||A.$$typeof===C||A.$$typeof===_||A.$$typeof===v)},Tt.typeOf=M,Tt}var Gj;function yfe(){return Gj||(Gj=1,_1.exports=mfe()),_1.exports}var E1,qj;function Sfe(){if(qj)return E1;qj=1;var t=yfe(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};s[t.ForwardRef]=r,s[t.Memo]=i;function o(b){return t.isMemo(b)?i:s[b.$$typeof]||e}var l=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,g=Object.getPrototypeOf,m=Object.prototype;function S(b,v,w){if(typeof v!="string"){if(m){var C=g(v);C&&C!==m&&S(b,C,w)}var _=u(v);d&&(_=_.concat(d(v)));for(var M=o(b),I=o(v),A=0;A<_.length;++A){var R=_[A];if(!n[R]&&!(w&&w[R])&&!(I&&I[R])&&!(M&&M[R])){var D=f(v,R);try{l(b,R,D)}catch{}}}}return b}return E1=S,E1}Sfe();var vfe=!0;function S7(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(r+=i+" ")}),r}var eP=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||vfe===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},v7=function(e,n,r){eP(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var s=n;do e.insert(n===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function bfe(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var xfe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},wfe=/[A-Z]|^ms/g,Cfe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,b7=function(e){return e.charCodeAt(1)===45},Yj=function(e){return e!=null&&typeof e!="boolean"},P1=m7(function(t){return b7(t)?t:t.replace(wfe,"-$&").toLowerCase()}),Vj=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(Cfe,function(r,i,s){return to={name:i,styles:s,next:to},i})}return xfe[e]!==1&&!b7(e)&&typeof n=="number"&&n!==0?n+"px":n};function Yf(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return to={name:i.name,styles:i.styles,next:to},i.name;var s=n;if(s.styles!==void 0){var o=s.next;if(o!==void 0)for(;o!==void 0;)to={name:o.name,styles:o.styles,next:to},o=o.next;var l=s.styles+";";return l}return _fe(t,e,n)}case"function":{if(t!==void 0){var u=to,d=n(t);return to=u,Yf(t,e,d)}break}}var f=n;if(e==null)return f;var g=e[f];return g!==void 0?g:f}function _fe(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Yf(t,e,n[i])+";";else for(var s in n){var o=n[s];if(typeof o!="object"){var l=o;e!=null&&e[l]!==void 0?r+=s+"{"+e[l]+"}":Yj(l)&&(r+=P1(s)+":"+Vj(s,l)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var u=0;u<o.length;u++)Yj(o[u])&&(r+=P1(s)+":"+Vj(s,o[u])+";");else{var d=Yf(t,e,o);switch(s){case"animation":case"animationName":{r+=P1(s)+":"+d+";";break}default:r+=s+"{"+d+"}"}}}return r}var Wj=/label:\s*([^\s;{]+)\s*(;|$)/g,to;function lv(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,i="";to=void 0;var s=t[0];if(s==null||s.raw===void 0)r=!1,i+=Yf(n,e,s);else{var o=s;i+=o[0]}for(var l=1;l<t.length;l++)if(i+=Yf(n,e,t[l]),r){var u=s;i+=u[l]}Wj.lastIndex=0;for(var d="",f;(f=Wj.exec(i))!==null;)d+="-"+f[1];var g=bfe(i)+d;return{name:g,styles:i,next:to}}var Efe=function(e){return e()},Pfe=oy.useInsertionEffect?oy.useInsertionEffect:!1,x7=Pfe||Efe,w7=E.createContext(typeof HTMLElement<"u"?gfe({key:"css"}):null);w7.Provider;var C7=function(e){return E.forwardRef(function(n,r){var i=E.useContext(w7);return e(n,i,r)})},_7=E.createContext({}),tP={}.hasOwnProperty,p_="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",Tfe=function(e,n){var r={};for(var i in n)tP.call(n,i)&&(r[i]=n[i]);return r[p_]=e,r},Ife=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return eP(n,r,i),x7(function(){return v7(n,r,i)}),null},Mfe=C7(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var i=t[p_],s=[r],o="";typeof t.className=="string"?o=S7(e.registered,s,t.className):t.className!=null&&(o=t.className+" ");var l=lv(s,void 0,E.useContext(_7));o+=e.key+"-"+l.name;var u={};for(var d in t)tP.call(t,d)&&d!=="css"&&d!==p_&&(u[d]=t[d]);return u.className=o,n&&(u.ref=n),E.createElement(E.Fragment,null,E.createElement(Ife,{cache:e,serialized:l,isStringTag:typeof i=="string"}),E.createElement(i,u))}),Afe=Mfe,Xj=function(e,n){var r=arguments;if(n==null||!tP.call(n,"css"))return E.createElement.apply(void 0,r);var i=r.length,s=new Array(i);s[0]=Afe,s[1]=Tfe(e,n);for(var o=2;o<i;o++)s[o]=r[o];return E.createElement.apply(null,s)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(Xj||(Xj={}));function nP(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return lv(e)}function Cp(){var t=nP.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var kfe=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Rfe=m7(function(t){return kfe.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),Ofe=Rfe,jfe=function(e){return e!=="theme"},Zj=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Ofe:jfe},Qj=function(e,n,r){var i;if(n){var s=n.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(o){return e.__emotion_forwardProp(o)&&s(o)}:s}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},Dfe=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return eP(n,r,i),x7(function(){return v7(n,r,i)}),null},Lfe=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,s,o;n!==void 0&&(s=n.label,o=n.target);var l=Qj(e,n,r),u=l||Zj(i),d=!u("as");return function(){var f=arguments,g=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&g.push("label:"+s+";"),f[0]==null||f[0].raw===void 0)g.push.apply(g,f);else{var m=f[0];g.push(m[0]);for(var S=f.length,b=1;b<S;b++)g.push(f[b],m[b])}var v=C7(function(w,C,_){var M=d&&w.as||i,I="",A=[],R=w;if(w.theme==null){R={};for(var D in w)R[D]=w[D];R.theme=E.useContext(_7)}typeof w.className=="string"?I=S7(C.registered,A,w.className):w.className!=null&&(I=w.className+" ");var L=lv(g.concat(A),C.registered,R);I+=C.key+"-"+L.name,o!==void 0&&(I+=" "+o);var G=d&&l===void 0?Zj(M):u,k={};for(var $ in w)d&&$==="as"||G($)&&(k[$]=w[$]);return k.className=I,_&&(k.ref=_),E.createElement(E.Fragment,null,E.createElement(Dfe,{cache:C,serialized:L,isStringTag:typeof M=="string"}),E.createElement(M,k))});return v.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",v.defaultProps=e.defaultProps,v.__emotion_real=v,v.__emotion_base=i,v.__emotion_styles=g,v.__emotion_forwardProp=l,Object.defineProperty(v,"toString",{value:function(){return"."+o}}),v.withComponent=function(w,C){var _=t(w,qy({},n,C,{shouldForwardProp:Qj(v,C,!0)}));return _.apply(void 0,g)},v}},Nfe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],g_=Lfe.bind(null);Nfe.forEach(function(t){g_[t]=g_(t)});/**
 * @mui/styled-engine v6.4.3
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function zfe(t,e){return g_(t,e)}function $fe(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const Jj=[];function eD(t){return Jj[0]=t,lv(Jj)}var T1={exports:{}},jt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tD;function Bfe(){if(tD)return jt;tD=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen"),S=Symbol.for("react.client.reference");function b(v){if(typeof v=="object"&&v!==null){var w=v.$$typeof;switch(w){case t:switch(v=v.type,v){case n:case i:case r:case u:case d:return v;default:switch(v=v&&v.$$typeof,v){case o:case l:case g:case f:return v;case s:return v;default:return w}}case e:return w}}}return jt.ContextConsumer=s,jt.ContextProvider=o,jt.Element=t,jt.ForwardRef=l,jt.Fragment=n,jt.Lazy=g,jt.Memo=f,jt.Portal=e,jt.Profiler=i,jt.StrictMode=r,jt.Suspense=u,jt.SuspenseList=d,jt.isContextConsumer=function(v){return b(v)===s},jt.isContextProvider=function(v){return b(v)===o},jt.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},jt.isForwardRef=function(v){return b(v)===l},jt.isFragment=function(v){return b(v)===n},jt.isLazy=function(v){return b(v)===g},jt.isMemo=function(v){return b(v)===f},jt.isPortal=function(v){return b(v)===e},jt.isProfiler=function(v){return b(v)===i},jt.isStrictMode=function(v){return b(v)===r},jt.isSuspense=function(v){return b(v)===u},jt.isSuspenseList=function(v){return b(v)===d},jt.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===i||v===r||v===u||v===d||v===m||typeof v=="object"&&v!==null&&(v.$$typeof===g||v.$$typeof===f||v.$$typeof===o||v.$$typeof===s||v.$$typeof===l||v.$$typeof===S||v.getModuleId!==void 0)},jt.typeOf=b,jt}var nD;function Ffe(){return nD||(nD=1,T1.exports=Bfe()),T1.exports}var E7=Ffe();function ca(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function P7(t){if(E.isValidElement(t)||E7.isValidElementType(t)||!ca(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=P7(t[n])}),e}function Ti(t,e,n={clone:!0}){const r=n.clone?{...t}:t;return ca(t)&&ca(e)&&Object.keys(e).forEach(i=>{E.isValidElement(e[i])||E7.isValidElementType(e[i])?r[i]=e[i]:ca(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&ca(t[i])?r[i]=Ti(t[i],e[i],n):n.clone?r[i]=ca(e[i])?P7(e[i]):e[i]:r[i]=e[i]}),r}const Ufe=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function Hfe(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=t,s=Ufe(e),o=Object.keys(s);function l(m){return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${n})`}function u(m){return`@media (max-width:${(typeof e[m]=="number"?e[m]:m)-r/100}${n})`}function d(m,S){const b=o.indexOf(S);return`@media (min-width:${typeof e[m]=="number"?e[m]:m}${n}) and (max-width:${(b!==-1&&typeof e[o[b]]=="number"?e[o[b]]:S)-r/100}${n})`}function f(m){return o.indexOf(m)+1<o.length?d(m,o[o.indexOf(m)+1]):l(m)}function g(m){const S=o.indexOf(m);return S===0?l(o[1]):S===o.length-1?u(o[S]):d(m,o[o.indexOf(m)+1]).replace("@media","@media not all and")}return{keys:o,values:s,up:l,down:u,between:d,only:f,not:g,unit:n,...i}}function Kfe(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,i)=>{var o,l;const s=/min-width:\s*([0-9.]+)/;return+(((o=r.match(s))==null?void 0:o[1])||0)-+(((l=i.match(s))==null?void 0:l[1])||0)});return n.length?n.reduce((r,i)=>{const s=e[i];return delete r[i],r[i]=s,r},{...e}):e}function Gfe(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function qfe(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,s=Number.isNaN(+r)?r||0:+r;return t.containerQueries(i).up(s)}function Yfe(t){const e=(s,o)=>s.replace("@media",o?`@container ${o}`:"@container");function n(s,o){s.up=(...l)=>e(t.breakpoints.up(...l),o),s.down=(...l)=>e(t.breakpoints.down(...l),o),s.between=(...l)=>e(t.breakpoints.between(...l),o),s.only=(...l)=>e(t.breakpoints.only(...l),o),s.not=(...l)=>{const u=e(t.breakpoints.not(...l),o);return u.includes("not all and")?u.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):u}}const r={},i=s=>(n(r,s),r);return n(i),{...t,containerQueries:i}}const Vfe={borderRadius:4};function _f(t,e){return e?Ti(t,e,{clone:!1}):t}const cv={xs:0,sm:600,md:900,lg:1200,xl:1536},rD={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${cv[t]}px)`},Wfe={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:cv[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function ba(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const s=r.breakpoints||rD;return e.reduce((o,l,u)=>(o[s.up(s.keys[u])]=n(e[u]),o),{})}if(typeof e=="object"){const s=r.breakpoints||rD;return Object.keys(e).reduce((o,l)=>{if(Gfe(s.keys,l)){const u=qfe(r.containerQueries?r:Wfe,l);u&&(o[u]=n(e[l],l))}else if(Object.keys(s.values||cv).includes(l)){const u=s.up(l);o[u]=n(e[l],l)}else{const u=l;o[u]=e[u]}return o},{})}return n(e)}function Xfe(t={}){var n;return((n=t.keys)==null?void 0:n.reduce((r,i)=>{const s=t.up(i);return r[s]={},r},{}))||{}}function Zfe(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function tn(t){if(typeof t!="string")throw new Error(Rc(7));return t.charAt(0).toUpperCase()+t.slice(1)}function uv(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,s)=>i&&i[s]?i[s]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Vy(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=uv(t,n)||r,e&&(i=e(i,r,t)),i}function En(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,s=o=>{if(o[e]==null)return null;const l=o[e],u=o.theme,d=uv(u,r)||{};return ba(o,l,g=>{let m=Vy(d,i,g);return g===m&&typeof g=="string"&&(m=Vy(d,i,`${e}${g==="default"?"":tn(g)}`,g)),n===!1?m:{[n]:m}})};return s.propTypes={},s.filterProps=[e],s}function Qfe(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const Jfe={m:"margin",p:"padding"},epe={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},iD={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},tpe=Qfe(t=>{if(t.length>2)if(iD[t])t=iD[t];else return[t];const[e,n]=t.split(""),r=Jfe[e],i=epe[n]||"";return Array.isArray(i)?i.map(s=>r+s):[r+i]}),rP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],iP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...rP,...iP];function _p(t,e,n,r){const i=uv(t,e,!0)??n;return typeof i=="number"||typeof i=="string"?s=>typeof s=="string"?s:typeof i=="string"?`calc(${s} * ${i})`:i*s:Array.isArray(i)?s=>{if(typeof s=="string")return s;const o=Math.abs(s),l=i[o];return s>=0?l:typeof l=="number"?-l:`-${l}`}:typeof i=="function"?i:()=>{}}function sP(t){return _p(t,"spacing",8)}function Ep(t,e){return typeof e=="string"||e==null?e:t(e)}function npe(t,e){return n=>t.reduce((r,i)=>(r[i]=Ep(e,n),r),{})}function rpe(t,e,n,r){if(!e.includes(n))return null;const i=tpe(n),s=npe(i,r),o=t[n];return ba(t,o,s)}function T7(t,e){const n=sP(t.theme);return Object.keys(t).map(r=>rpe(t,e,r,n)).reduce(_f,{})}function mn(t){return T7(t,rP)}mn.propTypes={};mn.filterProps=rP;function yn(t){return T7(t,iP)}yn.propTypes={};yn.filterProps=iP;function I7(t=8,e=sP({spacing:t})){if(t.mui)return t;const n=(...r)=>(r.length===0?[1]:r).map(s=>{const o=e(s);return typeof o=="number"?`${o}px`:o}).join(" ");return n.mui=!0,n}function dv(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(s=>{r[s]=i}),r),{}),n=r=>Object.keys(r).reduce((i,s)=>e[s]?_f(i,e[s](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Zi(t){return typeof t!="number"?t:`${t}px solid`}function as(t,e){return En({prop:t,themeKey:"borders",transform:e})}const ipe=as("border",Zi),spe=as("borderTop",Zi),ope=as("borderRight",Zi),ape=as("borderBottom",Zi),lpe=as("borderLeft",Zi),cpe=as("borderColor"),upe=as("borderTopColor"),dpe=as("borderRightColor"),hpe=as("borderBottomColor"),fpe=as("borderLeftColor"),ppe=as("outline",Zi),gpe=as("outlineColor"),hv=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=_p(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Ep(e,r)});return ba(t,t.borderRadius,n)}return null};hv.propTypes={};hv.filterProps=["borderRadius"];dv(ipe,spe,ope,ape,lpe,cpe,upe,dpe,hpe,fpe,hv,ppe,gpe);const fv=t=>{if(t.gap!==void 0&&t.gap!==null){const e=_p(t.theme,"spacing",8),n=r=>({gap:Ep(e,r)});return ba(t,t.gap,n)}return null};fv.propTypes={};fv.filterProps=["gap"];const pv=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=_p(t.theme,"spacing",8),n=r=>({columnGap:Ep(e,r)});return ba(t,t.columnGap,n)}return null};pv.propTypes={};pv.filterProps=["columnGap"];const gv=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=_p(t.theme,"spacing",8),n=r=>({rowGap:Ep(e,r)});return ba(t,t.rowGap,n)}return null};gv.propTypes={};gv.filterProps=["rowGap"];const mpe=En({prop:"gridColumn"}),ype=En({prop:"gridRow"}),Spe=En({prop:"gridAutoFlow"}),vpe=En({prop:"gridAutoColumns"}),bpe=En({prop:"gridAutoRows"}),xpe=En({prop:"gridTemplateColumns"}),wpe=En({prop:"gridTemplateRows"}),Cpe=En({prop:"gridTemplateAreas"}),_pe=En({prop:"gridArea"});dv(fv,pv,gv,mpe,ype,Spe,vpe,bpe,xpe,wpe,Cpe,_pe);function id(t,e){return e==="grey"?e:t}const Epe=En({prop:"color",themeKey:"palette",transform:id}),Ppe=En({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:id}),Tpe=En({prop:"backgroundColor",themeKey:"palette",transform:id});dv(Epe,Ppe,Tpe);function vi(t){return t<=1&&t!==0?`${t*100}%`:t}const Ipe=En({prop:"width",transform:vi}),oP=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var i,s,o,l,u;const r=((o=(s=(i=t.theme)==null?void 0:i.breakpoints)==null?void 0:s.values)==null?void 0:o[n])||cv[n];return r?((u=(l=t.theme)==null?void 0:l.breakpoints)==null?void 0:u.unit)!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:vi(n)}};return ba(t,t.maxWidth,e)}return null};oP.filterProps=["maxWidth"];const Mpe=En({prop:"minWidth",transform:vi}),Ape=En({prop:"height",transform:vi}),kpe=En({prop:"maxHeight",transform:vi}),Rpe=En({prop:"minHeight",transform:vi});En({prop:"size",cssProperty:"width",transform:vi});En({prop:"size",cssProperty:"height",transform:vi});const Ope=En({prop:"boxSizing"});dv(Ipe,oP,Mpe,Ape,kpe,Rpe,Ope);const mv={border:{themeKey:"borders",transform:Zi},borderTop:{themeKey:"borders",transform:Zi},borderRight:{themeKey:"borders",transform:Zi},borderBottom:{themeKey:"borders",transform:Zi},borderLeft:{themeKey:"borders",transform:Zi},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Zi},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:hv},color:{themeKey:"palette",transform:id},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:id},backgroundColor:{themeKey:"palette",transform:id},p:{style:yn},pt:{style:yn},pr:{style:yn},pb:{style:yn},pl:{style:yn},px:{style:yn},py:{style:yn},padding:{style:yn},paddingTop:{style:yn},paddingRight:{style:yn},paddingBottom:{style:yn},paddingLeft:{style:yn},paddingX:{style:yn},paddingY:{style:yn},paddingInline:{style:yn},paddingInlineStart:{style:yn},paddingInlineEnd:{style:yn},paddingBlock:{style:yn},paddingBlockStart:{style:yn},paddingBlockEnd:{style:yn},m:{style:mn},mt:{style:mn},mr:{style:mn},mb:{style:mn},ml:{style:mn},mx:{style:mn},my:{style:mn},margin:{style:mn},marginTop:{style:mn},marginRight:{style:mn},marginBottom:{style:mn},marginLeft:{style:mn},marginX:{style:mn},marginY:{style:mn},marginInline:{style:mn},marginInlineStart:{style:mn},marginInlineEnd:{style:mn},marginBlock:{style:mn},marginBlockStart:{style:mn},marginBlockEnd:{style:mn},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:fv},rowGap:{style:gv},columnGap:{style:pv},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:vi},maxWidth:{style:oP},minWidth:{transform:vi},height:{transform:vi},maxHeight:{transform:vi},minHeight:{transform:vi},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function jpe(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function Dpe(t,e){return typeof t=="function"?t(e):t}function Lpe(){function t(n,r,i,s){const o={[n]:r,theme:i},l=s[n];if(!l)return{[n]:r};const{cssProperty:u=n,themeKey:d,transform:f,style:g}=l;if(r==null)return null;if(d==="typography"&&r==="inherit")return{[n]:r};const m=uv(i,d)||{};return g?g(o):ba(o,r,b=>{let v=Vy(m,f,b);return b===v&&typeof b=="string"&&(v=Vy(m,f,`${n}${b==="default"?"":tn(b)}`,b)),u===!1?v:{[u]:v}})}function e(n){const{sx:r,theme:i={}}=n||{};if(!r)return null;const s=i.unstable_sxConfig??mv;function o(l){let u=l;if(typeof l=="function")u=l(i);else if(typeof l!="object")return l;if(!u)return null;const d=Xfe(i.breakpoints),f=Object.keys(d);let g=d;return Object.keys(u).forEach(m=>{const S=Dpe(u[m],i);if(S!=null)if(typeof S=="object")if(s[m])g=_f(g,t(m,S,i,s));else{const b=ba({theme:i},S,v=>({[m]:v}));jpe(b,S)?g[m]=e({sx:S,theme:i}):g=_f(g,b)}else g=_f(g,t(m,S,i,s))}),Kfe(i,Zfe(f,g))}return Array.isArray(r)?r.map(o):o(r)}return e}const gd=Lpe();gd.filterProps=["sx"];function Npe(t,e){var r;const n=this;if(n.vars){if(!((r=n.colorSchemes)!=null&&r[t])||typeof n.getColorSchemeSelector!="function")return{};let i=n.getColorSchemeSelector(t);return i==="&"?e:((i.includes("data-")||i.includes("."))&&(i=`*:where(${i.replace(/\s*&$/,"")}) &`),{[i]:e})}return n.palette.mode===t?e:{}}function M7(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:s={},...o}=t,l=Hfe(n),u=I7(i);let d=Ti({breakpoints:l,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:u,shape:{...Vfe,...s}},o);return d=Yfe(d),d.applyStyles=Npe,d=e.reduce((f,g)=>Ti(f,g),d),d.unstable_sxConfig={...mv,...o==null?void 0:o.unstable_sxConfig},d.unstable_sx=function(g){return gd({sx:g,theme:this})},d}const sD=t=>t,zpe=()=>{let t=sD;return{configure(e){t=e},generate(e){return t(e)},reset(){t=sD}}},$pe=zpe();function A7(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=A7(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Nn(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=A7(t))&&(r&&(r+=" "),r+=e);return r}const Bpe={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function To(t,e,n="Mui"){const r=Bpe[e];return r?`${n}-${r}`:`${$pe.generate(t)}-${e}`}function Io(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=To(t,i,n)}),r}function k7(t){const{variants:e,...n}=t,r={variants:e,style:eD(n),isProcessed:!0};return r.style===n||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=eD(i.style))}),r}const Fpe=M7();function I1(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Upe(t){return t?(e,n)=>n[t]:null}function Hpe(t,e,n){t.theme=qpe(t.theme)?n:t.theme[e]||t.theme}function iy(t,e){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(r=>iy(t,r));if(Array.isArray(n==null?void 0:n.variants)){let r;if(n.isProcessed)r=n.style;else{const{variants:i,...s}=n;r=s}return R7(t,n.variants,[r])}return n!=null&&n.isProcessed?n.style:n}function R7(t,e,n=[]){var i;let r;e:for(let s=0;s<e.length;s+=1){const o=e[s];if(typeof o.props=="function"){if(r??(r={...t,...t.ownerState,ownerState:t.ownerState}),!o.props(r))continue}else for(const l in o.props)if(t[l]!==o.props[l]&&((i=t.ownerState)==null?void 0:i[l])!==o.props[l])continue e;typeof o.style=="function"?(r??(r={...t,...t.ownerState,ownerState:t.ownerState}),n.push(o.style(r))):n.push(o.style)}return n}function Kpe(t={}){const{themeId:e,defaultTheme:n=Fpe,rootShouldForwardProp:r=I1,slotShouldForwardProp:i=I1}=t;function s(l){Hpe(l,e,n)}return(l,u={})=>{$fe(l,A=>A.filter(R=>R!==gd));const{name:d,slot:f,skipVariantsResolver:g,skipSx:m,overridesResolver:S=Upe(Vpe(f)),...b}=u,v=g!==void 0?g:f&&f!=="Root"&&f!=="root"||!1,w=m||!1;let C=I1;f==="Root"||f==="root"?C=r:f?C=i:Ype(l)&&(C=void 0);const _=zfe(l,{shouldForwardProp:C,label:Gpe(),...b}),M=A=>{if(typeof A=="function"&&A.__emotion_real!==A)return function(D){return iy(D,A)};if(ca(A)){const R=k7(A);return R.variants?function(L){return iy(L,R)}:R.style}return A},I=(...A)=>{const R=[],D=A.map(M),L=[];if(R.push(s),d&&S&&L.push(function(F){var K,V;const B=(V=(K=F.theme.components)==null?void 0:K[d])==null?void 0:V.styleOverrides;if(!B)return null;const Y={};for(const W in B)Y[W]=iy(F,B[W]);return S(F,Y)}),d&&!v&&L.push(function(F){var Y,K;const N=F.theme,B=(K=(Y=N==null?void 0:N.components)==null?void 0:Y[d])==null?void 0:K.variants;return B?R7(F,B):null}),w||L.push(gd),Array.isArray(D[0])){const $=D.shift(),F=new Array(R.length).fill(""),N=new Array(L.length).fill("");let B;B=[...F,...$,...N],B.raw=[...F,...$.raw,...N],R.unshift(B)}const G=[...R,...D,...L],k=_(...G);return l.muiName&&(k.muiName=l.muiName),k};return _.withConfig&&(I.withConfig=_.withConfig),I}}function Gpe(t,e){return void 0}function qpe(t){for(const e in t)return!1;return!0}function Ype(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Vpe(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function Wy(t,e){const n={...e};for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const i=r;if(i==="components"||i==="slots")n[i]={...t[i],...n[i]};else if(i==="componentsProps"||i==="slotProps"){const s=t[i],o=e[i];if(!o)n[i]=s||{};else if(!s)n[i]=o;else{n[i]={...o};for(const l in s)if(Object.prototype.hasOwnProperty.call(s,l)){const u=l;n[i][u]=Wy(s[u],o[u])}}}else n[i]===void 0&&(n[i]=t[i])}return n}const Wpe=typeof window<"u"?E.useLayoutEffect:E.useEffect;function Xpe(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function aP(t,e=0,n=1){return Xpe(t,e,n)}function Zpe(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Cl(t){if(t.type)return t;if(t.charAt(0)==="#")return Cl(Zpe(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Rc(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(Rc(10,i))}else r=r.split(",");return r=r.map(s=>parseFloat(s)),{type:n,values:r,colorSpace:i}}const Qpe=t=>{const e=Cl(t);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},ff=(t,e)=>{try{return Qpe(t)}catch{return t}};function yv(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.includes("rgb")?r=r.map((i,s)=>s<3?parseInt(i,10):i):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function O7(t){t=Cl(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,s=r*Math.min(i,1-i),o=(d,f=(d+n/30)%12)=>i-s*Math.max(Math.min(f-3,9-f,1),-1);let l="rgb";const u=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return t.type==="hsla"&&(l+="a",u.push(e[3])),yv({type:l,values:u})}function m_(t){t=Cl(t);let e=t.type==="hsl"||t.type==="hsla"?Cl(O7(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Jpe(t,e){const n=m_(t),r=m_(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function io(t,e){return t=Cl(t),e=aP(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,yv(t)}function Sm(t,e,n){try{return io(t,e)}catch{return t}}function Sv(t,e){if(t=Cl(t),e=aP(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return yv(t)}function $t(t,e,n){try{return Sv(t,e)}catch{return t}}function vv(t,e){if(t=Cl(t),e=aP(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return yv(t)}function Bt(t,e,n){try{return vv(t,e)}catch{return t}}function ege(t,e=.15){return m_(t)>.5?Sv(t,e):vv(t,e)}function vm(t,e,n){try{return ege(t,e)}catch{return t}}function tge(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let oD=0;function nge(t){const[e,n]=E.useState(t),r=t||e;return E.useEffect(()=>{e==null&&(oD+=1,n(`mui-${oD}`))},[e]),r}const rge={...oy},aD=rge.useId;function ige(t){if(aD!==void 0){const e=aD();return t??e}return nge(t)}function sy(t){const e=E.useRef(t);return Wpe(()=>{e.current=t}),E.useRef((...n)=>(0,e.current)(...n)).current}function lD(...t){return E.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{tge(n,e)})},t)}const cD={};function j7(t,e){const n=E.useRef(cD);return n.current===cD&&(n.current=t(e)),n}const sge=[];function oge(t){E.useEffect(t,sge)}class lP{constructor(){O(this,"currentId",null);O(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});O(this,"disposeEffect",()=>this.clear)}static create(){return new lP}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function age(){const t=j7(lP.create).current;return oge(t.disposeEffect),t}function uD(t){try{return t.matches(":focus-visible")}catch{}return!1}function Ta(t,e,n=void 0){const r={};for(const i in t){const s=t[i];let o="",l=!0;for(let u=0;u<s.length;u+=1){const d=s[u];d&&(o+=(l===!0?"":" ")+e(d),l=!1,n&&n[d]&&(o+=" "+n[d]))}r[i]=o}return r}const lge=E.createContext(void 0);function cge(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const i=e.components[n];return i.defaultProps?Wy(i.defaultProps,r):!i.styleOverrides&&!i.variants?Wy(i,r):r}function uge({props:t,name:e}){const n=E.useContext(lge);return cge({props:t,name:e,theme:{components:n}})}const dD={theme:void 0};function dge(t){let e,n;return function(i){let s=e;return(s===void 0||i.theme!==n)&&(dD.theme=i.theme,s=k7(t(dD)),e=s,n=i.theme),s}}function hge(t=""){function e(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${t?`${t}-`:""}${r}${e(...i)})`}const hD=(t,e,n,r=[])=>{let i=t;e.forEach((s,o)=>{o===e.length-1?Array.isArray(i)?i[Number(s)]=n:i&&typeof i=="object"&&(i[s]=n):i&&typeof i=="object"&&(i[s]||(i[s]=r.includes(s)?[]:{}),i=i[s])})},fge=(t,e,n)=>{function r(i,s=[],o=[]){Object.entries(i).forEach(([l,u])=>{(!n||n&&!n([...s,l]))&&u!=null&&(typeof u=="object"&&Object.keys(u).length>0?r(u,[...s,l],Array.isArray(u)?[...o,l]:o):e([...s,l],u,o))})}r(t)},pge=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function M1(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},i={},s={},o={};return fge(t,(l,u,d)=>{if((typeof u=="string"||typeof u=="number")&&(!r||!r(l,u))){const f=`--${n?`${n}-`:""}${l.join("-")}`,g=pge(l,u);Object.assign(i,{[f]:g}),hD(s,l,`var(${f})`,d),hD(o,l,`var(${f}, ${g})`,d)}},l=>l[0]==="vars"),{css:i,vars:s,varsWithDefaults:o}}function gge(t,e={}){const{getSelector:n=w,disableCssColorScheme:r,colorSchemeSelector:i}=e,{colorSchemes:s={},components:o,defaultColorScheme:l="light",...u}=t,{vars:d,css:f,varsWithDefaults:g}=M1(u,e);let m=g;const S={},{[l]:b,...v}=s;if(Object.entries(v||{}).forEach(([M,I])=>{const{vars:A,css:R,varsWithDefaults:D}=M1(I,e);m=Ti(m,D),S[M]={css:R,vars:A}}),b){const{css:M,vars:I,varsWithDefaults:A}=M1(b,e);m=Ti(m,A),S[l]={css:M,vars:I}}function w(M,I){var R,D;let A=i;if(i==="class"&&(A=".%s"),i==="data"&&(A="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(A=`[${i}="%s"]`),M){if(A==="media")return t.defaultColorScheme===M?":root":{[`@media (prefers-color-scheme: ${((D=(R=s[M])==null?void 0:R.palette)==null?void 0:D.mode)||M})`]:{":root":I}};if(A)return t.defaultColorScheme===M?`:root, ${A.replace("%s",String(M))}`:A.replace("%s",String(M))}return":root"}return{vars:m,generateThemeVars:()=>{let M={...d};return Object.entries(S).forEach(([,{vars:I}])=>{M=Ti(M,I)}),M},generateStyleSheets:()=>{var L,G;const M=[],I=t.defaultColorScheme||"light";function A(k,$){Object.keys($).length&&M.push(typeof k=="string"?{[k]:{...$}}:k)}A(n(void 0,{...f}),f);const{[I]:R,...D}=S;if(R){const{css:k}=R,$=(G=(L=s[I])==null?void 0:L.palette)==null?void 0:G.mode,F=!r&&$?{colorScheme:$,...k}:{...k};A(n(I,{...F}),F)}return Object.entries(D).forEach(([k,{css:$}])=>{var B,Y;const F=(Y=(B=s[k])==null?void 0:B.palette)==null?void 0:Y.mode,N=!r&&F?{colorScheme:F,...$}:{...$};A(n(k,{...N}),N)}),M}}}function mge(t){return function(n){return t==="media"?`@media (prefers-color-scheme: ${n})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}function D7(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Kf.white,default:Kf.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const yge=D7();function L7(){return{text:{primary:Kf.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Kf.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const fD=L7();function pD(t,e,n,r){const i=r.light||r,s=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=vv(t.main,i):e==="dark"&&(t.dark=Sv(t.main,s)))}function Sge(t="light"){return t==="dark"?{main:Nu[200],light:Nu[50],dark:Nu[400]}:{main:Nu[700],light:Nu[400],dark:Nu[800]}}function vge(t="light"){return t==="dark"?{main:Lu[200],light:Lu[50],dark:Lu[400]}:{main:Lu[500],light:Lu[300],dark:Lu[700]}}function bge(t="light"){return t==="dark"?{main:Du[500],light:Du[300],dark:Du[700]}:{main:Du[700],light:Du[400],dark:Du[800]}}function xge(t="light"){return t==="dark"?{main:zu[400],light:zu[300],dark:zu[700]}:{main:zu[700],light:zu[500],dark:zu[900]}}function wge(t="light"){return t==="dark"?{main:$u[400],light:$u[300],dark:$u[700]}:{main:$u[800],light:$u[500],dark:$u[900]}}function Cge(t="light"){return t==="dark"?{main:Jh[400],light:Jh[300],dark:Jh[700]}:{main:"#ed6c02",light:Jh[500],dark:Jh[900]}}function cP(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=t,s=t.primary||Sge(e),o=t.secondary||vge(e),l=t.error||bge(e),u=t.info||xge(e),d=t.success||wge(e),f=t.warning||Cge(e);function g(v){return Jpe(v,fD.text.primary)>=n?fD.text.primary:yge.text.primary}const m=({color:v,name:w,mainShade:C=500,lightShade:_=300,darkShade:M=700})=>{if(v={...v},!v.main&&v[C]&&(v.main=v[C]),!v.hasOwnProperty("main"))throw new Error(Rc(11,w?` (${w})`:"",C));if(typeof v.main!="string")throw new Error(Rc(12,w?` (${w})`:"",JSON.stringify(v.main)));return pD(v,"light",_,r),pD(v,"dark",M,r),v.contrastText||(v.contrastText=g(v.main)),v};let S;return e==="light"?S=D7():e==="dark"&&(S=L7()),Ti({common:{...Kf},mode:e,primary:m({color:s,name:"primary"}),secondary:m({color:o,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:m({color:l,name:"error"}),warning:m({color:f,name:"warning"}),info:m({color:u,name:"info"}),success:m({color:d,name:"success"}),grey:$he,contrastThreshold:n,getContrastText:g,augmentColor:m,tonalOffset:r,...S},i)}function _ge(t){const e={};return Object.entries(t).forEach(r=>{const[i,s]=r;typeof s=="object"&&(e[i]=`${s.fontStyle?`${s.fontStyle} `:""}${s.fontVariant?`${s.fontVariant} `:""}${s.fontWeight?`${s.fontWeight} `:""}${s.fontStretch?`${s.fontStretch} `:""}${s.fontSize||""}${s.lineHeight?`/${s.lineHeight} `:""}${s.fontFamily||""}`)}),e}function Ege(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function Pge(t){return Math.round(t*1e5)/1e5}const gD={textTransform:"uppercase"},mD='"Roboto", "Helvetica", "Arial", sans-serif';function Tge(t,e){const{fontFamily:n=mD,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:s=400,fontWeightMedium:o=500,fontWeightBold:l=700,htmlFontSize:u=16,allVariants:d,pxToRem:f,...g}=typeof e=="function"?e(t):e,m=r/14,S=f||(w=>`${w/u*m}rem`),b=(w,C,_,M,I)=>({fontFamily:n,fontWeight:w,fontSize:S(C),lineHeight:_,...n===mD?{letterSpacing:`${Pge(M/C)}em`}:{},...I,...d}),v={h1:b(i,96,1.167,-1.5),h2:b(i,60,1.2,-.5),h3:b(s,48,1.167,0),h4:b(s,34,1.235,.25),h5:b(s,24,1.334,0),h6:b(o,20,1.6,.15),subtitle1:b(s,16,1.75,.15),subtitle2:b(o,14,1.57,.1),body1:b(s,16,1.5,.15),body2:b(s,14,1.43,.15),button:b(o,14,1.75,.4,gD),caption:b(s,12,1.66,.4),overline:b(s,12,2.66,1,gD),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ti({htmlFontSize:u,pxToRem:S,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:s,fontWeightMedium:o,fontWeightBold:l,...v},g,{clone:!1})}const Ige=.2,Mge=.14,Age=.12;function Qt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Ige})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Mge})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Age})`].join(",")}const kge=["none",Qt(0,2,1,-1,0,1,1,0,0,1,3,0),Qt(0,3,1,-2,0,2,2,0,0,1,5,0),Qt(0,3,3,-2,0,3,4,0,0,1,8,0),Qt(0,2,4,-1,0,4,5,0,0,1,10,0),Qt(0,3,5,-1,0,5,8,0,0,1,14,0),Qt(0,3,5,-1,0,6,10,0,0,1,18,0),Qt(0,4,5,-2,0,7,10,1,0,2,16,1),Qt(0,5,5,-3,0,8,10,1,0,3,14,2),Qt(0,5,6,-3,0,9,12,1,0,3,16,2),Qt(0,6,6,-3,0,10,14,1,0,4,18,3),Qt(0,6,7,-4,0,11,15,1,0,4,20,3),Qt(0,7,8,-4,0,12,17,2,0,5,22,4),Qt(0,7,8,-4,0,13,19,2,0,5,24,4),Qt(0,7,9,-4,0,14,21,2,0,5,26,4),Qt(0,8,9,-5,0,15,22,2,0,6,28,5),Qt(0,8,10,-5,0,16,24,2,0,6,30,5),Qt(0,8,11,-5,0,17,26,2,0,6,32,5),Qt(0,9,11,-5,0,18,28,2,0,7,34,6),Qt(0,9,12,-6,0,19,29,2,0,7,36,6),Qt(0,10,13,-6,0,20,31,3,0,8,38,7),Qt(0,10,13,-6,0,21,33,3,0,8,40,7),Qt(0,10,14,-6,0,22,35,3,0,8,42,7),Qt(0,11,14,-7,0,23,36,3,0,9,44,8),Qt(0,11,15,-7,0,24,38,3,0,9,46,8)],Rge={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Oge={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function yD(t){return`${Math.round(t)}ms`}function jge(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function Dge(t){const e={...Rge,...t.easing},n={...Oge,...t.duration};return{getAutoHeightDuration:jge,create:(i=["all"],s={})=>{const{duration:o=n.standard,easing:l=e.easeInOut,delay:u=0,...d}=s;return(Array.isArray(i)?i:[i]).map(f=>`${f} ${typeof o=="string"?o:yD(o)} ${l} ${typeof u=="string"?u:yD(u)}`).join(",")},...t,easing:e,duration:n}}const Lge={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function Nge(t){return ca(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function N7(t={}){const e={...t};function n(r){const i=Object.entries(r);for(let s=0;s<i.length;s++){const[o,l]=i[s];!Nge(l)||o.startsWith("unstable_")?delete r[o]:ca(l)&&(r[o]={...l},n(r[o]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function y_(t={},...e){const{breakpoints:n,mixins:r={},spacing:i,palette:s={},transitions:o={},typography:l={},shape:u,...d}=t;if(t.vars)throw new Error(Rc(20));const f=cP(s),g=M7(t);let m=Ti(g,{mixins:Ege(g.breakpoints,r),palette:f,shadows:kge.slice(),typography:Tge(f,l),transitions:Dge(o),zIndex:{...Lge}});return m=Ti(m,d),m=e.reduce((S,b)=>Ti(S,b),m),m.unstable_sxConfig={...mv,...d==null?void 0:d.unstable_sxConfig},m.unstable_sx=function(b){return gd({sx:b,theme:this})},m.toRuntimeSource=N7,m}function zge(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const $ge=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=zge(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function z7(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function $7(t){return t==="dark"?$ge:[]}function Bge(t){const{palette:e={mode:"light"},opacity:n,overlays:r,...i}=t,s=cP(e);return{palette:s,opacity:{...z7(s.mode),...n},overlays:r||$7(s.mode),...i}}function Fge(t){var e;return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const Uge=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],Hge=t=>(e,n)=>{const r=t.rootSelector||":root",i=t.colorSchemeSelector;let s=i;if(i==="class"&&(s=".%s"),i==="data"&&(s="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(s=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const o={};return Uge(t.cssVarPrefix).forEach(l=>{o[l]=n[l],delete n[l]}),s==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:o}}:s?{[s.replace("%s",e)]:o,[`${r}, ${s.replace("%s",e)}`]:n}:{[r]:{...n,...o}}}if(s&&s!=="media")return`${r}, ${s.replace("%s",String(e))}`}else if(e){if(s==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(s)return s.replace("%s",String(e))}return r};function Kge(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function le(t,e,n){!t[e]&&n&&(t[e]=n)}function pf(t){return typeof t!="string"||!t.startsWith("hsl")?t:O7(t)}function na(t,e){`${e}Channel`in t||(t[`${e}Channel`]=ff(pf(t[e])))}function Gge(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Zs=t=>{try{return t()}catch{}},qge=(t="mui")=>hge(t);function A1(t,e,n,r){if(!e)return;e=e===!0?{}:e;const i=r==="dark"?"dark":"light";if(!n){t[r]=Bge({...e,palette:{mode:i,...e==null?void 0:e.palette}});return}const{palette:s,...o}=y_({...n,palette:{mode:i,...e==null?void 0:e.palette}});return t[r]={...e,palette:s,opacity:{...z7(i),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||$7(i)},o}function Yge(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:i=!1,cssVarPrefix:s="mui",shouldSkipGeneratingVar:o=Fge,colorSchemeSelector:l=n.light&&n.dark?"media":void 0,rootSelector:u=":root",...d}=t,f=Object.keys(n)[0],g=r||(n.light&&f!=="light"?"light":f),m=qge(s),{[g]:S,light:b,dark:v,...w}=n,C={...w};let _=S;if((g==="dark"&&!("dark"in n)||g==="light"&&!("light"in n))&&(_=!0),!_)throw new Error(Rc(21,g));const M=A1(C,_,d,g);b&&!C.light&&A1(C,b,void 0,"light"),v&&!C.dark&&A1(C,v,void 0,"dark");let I={defaultColorScheme:g,...M,cssVarPrefix:s,colorSchemeSelector:l,rootSelector:u,getCssVar:m,colorSchemes:C,font:{..._ge(M.typography),...M.font},spacing:Gge(d.spacing)};Object.keys(I.colorSchemes).forEach(G=>{const k=I.colorSchemes[G].palette,$=F=>{const N=F.split("-"),B=N[1],Y=N[2];return m(F,k[B][Y])};if(k.mode==="light"&&(le(k.common,"background","#fff"),le(k.common,"onBackground","#000")),k.mode==="dark"&&(le(k.common,"background","#000"),le(k.common,"onBackground","#fff")),Kge(k,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),k.mode==="light"){le(k.Alert,"errorColor",$t(k.error.light,.6)),le(k.Alert,"infoColor",$t(k.info.light,.6)),le(k.Alert,"successColor",$t(k.success.light,.6)),le(k.Alert,"warningColor",$t(k.warning.light,.6)),le(k.Alert,"errorFilledBg",$("palette-error-main")),le(k.Alert,"infoFilledBg",$("palette-info-main")),le(k.Alert,"successFilledBg",$("palette-success-main")),le(k.Alert,"warningFilledBg",$("palette-warning-main")),le(k.Alert,"errorFilledColor",Zs(()=>k.getContrastText(k.error.main))),le(k.Alert,"infoFilledColor",Zs(()=>k.getContrastText(k.info.main))),le(k.Alert,"successFilledColor",Zs(()=>k.getContrastText(k.success.main))),le(k.Alert,"warningFilledColor",Zs(()=>k.getContrastText(k.warning.main))),le(k.Alert,"errorStandardBg",Bt(k.error.light,.9)),le(k.Alert,"infoStandardBg",Bt(k.info.light,.9)),le(k.Alert,"successStandardBg",Bt(k.success.light,.9)),le(k.Alert,"warningStandardBg",Bt(k.warning.light,.9)),le(k.Alert,"errorIconColor",$("palette-error-main")),le(k.Alert,"infoIconColor",$("palette-info-main")),le(k.Alert,"successIconColor",$("palette-success-main")),le(k.Alert,"warningIconColor",$("palette-warning-main")),le(k.AppBar,"defaultBg",$("palette-grey-100")),le(k.Avatar,"defaultBg",$("palette-grey-400")),le(k.Button,"inheritContainedBg",$("palette-grey-300")),le(k.Button,"inheritContainedHoverBg",$("palette-grey-A100")),le(k.Chip,"defaultBorder",$("palette-grey-400")),le(k.Chip,"defaultAvatarColor",$("palette-grey-700")),le(k.Chip,"defaultIconColor",$("palette-grey-700")),le(k.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),le(k.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),le(k.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),le(k.LinearProgress,"primaryBg",Bt(k.primary.main,.62)),le(k.LinearProgress,"secondaryBg",Bt(k.secondary.main,.62)),le(k.LinearProgress,"errorBg",Bt(k.error.main,.62)),le(k.LinearProgress,"infoBg",Bt(k.info.main,.62)),le(k.LinearProgress,"successBg",Bt(k.success.main,.62)),le(k.LinearProgress,"warningBg",Bt(k.warning.main,.62)),le(k.Skeleton,"bg",`rgba(${$("palette-text-primaryChannel")} / 0.11)`),le(k.Slider,"primaryTrack",Bt(k.primary.main,.62)),le(k.Slider,"secondaryTrack",Bt(k.secondary.main,.62)),le(k.Slider,"errorTrack",Bt(k.error.main,.62)),le(k.Slider,"infoTrack",Bt(k.info.main,.62)),le(k.Slider,"successTrack",Bt(k.success.main,.62)),le(k.Slider,"warningTrack",Bt(k.warning.main,.62));const F=vm(k.background.default,.8);le(k.SnackbarContent,"bg",F),le(k.SnackbarContent,"color",Zs(()=>k.getContrastText(F))),le(k.SpeedDialAction,"fabHoverBg",vm(k.background.paper,.15)),le(k.StepConnector,"border",$("palette-grey-400")),le(k.StepContent,"border",$("palette-grey-400")),le(k.Switch,"defaultColor",$("palette-common-white")),le(k.Switch,"defaultDisabledColor",$("palette-grey-100")),le(k.Switch,"primaryDisabledColor",Bt(k.primary.main,.62)),le(k.Switch,"secondaryDisabledColor",Bt(k.secondary.main,.62)),le(k.Switch,"errorDisabledColor",Bt(k.error.main,.62)),le(k.Switch,"infoDisabledColor",Bt(k.info.main,.62)),le(k.Switch,"successDisabledColor",Bt(k.success.main,.62)),le(k.Switch,"warningDisabledColor",Bt(k.warning.main,.62)),le(k.TableCell,"border",Bt(Sm(k.divider,1),.88)),le(k.Tooltip,"bg",Sm(k.grey[700],.92))}if(k.mode==="dark"){le(k.Alert,"errorColor",Bt(k.error.light,.6)),le(k.Alert,"infoColor",Bt(k.info.light,.6)),le(k.Alert,"successColor",Bt(k.success.light,.6)),le(k.Alert,"warningColor",Bt(k.warning.light,.6)),le(k.Alert,"errorFilledBg",$("palette-error-dark")),le(k.Alert,"infoFilledBg",$("palette-info-dark")),le(k.Alert,"successFilledBg",$("palette-success-dark")),le(k.Alert,"warningFilledBg",$("palette-warning-dark")),le(k.Alert,"errorFilledColor",Zs(()=>k.getContrastText(k.error.dark))),le(k.Alert,"infoFilledColor",Zs(()=>k.getContrastText(k.info.dark))),le(k.Alert,"successFilledColor",Zs(()=>k.getContrastText(k.success.dark))),le(k.Alert,"warningFilledColor",Zs(()=>k.getContrastText(k.warning.dark))),le(k.Alert,"errorStandardBg",$t(k.error.light,.9)),le(k.Alert,"infoStandardBg",$t(k.info.light,.9)),le(k.Alert,"successStandardBg",$t(k.success.light,.9)),le(k.Alert,"warningStandardBg",$t(k.warning.light,.9)),le(k.Alert,"errorIconColor",$("palette-error-main")),le(k.Alert,"infoIconColor",$("palette-info-main")),le(k.Alert,"successIconColor",$("palette-success-main")),le(k.Alert,"warningIconColor",$("palette-warning-main")),le(k.AppBar,"defaultBg",$("palette-grey-900")),le(k.AppBar,"darkBg",$("palette-background-paper")),le(k.AppBar,"darkColor",$("palette-text-primary")),le(k.Avatar,"defaultBg",$("palette-grey-600")),le(k.Button,"inheritContainedBg",$("palette-grey-800")),le(k.Button,"inheritContainedHoverBg",$("palette-grey-700")),le(k.Chip,"defaultBorder",$("palette-grey-700")),le(k.Chip,"defaultAvatarColor",$("palette-grey-300")),le(k.Chip,"defaultIconColor",$("palette-grey-300")),le(k.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),le(k.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),le(k.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),le(k.LinearProgress,"primaryBg",$t(k.primary.main,.5)),le(k.LinearProgress,"secondaryBg",$t(k.secondary.main,.5)),le(k.LinearProgress,"errorBg",$t(k.error.main,.5)),le(k.LinearProgress,"infoBg",$t(k.info.main,.5)),le(k.LinearProgress,"successBg",$t(k.success.main,.5)),le(k.LinearProgress,"warningBg",$t(k.warning.main,.5)),le(k.Skeleton,"bg",`rgba(${$("palette-text-primaryChannel")} / 0.13)`),le(k.Slider,"primaryTrack",$t(k.primary.main,.5)),le(k.Slider,"secondaryTrack",$t(k.secondary.main,.5)),le(k.Slider,"errorTrack",$t(k.error.main,.5)),le(k.Slider,"infoTrack",$t(k.info.main,.5)),le(k.Slider,"successTrack",$t(k.success.main,.5)),le(k.Slider,"warningTrack",$t(k.warning.main,.5));const F=vm(k.background.default,.98);le(k.SnackbarContent,"bg",F),le(k.SnackbarContent,"color",Zs(()=>k.getContrastText(F))),le(k.SpeedDialAction,"fabHoverBg",vm(k.background.paper,.15)),le(k.StepConnector,"border",$("palette-grey-600")),le(k.StepContent,"border",$("palette-grey-600")),le(k.Switch,"defaultColor",$("palette-grey-300")),le(k.Switch,"defaultDisabledColor",$("palette-grey-600")),le(k.Switch,"primaryDisabledColor",$t(k.primary.main,.55)),le(k.Switch,"secondaryDisabledColor",$t(k.secondary.main,.55)),le(k.Switch,"errorDisabledColor",$t(k.error.main,.55)),le(k.Switch,"infoDisabledColor",$t(k.info.main,.55)),le(k.Switch,"successDisabledColor",$t(k.success.main,.55)),le(k.Switch,"warningDisabledColor",$t(k.warning.main,.55)),le(k.TableCell,"border",$t(Sm(k.divider,1),.68)),le(k.Tooltip,"bg",Sm(k.grey[700],.92))}na(k.background,"default"),na(k.background,"paper"),na(k.common,"background"),na(k.common,"onBackground"),na(k,"divider"),Object.keys(k).forEach(F=>{const N=k[F];F!=="tonalOffset"&&N&&typeof N=="object"&&(N.main&&le(k[F],"mainChannel",ff(pf(N.main))),N.light&&le(k[F],"lightChannel",ff(pf(N.light))),N.dark&&le(k[F],"darkChannel",ff(pf(N.dark))),N.contrastText&&le(k[F],"contrastTextChannel",ff(pf(N.contrastText))),F==="text"&&(na(k[F],"primary"),na(k[F],"secondary")),F==="action"&&(N.active&&na(k[F],"active"),N.selected&&na(k[F],"selected")))})}),I=e.reduce((G,k)=>Ti(G,k),I);const A={prefix:s,disableCssColorScheme:i,shouldSkipGeneratingVar:o,getSelector:Hge(I)},{vars:R,generateThemeVars:D,generateStyleSheets:L}=gge(I,A);return I.vars=R,Object.entries(I.colorSchemes[I.defaultColorScheme]).forEach(([G,k])=>{I[G]=k}),I.generateThemeVars=D,I.generateStyleSheets=L,I.generateSpacing=function(){return I7(d.spacing,sP(this))},I.getColorSchemeSelector=mge(l),I.spacing=I.generateSpacing(),I.shouldSkipGeneratingVar=o,I.unstable_sxConfig={...mv,...d==null?void 0:d.unstable_sxConfig},I.unstable_sx=function(k){return gd({sx:k,theme:this})},I.toRuntimeSource=N7,I}function SD(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:cP({...n===!0?{}:n.palette,mode:e})})}function Vge(t={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:i=n?void 0:{light:!0},defaultColorScheme:s=n==null?void 0:n.mode,...o}=t,l=s||"light",u=i==null?void 0:i[l],d={...i,...n?{[l]:{...typeof u!="boolean"&&u,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in t))return y_(t,...e);let f=n;"palette"in t||d[l]&&(d[l]!==!0?f=d[l].palette:l==="dark"&&(f={mode:"dark"}));const g=y_({...t,palette:f},...e);return g.defaultColorScheme=l,g.colorSchemes=d,g.palette.mode==="light"&&(g.colorSchemes.light={...d.light!==!0&&d.light,palette:g.palette},SD(g,"dark",d.dark)),g.palette.mode==="dark"&&(g.colorSchemes.dark={...d.dark!==!0&&d.dark,palette:g.palette},SD(g,"light",d.light)),g}return!n&&!("light"in d)&&l==="light"&&(d.light=!0),Yge({...o,colorSchemes:d,defaultColorScheme:l,...typeof r!="boolean"&&r},...e)}const Wge=Vge();function Xge(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const B7=t=>Xge(t)&&t!=="classes",ar=Kpe({themeId:Bhe,defaultTheme:Wge,rootShouldForwardProp:B7}),Od=dge;function Mo(t){return uge(t)}function Zge(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function S_(t,e){return S_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},S_(t,e)}function Qge(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,S_(t,e)}const vD=et.createContext(null);function Jge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function uP(t,e){var n=function(s){return e&&E.isValidElement(s)?e(s):s},r=Object.create(null);return t&&E.Children.map(t,function(i){return i}).forEach(function(i){r[i.key]=n(i)}),r}function eme(t,e){t=t||{},e=e||{};function n(f){return f in e?e[f]:t[f]}var r=Object.create(null),i=[];for(var s in t)s in e?i.length&&(r[s]=i,i=[]):i.push(s);var o,l={};for(var u in e){if(r[u])for(o=0;o<r[u].length;o++){var d=r[u][o];l[r[u][o]]=n(d)}l[u]=n(u)}for(o=0;o<i.length;o++)l[i[o]]=n(i[o]);return l}function gc(t,e,n){return n[e]!=null?n[e]:t.props[e]}function tme(t,e){return uP(t.children,function(n){return E.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:gc(n,"appear",t),enter:gc(n,"enter",t),exit:gc(n,"exit",t)})})}function nme(t,e,n){var r=uP(t.children),i=eme(e,r);return Object.keys(i).forEach(function(s){var o=i[s];if(E.isValidElement(o)){var l=s in e,u=s in r,d=e[s],f=E.isValidElement(d)&&!d.props.in;u&&(!l||f)?i[s]=E.cloneElement(o,{onExited:n.bind(null,o),in:!0,exit:gc(o,"exit",t),enter:gc(o,"enter",t)}):!u&&l&&!f?i[s]=E.cloneElement(o,{in:!1}):u&&l&&E.isValidElement(d)&&(i[s]=E.cloneElement(o,{onExited:n.bind(null,o),in:d.props.in,exit:gc(o,"exit",t),enter:gc(o,"enter",t)}))}}),i}var rme=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},ime={component:"div",childFactory:function(e){return e}},dP=function(t){Qge(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var o=s.handleExited.bind(Jge(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(i,s){var o=s.children,l=s.handleExited,u=s.firstRender;return{children:u?tme(i,l):nme(i,o,l),firstRender:!1}},n.handleExited=function(i,s){var o=uP(this.props.children);i.key in o||(i.props.onExited&&i.props.onExited(s),this.mounted&&this.setState(function(l){var u=qy({},l.children);return delete u[i.key],{children:u}}))},n.render=function(){var i=this.props,s=i.component,o=i.childFactory,l=Zge(i,["component","childFactory"]),u=this.state.contextValue,d=rme(this.state.children).map(o);return delete l.appear,delete l.enter,delete l.exit,s===null?et.createElement(vD.Provider,{value:u},d):et.createElement(vD.Provider,{value:u},et.createElement(s,l,d))},e}(et.Component);dP.propTypes={};dP.defaultProps=ime;class Xy{constructor(){O(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new Xy}static use(){const e=j7(Xy.create).current,[n,r]=E.useState(!1);return e.shouldMount=n,e.setShouldMount=r,E.useEffect(e.mountEffect,[n]),e}mount(){return this.mounted||(this.mounted=ome(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.start(...e)})}stop(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.stop(...e)})}pulsate(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.pulsate(...e)})}}function sme(){return Xy.use()}function ome(){let t,e;const n=new Promise((r,i)=>{t=r,e=i});return n.resolve=t,n.reject=e,n}function ame(t){const{className:e,classes:n,pulsate:r=!1,rippleX:i,rippleY:s,rippleSize:o,in:l,onExited:u,timeout:d}=t,[f,g]=E.useState(!1),m=Nn(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),S={width:o,height:o,top:-(o/2)+s,left:-(o/2)+i},b=Nn(n.child,f&&n.childLeaving,r&&n.childPulsate);return!l&&!f&&g(!0),E.useEffect(()=>{if(!l&&u!=null){const v=setTimeout(u,d);return()=>{clearTimeout(v)}}},[u,l,d]),p.jsx("span",{className:m,style:S,children:p.jsx("span",{className:b})})}const Wi=Io("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),v_=550,lme=80,cme=Cp`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,ume=Cp`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,dme=Cp`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,hme=ar("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),fme=ar(ame,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Wi.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${cme};
    animation-duration: ${v_}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Wi.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Wi.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Wi.childLeaving} {
    opacity: 0;
    animation-name: ${ume};
    animation-duration: ${v_}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Wi.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${dme};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,pme=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTouchRipple"}),{center:i=!1,classes:s={},className:o,...l}=r,[u,d]=E.useState([]),f=E.useRef(0),g=E.useRef(null);E.useEffect(()=>{g.current&&(g.current(),g.current=null)},[u]);const m=E.useRef(!1),S=age(),b=E.useRef(null),v=E.useRef(null),w=E.useCallback(I=>{const{pulsate:A,rippleX:R,rippleY:D,rippleSize:L,cb:G}=I;d(k=>[...k,p.jsx(fme,{classes:{ripple:Nn(s.ripple,Wi.ripple),rippleVisible:Nn(s.rippleVisible,Wi.rippleVisible),ripplePulsate:Nn(s.ripplePulsate,Wi.ripplePulsate),child:Nn(s.child,Wi.child),childLeaving:Nn(s.childLeaving,Wi.childLeaving),childPulsate:Nn(s.childPulsate,Wi.childPulsate)},timeout:v_,pulsate:A,rippleX:R,rippleY:D,rippleSize:L},f.current)]),f.current+=1,g.current=G},[s]),C=E.useCallback((I={},A={},R=()=>{})=>{const{pulsate:D=!1,center:L=i||A.pulsate,fakeElement:G=!1}=A;if((I==null?void 0:I.type)==="mousedown"&&m.current){m.current=!1;return}(I==null?void 0:I.type)==="touchstart"&&(m.current=!0);const k=G?null:v.current,$=k?k.getBoundingClientRect():{width:0,height:0,left:0,top:0};let F,N,B;if(L||I===void 0||I.clientX===0&&I.clientY===0||!I.clientX&&!I.touches)F=Math.round($.width/2),N=Math.round($.height/2);else{const{clientX:Y,clientY:K}=I.touches&&I.touches.length>0?I.touches[0]:I;F=Math.round(Y-$.left),N=Math.round(K-$.top)}if(L)B=Math.sqrt((2*$.width**2+$.height**2)/3),B%2===0&&(B+=1);else{const Y=Math.max(Math.abs((k?k.clientWidth:0)-F),F)*2+2,K=Math.max(Math.abs((k?k.clientHeight:0)-N),N)*2+2;B=Math.sqrt(Y**2+K**2)}I!=null&&I.touches?b.current===null&&(b.current=()=>{w({pulsate:D,rippleX:F,rippleY:N,rippleSize:B,cb:R})},S.start(lme,()=>{b.current&&(b.current(),b.current=null)})):w({pulsate:D,rippleX:F,rippleY:N,rippleSize:B,cb:R})},[i,w,S]),_=E.useCallback(()=>{C({},{pulsate:!0})},[C]),M=E.useCallback((I,A)=>{if(S.clear(),(I==null?void 0:I.type)==="touchend"&&b.current){b.current(),b.current=null,S.start(0,()=>{M(I,A)});return}b.current=null,d(R=>R.length>0?R.slice(1):R),g.current=A},[S]);return E.useImperativeHandle(n,()=>({pulsate:_,start:C,stop:M}),[_,C,M]),p.jsx(hme,{className:Nn(Wi.root,s.root,o),ref:v,...l,children:p.jsx(dP,{component:null,exit:!0,children:u})})});function gme(t){return To("MuiButtonBase",t)}const mme=Io("MuiButtonBase",["root","disabled","focusVisible"]),yme=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:i}=t,o=Ta({root:["root",e&&"disabled",n&&"focusVisible"]},gme,i);return n&&r&&(o.root+=` ${r}`),o},Sme=ar("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${mme.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),vme=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiButtonBase"}),{action:i,centerRipple:s=!1,children:o,className:l,component:u="button",disabled:d=!1,disableRipple:f=!1,disableTouchRipple:g=!1,focusRipple:m=!1,focusVisibleClassName:S,LinkComponent:b="a",onBlur:v,onClick:w,onContextMenu:C,onDragLeave:_,onFocus:M,onFocusVisible:I,onKeyDown:A,onKeyUp:R,onMouseDown:D,onMouseLeave:L,onMouseUp:G,onTouchEnd:k,onTouchMove:$,onTouchStart:F,tabIndex:N=0,TouchRippleProps:B,touchRippleRef:Y,type:K,...V}=r,W=E.useRef(null),ee=sme(),H=lD(ee.ref,Y),[te,ge]=E.useState(!1);d&&te&&ge(!1),E.useImperativeHandle(i,()=>({focusVisible:()=>{ge(!0),W.current.focus()}}),[]);const de=ee.shouldMount&&!f&&!d;E.useEffect(()=>{te&&m&&!f&&ee.pulsate()},[f,m,te,ee]);const Se=ra(ee,"start",D,g),me=ra(ee,"stop",C,g),Me=ra(ee,"stop",_,g),Ne=ra(ee,"stop",G,g),we=ra(ee,"stop",qe=>{te&&qe.preventDefault(),L&&L(qe)},g),Ie=ra(ee,"start",F,g),ke=ra(ee,"stop",k,g),Ue=ra(ee,"stop",$,g),Nt=ra(ee,"stop",qe=>{uD(qe.target)||ge(!1),v&&v(qe)},!1),ot=sy(qe=>{W.current||(W.current=qe.currentTarget),uD(qe.target)&&(ge(!0),I&&I(qe)),M&&M(qe)}),Mt=()=>{const qe=W.current;return u&&u!=="button"&&!(qe.tagName==="A"&&qe.href)},wt=sy(qe=>{m&&!qe.repeat&&te&&qe.key===" "&&ee.stop(qe,()=>{ee.start(qe)}),qe.target===qe.currentTarget&&Mt()&&qe.key===" "&&qe.preventDefault(),A&&A(qe),qe.target===qe.currentTarget&&Mt()&&qe.key==="Enter"&&!d&&(qe.preventDefault(),w&&w(qe))}),ft=sy(qe=>{m&&qe.key===" "&&te&&!qe.defaultPrevented&&ee.stop(qe,()=>{ee.pulsate(qe)}),R&&R(qe),w&&qe.target===qe.currentTarget&&Mt()&&qe.key===" "&&!qe.defaultPrevented&&w(qe)});let jn=u;jn==="button"&&(V.href||V.to)&&(jn=b);const dn={};jn==="button"?(dn.type=K===void 0?"button":K,dn.disabled=d):(!V.href&&!V.to&&(dn.role="button"),d&&(dn["aria-disabled"]=d));const lr=lD(n,W),Tr={...r,centerRipple:s,component:u,disabled:d,disableRipple:f,disableTouchRipple:g,focusRipple:m,tabIndex:N,focusVisible:te},ls=yme(Tr);return p.jsxs(Sme,{as:jn,className:Nn(ls.root,l),ownerState:Tr,onBlur:Nt,onClick:w,onContextMenu:me,onFocus:ot,onKeyDown:wt,onKeyUp:ft,onMouseDown:Se,onMouseLeave:we,onMouseUp:Ne,onDragLeave:Me,onTouchEnd:ke,onTouchMove:Ue,onTouchStart:Ie,ref:lr,tabIndex:d?-1:N,type:K,...dn,...V,children:[o,de?p.jsx(pme,{ref:H,center:s,...B}):null]})});function ra(t,e,n,r=!1){return sy(i=>(n&&n(i),r||t[e](i),!0))}function bme(t){return typeof t.main=="string"}function xme(t,e=[]){if(!bme(t))return!1;for(const n of e)if(!t.hasOwnProperty(n)||typeof t[n]!="string")return!1;return!0}function F7(t=[]){return([,e])=>e&&xme(e,t)}function wme(t){return To("MuiCircularProgress",t)}Io("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const il=44,b_=Cp`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,x_=Cp`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Cme=typeof b_!="string"?nP`
        animation: ${b_} 1.4s linear infinite;
      `:null,_me=typeof x_!="string"?nP`
        animation: ${x_} 1.4s ease-in-out infinite;
      `:null,Eme=t=>{const{classes:e,variant:n,color:r,disableShrink:i}=t,s={root:["root",n,`color${tn(r)}`],svg:["svg"],circle:["circle",`circle${tn(n)}`,i&&"circleDisableShrink"]};return Ta(s,wme,e)},Pme=ar("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${tn(n.color)}`]]}})(Od(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Cme||{animation:`${b_} 1.4s linear infinite`}},...Object.entries(t.palette).filter(F7()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),Tme=ar("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({display:"block"}),Ime=ar("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${tn(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(Od(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:_me||{animation:`${x_} 1.4s ease-in-out infinite`}}]}))),Mme=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiCircularProgress"}),{className:i,color:s="primary",disableShrink:o=!1,size:l=40,style:u,thickness:d=3.6,value:f=0,variant:g="indeterminate",...m}=r,S={...r,color:s,disableShrink:o,size:l,thickness:d,value:f,variant:g},b=Eme(S),v={},w={},C={};if(g==="determinate"){const _=2*Math.PI*((il-d)/2);v.strokeDasharray=_.toFixed(3),C["aria-valuenow"]=Math.round(f),v.strokeDashoffset=`${((100-f)/100*_).toFixed(3)}px`,w.transform="rotate(-90deg)"}return p.jsx(Pme,{className:Nn(b.root,i),style:{width:l,height:l,...w,...u},ownerState:S,ref:n,role:"progressbar",...C,...m,children:p.jsx(Tme,{className:b.svg,ownerState:S,viewBox:`${il/2} ${il/2} ${il} ${il}`,children:p.jsx(Ime,{className:b.circle,style:v,ownerState:S,cx:il,cy:il,r:(il-d)/2,fill:"none",strokeWidth:d})})})});function Ame(t){return To("MuiButton",t)}const dc=Io("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),kme=E.createContext({}),Rme=E.createContext(void 0),Ome=t=>{const{color:e,disableElevation:n,fullWidth:r,size:i,variant:s,loading:o,loadingPosition:l,classes:u}=t,d={root:["root",o&&"loading",s,`${s}${tn(e)}`,`size${tn(i)}`,`${s}Size${tn(i)}`,`color${tn(e)}`,n&&"disableElevation",r&&"fullWidth",o&&`loadingPosition${tn(l)}`],startIcon:["icon","startIcon",`iconSize${tn(i)}`],endIcon:["icon","endIcon",`iconSize${tn(i)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},f=Ta(d,Ame,u);return{...u,...f}},U7=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],jme=ar(vme,{shouldForwardProp:t=>B7(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${tn(n.color)}`],e[`size${tn(n.size)}`],e[`${n.variant}Size${tn(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,n.loading&&e.loading]}})(Od(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],n=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${dc.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${dc.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${dc.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${dc.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter(F7()).map(([r])=>({props:{color:r},style:{"--variant-textColor":(t.vars||t).palette[r].main,"--variant-outlinedColor":(t.vars||t).palette[r].main,"--variant-outlinedBorder":t.vars?`rgba(${t.vars.palette[r].mainChannel} / 0.5)`:io(t.palette[r].main,.5),"--variant-containedColor":(t.vars||t).palette[r].contrastText,"--variant-containedBg":(t.vars||t).palette[r].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[r].dark,"--variant-textBg":t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:io(t.palette[r].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[r].main,"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:io(t.palette[r].main,t.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:io(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:io(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${dc.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${dc.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${dc.loading}`]:{color:"transparent"}}}]}})),Dme=ar("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,n.loading&&e.startIconLoadingStart,e[`iconSize${tn(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...U7]})),Lme=ar("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,n.loading&&e.endIconLoadingEnd,e[`iconSize${tn(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...U7]})),Nme=ar("span",{name:"MuiButton",slot:"LoadingIndicator",overridesResolver:(t,e)=>e.loadingIndicator})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),bD=ar("span",{name:"MuiButton",slot:"LoadingIconPlaceholder",overridesResolver:(t,e)=>e.loadingIconPlaceholder})({display:"inline-block",width:"1em",height:"1em"}),zme=E.forwardRef(function(e,n){const r=E.useContext(kme),i=E.useContext(Rme),s=Wy(r,e),o=Mo({props:s,name:"MuiButton"}),{children:l,color:u="primary",component:d="button",className:f,disabled:g=!1,disableElevation:m=!1,disableFocusRipple:S=!1,endIcon:b,focusVisibleClassName:v,fullWidth:w=!1,id:C,loading:_=null,loadingIndicator:M,loadingPosition:I="center",size:A="medium",startIcon:R,type:D,variant:L="text",...G}=o,k=ige(C),$=M??p.jsx(Mme,{"aria-labelledby":k,color:"inherit",size:16}),F={...o,color:u,component:d,disabled:g,disableElevation:m,disableFocusRipple:S,fullWidth:w,loading:_,loadingIndicator:$,loadingPosition:I,size:A,type:D,variant:L},N=Ome(F),B=(R||_&&I==="start")&&p.jsx(Dme,{className:N.startIcon,ownerState:F,children:R||p.jsx(bD,{className:N.loadingIconPlaceholder,ownerState:F})}),Y=(b||_&&I==="end")&&p.jsx(Lme,{className:N.endIcon,ownerState:F,children:b||p.jsx(bD,{className:N.loadingIconPlaceholder,ownerState:F})}),K=i||"",V=typeof _=="boolean"?p.jsx("span",{className:N.loadingWrapper,style:{display:"contents"},children:_&&p.jsx(Nme,{className:N.loadingIndicator,ownerState:F,children:$})}):null;return p.jsxs(jme,{ownerState:F,className:Nn(r.className,N.root,f,K),component:d,disabled:g||_,focusRipple:!S,focusVisibleClassName:Nn(N.focusVisible,v),ref:n,type:D,id:_?k:C,...G,classes:N,children:[B,I!=="end"&&V,l,I==="end"&&V,Y]})}),H7=E.createContext();function $me(t){return To("MuiTable",t)}Io("MuiTable",["root","stickyHeader"]);const Bme=t=>{const{classes:e,stickyHeader:n}=t;return Ta({root:["root",n&&"stickyHeader"]},$me,e)},Fme=ar("table",{name:"MuiTable",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.stickyHeader&&e.stickyHeader]}})(Od(({theme:t})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...t.typography.body2,padding:t.spacing(2),color:(t.vars||t).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:e})=>e.stickyHeader,style:{borderCollapse:"separate"}}]}))),xD="table",Ume=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTable"}),{className:i,component:s=xD,padding:o="normal",size:l="medium",stickyHeader:u=!1,...d}=r,f={...r,component:s,padding:o,size:l,stickyHeader:u},g=Bme(f),m=E.useMemo(()=>({padding:o,size:l,stickyHeader:u}),[o,l,u]);return p.jsx(H7.Provider,{value:m,children:p.jsx(Fme,{as:s,role:s===xD?null:"table",ref:n,className:Nn(g.root,i),ownerState:f,...d})})}),bv=E.createContext();function Hme(t){return To("MuiTableBody",t)}Io("MuiTableBody",["root"]);const Kme=t=>{const{classes:e}=t;return Ta({root:["root"]},Hme,e)},Gme=ar("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"table-row-group"}),qme={variant:"body"},wD="tbody",Yme=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTableBody"}),{className:i,component:s=wD,...o}=r,l={...r,component:s},u=Kme(l);return p.jsx(bv.Provider,{value:qme,children:p.jsx(Gme,{className:Nn(u.root,i),as:s,ref:n,role:s===wD?null:"rowgroup",ownerState:l,...o})})});function Vme(t){return To("MuiTableCell",t)}const Wme=Io("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Xme=t=>{const{classes:e,variant:n,align:r,padding:i,size:s,stickyHeader:o}=t,l={root:["root",n,o&&"stickyHeader",r!=="inherit"&&`align${tn(r)}`,i!=="normal"&&`padding${tn(i)}`,`size${tn(s)}`]};return Ta(l,Vme,e)},Zme=ar("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`size${tn(n.size)}`],n.padding!=="normal"&&e[`padding${tn(n.padding)}`],n.align!=="inherit"&&e[`align${tn(n.align)}`],n.stickyHeader&&e.stickyHeader]}})(Od(({theme:t})=>({...t.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:t.vars?`1px solid ${t.vars.palette.TableCell.border}`:`1px solid
    ${t.palette.mode==="light"?vv(io(t.palette.divider,1),.88):Sv(io(t.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(t.vars||t).palette.text.primary,lineHeight:t.typography.pxToRem(24),fontWeight:t.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(t.vars||t).palette.text.primary}},{props:{variant:"footer"},style:{color:(t.vars||t).palette.text.secondary,lineHeight:t.typography.pxToRem(21),fontSize:t.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${Wme.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:e})=>e.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(t.vars||t).palette.background.default}}]}))),CD=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTableCell"}),{align:i="inherit",className:s,component:o,padding:l,scope:u,size:d,sortDirection:f,variant:g,...m}=r,S=E.useContext(H7),b=E.useContext(bv),v=b&&b.variant==="head";let w;o?w=o:w=v?"th":"td";let C=u;w==="td"?C=void 0:!C&&v&&(C="col");const _=g||b&&b.variant,M={...r,align:i,component:w,padding:l||(S&&S.padding?S.padding:"normal"),size:d||(S&&S.size?S.size:"medium"),sortDirection:f,stickyHeader:_==="head"&&S&&S.stickyHeader,variant:_},I=Xme(M);let A=null;return f&&(A=f==="asc"?"ascending":"descending"),p.jsx(Zme,{as:w,ref:n,className:Nn(I.root,s),"aria-sort":A,scope:C,ownerState:M,...m})});function Qme(t){return To("MuiTableContainer",t)}Io("MuiTableContainer",["root"]);const Jme=t=>{const{classes:e}=t;return Ta({root:["root"]},Qme,e)},eye=ar("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(t,e)=>e.root})({width:"100%",overflowX:"auto"}),tye=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTableContainer"}),{className:i,component:s="div",...o}=r,l={...r,component:s},u=Jme(l);return p.jsx(eye,{ref:n,as:s,className:Nn(u.root,i),ownerState:l,...o})});function nye(t){return To("MuiTableHead",t)}Io("MuiTableHead",["root"]);const rye=t=>{const{classes:e}=t;return Ta({root:["root"]},nye,e)},iye=ar("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"table-header-group"}),sye={variant:"head"},_D="thead",oye=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTableHead"}),{className:i,component:s=_D,...o}=r,l={...r,component:s},u=rye(l);return p.jsx(bv.Provider,{value:sye,children:p.jsx(iye,{as:s,className:Nn(u.root,i),ref:n,role:s===_D?null:"rowgroup",ownerState:l,...o})})});function aye(t){return To("MuiTableRow",t)}const ED=Io("MuiTableRow",["root","selected","hover","head","footer"]),lye=t=>{const{classes:e,selected:n,hover:r,head:i,footer:s}=t;return Ta({root:["root",n&&"selected",r&&"hover",i&&"head",s&&"footer"]},aye,e)},cye=ar("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.head&&e.head,n.footer&&e.footer]}})(Od(({theme:t})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${ED.hover}:hover`]:{backgroundColor:(t.vars||t).palette.action.hover},[`&.${ED.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:io(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:io(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity)}}}))),PD="tr",TD=E.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTableRow"}),{className:i,component:s=PD,hover:o=!1,selected:l=!1,...u}=r,d=E.useContext(bv),f={...r,component:s,hover:o,selected:l,head:d&&d.variant==="head",footer:d&&d.variant==="footer"},g=lye(f);return p.jsx(cye,{as:s,ref:n,className:Nn(g.root,i),role:s===PD?null:"row",ownerState:f,...u})});let Ef=a7.map(t=>({word:t}));Ef=Ef.slice(0,10);function uye(t,e){const n=Math.floor(Math.random()*t.length);return e(n),n}function dye({reportResult:t,editor:e}){const[n,r]=E.useState(-1);return p.jsxs(tye,{children:[p.jsx(zme,{variant:"contained",onClick:()=>{t(e,Ef[uye(Ef,r)].word)},children:"Roll"}),p.jsxs(Ume,{children:[p.jsx(oye,{children:p.jsx(TD,{children:p.jsx(CD,{children:"Result"})})}),p.jsx(Yme,{children:Ef.map((i,s)=>p.jsx(TD,{selected:s===n,children:p.jsx(CD,{children:i.word})},s))})]})]})}class w_ extends si{getDefaultProps(){return{w:200,h:200}}getBoundsSnapGeometry(e){return new Rr({width:e.props.h/2,height:e.props.w/2,isFilled:!0})}canEdit(){return!1}canResize(){return!0}isAspectRatioLocked(){return!1}getGeometry(e){return new Rr({width:e.props.w,height:e.props.h,isFilled:!0})}onResize(e,n){return Nc(e,n)}component(e){return p.jsx(ks,{children:p.jsx("span",{style:{position:"absolute",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:e.props.h/2,width:e.props.w/2,pointerEvents:"all"},children:p.jsx(dye,{reportResult:this.GetResultCard,editor:this.editor})})})}indicator(e){return p.jsx("rect",{width:e.props.w,height:e.props.h})}GetResultCard(e,n){console.log(n),e.createShape({type:"card-shape",x:0,y:0,props:{text:n}})}}O(w_,"type","rollabletable-shape"),O(w_,"props",{w:Le,h:Le});const ID=12;class K7 extends Ae{onEnter(){this.editor.setCursor({type:"cross",rotation:0})}onPointerDown(){const{currentPagePoint:e}=this.editor.inputs;this.editor.createShape({type:"rollabletable-shape",x:e.x-ID,y:e.y-ID})}}O(K7,"id","rollabletable");const hye=[u_,d_,w_],fye=[l7,c7,K7],pye={tools:(t,e)=>({...e,card:{id:"card",label:"Card",icon:"",kbd:"",onSelect(){t.setCurrentTool("card")}},cardgroup:{id:"cardgroup",label:"Card Group",icon:"",kbd:"",onSelect(){t.setCurrentTool("cardgroup")}},rollabletable:{id:"rollabletable",label:"Rollable Table",icon:"",kbd:"",onSelect(){t.setCurrentTool("rollabletable")}}})},gye=t=>{t.user.updateUserPreferences({isSnapMode:!0})};function mye(){const t=VS(),e=Jm(t.card),n=Jm(t.cardgroup),r=Jm(t.rollabletable);return p.jsxs(i7,{children:[p.jsx(kn,{...t.card,isSelected:e}),p.jsx(kn,{...t.cardgroup,isSelected:n}),p.jsx(kn,{...t.rollabletable,isSelected:r}),p.jsx(Q9,{})]})}const yye={Toolbar:mye};function Sye(){return p.jsx("div",{style:{position:"fixed",inset:0},children:p.jsx(jhe,{shapeUtils:hye,tools:fye,overrides:pye,components:yye,initialState:"card",onMount:gye})})}AD.createRoot(document.getElementById("root")).render(p.jsx(E.StrictMode,{children:p.jsx(Sye,{})}));
